"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[4982],{24982:function(e,t,r){r.r(t),r.d(t,{F:function(){return Nt},K:function(){return Qt},i:function(){return yt}});var i,n=r(1413),o=r(11752),a=r(61120),s=r(74165),u=r(15861),l=r(37762),p=r(15671),d=r(43144),c=r(60136),y=r(29388),h=r(50165),f=r(98496),v=r(49350),m=r(97823),g=r(13994),b=r(62980),w=r(78697),S=r(40133),k=r(69738),x=r(46584),F=r(7093),I=r(77322),Z=r(32335),E=r(49961),T=r(96263),j=r(85966),C=r(28003),_=r(33530),O=r(89031),M=r(22984),R=r(78330),D=r(52155),q=r(49796),A=r(73428),L=r(90339),P=r(82046),G=r(31278),Q=r(58428),N=r(8049),V=r(40858),U=r(95076),B=r(56389),J=r(33074),z=r(31134),W=r(41524),H=r(55916),K=r(66319),$=r(24781),X=r(80933),Y=r(63334),ee=r(37243),te=r(97345),re=r(4483),ie=r(86738),ne=r(84913),oe=r(2329),ae=r(84823),se=r(53089),ue=r(9411),le=r(66270),pe=r(14826),de=r(42488),ce=i=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).expression=null,i.name=null,i.returnType="boolean",i.title=null,i}return(0,d.Z)(r,[{key:"clone",value:function(){return new i({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}}]),r}(Z.l);(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],ce.prototype,"expression",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],ce.prototype,"name",void 0),(0,h.e)([(0,h.d)({type:["boolean","date","number","string"],json:{write:!0}})],ce.prototype,"returnType",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],ce.prototype,"title",void 0);var ye=ce=i=(0,h.e)([(0,h.n)("esri.form.ExpressionInfo")],ce),he=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).description=null,i.label=null,i.type=null,i.visibilityExpression=null,i}return(0,d.Z)(r)}(Z.l);(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],he.prototype,"description",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],he.prototype,"label",void 0),(0,h.e)([(0,h.d)()],he.prototype,"type",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],he.prototype,"visibilityExpression",void 0);var fe,ve=he=(0,h.e)([(0,h.n)("esri.form.elements.Element")],he),me=fe=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).type=null,i}return(0,d.Z)(r,[{key:"clone",value:function(){return new fe({type:this.type})}}]),r}(Z.l);(0,h.e)([(0,h.d)({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],me.prototype,"type",void 0);var ge,be=me=fe=(0,h.e)([(0,h.n)("esri.form.elements.inputs.AttachmentInput")],me),we=ge=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).attachmentKeyword=null,i.editable=!0,i.input=null,i.type="attachment",i}return(0,d.Z)(r,[{key:"clone",value:function(){return new ge({attachmentKeyword:this.attachmentKeyword,description:this.description,editable:this.editable,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}}]),r}(ve);(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],we.prototype,"attachmentKeyword",void 0),(0,h.e)([(0,h.d)({type:Boolean,json:{write:!0}})],we.prototype,"editable",void 0),(0,h.e)([(0,h.d)({type:be,json:{read:{source:"inputType"},write:{target:"inputType"}}})],we.prototype,"input",void 0),(0,h.e)([(0,h.d)({type:["attachment"],json:{read:!1,write:!0}})],we.prototype,"type",void 0);var Se=we=ge=(0,h.e)([(0,h.n)("esri.form.elements.AttachmentElement")],we),ke=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).type=null,i}return(0,d.Z)(r)}(Z.l);(0,h.e)([(0,h.d)()],ke.prototype,"type",void 0);var xe=ke=(0,h.e)([(0,h.n)("esri.form.elements.inputs.Input")],ke),Fe=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).maxLength=null,i.minLength=0,i}return(0,d.Z)(r)}(xe);(0,h.e)([(0,h.d)({type:Number,json:{write:!0}})],Fe.prototype,"maxLength",void 0),(0,h.e)([(0,h.d)({type:Number,json:{write:!0}})],Fe.prototype,"minLength",void 0);var Ie,Ze=Fe=(0,h.e)([(0,h.n)("esri.form.elements.inputs.TextInput")],Fe),Ee=Ie=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).type="barcode-scanner",i}return(0,d.Z)(r,[{key:"clone",value:function(){return new Ie({maxLength:this.maxLength,minLength:this.minLength})}}]),r}(Ze);(0,h.e)([(0,h.d)({type:["barcode-scanner"],json:{read:!1,write:!0}})],Ee.prototype,"type",void 0);var Te,je=Ee=Ie=(0,h.e)([(0,h.n)("esri.form.elements.inputs.BarcodeScannerInput")],Ee),Ce=Te=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).noValueOptionLabel=null,i.showNoValueOption=!1,i.type="combo-box",i}return(0,d.Z)(r,[{key:"clone",value:function(){return new Te({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}}]),r}(xe);(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],Ce.prototype,"noValueOptionLabel",void 0),(0,h.e)([(0,h.d)({type:Boolean,json:{write:!0}})],Ce.prototype,"showNoValueOption",void 0),(0,h.e)([(0,h.d)({type:["combo-box"],json:{read:!1,write:!0}})],Ce.prototype,"type",void 0);var _e,Oe=Ce=Te=(0,h.e)([(0,h.n)("esri.form.elements.inputs.ComboBoxInput")],Ce);function Me(e){return null!=e?new Date(e):null}function Re(e){return e?e.getTime():null}var De=_e=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).includeTime=!1,i.max=null,i.min=null,i.type="datetime-picker",i}return(0,d.Z)(r,[{key:"readMax",value:function(e,t){return Me(t.max)}},{key:"writeMax",value:function(e,t){t.max=Re(e)}},{key:"readMin",value:function(e,t){return Me(t.min)}},{key:"writeMin",value:function(e,t){t.min=Re(e)}},{key:"clone",value:function(){return new _e({includeTime:this.includeTime,max:this.max,min:this.min,type:this.type})}}]),r}(xe);(0,h.e)([(0,h.d)({type:Boolean,json:{write:!0}})],De.prototype,"includeTime",void 0),(0,h.e)([(0,h.d)({type:Date,json:{type:Number,write:!0}})],De.prototype,"max",void 0),(0,h.e)([(0,I.o)("max")],De.prototype,"readMax",null),(0,h.e)([(0,I.r)("max")],De.prototype,"writeMax",null),(0,h.e)([(0,h.d)({type:Date,json:{type:Number,write:!0}})],De.prototype,"min",void 0),(0,h.e)([(0,I.o)("min")],De.prototype,"readMin",null),(0,h.e)([(0,I.r)("min")],De.prototype,"writeMin",null),(0,h.e)([(0,h.d)({type:["datetime-picker"],json:{read:!1,write:!0}})],De.prototype,"type",void 0);var qe,Ae=De=_e=(0,h.e)([(0,h.n)("esri.form.elements.inputs.DateTimePickerInput")],De),Le=qe=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).noValueOptionLabel=null,i.showNoValueOption=!1,i.type="radio-buttons",i}return(0,d.Z)(r,[{key:"clone",value:function(){return new qe({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}}]),r}(xe);(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],Le.prototype,"noValueOptionLabel",void 0),(0,h.e)([(0,h.d)({type:Boolean,json:{write:!0}})],Le.prototype,"showNoValueOption",void 0),(0,h.e)([(0,h.d)({type:["radio-buttons"],json:{read:!1,write:!0}})],Le.prototype,"type",void 0);var Pe,Ge=Le=qe=(0,h.e)([(0,h.n)("esri.form.elements.inputs.RadioButtonsInput")],Le),Qe=Pe=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).offValue=null,i.onValue=null,i.type="switch",i}return(0,d.Z)(r,[{key:"clone",value:function(){return new Pe({offValue:this.offValue,onValue:this.onValue})}}]),r}(xe);(0,h.e)([(0,h.d)({type:[String,Number],json:{write:!0}})],Qe.prototype,"offValue",void 0),(0,h.e)([(0,h.d)({type:[String,Number],json:{write:!0}})],Qe.prototype,"onValue",void 0),(0,h.e)([(0,h.d)({type:["switch"],json:{read:!1,write:!0}})],Qe.prototype,"type",void 0);var Ne,Ve=Qe=Pe=(0,h.e)([(0,h.n)("esri.form.elements.inputs.SwitchInput")],Qe),Ue=Ne=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).type="text-area",i}return(0,d.Z)(r,[{key:"clone",value:function(){return new Ne({maxLength:this.maxLength,minLength:this.minLength})}}]),r}(Ze);(0,h.e)([(0,h.d)({type:["text-area"],json:{read:!1,write:!0}})],Ue.prototype,"type",void 0);var Be,Je=Ue=Ne=(0,h.e)([(0,h.n)("esri.form.elements.inputs.TextAreaInput")],Ue),ze=Be=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).type="text-box",i}return(0,d.Z)(r,[{key:"clone",value:function(){return new Be({maxLength:this.maxLength,minLength:this.minLength})}}]),r}(Ze);(0,h.e)([(0,h.d)({type:["text-box"],json:{read:!1,write:!0}})],ze.prototype,"type",void 0);var We,He={base:xe,key:"type",typeMap:{"barcode-scanner":je,"combo-box":Oe,"datetime-picker":Ae,"radio-buttons":Ge,switch:Ve,"text-area":Je,"text-box":ze=Be=(0,h.e)([(0,h.n)("esri.form.elements.inputs.TextBoxInput")],ze)}},Ke=We=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).domain=null,i.editable=!0,i.editableExpression=null,i.fieldName=null,i.hint=null,i.input=null,i.requiredExpression=null,i.type="field",i.valueExpression=null,i}return(0,d.Z)(r,[{key:"clone",value:function(){return new We({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}}]),r}(ve);(0,h.e)([(0,h.d)({types:E.n,json:{read:{reader:E.t},write:!0}})],Ke.prototype,"domain",void 0),(0,h.e)([(0,h.d)({type:Boolean,json:{write:!0}})],Ke.prototype,"editable",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],Ke.prototype,"editableExpression",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],Ke.prototype,"fieldName",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],Ke.prototype,"hint",void 0),(0,h.e)([(0,h.d)({types:He,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Ke.prototype,"input",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],Ke.prototype,"requiredExpression",void 0),(0,h.e)([(0,h.d)({type:String,json:{read:!1,write:!0}})],Ke.prototype,"type",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],Ke.prototype,"valueExpression",void 0);var $e,Xe=Ke=We=(0,h.e)([(0,h.n)("esri.form.elements.FieldElement")],Ke),Ye=$e=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).displayCount=null,i.displayType="list",i.editable=!0,i.orderByFields=null,i.relationshipId=null,i.type="relationship",i}return(0,d.Z)(r,[{key:"clone",value:function(){return new $e({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editable:this.editable,label:this.label,orderByFields:(0,h.m)(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}}]),r}(ve);(0,h.e)([(0,h.d)({type:Number,json:{write:!0}})],Ye.prototype,"displayCount",void 0),(0,h.e)([(0,h.d)({type:["list"],json:{write:!0}})],Ye.prototype,"displayType",void 0),(0,h.e)([(0,h.d)({type:Boolean,json:{write:!0}})],Ye.prototype,"editable",void 0),(0,h.e)([(0,h.d)({type:[f.c],json:{write:!0}})],Ye.prototype,"orderByFields",void 0),(0,h.e)([(0,h.d)({type:Number,json:{write:!0}})],Ye.prototype,"relationshipId",void 0),(0,h.e)([(0,h.d)({type:["relationship"],json:{read:!1,write:!0}})],Ye.prototype,"type",void 0);var et,tt=Ye=$e=(0,h.e)([(0,h.n)("esri.form.elements.RelationshipElement")],Ye);function rt(e){return{typesWithGroup:{base:ve,key:"type",typeMap:{attachment:Se,field:Xe,group:e,relationship:tt}},typesWithoutGroup:{base:ve,key:"type",typeMap:{attachment:Se,field:Xe,relationship:tt}}}}function it(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;var i=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((function(e){return i[e.type]})).map((function(e){return i[e.type].fromJSON(e)}))}function nt(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;var i=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((function(e){return i[e.type]})).map((function(e){return e.toJSON()}))}function ot(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e?e.map((function(e){return(0,h.N)(r?t.typesWithGroup:t.typesWithoutGroup,e)})):null}var at=et=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).elements=null,i.initialState="expanded",i.type="group",i}return(0,d.Z)(r,[{key:"castElements",value:function(e){return ot(e,ut,!1)}},{key:"readElements",value:function(e,t){return it(t.formElements,ut,!1)}},{key:"writeElements",value:function(e,t){t.formElements=nt(e,ut,!1)}},{key:"clone",value:function(){return new et({description:this.description,elements:(0,h.m)(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}}]),r}(ve);(0,h.e)([(0,h.d)({json:{write:!0}})],at.prototype,"elements",void 0),(0,h.e)([(0,h.H)("elements")],at.prototype,"castElements",null),(0,h.e)([(0,I.o)("elements",["formElements"])],at.prototype,"readElements",null),(0,h.e)([(0,I.r)("elements")],at.prototype,"writeElements",null),(0,h.e)([(0,h.d)({type:["collapsed","expanded"],json:{write:!0}})],at.prototype,"initialState",void 0),(0,h.e)([(0,h.d)({type:String,json:{read:!1,write:!0}})],at.prototype,"type",void 0);var st,ut=rt(at=et=(0,h.e)([(0,h.n)("esri.form.elements.GroupElement")],at)),lt=rt(at),pt=st=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).description=null,i.elements=null,i.expressionInfos=null,i.title=null,i}return(0,d.Z)(r,[{key:"castElements",value:function(e){return ot(e,lt)}},{key:"readElements",value:function(e,t){return it(t.formElements,lt)}},{key:"writeElements",value:function(e,t){t.formElements=nt(e,lt)}},{key:"clone",value:function(){return new st({description:this.description,expressionInfos:(0,h.m)(this.expressionInfos),elements:(0,h.m)(this.elements),title:this.title})}}]),r}(Z.l);(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],pt.prototype,"description",void 0),(0,h.e)([(0,h.d)({json:{write:!0}})],pt.prototype,"elements",void 0),(0,h.e)([(0,h.H)("elements")],pt.prototype,"castElements",null),(0,h.e)([(0,I.o)("elements",["formElements"])],pt.prototype,"readElements",null),(0,h.e)([(0,I.r)("elements")],pt.prototype,"writeElements",null),(0,h.e)([(0,h.d)({type:[ye],json:{write:!0}})],pt.prototype,"expressionInfos",void 0),(0,h.e)([(0,h.d)({type:String,json:{write:!0}})],pt.prototype,"title",void 0);var dt=pt=st=(0,h.e)([(0,h.n)("esri.form.FormTemplate")],pt);function ct(e,t,r){if(null==e.hasM||e.hasZ){var i,n=(0,l.Z)(t);try{for(n.s();!(i=n.n()).done;){var o,a=i.value,s=(0,l.Z)(a);try{for(s.s();!(o=s.n()).done;){var u=o.value;u.length>2&&(u[2]*=r)}}catch(p){s.e(p)}finally{s.f()}}}catch(p){n.e(p)}finally{n.f()}}}function yt(e,t,r){if((e||t)&&r){var i=(0,A.W)(r);ht(e,r,i),ht(t,r,i)}}function ht(e,t,r){if(e){var i,n=(0,l.Z)(e);try{for(n.s();!(i=n.n()).done;){ft(i.value.geometry,t,r)}}catch(o){n.e(o)}finally{n.f()}}}function ft(e,t,r){if(!(0,h.t)(e)&&e.spatialReference&&!(0,I.E)(e.spatialReference,t)){var i=(0,A.W)(e.spatialReference)/r;if(1!==i)if("x"in e)null!=e.z&&(e.z*=i);else if("rings"in e)ct(e,e.rings,i);else if("paths"in e)ct(e,e.paths,i);else if("points"in e&&(null==e.hasM||e.hasZ)){var n,o=(0,l.Z)(e.points);try{for(o.s();!(n=o.n()).done;){var a=n.value;a.length>2&&(a[2]*=i)}}catch(s){o.e(s)}finally{o.f()}}}}var vt,mt=0,gt=h.s.getLogger("esri.layers.graphics.sources.MemorySource"),bt=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e))._idToClientGraphic=null,i.type="memory",i}return(0,d.Z)(r,[{key:"load",value:function(e){var t=(0,h.r)(e)?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Promise.resolve(this)}},{key:"destroy",value:function(){var e;null!==(e=this._connection)&&void 0!==e&&e.close(),this._connection=null}},{key:"workerGeometryType",get:function(){var e,t=null===(e=this.layer)||void 0===e?void 0:e.geometryType;return t?this._geometryTypeRequiresClientGraphicMapping(t)?"polygon":t:null}},{key:"applyEdits",value:function(e){var t=this;return this.load().then((function(){return t._applyEdits(e)}))}},{key:"openPorts",value:function(){var e=this;return this.load().then((function(){return e._connection.openPorts()}))}},{key:"queryFeatures",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,i,n,o,a,u,p,d,c,y=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.length>1&&void 0!==y[1]?y[1]:{},e.next=3,this.load(r);case 3:return e.next=5,this._connection.invoke("queryFeatures",t?t.toJSON():null,r);case 5:if(i=e.sent,(0,L.r)(t,this.layer.spatialReference,i),n=P.default.fromJSON(i),this._requiresClientGraphicMapping()){e.next=10;break}return e.abrupt("return",n);case 10:o=this.layer.objectIdField,a=(0,l.Z)(n.features);try{for(a.s();!(u=a.n()).done;)p=u.value,d=p.attributes[o],(c=this._idToClientGraphic.get(d))&&(p.geometry=c.geometry)}catch(s){a.e(s)}finally{a.f()}return e.abrupt("return",(n.geometryType=this.layer.geometryType,n));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeaturesJSON",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,i,n=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>1&&void 0!==n[1]?n[1]:{},!this._requiresClientGraphicMapping()){e.next=3;break}throw new h.a("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");case 3:return e.next=5,this.load(r);case 5:return e.next=7,this._connection.invoke("queryFeatures",t?t.toJSON():null,r);case 7:return i=e.sent,e.abrupt("return",((0,L.r)(t,this.layer.spatialReference,i),i));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeatureCount",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryFeatureCount",e?e.toJSON():null,r)}))}},{key:"queryObjectIds",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryObjectIds",e?e.toJSON():null,r)}))}},{key:"queryExtent",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryExtent",e?e.toJSON():null,r)})).then((function(e){return{count:e.count,extent:T.M.fromJSON(e.extent)}}))}},{key:"querySnapping",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("querySnapping",e,r)}))}},{key:"_applyEdits",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,i,n,o,a,u,p,d,c,y,f,v,m,g,b,w,S;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._connection){e.next=2;break}throw new h.a("feature-layer-source:edit-failure","Memory source not loaded");case 2:return r=this.layer.objectIdField,i=null,n=[],o=[],e.next=7,Promise.all([this._prepareClientMapping(t.addFeatures,null),this._prepareClientMapping(t.updateFeatures,null)]);case 7:if(a=function(e){return"objectId"in e&&null!=e.objectId?e.objectId:"attributes"in e&&null!=e.attributes[r]?e.attributes[r]:null},t.addFeatures&&(i=this._prepareAddFeatures(t.addFeatures)),t.deleteFeatures){u=(0,l.Z)(t.deleteFeatures);try{for(u.s();!(p=u.n()).done;)d=p.value,null!=(c=a(d))&&n.push(c)}catch(s){u.e(s)}finally{u.f()}}if(y=t.updateFeatures&&this._idToClientGraphic?new Map:null,t.updateFeatures){f=(0,l.Z)(t.updateFeatures);try{for(f.s();!(v=f.n()).done;)m=v.value,o.push(this._serializeFeature(m)),y&&null!=(g=a(m))&&y.set(g,m)}catch(s){f.e(s)}finally{f.f()}}return yt(i?i.features:null,o,this.layer.spatialReference),e.next=14,this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:o,deletes:n});case 14:return b=e.sent,w=b.fullExtent,S=b.featureEditResults,e.abrupt("return",(this.fullExtent=w,i&&i.finish(S.uidToObjectId),this._updateClientGraphicIds(y,S),this._createEditsResult(S)));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_prepareClientMapping",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){var i,n,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("mesh"===this.layerOrSourceGeometryType&&!(0,h.t)(t)){e.next=2;break}return e.abrupt("return");case 2:i=[],n=(0,l.Z)(t);try{for(n.s();!(o=n.n()).done;)a=o.value.geometry,!(0,h.r)(a)||"mesh"!==a.type||a.hasExtent||a.loaded||i.push(a.load({signal:r}))}catch(s){n.e(s)}finally{n.f()}if(e.t0=i.length,!e.t0){e.next=9;break}return e.next=9,Promise.all(i);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_updateClientGraphicIds",value:function(e,t){if(this._idToClientGraphic){if(e){var r,i=(0,l.Z)(t.updateResults);try{for(i.s();!(r=i.n()).done;){var n=r.value;if(n.success){var o=e.get(n.objectId);null!=o&&this._addIdToClientGraphic(o)}}}catch(p){i.e(p)}finally{i.f()}}var a,s=(0,l.Z)(t.deleteResults);try{for(s.s();!(a=s.n()).done;){var u=a.value;u.success&&this._idToClientGraphic.delete(u.objectId)}}catch(p){s.e(p)}finally{s.f()}}}},{key:"_createEditsResult",value:function(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}},{key:"_createFeatureEditResult",value:function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new h.a("feature-layer-source:edit-failure",t.description,{code:t.code}):null}}},{key:"_prepareAddFeatures",value:function(e){for(var t=new Map,r=new Array(e.length),i=null,n=0;n<e.length;n++){var o=e[n],a=this._serializeFeature(o);!i&&(0,h.r)(o.geometry)&&(i=o.geometry.type),r[n]=a,t.set("".concat(a.uid),o)}var s=this;return{features:r,inferredGeometryType:i,finish:function(e){var r=s.sourceJSON.objectIdField;for(var i in e){var n=e[i],o=t.get(i);o&&(o.attributes||(o.attributes={}),-1===n?delete o.attributes[r]:o.attributes[r]=n,s._addIdToClientGraphic(o))}}}}},{key:"_addIdToClientGraphic",value:function(e){if(this._idToClientGraphic){var t=this.sourceJSON.objectIdField,r=e.attributes&&e.attributes[t];null!=r&&this._idToClientGraphic.set(r,e)}}},{key:"layerOrSourceGeometryType",get:function(){var e,t,r;return null!==(e=null===(t=this.layer)||void 0===t?void 0:t.geometryType)&&void 0!==e?e:null===(r=this.sourceJSON)||void 0===r?void 0:r.geometryType}},{key:"_requiresClientGraphicMapping",value:function(){return this._geometryTypeRequiresClientGraphicMapping(this.layerOrSourceGeometryType)}},{key:"_geometryRequiresClientGraphicMapping",value:function(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}},{key:"_geometryTypeRequiresClientGraphicMapping",value:function(e){return"mesh"===e||"multipatch"===e||"extent"===e}},{key:"_serializeFeature",value:function(e){var t=e.attributes,r=this._geometryForSerialization(e),i=(mt++).toString();return r?{uid:i,geometry:r.toJSON(),attributes:t}:{uid:i,attributes:t}}},{key:"_geometryForSerialization",value:function(e){var t=e.geometry;return(0,h.t)(t)?null:this._geometryRequiresClientGraphicMapping(t)?t.extent?G.v.fromExtent(t.extent):null:t}},{key:"_startWorker",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,i,n,o,a,u,p,d,c,y,f,v,m,g,b;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,q.u)("MemorySourceWorker",{strategy:(0,h.c)("feature-layers-workers")?"dedicated":"local",signal:t});case 2:return this._connection=e.sent,r=this.layer,i=r.fields,n=r.spatialReference,o=r.objectIdField,a=r.hasM,u=r.hasZ,p=r.timeInfo,d="defaults"===this.layer.originOf("spatialReference"),e.next=6,this._prepareClientMapping(this.items,t);case 6:return c=this._prepareAddFeatures(this.items),this.handles.add(this.on("before-changes",(function(e){gt.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),e.preventDefault()}))),y={features:c.features,fields:i&&i.map((function(e){return e.toJSON()})),geometryType:_.t.toJSON(this.workerGeometryType),hasM:"mesh"!==this.layerOrSourceGeometryType&&a,hasZ:"mesh"===this.layerOrSourceGeometryType||u,objectIdField:o,spatialReference:d?null:n&&n.toJSON(),timeInfo:p?p.toJSON():null},e.next=11,this._connection.invoke("load",y,{signal:t});case 11:f=e.sent,v=(0,l.Z)(f.warnings);try{for(v.s();!(m=v.n()).done;)g=m.value,gt.warn(g.message,{layer:this.layer,warning:g})}catch(s){v.e(s)}finally{v.f()}f.featureErrors.length&&gt.warn("Encountered ".concat(f.featureErrors.length," validation errors while loading features"),f.featureErrors),b=f.layerDefinition,this._geometryTypeRequiresClientGraphicMapping(c.inferredGeometryType)&&(b.geometryType=_.t.toJSON(c.inferredGeometryType)),this.sourceJSON=b,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),c.finish(f.assignedObjectIds);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(R.m.LoadableMixin((0,D.m)((0,M.a)(S.j))));(0,h.e)([(0,S.a)({Type:O.g,ensureType:(0,h.b)(O.g)})],bt.prototype,"itemType",void 0),(0,h.e)([(0,h.d)()],bt.prototype,"type",void 0),(0,h.e)([(0,h.d)({constructOnly:!0})],bt.prototype,"layer",void 0),(0,h.e)([(0,h.d)({readOnly:!0})],bt.prototype,"workerGeometryType",null),(0,h.e)([(0,h.d)()],bt.prototype,"sourceJSON",void 0),bt=(0,h.e)([(0,h.n)("esri.layers.graphics.sources.MemorySource")],bt);var wt=vt=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){return(0,p.Z)(this,r),t.call(this,e)}return(0,d.Z)(r,[{key:"clone",value:function(){var e=this.name,t=this.fields,r=this.isAscending,i=this.isUnique,n=this.description;return new vt({name:e,fields:t,isAscending:r,isUnique:i,description:n})}}]),r}(Z.l);(0,h.e)([(0,h.d)({constructOnly:!0})],wt.prototype,"name",void 0),(0,h.e)([(0,h.d)({constructOnly:!0})],wt.prototype,"fields",void 0),(0,h.e)([(0,h.d)({constructOnly:!0})],wt.prototype,"isAscending",void 0),(0,h.e)([(0,h.d)({constructOnly:!0})],wt.prototype,"isUnique",void 0),(0,h.e)([(0,h.d)({constructOnly:!0})],wt.prototype,"description",void 0),wt=vt=(0,h.e)([(0,h.n)("esri.layers.support.FeatureIndex")],wt);var St=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).shapeAreaField=null,i.shapeLengthField=null,i.units=null,i}return(0,d.Z)(r)}((0,w.l)(Z.l));(0,h.e)([(0,h.d)({type:String,json:{read:{source:"shapeAreaFieldName"}}})],St.prototype,"shapeAreaField",void 0),(0,h.e)([(0,h.d)({type:String,json:{read:{source:"shapeLengthFieldName"}}})],St.prototype,"shapeLengthField",void 0),(0,h.e)([(0,h.d)({type:String,json:{read:function(e){return A.m.read(e)||A.f.read(e)}}})],St.prototype,"units",void 0);var kt=St=(0,h.e)([(0,h.n)("esri.layers.support.GeometryFieldsInfo")],St),xt=new g.s({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),Ft=new g.s({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"}),It=function(e){(0,c.Z)(r,e);var t=(0,y.Z)(r);function r(e){var i;return(0,p.Z)(this,r),(i=t.call(this,e)).cardinality=null,i.composite=null,i.id=null,i.keyField=null,i.keyFieldInRelationshipTable=null,i.name=null,i.relatedTableId=null,i.relationshipTableId=null,i.role=null,i}return(0,d.Z)(r)}((0,w.l)(Z.l));(0,h.e)([(0,h.d)({json:{read:xt.read,write:xt.write}})],It.prototype,"cardinality",void 0),(0,h.e)([(0,h.d)({json:{read:!0,write:!0}})],It.prototype,"composite",void 0),(0,h.e)([(0,h.d)({json:{read:!0,write:!0}})],It.prototype,"id",void 0),(0,h.e)([(0,h.d)({json:{read:!0,write:!0}})],It.prototype,"keyField",void 0),(0,h.e)([(0,h.d)({json:{read:!0,write:!0}})],It.prototype,"keyFieldInRelationshipTable",void 0),(0,h.e)([(0,h.d)({json:{read:!0,write:!0}})],It.prototype,"name",void 0),(0,h.e)([(0,h.d)({json:{read:!0,write:!0}})],It.prototype,"relatedTableId",void 0),(0,h.e)([(0,h.d)({json:{read:!0,write:!0}})],It.prototype,"relationshipTableId",void 0),(0,h.e)([(0,h.d)({json:{read:Ft.read,write:Ft.write}})],It.prototype,"role",void 0);var Zt=It=(0,h.e)([(0,h.n)("esri.layers.support.Relationship")],It),Et=new g.s({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Tt={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"},jt="FeatureLayer",Ct=h.s.getLogger("esri.layers.FeatureLayer");function _t(e,t){return new h.a("layer:unsupported","Layer (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' ").concat(t),{layer:e})}function Ot(e){return e&&e instanceof S.j}function Mt(e,t,r){return!!(e&&e.hasOwnProperty(t)?e[t]:r)}function Rt(e,t,r){return e&&e.hasOwnProperty(t)?e[t]:r}function Dt(e){var t,r=null===e||void 0===e||null===(t=e.supportedSpatialAggregationStatistics)||void 0===t?void 0:t.map((function(e){return e.toLowerCase()}));return{envelope:!(null===r||void 0===r||!r.includes("envelopeaggregate")),centroid:!(null===r||void 0===r||!r.includes("centroidaggregate")),convexHull:!(null===r||void 0===r||!r.includes("convexhullaggregate"))}}function qt(e,t){var r,i=null===e||void 0===e||null===(r=e.supportedOperationsWithCacheHint)||void 0===r?void 0:r.map((function(e){return e.toLowerCase()}));return!(null===i||void 0===i||!i.includes(t.toLowerCase()))}var At=(0,te.l)();function Lt(e,t,r){var i=!(null===r||void 0===r||!r.writeLayerSchema);return{enabled:i,ignoreOrigin:i}}var Pt=function(e){(0,c.Z)(i,e);var t=(0,y.Z)(i);function i(){var e;(0,p.Z)(this,i);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n)))._handles=new k.u,e.capabilities=null,e.charts=null,e.copyright=null,e.datesInUnknownTimezone=!1,e.displayField=null,e.definitionExpression=null,e.dynamicDataSource=null,e.editFieldsInfo=null,e.editingInfo=null,e.elevationInfo=null,e.featureReduction=null,e.fields=null,e.fieldsIndex=null,e.floorInfo=null,e.formTemplate=null,e.fullExtent=null,e.gdbVersion=null,e.geometryFieldsInfo=null,e.geometryType=null,e.hasM=void 0,e.hasZ=void 0,e.heightModelInfo=null,e.historicMoment=null,e.infoFor3D=null,e.isTable=!1,e.labelsVisible=!0,e.labelingInfo=null,e.layerId=void 0,e.legendEnabled=!0,e.minScale=0,e.maxScale=0,e.globalIdField=null,e.objectIdField=null,e.outFields=null,e.path=null,e.popupEnabled=!0,e.popupTemplate=null,e.relationships=null,e.sourceJSON=null,e.returnM=void 0,e.returnZ=void 0,e.screenSizePerspectiveEnabled=!0,e.serviceDefinitionExpression=null,e.spatialReference=I.k.WGS84,e.subtypeCode=null,e.subtypeField=null,e.templates=null,e.timeInfo=null,e.title=null,e.sublayerTitleMode="item-title",e.trackIdField=null,e.type="feature",e.typeIdField=null,e.types=null,e.indexes=new(S.j.ofType(wt)),e.userIsAdmin=!1,e.version=void 0,e.visible=!0,e}return(0,d.Z)(i,[{key:"destroy",value:function(){var e;null!==(e=this.source)&&void 0!==e&&e.destroy(),this._handles=(0,h.G)(this._handles)}},{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?(0,n.Z)({url:e},t):e}},{key:"load",value:function(e){var t=this,r=(0,h.r)(e)?e.signal:null;if(!(this.portalItem&&this.portalItem.loaded&&this.source)){var i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},e).catch(h._).then((0,u.Z)((0,s.Z)().mark((function e(){var i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.url||null!=t.layerId||!/FeatureServer|MapServer\/*$/i.test(t.url)){e.next=5;break}return e.next=3,t._fetchFirstLayerId(r);case 3:null!=(i=e.sent)&&(t.layerId=i);case 5:if(t.url||t._hasMemorySource()){e.next=7;break}throw new h.a("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");case 7:return e.t0=t,e.next=10,t.createGraphicsSource(r);case 10:return e.t1=e.sent,e.abrupt("return",e.t0._initLayerProperties.call(e.t0,e.t1));case 12:case"end":return e.stop()}}),e)})))).then((function(){return t.finishLoadEditablePortalLayer(e)}));return this.addResolvingPromise(i),Promise.resolve(this)}this.addResolvingPromise(this.createGraphicsSource(r).then((function(e){return t._initLayerProperties(e)})))}},{key:"readCapabilities",value:function(e,t){return t=t.layerDefinition||t,{analytics:this._readAnalyticsCapabilities(t),attachment:this._readAttachmentCapabilities(t),data:this._readDataCapabilities(t),metadata:this._readMetadataCapabilities(t),operations:this._readOperationsCapabilities(t.capabilities||e,t),query:this._readQueryCapabilities(t),queryRelated:this._readQueryRelatedCapabilities(t),queryTopFeatures:this._readQueryTopFeaturesCapabilities(t),editing:this._readEditingCapabilities(t)}}},{key:"createQueryVersion",get:function(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")||0)+1}},{key:"editingEnabled",get:function(){return!(this.loaded&&!this.capabilities.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)},set:function(e){null!=e?this._override("editingEnabled",e):this._clearOverride("editingEnabled")}},{key:"readEditingEnabled",value:function(e,t){return this._readEditingEnabled(t,!1)}},{key:"readEditingEnabledFromWebMap",value:function(e,t,r){return this._readEditingEnabled(t,!0,r)}},{key:"writeEditingEnabled",value:function(e,t){this._writeEditingEnabled(e,t,!1)}},{key:"writeEditingEnabledToWebMap",value:function(e,t,r,i){this._writeEditingEnabled(e,t,!0,i)}},{key:"readEditingInfo",value:function(e,t){var r=t.editingInfo;return r?{lastEditDate:null!=r.lastEditDate?new Date(r.lastEditDate):null}:null}},{key:"readIsTable",value:function(e,t){return"Table"===(t=t&&t.layerDefinition||t).type||!t.geometryType}},{key:"writeIsTable",value:function(e,t,r,i){(null===i||void 0===i?void 0:i.writeLayerSchema)&&(0,h.$)(r,e?"Table":"Feature Layer",t)}},{key:"readMinScale",value:function(e,t){return t.effectiveMinScale||e||0}},{key:"readMaxScale",value:function(e,t){return t.effectiveMaxScale||e||0}},{key:"readGlobalIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).globalIdField)return t.globalIdField;if(t.fields){var r,i=(0,l.Z)(t.fields);try{for(i.s();!(r=i.n()).done;){var n=r.value;if("esriFieldTypeGlobalID"===n.type)return n.name}}catch(o){i.e(o)}finally{i.f()}}}},{key:"readObjectIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields){var r,i=(0,l.Z)(t.fields);try{for(i.s();!(r=i.n()).done;){var n=r.value;if("esriFieldTypeOID"===n.type)return n.name}}catch(o){i.e(o)}finally{i.f()}}}},{key:"parsedUrl",get:function(){var e=this.url?(0,g.j)(this.url):null;return null!=e&&(null!=this.dynamicDataSource?e.path=(0,g.G)(e.path,"dynamicLayer"):null!=this.layerId&&(e.path=(0,g.G)(e.path,this.layerId.toString()))),e}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(e){(0,re.c)(e,this.fieldsIndex),this._set("renderer",e)}},{key:"readRenderer",value:function(e,t,r){var i=(t=t.layerDefinition||t).drawingInfo&&t.drawingInfo.renderer||void 0;if(i){var n=(0,m.o)(i,t,r)||void 0;return n||Ct.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r}),n}if(t.defaultSymbol)return t.types&&t.types.length?new v.P({defaultSymbol:Gt(t.defaultSymbol,t,r),field:t.typeIdField,uniqueValueInfos:t.types.map((function(e){return{id:e.id,symbol:Gt(e.symbol,e,r)}}))}):new m.p({symbol:Gt(t.defaultSymbol,t,r)})}},{key:"source",set:function(e){var t=this._get("source");t!==e&&(Ot(t)&&this._resetMemorySource(t),Ot(e)&&this._initMemorySource(e),this._set("source",e))}},{key:"castSource",value:function(e){return e?Array.isArray(e)||e instanceof S.j?new bt({layer:this,items:e}):e:null}},{key:"readSource",value:function(e,t){var r=P.default.fromJSON(t.featureSet);return new bt({layer:this,items:r&&r.features||[]})}},{key:"readServiceDefinitionExpression",value:function(e,t){return t.definitionQuery||t.definitionExpression}},{key:"readTemplates",value:function(e,t){var r=t.editFieldsInfo,i=r&&r.creatorField,n=r&&r.editorField;return e=e&&e.map((function(e){return ee.p.fromJSON(e)})),this._fixTemplates(e,i),this._fixTemplates(e,n),e}},{key:"readTitle",value:function(e,t){var r=t.layerDefinition&&t.layerDefinition.name||t.name,i=t.title||t.layerDefinition&&t.layerDefinition.title;if(r){var n=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?(0,X.y)(this.url,r):r;var o=r;if(!o&&this.url){var a=(0,X.m)(this.url);(0,h.r)(a)&&(o=a.title)}if(!o)return;return"item-title-and-service-name"===this.sublayerTitleMode&&n&&n!==o&&(o=n+" - "+o),(0,X.h)(o)}if("item-title"===this.sublayerTitleMode&&i)return i}},{key:"readTitleFromWebMap",value:function(e,t){return t.title||t.layerDefinition&&t.layerDefinition.name}},{key:"readTypeIdField",value:function(e,t){var r=(t=t.layerDefinition||t).typeIdField;if(r&&t.fields){r=r.toLowerCase();var i=t.fields.find((function(e){return e.name.toLowerCase()===r}));i&&(r=i.name)}return r}},{key:"readTypes",value:function(e,t){var r=this;e=(t=t.layerDefinition||t).types;var i=t.editFieldsInfo,n=i&&i.creatorField,o=i&&i.editorField;return e&&e.map((function(e){return e=ee.n.fromJSON(e),r._fixTemplates(e.templates,n),r._fixTemplates(e.templates,o),e}))}},{key:"url",set:function(e){var t=(0,X.L)({layer:this,url:e,nonStandardUrlAllowed:!0,logger:Ct});this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)}},{key:"writeUrl",value:function(e,t,r,i){(0,X.b)(this,e,null,t,i)}},{key:"readVersion",value:function(e,t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}},{key:"readVisible",value:function(e,t){return t.layerDefinition&&null!=t.layerDefinition.defaultVisibility?!!t.layerDefinition.defaultVisibility:null!=t.visibility?!!t.visibility:void 0}},{key:"addAttachment",value:function(e,t){var r=this;return this.load().then((function(){return r._checkAttachmentSupport(e)})).then((function(){if(!("addAttachment"in r.source))throw new h.a(jt,"Layer source does not support addAttachment capability");return r.source.addAttachment(e,t)}))}},{key:"updateAttachment",value:function(e,t,r){var i=this;return this.load().then((function(){return i._checkAttachmentSupport(e)})).then((function(){if(!("updateAttachment"in i.source))throw new h.a(jt,"Layer source does not support updateAttachment capability");return i.source.updateAttachment(e,t,r)}))}},{key:"applyEdits",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,i){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(8057).then(r.bind(r,78057));case 2:return n=e.sent,e.next=5,this.load();case 5:return e.abrupt("return",n.applyEdits(this,this.source,t,i));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"on",value:function(e,t){return(0,o.Z)((0,a.Z)(i.prototype),"on",this).call(this,e,t)}},{key:"createPopupTemplate",value:function(e){return(0,pe.d)(this,e)}},{key:"createGraphicsSource",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var i,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._hasMemorySource()){e.next=2;break}return e.abrupt("return",this.source.load({signal:t}));case 2:return e.next=4,(0,h.ao)(Promise.all([r.e(594),r.e(2298),r.e(392),r.e(2067)]).then(r.bind(r,22067)),t);case 4:return i=e.sent,n=i.default,e.abrupt("return",new n({layer:this}).load({signal:t}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createQuery",value:function(){var e=new se.b,t=this.get("capabilities.data"),r=this.get("capabilities.query");e.dynamicDataSource=this.dynamicDataSource,e.historicMoment=this.historicMoment,e.gdbVersion=this.gdbVersion,e.returnGeometry=!0,r&&(e.compactGeometryEnabled=r.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference),t&&(t.supportsZ&&null!=this.returnZ&&(e.returnZ=this.returnZ),t.supportsM&&null!=this.returnM&&(e.returnM=this.returnM)),e.outFields=["*"];var i=(0,h.r)(this.subtypeCode)?"".concat(this.subtypeField," = ").concat(this.subtypeCode):null,n=(0,F.t)(this.definitionExpression,i);e.where=n||"1=1";var o=this.timeOffset,a=this.timeExtent;return e.timeExtent=null!=o&&null!=a?a.offset(-o.value,o.unit):a||null,e.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,e}},{key:"deleteAttachments",value:function(e,t){var r=this;return this.load().then((function(){return r._checkAttachmentSupport(e)})).then((function(){if(!("deleteAttachments"in r.source))throw new h.a(jt,"Layer source does not support deleteAttachments capability");return r.source.deleteAttachments(e,t)}))}},{key:"fetchRecomputedExtents",value:function(e){var t=this;return this.load({signal:null===e||void 0===e?void 0:e.signal}).then((function(){if(t.source.fetchRecomputedExtents)return t.source.fetchRecomputedExtents(e);throw new h.a(jt,"Layer source does not support fetchUpdates capability")}))}},{key:"getFeatureType",value:function(e){var t=this.typeIdField,r=this.types;if(!t||!e)return null;var i=e.attributes?e.attributes[t]:void 0;if(null==i)return null;var n=null;return r.some((function(e){var t=e.id;return null!=t&&(t.toString()===i.toString()&&(n=e),!!n)})),n}},{key:"getFieldDomain",value:function(e,t){var r=t&&t.feature,i=this.getFeatureType(r);if(i){var n=i.domains&&i.domains[e];if(n&&"inherited"!==n.type)return n}return this._getLayerDomain(e)}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"queryAttachments",value:function(e,t){var r=this;return e=le.c.from(e),this.load().then((function(){if(!r.get("capabilities.data.supportsAttachment"))throw new h.a(jt,"this layer doesn't support attachments");var t=e,i=t.attachmentTypes,n=t.objectIds,o=t.globalIds,a=t.num,s=t.size,u=t.start,l=t.where;if(!r.get("capabilities.operations.supportsQueryAttachments")){var p=n&&n.length>1,d=i&&i.length,c=o&&o.length,y=s&&s.length;if(p||d||c||y||a||u||l)throw new h.a(jt,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",e)}if(!(n&&n.length||l))throw new h.a(jt,"'objectIds' or 'where' are required to perform attachment query",e);if(!("queryAttachments"in r.source))throw new h.a(jt,"Layer source does not support queryAttachments capability",e);return r.source.queryAttachments(e)}))}},{key:"queryFeatures",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatures(se.b.from(e)||r.createQuery(),t)})).then((function(e){if(null!==e&&void 0!==e&&e.features){var t,i=(0,l.Z)(e.features);try{for(i.s();!(t=i.n()).done;){var n=t.value;n.layer=n.sourceLayer=r}}catch(o){i.e(o)}finally{i.f()}}return e}))}},{key:"queryObjectIds",value:function(e,t){var r=this;return this.load().then((function(){if(r.source.queryObjectIds)return r.source.queryObjectIds(se.b.from(e)||r.createQuery(),t);throw new h.a(jt,"Layer source does not support queryObjectIds capability")}))}},{key:"queryFeatureCount",value:function(e,t){var r=this;return this.load().then((function(){if(r.source.queryFeatureCount)return r.source.queryFeatureCount(se.b.from(e)||r.createQuery(),t);throw new h.a(jt,"Layer source does not support queryFeatureCount capability")}))}},{key:"queryExtent",value:function(e,t){var r=this;return this.load().then((function(){if(r.source.queryExtent)return r.source.queryExtent(se.b.from(e)||r.createQuery(),t);throw new h.a(jt,"Layer source does not support queryExtent capability")}))}},{key:"queryRelatedFeatures",value:function(e,t){var r=this;return this.load().then((function(){if("queryRelatedFeatures"in r.source)return r.source.queryRelatedFeatures(le.d.from(e),t);throw new h.a(jt,"Layer source does not support queryRelatedFeatures capability")}))}},{key:"queryRelatedFeaturesCount",value:function(e,t){var r=this;return this.load().then((function(){if("queryRelatedFeaturesCount"in r.source)return r.source.queryRelatedFeaturesCount(le.d.from(e),t);throw new h.a(jt,"Layer source does not support queryRelatedFeaturesCount capability")}))}},{key:"queryTopFeatures",value:function(e,t){var r=this;return this.load().then((function(){if("queryTopFeatures"in r.source&&r.get("capabilities.query.supportsTopFeaturesQuery"))return r.source.queryTopFeatures(le.S.from(e),t).then((function(e){if(null!==e&&void 0!==e&&e.features){var t,i=(0,l.Z)(e.features);try{for(i.s();!(t=i.n()).done;){var n=t.value;n.layer=n.sourceLayer=r}}catch(o){i.e(o)}finally{i.f()}}return e}));throw new h.a(jt,"Layer source does not support queryTopFeatures capability")}))}},{key:"queryTopObjectIds",value:function(e,t){var r=this;return this.load().then((function(){if("queryTopObjectIds"in r.source&&r.get("capabilities.query.supportsTopFeaturesQuery"))return r.source.queryTopObjectIds(le.S.from(e),t);throw new h.a(jt,"Layer source does not support queryTopObjectIds capability")}))}},{key:"queryTopFeaturesExtent",value:function(e,t){var r=this;return this.load().then((function(){if("queryTopExtents"in r.source&&r.get("capabilities.query.supportsTopFeaturesQuery"))return r.source.queryTopExtents(le.S.from(e),t);throw new h.a(jt,"Layer source does not support queryTopExtents capability")}))}},{key:"queryTopFeatureCount",value:function(e,t){var r=this;return this.load().then((function(){if("queryTopCount"in r.source&&r.get("capabilities.query.supportsTopFeaturesQuery"))return r.source.queryTopCount(le.S.from(e),t);throw new h.a(jt,"Layer source does not support queryFeatureCount capability")}))}},{key:"read",value:function(e,t){var r=e.featureCollection;if(r){var n=r.layers;n&&1===n.length&&((0,o.Z)((0,a.Z)(i.prototype),"read",this).call(this,n[0],t),null!=r.showLegend&&(0,o.Z)((0,a.Z)(i.prototype),"read",this).call(this,{showLegend:r.showLegend},t))}(0,o.Z)((0,a.Z)(i.prototype),"read",this).call(this,e,t),t&&"service"===t.origin&&this.revert(["objectIdField","fields","timeInfo","spatialReference"],"service")}},{key:"write",value:function(e,t){var r,s,u=t=(0,n.Z)((0,n.Z)({},t),{},{writeLayerSchema:null!==(r=null===(s=t)||void 0===s?void 0:s.writeLayerSchema)&&void 0!==r?r:this._hasMemorySource()}),l=u.origin,p=u.layerContainerType,d=u.messages;if(this.dynamicDataSource)return null!==d&&void 0!==d&&d.push(_t(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if("web-scene"===l||"web-map"===l&&"tables"!==p)return null!==d&&void 0!==d&&d.push(_t(this,"using a table source cannot be written to web scenes and web maps")),null;if(this._hasMemorySource())return null!==d&&void 0!==d&&d.push(_t(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&"web-map"===l&&"tables"===p)return null!==d&&void 0!==d&&d.push(_t(this,"using a non-table source cannot be written to tables in web maps")),null;return(0,o.Z)((0,a.Z)(i.prototype),"write",this).call(this,e,t)}},{key:"clone",value:function(){if(this._hasMemorySource())throw new h.a(jt,"FeatureLayer (title: ".concat(this.title,", id: ").concat(this.id,") created using in-memory source cannot be cloned"));return(0,o.Z)((0,a.Z)(i.prototype),"clone",this).call(this)}},{key:"serviceSupportsSpatialReference",value:function(e){return!!this.loaded&&("memory"===this.source.type||(0,ae.e)(this,e))}},{key:"save",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(8643),r.e(1056),r.e(8638)]).then(r.bind(r,98638));case 2:return e.abrupt("return",e.sent.save(this,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveAs",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,i){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(8643),r.e(1056),r.e(8638)]).then(r.bind(r,98638));case 2:return e.abrupt("return",e.sent.saveAs(this,t,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_readEditingEnabled",value:function(e,t,r){var i,n=null===(i=e.layerDefinition)||void 0===i?void 0:i.capabilities;return n?this._hasEditingCapability(n):(n=e.capabilities,t&&"web-map"===(null===r||void 0===r?void 0:r.origin)&&!this._hasMemorySource()&&n?this._hasEditingCapability(n):void 0)}},{key:"_hasEditingCapability",value:function(e){return e.toLowerCase().split(",").map((function(e){return e.trim()})).includes("editing")}},{key:"_writeEditingEnabled",value:function(e,t,r,i){if(!e){var n,o,a=null!==(n=this.capabilities)&&void 0!==n&&null!==(o=n.operations)&&void 0!==o&&o.supportsSync?"Query,Sync":"Query";(0,h.$)("layerDefinition.capabilities",a,t),r&&(null===i||void 0===i||!i.writeLayerSchema)&&(t.capabilities=a)}}},{key:"_checkAttachmentSupport",value:function(e){var t=e.attributes,r=this.objectIdField;return this.get("capabilities.data.supportsAttachment")?e?t?t[r]?void 0:Promise.reject(new h.a(jt,"feature is missing the identifying attribute ".concat(r))):Promise.reject(new h.a(jt,"'attributes' are required on a feature to query attachments")):Promise.reject(new h.a(jt,"A feature is required to add/delete/update attachments")):Promise.reject(new h.a(jt,"this layer doesn't support attachments"))}},{key:"_getLayerDomain",value:function(e){var t=this.fieldsIndex.get(e);return t?t.domain:null}},{key:"_fetchFirstLayerId",value:function(e){return(0,g.U)(this.url,{query:(0,n.Z)((0,n.Z)({f:"json"},this.customParameters),{},{token:this.apiKey}),responseType:"json",signal:e}).then((function(e){var t=e.data;if(t)return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}))}},{key:"_initLayerProperties",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",url:this.parsedUrl})),this._verifySource(),this._verifyFields(),(0,re.c)(this.renderer,this.fieldsIndex),(0,re.m)(this.timeInfo,this.fieldsIndex),(0,ue.t)(this,{origin:"service"})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hasDataChanged",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,r,i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=this.source)||void 0===t||!t.refresh){e.next=13;break}return e.prev=1,e.next=4,null===(r=this.source)||void 0===r?void 0:r.refresh();case 4:if(i=e.sent,o=i.dataChanged,a=i.updates,(0,h.r)(a)&&(this.sourceJSON=(0,n.Z)((0,n.Z)({},this.sourceJSON),a),this.read(a,{origin:"service",url:this.parsedUrl})),!o){e.next=9;break}return e.abrupt("return",!0);case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(1);case 13:if(!this.definitionExpression){e.next=22;break}return e.prev=14,e.next=17,(0,F.r)(this.definitionExpression,this.fieldsIndex);case 17:return e.abrupt("return",e.sent.hasDateFunctions);case 20:e.prev=20,e.t1=e.catch(14);case 22:return e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e,this,[[1,11],[14,20]])})));return function(){return e.apply(this,arguments)}}()},{key:"_verifyFields",value:function(){var e,t=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||-1!==t.search(/\/FeatureServer\//i)||(null===(e=this.fields)||void 0===e?void 0:e.some((function(e){return"geometry"===e.type})))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}},{key:"_fixTemplates",value:function(e,t){e&&e.forEach((function(e){var r=e.prototype&&e.prototype.attributes;r&&t&&delete r[t]}))}},{key:"_verifySource",value:function(){if(this._hasMemorySource()){if(this.url)throw new h.a("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new h.a("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}},{key:"_initMemorySource",value:function(e){var t=this;e.forEach((function(e){e.layer=t,e.sourceLayer=t})),this._handles.add([e.on("after-add",(function(e){e.item.layer=t,e.item.sourceLayer=t})),e.on("after-remove",(function(e){e.item.layer=null,e.item.sourceLayer=null}))],"fl-source")}},{key:"_resetMemorySource",value:function(e){e.forEach((function(e){e.layer=null,e.sourceLayer=null})),this._handles.remove("fl-source")}},{key:"_hasMemorySource",value:function(){return!(this.url||!this.source)}},{key:"_readAnalyticsCapabilities",value:function(e){return{supportsCacheHint:qt(e.advancedQueryCapabilities,"queryAnalytics")}}},{key:"_readAttachmentCapabilities",value:function(e){var t=e.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:qt(e.advancedQueryCapabilities,"queryAttachments"),supportsResize:Mt(e,"supportsAttachmentsResizing",!1)};return t&&Array.isArray(t)&&t.forEach((function(e){var t=Tt[e.name];t&&(r[t]=!!e.isEnabled)})),r}},{key:"_readDataCapabilities",value:function(e){return{isVersioned:Mt(e,"isDataVersioned",!1),supportsAttachment:Mt(e,"hasAttachments",!1),supportsM:Mt(e,"hasM",!1),supportsZ:Mt(e,"hasZ",!1)}}},{key:"_readMetadataCapabilities",value:function(e){return{supportsAdvancedFieldProperties:Mt(e,"supportsFieldDescriptionProperty",!1)}}},{key:"_readOperationsCapabilities",value:function(e,t){var r=e?e.toLowerCase().split(",").map((function(e){return e.trim()})):[],i=this.url?(0,X.m)(this.url):null,n=r.includes((0,h.r)(i)&&"MapServer"===i.serverType?"data":"query"),o=r.includes("editing")&&!t.datesInUnknownTimezone,a=o&&r.includes("create"),s=o&&r.includes("delete"),u=o&&r.includes("update"),l=r.includes("changetracking"),p=t.advancedQueryCapabilities;return o&&!(a||s||u)&&(a=s=u=!0),{supportsCalculate:Mt(t,"supportsCalculate",!1),supportsTruncate:Mt(t,"supportsTruncate",!1),supportsValidateSql:Mt(t,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:s,supportsEditing:o,supportsChangeTracking:l,supportsQuery:n,supportsQueryAnalytics:Mt(p,"supportsQueryAnalytic",!1),supportsQueryAttachments:Mt(p,"supportsQueryAttachments",!1),supportsQueryTopFeatures:Mt(p,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:Mt(t,"supportsAttachmentsResizing",!1),supportsSync:r.includes("sync"),supportsUpdate:u,supportsExceedsLimitStatistics:Mt(t,"supportsExceedsLimitStatistics",!1)}}},{key:"_readQueryCapabilities",value:function(e){var t,r=e.advancedQueryCapabilities,i=e.ownershipBasedAccessControlForFeatures,n=e.archivingInfo,o=null===(t=this.url)||void 0===t?void 0:t.includes("MapServer"),a=!(0,h.c)("mapserver-pbf-enabled")&&o&&this.version<10.81,s=(0,X.g)(this.url),u=(e.supportedQueryFormats||"").split(",").reduce((function(e,t){var r=t.toLowerCase().trim();return r&&e.add(r),e}),new Set);return{supportsStatistics:Mt(r,"supportsStatistics",e.supportsStatistics),supportsPercentileStatistics:Mt(r,"supportsPercentileStatistics",!1),supportsSpatialAggregationStatistics:Mt(r,"supportsSpatialAggregationStatistics",!1),supportedSpatialAggregationStatistics:Dt(r),supportsCentroid:Mt(r,"supportsReturningGeometryCentroid",!1),supportsDistance:Mt(r,"supportsQueryWithDistance",!1),supportsDistinct:Mt(r,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:Mt(r,"supportsReturningQueryExtent",!1),supportsGeometryProperties:Mt(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:Mt(r,"supportsHavingClause",!1),supportsOrderBy:Mt(r,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:Mt(r,"supportsPagination",!1),supportsQuantization:Mt(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:Mt(e,"supportsQuantizationEditMode",!1),supportsQueryGeometry:Mt(e,"supportsReturningQueryGeometry",!1),supportsResultType:Mt(r,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:Mt(r,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:Mt(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:Mt(e,"useStandardizedQueries",!1),supportsTopFeaturesQuery:Mt(r,"supportsTopFeaturesQuery",!1),supportsQueryByOthers:Mt(i,"allowOthersToQuery",!0),supportsHistoricMoment:Mt(n,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:!a&&u.has("pbf"),supportsDisjointSpatialRelationship:Mt(r,"supportsDisjointSpatialRel",!1),supportsCacheHint:Mt(r,"supportsQueryWithCacheHint",!1)||qt(r,"query"),supportsDefaultSpatialReference:Mt(r,"supportsDefaultSR",!1),supportsCompactGeometry:s,maxRecordCountFactor:Rt(e,"maxRecordCountFactor",void 0),maxRecordCount:Rt(e,"maxRecordCount",void 0),standardMaxRecordCount:Rt(e,"standardMaxRecordCount",void 0),tileMaxRecordCount:Rt(e,"tileMaxRecordCount",void 0)}}},{key:"_readQueryRelatedCapabilities",value:function(e){var t=e.advancedQueryCapabilities,r=Mt(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:Mt(t,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:qt(t,"queryRelated")}}},{key:"_readQueryTopFeaturesCapabilities",value:function(e){return{supportsCacheHint:qt(e.advancedQueryCapabilities,"queryTopFilter")}}},{key:"_readEditingCapabilities",value:function(e){var t=e.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:Mt(e,"allowGeometryUpdates",!0),supportsGlobalId:Mt(e,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:Mt(e,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:Mt(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:Mt(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:Mt(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:Mt(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:Mt(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:Mt(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:Mt(t,"allowOthersToUpdate",!0)}}}]),i}((0,B.p)((0,V.a)((0,z.p)((0,$.a)((0,K.t)((0,H.n)((0,N.p)((0,J.c)((0,W.v)((0,x.O)((0,U.o)((0,Q.i)((0,w.l)(C.b))))))))))))));(0,h.e)([(0,h.d)({readOnly:!0,json:{read:!1}})],Pt.prototype,"capabilities",void 0),(0,h.e)([(0,I.o)("service","capabilities",["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"])],Pt.prototype,"readCapabilities",null),(0,h.e)([(0,h.d)({json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Pt.prototype,"charts",void 0),(0,h.e)([(0,h.d)({readOnly:!0})],Pt.prototype,"createQueryVersion",null),(0,h.e)([(0,h.d)({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],Pt.prototype,"copyright",void 0),(0,h.e)([(0,h.d)({type:Boolean})],Pt.prototype,"datesInUnknownTimezone",void 0),(0,h.e)([(0,h.d)({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],Pt.prototype,"displayField",void 0),(0,h.e)([(0,h.d)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],Pt.prototype,"definitionExpression",void 0),(0,h.e)([(0,h.d)({types:b.j,readOnly:!0})],Pt.prototype,"defaultSymbol",void 0),(0,h.e)([(0,h.d)({type:se.K})],Pt.prototype,"dynamicDataSource",void 0),(0,h.e)([(0,h.d)({readOnly:!0})],Pt.prototype,"editFieldsInfo",void 0),(0,h.e)([(0,h.d)({type:Boolean})],Pt.prototype,"editingEnabled",null),(0,h.e)([(0,I.o)(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],Pt.prototype,"readEditingEnabled",null),(0,h.e)([(0,I.o)("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],Pt.prototype,"readEditingEnabledFromWebMap",null),(0,h.e)([(0,I.r)(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],Pt.prototype,"writeEditingEnabled",null),(0,h.e)([(0,I.r)("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],Pt.prototype,"writeEditingEnabledToWebMap",null),(0,h.e)([(0,h.d)({readOnly:!0})],Pt.prototype,"editingInfo",void 0),(0,h.e)([(0,I.o)("editingInfo")],Pt.prototype,"readEditingInfo",null),(0,h.e)([(0,h.d)(function(){var e=(0,h.m)(Y.d),t=e.json.origins;return t["web-map"]={read:!1,write:!1},t["portal-item"]={read:!1,write:!1},e}())],Pt.prototype,"elevationInfo",void 0),(0,h.e)([(0,h.d)(B.a)],Pt.prototype,"featureReduction",void 0),(0,h.e)([(0,h.d)((0,n.Z)((0,n.Z)({},At.fields),{},{json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:Lt}}}}}))],Pt.prototype,"fields",void 0),(0,h.e)([(0,h.d)(At.fieldsIndex)],Pt.prototype,"fieldsIndex",void 0),(0,h.e)([(0,h.d)({type:ne.p,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],Pt.prototype,"floorInfo",void 0),(0,h.e)([(0,h.d)({type:dt,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Pt.prototype,"formTemplate",void 0),(0,h.e)([(0,h.d)({type:T.M,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],Pt.prototype,"fullExtent",void 0),(0,h.e)([(0,h.d)()],Pt.prototype,"gdbVersion",void 0),(0,h.e)([(0,h.d)({readOnly:!0,type:kt,json:{read:{source:"geometryProperties"}}})],Pt.prototype,"geometryFieldsInfo",void 0),(0,h.e)([(0,h.d)({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:Et.read},"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:Lt,writer:function(e,t,r){var i=e?Et.toJSON(e):null;i&&(0,h.$)(r,i,t)}}}},read:{source:"layerDefinition.geometryType",reader:Et.read}}})],Pt.prototype,"geometryType",void 0),(0,h.e)([(0,h.d)({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],Pt.prototype,"hasM",void 0),(0,h.e)([(0,h.d)({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],Pt.prototype,"hasZ",void 0),(0,h.e)([(0,h.d)({readOnly:!0,type:j.v})],Pt.prototype,"heightModelInfo",void 0),(0,h.e)([(0,h.d)({type:Date})],Pt.prototype,"historicMoment",void 0),(0,h.e)([(0,h.d)(Y.v)],Pt.prototype,"id",void 0),(0,h.e)([(0,h.d)({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],Pt.prototype,"infoFor3D",void 0),(0,h.e)([(0,h.d)({readOnly:!0,json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],Pt.prototype,"isTable",void 0),(0,h.e)([(0,I.o)("service","isTable",["type","geometryType"]),(0,I.o)("isTable",["layerDefinition.type","layerDefinition.geometryType"])],Pt.prototype,"readIsTable",null),(0,h.e)([(0,I.r)("web-map","isTable")],Pt.prototype,"writeIsTable",null),(0,h.e)([(0,h.d)(Y.m)],Pt.prototype,"labelsVisible",void 0),(0,h.e)([(0,h.d)({type:[ie.j],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:B.r},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:B.r},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],Pt.prototype,"labelingInfo",void 0),(0,h.e)([(0,h.d)(function(){var e=(0,h.m)(Y.u);return e.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer:function(e,t,r){(0,h.$)(r,(0,de.n)(e),t)}}},e}())],Pt.prototype,"opacity",void 0),(0,h.e)([(0,h.d)({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],Pt.prototype,"layerId",void 0),(0,h.e)([(0,h.d)(Y.c)],Pt.prototype,"legendEnabled",void 0),(0,h.e)([(0,h.d)({type:["show","hide"],json:function(){var e=(0,h.m)(Y.D.json);return e.origins["portal-item"]={read:!1,write:!1},e}()})],Pt.prototype,"listMode",void 0),(0,h.e)([(0,h.d)(Y.b)],Pt.prototype,"minScale",void 0),(0,h.e)([(0,I.o)("service","minScale",["minScale","effectiveMinScale"])],Pt.prototype,"readMinScale",null),(0,h.e)([(0,h.d)(Y.I)],Pt.prototype,"maxScale",void 0),(0,h.e)([(0,I.o)("service","maxScale",["maxScale","effectiveMaxScale"])],Pt.prototype,"readMaxScale",null),(0,h.e)([(0,h.d)({type:String})],Pt.prototype,"globalIdField",void 0),(0,h.e)([(0,I.o)("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"]),(0,I.o)("service","globalIdField",["globalIdField","fields"])],Pt.prototype,"readGlobalIdFieldFromService",null),(0,h.e)([(0,h.d)({type:String,json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:Lt}}}}})],Pt.prototype,"objectIdField",void 0),(0,h.e)([(0,I.o)("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),(0,I.o)("service","objectIdField",["objectIdField","fields"])],Pt.prototype,"readObjectIdFieldFromService",null),(0,h.e)([(0,h.d)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],Pt.prototype,"operationalLayerType",void 0),(0,h.e)([(0,h.d)(At.outFields)],Pt.prototype,"outFields",void 0),(0,h.e)([(0,h.d)({readOnly:!0})],Pt.prototype,"parsedUrl",null),(0,h.e)([(0,h.d)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Pt.prototype,"path",void 0),(0,h.e)([(0,h.d)(Y.p)],Pt.prototype,"popupEnabled",void 0),(0,h.e)([(0,h.d)({type:f.B,json:{name:"popupInfo",write:!0}})],Pt.prototype,"popupTemplate",void 0),(0,h.e)([(0,h.d)({readOnly:!0})],Pt.prototype,"defaultPopupTemplate",null),(0,h.e)([(0,h.d)({type:[Zt],readOnly:!0})],Pt.prototype,"relationships",void 0),(0,h.e)([(0,h.d)({types:m.a,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:m.n,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:function(e,t,r){return{ignoreOrigin:null===r||void 0===r?void 0:r.writeLayerSchema}}}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:function(e,t,r){return{ignoreOrigin:null===r||void 0===r?void 0:r.writeLayerSchema}}}}})],Pt.prototype,"renderer",null),(0,h.e)([(0,I.o)("service","renderer",["drawingInfo.renderer","defaultSymbol"]),(0,I.o)("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Pt.prototype,"readRenderer",null),(0,h.e)([(0,h.d)()],Pt.prototype,"sourceJSON",void 0),(0,h.e)([(0,h.d)({type:Boolean})],Pt.prototype,"returnM",void 0),(0,h.e)([(0,h.d)({type:Boolean})],Pt.prototype,"returnZ",void 0),(0,h.e)([(0,h.d)(function(){var e=(0,h.m)(Y.l);return e.json.origins["portal-item"]={read:!1,write:!1},e}())],Pt.prototype,"screenSizePerspectiveEnabled",void 0),(0,h.e)([(0,h.d)({clonable:!1})],Pt.prototype,"source",null),(0,h.e)([(0,h.H)("source")],Pt.prototype,"castSource",null),(0,h.e)([(0,I.o)("portal-item","source",["featureSet"]),(0,I.o)("web-map","source",["featureSet"])],Pt.prototype,"readSource",null),(0,h.e)([(0,h.d)({readOnly:!0})],Pt.prototype,"serviceDefinitionExpression",void 0),(0,h.e)([(0,I.o)("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],Pt.prototype,"readServiceDefinitionExpression",null),(0,h.e)([(0,h.d)({type:I.k,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],Pt.prototype,"spatialReference",void 0),(0,h.e)([(0,h.d)({type:Number})],Pt.prototype,"subtypeCode",void 0),(0,h.e)([(0,h.d)({type:String,json:{origins:{service:{read:!0}}}})],Pt.prototype,"subtypeField",void 0),(0,h.e)([(0,h.d)({type:[ee.p]})],Pt.prototype,"templates",void 0),(0,h.e)([(0,I.o)("templates",["editFieldsInfo","creatorField","editorField","templates"])],Pt.prototype,"readTemplates",null),(0,h.e)([(0,h.d)({type:oe.v})],Pt.prototype,"timeInfo",void 0),(0,h.e)([(0,h.d)()],Pt.prototype,"title",void 0),(0,h.e)([(0,I.o)("service","title",["name"]),(0,I.o)("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],Pt.prototype,"readTitle",null),(0,h.e)([(0,I.o)("web-map","title",["layerDefinition.name","title"])],Pt.prototype,"readTitleFromWebMap",null),(0,h.e)([(0,h.d)({type:String})],Pt.prototype,"sublayerTitleMode",void 0),(0,h.e)([(0,h.d)({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],Pt.prototype,"trackIdField",void 0),(0,h.e)([(0,h.d)({json:{read:!1}})],Pt.prototype,"type",void 0),(0,h.e)([(0,h.d)({type:String})],Pt.prototype,"typeIdField",void 0),(0,h.e)([(0,I.o)("service","typeIdField"),(0,I.o)("typeIdField",["layerDefinition.typeIdField"])],Pt.prototype,"readTypeIdField",null),(0,h.e)([(0,h.d)({type:[ee.n]})],Pt.prototype,"types",void 0),(0,h.e)([(0,I.o)("service","types",["types"]),(0,I.o)("types",["layerDefinition.types"])],Pt.prototype,"readTypes",null),(0,h.e)([(0,h.d)({readOnly:!0,json:{write:!1}})],Pt.prototype,"serverGens",void 0),(0,h.e)([(0,h.d)({type:S.j.ofType(wt),readOnly:!0})],Pt.prototype,"indexes",void 0),(0,h.e)([(0,h.d)(Y.f)],Pt.prototype,"url",null),(0,h.e)([(0,I.r)("url")],Pt.prototype,"writeUrl",null),(0,h.e)([(0,h.d)({readOnly:!0})],Pt.prototype,"userIsAdmin",void 0),(0,h.e)([(0,h.d)({json:{origins:{service:{read:!0}},read:!1}})],Pt.prototype,"version",void 0),(0,h.e)([(0,I.o)("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],Pt.prototype,"readVersion",null),(0,h.e)([(0,h.d)({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],Pt.prototype,"visible",void 0),(0,h.e)([(0,I.o)("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],Pt.prototype,"readVisible",null),Pt=(0,h.e)([(0,h.n)("esri.layers.FeatureLayer")],Pt);var Gt=(0,h.X)({types:b.M}),Qt=Pt,Nt=Object.freeze({__proto__:null,default:Qt})},85966:function(e,t,r){r.d(t,{v:function(){return S}});var i,n=r(1413),o=r(15671),a=r(43144),s=r(11752),u=r(61120),l=r(60136),p=r(29388),d=r(50165),c=r(13994),y=r(32335),h=r(73428),f=r(77322),v=(0,c.o)()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),m=v.jsonValues.slice();(0,d.au)(m,"orthometric");var g=(0,c.o)()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"}),b=i=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var i;return(0,o.Z)(this,r),(i=t.call(this,e)).heightModel="gravity-related-height",i.heightUnit="meters",i.vertCRS=null,i}return(0,a.Z)(r,[{key:"writeHeightModel",value:function(e,t,r){return v.write(e,t,r)}},{key:"readHeightModel",value:function(e,t,r){return v.read(e)||(r&&r.messages&&r.messages.push(function(e,t){return new d.V("height-model:unsupported","Height model of value '".concat(e,"' is not supported"),t)}(e,{context:r})),null)}},{key:"readHeightUnit",value:function(e,t,r){return g.read(e)||(r&&r.messages&&r.messages.push(w(e,{context:r})),null)}},{key:"readHeightUnitService",value:function(e,t,r){return(0,h.H)(e)||g.read(e)||(r&&r.messages&&r.messages.push(w(e,{context:r})),null)}},{key:"readVertCRS",value:function(e,t){return t.vertCRS||t.ellipsoid||t.geoid}},{key:"clone",value:function(){return new i({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}},{key:"equals",value:function(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}},{key:"write",value:function(e,t){return t=(0,n.Z)({origin:"web-scene"},t),(0,s.Z)((0,u.Z)(r.prototype),"write",this).call(this,e,t)}}],[{key:"deriveUnitFromSR",value:function(e,t){var r=(0,h.$)(t);return new i({heightModel:e.heightModel,heightUnit:r,vertCRS:e.vertCRS})}},{key:"fromJSON",value:function(e){if(!e)return null;var t=new i;return t.read(e,{origin:"web-scene"}),t}}]),r}(y.l);function w(e,t){return new d.V("height-unit:unsupported","Height unit of value '".concat(e,"' is not supported"),t)}(0,d.e)([(0,d.d)({type:v.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:m,default:"ellipsoidal"}}}})],b.prototype,"heightModel",void 0),(0,d.e)([(0,f.r)("web-scene","heightModel")],b.prototype,"writeHeightModel",null),(0,d.e)([(0,f.o)(["web-scene","service"],"heightModel")],b.prototype,"readHeightModel",null),(0,d.e)([(0,d.d)({type:g.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:g.jsonValues,write:g.write}}}})],b.prototype,"heightUnit",void 0),(0,d.e)([(0,f.o)("web-scene","heightUnit")],b.prototype,"readHeightUnit",null),(0,d.e)([(0,f.o)("service","heightUnit")],b.prototype,"readHeightUnitService",null),(0,d.e)([(0,d.d)({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],b.prototype,"vertCRS",void 0),(0,d.e)([(0,f.o)("service","vertCRS",["vertCRS","ellipsoid","geoid"])],b.prototype,"readVertCRS",null);var S=b=i=(0,d.e)([(0,d.n)("esri.geometry.HeightModelInfo")],b)},31134:function(e,t,r){r.d(t,{p:function(){return v}});var i,n=r(15671),o=r(43144),a=r(60136),s=r(29388),u=r(50165),l=r(13994),p=r(32335),d=new l.s({asc:"ascending",desc:"descending"}),c=i=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).field=null,i.valueExpression=null,i.order="ascending",i}return(0,o.Z)(r,[{key:"clone",value:function(){return new i({field:this.field,valueExpression:this.valueExpression,order:this.order})}}]),r}(p.l);(0,u.e)([(0,u.d)({type:String,json:{write:!0}})],c.prototype,"field",void 0),(0,u.e)([(0,u.d)({type:String,json:{write:!0}})],c.prototype,"valueExpression",void 0),(0,u.e)([(0,u.d)({type:d.apiValues,json:{read:d.read,write:d.write}})],c.prototype,"order",void 0);var y=c=i=(0,u.e)([(0,u.n)("esri.layers.support.OrderByInfo")],c);function h(e,t,r){if(!e)return null;var i=e.find((function(e){return!!e.field}));if(!i)return null;var n=new y;return n.read(i,r),[n]}function f(e,t,r,i){var n=e.find((function(e){return!!e.field}));n&&(0,u.$)(r,[n.toJSON()],t)}var v=function(e){var t=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).orderBy=null,e}return(0,o.Z)(r)}(e);return(0,u.e)([(0,u.d)({type:[y],json:{origins:{"web-scene":{write:!1,read:!1}},read:{source:"layerDefinition.orderBy",reader:h},write:{target:"layerDefinition.orderBy",writer:f}}})],t.prototype,"orderBy",void 0),t=(0,u.e)([(0,u.n)("esri.layers.mixins.OrderedLayer")],t)}},9411:function(e,t,r){r.d(t,{t:function(){return s}});var i=r(74165),n=r(15861),o=r(5233),a=r(50165);function s(e,t,r){return u.apply(this,arguments)}function u(){return u=(0,n.Z)((0,i.Z)().mark((function e(t,r,n){var s,u,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s=t&&t.getAtOrigin&&t.getAtOrigin("renderer",r.origin))||"unique-value"!==s.type||!s.styleOrigin){e.next=6;break}return e.next=4,(0,o.a)(s.populateFromStyle());case 4:u=e.sent,(0,a.W)(n),!1===u.ok&&(l=u.error,r&&r.messages&&r.messages.push(new a.V("renderer:style-reference","Failed to create unique value renderer from style reference: ".concat(l.message),{error:l,context:r})),t.clear("renderer",r.origin));case 6:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}}}]);
//# sourceMappingURL=4982.e180d21e.chunk.js.map