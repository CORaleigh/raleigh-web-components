"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[530,1816,6547],{62710:function(e,t,r){r.d(t,{i:function(){return s}});var n=r(15671),i=r(43144),o=r(60136),a=r(29388),u=r(48848);r(93661);var s=function(e){var t=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"apiKey",get:function(){var e;return this._isOverridden("apiKey")?this._get("apiKey"):"portalItem"in this?null===(e=this.portalItem)||void 0===e?void 0:e.apiKey:null},set:function(e){null!=e?this._override("apiKey",e):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}}]),r}(e);return(0,u.e)([(0,u.y)({type:String})],t.prototype,"apiKey",null),t=(0,u.e)([(0,u.n)("esri.layers.mixins.APIKeyMixin")],t)}},52721:function(e,t,r){r.d(t,{p:function(){return p}});var n=r(15671),i=r(43144),o=r(60136),a=r(29388),u=r(48848),s=r(93661),l=r(1685),p=function(e){var t=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"title",get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var e=(0,l.m)(this.url);if((0,s.r)(e)&&e.title)return e.title}return this._get("title")||""},set:function(e){this._set("title",e)}},{key:"url",set:function(e){this._set("url",(0,l.S)(e,u.a.getLogger(this.declaredClass)))}}]),r}(e);return(0,u.e)([(0,u.y)()],t.prototype,"title",null),(0,u.e)([(0,u.y)({type:String})],t.prototype,"url",null),t=(0,u.e)([(0,u.n)("esri.layers.mixins.ArcGISService")],t)}},36584:function(e,t,r){r.d(t,{m:function(){return y}});var n,i=r(15671),o=r(43144),a=r(60136),u=r(29388),s=r(48848),l=r(89794),p=r(40114),c=r(93661),d=n=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).color=new l.l([0,0,0,1]),n}return(0,o.Z)(r,[{key:"clone",value:function(){return new n((0,c.y)({color:this.color}))}}]),r}(p.l);(0,s.e)([(0,s.y)({type:l.l,json:{write:!0}})],d.prototype,"color",void 0);var y=d=n=(0,s.e)([(0,s.n)("esri.webmap.background.ColorBackground")],d)},61416:function(e,t,r){r.d(t,{p:function(){return y}});var n=r(43144),i=r(15671),o=r(60136),a=r(29388),u=r(48848),s=r(62610),l=r(40558),p=r(40114),c=(r(93661),new l.s({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"})),d=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.description=null,n.drawingTool=null,n.prototype=null,n.thumbnail=null,n}return(0,n.Z)(r)}((0,s.i)(p.l));(0,u.e)([(0,u.y)({json:{write:!0}})],d.prototype,"name",void 0),(0,u.e)([(0,u.y)({json:{write:!0}})],d.prototype,"description",void 0),(0,u.e)([(0,u.y)({json:{read:c.read,write:c.write}})],d.prototype,"drawingTool",void 0),(0,u.e)([(0,u.y)({json:{write:!0}})],d.prototype,"prototype",void 0),(0,u.e)([(0,u.y)({json:{write:!0}})],d.prototype,"thumbnail",void 0);var y=d=(0,u.e)([(0,u.n)("esri.layers.support.FeatureTemplate")],d)},77880:function(e,t,r){r.d(t,{n:function(){return v}});var n=r(15671),i=r(43144),o=r(60136),a=r(29388),u=r(48848),s=r(62610),l=r(40114),p=(r(93661),r(82474)),c=r(69641),d=r(61416),y=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).id=null,i.name=null,i.domains=null,i.templates=null,i}return(0,i.Z)(r,[{key:"readDomains",value:function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];t[i]=(0,c.t)(e[i])}return t}},{key:"writeDomains",value:function(e,t){for(var r={},n=0,i=Object.keys(e);n<i.length;n++){var o,a=i[n];e[a]&&(r[a]=null===(o=e[a])||void 0===o?void 0:o.toJSON())}t.domains=r}}]),r}((0,s.i)(l.l));(0,u.e)([(0,u.y)({json:{write:!0}})],y.prototype,"id",void 0),(0,u.e)([(0,u.y)({json:{write:!0}})],y.prototype,"name",void 0),(0,u.e)([(0,u.y)({json:{write:!0}})],y.prototype,"domains",void 0),(0,u.e)([(0,p.o)("domains")],y.prototype,"readDomains",null),(0,u.e)([(0,p.r)("domains")],y.prototype,"writeDomains",null),(0,u.e)([(0,u.y)({type:[d.p],json:{write:!0}})],y.prototype,"templates",void 0);var v=y=(0,u.e)([(0,u.n)("esri.layers.support.FeatureType")],y)},69641:function(e,t,r){r.d(t,{n:function(){return N},p:function(){return f},t:function(){return O},u:function(){return S},y:function(){return R}});var n,i=r(15671),o=r(43144),a=r(60136),u=r(29388),s=r(48848),l=r(40558),p=r(40114),c=r(93661),d=r(20302),y=r(82474),v=r(15436),f=n=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.code=null,n}return(0,o.Z)(r,[{key:"clone",value:function(){return new n({name:this.name,code:this.code})}}]),r}(p.l);(0,s.e)([(0,s.y)({type:String,json:{write:!0}})],f.prototype,"name",void 0),(0,s.e)([(0,s.y)({type:[String,Number],json:{write:!0}})],f.prototype,"code",void 0),f=n=(0,s.e)([(0,s.n)("esri.layers.support.CodedValue")],f);var h=new l.s({inherited:"inherited",codedValue:"coded-value",range:"range"}),m=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.type=null,n}return(0,o.Z)(r)}(p.l);(0,s.e)([(0,s.y)({type:String,json:{write:!0}})],m.prototype,"name",void 0),(0,s.e)([(0,d.r)(h)],m.prototype,"type",void 0);var g,w=m=(0,s.e)([(0,s.n)("esri.layers.support.Domain")],m),b=g=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).codedValues=null,n.type="coded-value",n}return(0,o.Z)(r,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some((function(e){return String(e.code)===r&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new g({codedValues:(0,c.y)(this.codedValues),name:this.name})}}]),r}(w);(0,s.e)([(0,s.y)({type:[f],json:{write:!0}})],b.prototype,"codedValues",void 0),(0,s.e)([(0,d.r)({codedValue:"coded-value"})],b.prototype,"type",void 0);var k,S=b=g=(0,s.e)([(0,s.n)("esri.layers.support.CodedValueDomain")],b),Z=k=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).type="inherited",n}return(0,o.Z)(r,[{key:"clone",value:function(){return new k}}]),r}(w);(0,s.e)([(0,d.r)({inherited:"inherited"})],Z.prototype,"type",void 0);var T,I=Z=k=(0,s.e)([(0,s.n)("esri.layers.support.InheritedDomain")],Z),x=T=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).maxValue=null,n.minValue=null,n.type="range",n}return(0,o.Z)(r,[{key:"clone",value:function(){return new T({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),r}(w);(0,s.e)([(0,s.y)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,r){t[r]=[this.minValue||0,e]}}}})],x.prototype,"maxValue",void 0),(0,s.e)([(0,s.y)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue||0]}}}})],x.prototype,"minValue",void 0),(0,s.e)([(0,d.r)({range:"range"})],x.prototype,"type",void 0);var _,j=x=T=(0,s.e)([(0,s.n)("esri.layers.support.RangeDomain")],x),N={key:"type",base:w,typeMap:{range:j,"coded-value":S,inherited:I}};function O(e){if(!e||!e.type)return null;switch(e.type){case"range":return j.fromJSON(e);case"codedValue":return S.fromJSON(e);case"inherited":return I.fromJSON(e)}return null}var A=new l.s({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),E=_=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).alias=null,n.defaultValue=void 0,n.description=null,n.domain=null,n.editable=!0,n.length=-1,n.name=null,n.nullable=!0,n.type=null,n.valueType=null,n.visible=!0,n}return(0,o.Z)(r,[{key:"readDescription",value:function(e,t){var r,n,i=t.description,o=null;try{o=i?JSON.parse(i):null}catch(a){}return null!==(r=null===(n=o)||void 0===n?void 0:n.value)&&void 0!==r?r:null}},{key:"readValueType",value:function(e,t){var r=t.description,n=null;try{n=r?JSON.parse(r):null}catch(i){}return n?A.fromJSON(n.fieldValueType):null}},{key:"clone",value:function(){return new _({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}}]),r}(p.l);(0,s.e)([(0,s.y)({type:String,json:{write:!0}})],E.prototype,"alias",void 0),(0,s.e)([(0,s.y)({type:[String,Number],json:{write:{allowNull:!0}}})],E.prototype,"defaultValue",void 0),(0,s.e)([(0,s.y)()],E.prototype,"description",void 0),(0,s.e)([(0,y.o)("description")],E.prototype,"readDescription",null),(0,s.e)([(0,s.y)({types:N,json:{read:{reader:O},write:!0}})],E.prototype,"domain",void 0),(0,s.e)([(0,s.y)({type:Boolean,json:{write:!0}})],E.prototype,"editable",void 0),(0,s.e)([(0,s.y)({type:s.T,json:{write:!0}})],E.prototype,"length",void 0),(0,s.e)([(0,s.y)({type:String,json:{write:!0}})],E.prototype,"name",void 0),(0,s.e)([(0,s.y)({type:Boolean,json:{write:!0}})],E.prototype,"nullable",void 0),(0,s.e)([(0,d.r)(v.i)],E.prototype,"type",void 0),(0,s.e)([(0,s.y)()],E.prototype,"valueType",void 0),(0,s.e)([(0,y.o)("valueType",["description"])],E.prototype,"readValueType",null),(0,s.e)([(0,s.y)({type:Boolean,json:{read:!1}})],E.prototype,"visible",void 0);var R=E=_=(0,s.e)([(0,s.n)("esri.layers.support.Field")],E)},630:function(e,t,r){r.d(t,{a:function(){return d},c:function(){return p},d:function(){return y}});var n=r(15671),i=r(43144),o=r(60136),a=r(29388),u=r(48848),s=r(93661),l=r(50690),p=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).updating=!1,e._handleId=0,e._handles=new u.X,e._scheduleHandleId=0,e._pendingPromises=new Set,e}return(0,i.Z)(r,[{key:"destroy",value:function(){this.removeAll(),this._handles.destroy()}},{key:"add",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._installWatch(e,t,r,l.l)}},{key:"addWhen",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._installWatch(e,t,r,l.f)}},{key:"addOnCollectionChange",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.initial,o=void 0!==i&&i,a=n.final,u=void 0!==a&&a,s=++this._handleId;return this._handles.add([(0,l.a)(e,"after-changes",this._createSyncUpdatingCallback(),l.U),(0,l.a)(e,"change",t,{onListenerAdd:o?function(e){return t({added:e.toArray(),removed:[]})}:void 0,onListenerRemove:u?function(e){return t({added:[],removed:e.toArray()})}:void 0})],s),{remove:function(){return r._handles.remove(s)}}}},{key:"addPromise",value:function(e){var t=this;if((0,s.t)(e))return e;var r=++this._handleId;this._handles.add({remove:function(){t._pendingPromises.delete(e)&&(0!==t._pendingPromises.size||t._handles.has(c)||t._set("updating",!1))}},r),this._pendingPromises.add(e),this._set("updating",!0);var n=function(){return t._handles.remove(r)};return e.then(n,n),e}},{key:"removeAll",value:function(){this._pendingPromises.clear(),this._handles.removeAll(),this._set("updating",!1)}},{key:"_installWatch",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,o=++this._handleId;n.sync||this._installSyncUpdatingWatch(e,o);var a=i(e,t,n);return this._handles.add(a,o),{remove:function(){return r._handles.remove(o)}}}},{key:"_installSyncUpdatingWatch",value:function(e,t){var r=this._createSyncUpdatingCallback(),n=(0,l.l)(e,r,{sync:!0,equals:function(){return!1}});return this._handles.add(n,t),n}},{key:"_createSyncUpdatingCallback",value:function(){var e=this;return function(){e._handles.remove(c),++e._scheduleHandleId;var t=e._scheduleHandleId;e._get("updating")||e._set("updating",!0),e._handles.add((0,u.k)((function(){t===e._scheduleHandleId&&(e._set("updating",e._pendingPromises.size>0),e._handles.remove(c))})),c)}}}]),r}(u.m);(0,u.e)([(0,u.y)({readOnly:!0})],p.prototype,"updating",void 0),p=(0,u.e)([(0,u.n)("esri.core.support.WatchUpdatingTracking")],p);var c=-42,d=function(e){var t=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"destroy",value:function(){var e,t;this.destroyed||(null!==(e=this._get("handles"))&&void 0!==e&&e.destroy(),null===(t=this._get("updatingHandles"))||void 0===t||t.destroy())}},{key:"handles",get:function(){return this._get("handles")||new u.X}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new p}}]),r}(e);return(0,u.e)([(0,u.y)({readOnly:!0})],t.prototype,"handles",null),(0,u.e)([(0,u.y)({readOnly:!0})],t.prototype,"updatingHandles",null),t=(0,u.e)([(0,u.n)("esri.core.HandleOwner")],t),t},y=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r)}(d(u.m));y=(0,u.e)([(0,u.n)("esri.core.HandleOwner")],y)},74797:function(e,t,r){r.d(t,{p:function(){return d}});var n,i=r(15671),o=r(43144),a=r(60136),u=r(29388),s=r(48848),l=r(93314),p=r(40114),c=(r(93661),n=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).floorField=null,n.viewAllMode=!1,n.viewAllLevelIds=new l.j,n}return(0,o.Z)(r,[{key:"clone",value:function(){return new n({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}}]),r}(p.l));(0,s.e)([(0,s.y)({type:String,json:{write:!0}})],c.prototype,"floorField",void 0),(0,s.e)([(0,s.y)({json:{read:!1,write:!1}})],c.prototype,"viewAllMode",void 0),(0,s.e)([(0,s.y)({json:{read:!1,write:!1}})],c.prototype,"viewAllLevelIds",void 0);var d=c=n=(0,s.e)([(0,s.n)("esri.layers.support.LayerFloorInfo")],c)},12864:function(e,t,r){r.r(t),r.d(t,{W:function(){return Gt},c:function(){return he}});var n=r(29439),i=r(93433),o=r(11752),a=r(61120),u=r(1413),s=r(37762),l=r(74165),p=r(43144),c=r(15671),d=r(60136),y=r(29388),v=r(15861),f=r(48848),h=r(40558),m=r(32161),g=r(17455),w=r(93314),b=r(93116),k=r(16641),S=r(93661),Z=r(99795),T=r(65094),I=r(50690),x=r(82474),_=r(96485),j=r(40114),N=r(1685),O=r(13405),A=r(8141),E=r(98987),R=r(477),C=r(46817),L=r(40811),F=r(35237),U=r(21015),V=(r(68781),r(74384)),P=r(94518),J=r(2473),G=r(63638),D=r(62610),M=r(20302),B=r(56162),W=r(89181),q=r(92982),z=r(62642),K=r(92072),H=r(36584),Y=r(70288);function X(e,t){return Q.apply(this,arguments)}function Q(){return Q=(0,v.Z)((0,l.Z)().mark((function e(t,r){var n,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Utility Network Layer"!==t){e.next=6;break}return e.next=3,Promise.resolve().then((function(){return _e}));case 3:return n=e.sent,i=n.default,e.abrupt("return",new i({layerUrl:r}));case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function $(){return $=(0,v.Z)((0,l.Z)().mark((function e(t){var r,n,i,o,a,s,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!(r="portalItem"in t?t:{portalItem:t}).portalItem||r.portalItem instanceof U.default||(r=(0,u.Z)((0,u.Z)({},r),{},{portalItem:new U.default(r.portalItem)})),n=r.portalItem,e.next=5,n.load();case 5:if("Feature Service"===n.type){e.next=7;break}throw new f.s("portal:unknown-item-type","Unknown item type '${type}'",{type:n.type});case 7:return i=n.url,e.next=10,(0,h.U)(i,{responseType:"json",query:{f:"json"}});case 10:if(o=e.sent,a="Network Layer",!o.data.type||!o.data.type.includes(a)){e.next=14;break}return e.abrupt("return",X(o.data.type,i));case 14:if(!o.data.layers){e.next=19;break}if(s=o.data.layers.find((function(e){return e.type.includes(a)})),!s){e.next=19;break}return p="".concat(i,"/").concat(s.id),e.abrupt("return",X(s.type,p));case 19:return e.abrupt("return",null);case 20:case"end":return e.stop()}}),e)}))),$.apply(this,arguments)}var ee=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).globalIds=[],n.creators=[],n.tags=[],n.names=[],n}return(0,p.Z)(r)}(j.l);(0,f.e)([(0,f.y)({type:[String],json:{write:!0}})],ee.prototype,"globalIds",void 0),(0,f.e)([(0,f.y)({type:[String],json:{write:!0}})],ee.prototype,"creators",void 0),(0,f.e)([(0,f.y)({type:[String],json:{write:!0}})],ee.prototype,"tags",void 0),(0,f.e)([(0,f.y)({type:[String],json:{write:!0}})],ee.prototype,"names",void 0);var te,re=ee=(0,f.e)([(0,f.n)("esri.rest.networks.support.QueryNamedTraceConfigurationsParameters")],ee);!function(e){e[e.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",e[e.RTContainment=2]="RTContainment",e[e.RTAttachment=3]="RTAttachment",e[e.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",e[e.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"}(te||(te={}));var ne=new h.s({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"});new h.s({connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"});var ie=new h.s({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"}),oe=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).gdbVersion=null,n.sessionID=null,n.validationType=null,n.validateArea=null,n.validationSet=null,n.returnEdits=!1,n}return(0,p.Z)(r)}(j.l);(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],oe.prototype,"gdbVersion",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],oe.prototype,"sessionID",void 0),(0,f.e)([(0,f.y)({type:ie.apiValues,json:{type:ie.jsonValues,read:ie.read,write:ie.write}})],oe.prototype,"validationType",void 0),(0,f.e)([(0,f.y)({type:C.w,json:{write:!0}})],oe.prototype,"validateArea",void 0),(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],oe.prototype,"validationSet",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],oe.prototype,"returnEdits",void 0);var ae=oe=(0,f.e)([(0,f.n)("esri.rest.networks.support.ValidateNetworkTopologyParameters")],oe),ue=function(e){(0,d.Z)(n,e);var t=(0,y.Z)(n);function n(e){var r;return(0,c.Z)(this,n),(r=t.call(this,e)).id=null,r.title=null,r.layerUrl=null,r.dataElement=null,r.fullExtent=null,r.spatialReference=null,r.type=null,r.sourceJSON=null,r}return(0,p.Z)(n,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){var r,n;(0,f.j)(t)||f.a.getLogger(e.declaredClass).error("#load()","Failed to load layer (title: '".concat(null!==(r=e.title)&&void 0!==r?r:"no title","', id: '").concat(null!==(n=e.id)&&void 0!==n?n:"no id","')"),{error:t})}))}},{key:"datasetName",get:function(){var e,t;return null!==(e=null===(t=this.dataElement)||void 0===t?void 0:t.name)&&void 0!==e?e:null}},{key:"owner",get:function(){var e,t;return null!==(e=null===(t=this.dataElement)||void 0===t?void 0:t.userIdentity)&&void 0!==e?e:null}},{key:"schemaGeneration",get:function(){var e,t;return null!==(e=null===(t=this.dataElement)||void 0===t?void 0:t.schemaGeneration)&&void 0!==e?e:null}},{key:"parsedUrl",get:function(){return(0,h.j)(this.layerUrl)}},{key:"featureServiceUrl",get:function(){var e=this.parsedUrl&&(0,N.m)(this.parsedUrl.path);return(0,S.r)(e)?e.url.path:null}},{key:"networkServiceUrl",get:function(){return this.featureServiceUrl?this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer"):null}},{key:"layerId",get:function(){var e=this.parsedUrl&&(0,N.m)(this.parsedUrl.path);return(0,S.r)(e)?e.sublayer:null}},{key:"networkSystemLayers",get:function(){return null}},{key:"load",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),t)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,t)),this));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLayerIdBySourceId",value:function(e){if(this.dataElement){var t,r=this.dataElement.domainNetworks,n=(0,s.Z)(r);try{for(n.s();!(t=n.n()).done;){var i,o=t.value,a=(0,s.Z)(o.edgeSources?o.edgeSources:[]);try{for(a.s();!(i=a.n()).done;){var u=i.value;if(u.sourceId===e)return u.layerId}}catch(d){a.e(d)}finally{a.f()}var l,p=(0,s.Z)(o.junctionSources?o.junctionSources:[]);try{for(p.s();!(l=p.n()).done;){var c=l.value;if(c.sourceId===e)return c.layerId}}catch(d){p.e(d)}finally{p.f()}}}catch(d){n.e(d)}finally{n.f()}return null}return null}},{key:"queryNamedTraceConfigurations",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,n){var i,o,a,s,p,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(4031).then(r.bind(r,64031));case 2:return a=e.sent,s=a.queryNamedTraceConfigurations,p=this.networkServiceUrl,c=new re((0,u.Z)({},t)),e.next=8,s(p,c,(0,u.Z)({},n));case 8:if(e.t2=o=e.sent,e.t1=null===e.t2,e.t1){e.next=12;break}e.t1=void 0===o;case 12:if(!e.t1){e.next=16;break}e.t3=void 0,e.next=17;break;case 16:e.t3=o.namedTraceConfigurations;case 17:if(e.t4=i=e.t3,e.t0=null!==e.t4,!e.t0){e.next=21;break}e.t0=void 0!==i;case 21:if(!e.t0){e.next=25;break}e.t5=i,e.next=26;break;case 25:e.t5=null;case 26:return e.abrupt("return",e.t5);case 27:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"validateNetworkTopology",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,n){var i,o,a,s,p,c,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.validateArea){e.next=2;break}throw new f.s("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");case 2:return e.next=4,r.e(2221).then(r.bind(r,62221));case 4:return i=e.sent,o=i.validateNetworkTopology,a=this.networkServiceUrl,s=new ae((0,u.Z)((0,u.Z)({},t),{},{returnEdits:!0})),e.next=10,o(a,s,(0,u.Z)({},n));case 10:return null!==(p=e.sent)&&void 0!==p&&p.serviceEdits&&(d={edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:p.serviceEdits},L.d.emit("edits",{serviceUrl:null!==(c=this.featureServiceUrl)&&void 0!==c?c:"",layerId:null,event:d})),e.abrupt("return",p);case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_fetchLayerMetaData",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,r){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.U)(t,(0,u.Z)({responseType:"json",query:{f:"json"}},r));case 2:n=e.sent,this.sourceJSON=n.data,this.read(n.data,{origin:"service"});case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_fetchDataElement",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,r,n){var i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dataElement){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,h.U)("".concat(t,"/queryDataElements"),(0,u.Z)({responseType:"json",query:{layers:JSON.stringify([r]),f:"json"}},n)).then((function(e){var t;return null===(t=e.data.layerDataElements)||void 0===t?void 0:t[0]}));case 4:(i=e.sent)&&this.read(i,{origin:"service"});case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}],[{key:"fromPortalItem",value:function(e){return function(e){return $.apply(this,arguments)}(e)}}]),n}((0,Z.O)(b.m));(0,f.e)([(0,f.y)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],ue.prototype,"id",void 0),(0,f.e)([(0,f.y)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],ue.prototype,"title",void 0),(0,f.e)([(0,f.y)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],ue.prototype,"layerUrl",void 0),(0,f.e)([(0,f.y)({type:Object,json:{origins:{service:{read:!0}},read:!1}})],ue.prototype,"dataElement",void 0),(0,f.e)([(0,f.y)({type:C.w,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],ue.prototype,"fullExtent",void 0),(0,f.e)([(0,f.y)({type:x.k,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],ue.prototype,"spatialReference",void 0),(0,f.e)([(0,f.y)({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],ue.prototype,"type",void 0),(0,f.e)([(0,f.y)({readOnly:!0})],ue.prototype,"datasetName",null),(0,f.e)([(0,f.y)({readOnly:!0})],ue.prototype,"owner",null),(0,f.e)([(0,f.y)({readOnly:!0})],ue.prototype,"schemaGeneration",null),(0,f.e)([(0,f.y)({readOnly:!0})],ue.prototype,"parsedUrl",null),(0,f.e)([(0,f.y)({readOnly:!0})],ue.prototype,"featureServiceUrl",null),(0,f.e)([(0,f.y)({readOnly:!0})],ue.prototype,"networkServiceUrl",null),(0,f.e)([(0,f.y)({readOnly:!0})],ue.prototype,"layerId",null),(0,f.e)([(0,f.y)()],ue.prototype,"sourceJSON",void 0),(0,f.e)([(0,f.y)({readOnly:!0})],ue.prototype,"networkSystemLayers",null);var se=ue=(0,f.e)([(0,f.n)("esri.networks.Network")],ue),le=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).request=h.U,n}return(0,p.Z)(r,[{key:"initialize",value:function(){}},{key:"load",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){var r,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.layer.load(t).then((function(){return n._initializeRulesTable()})),e.abrupt("return",(this.addResolvingPromise(r),this));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeatureSQL",value:function(e,t){var r,n,i=e.layerId.toString(),o=null===(r=e.fieldsIndex)||void 0===r?void 0:r.normalizeFieldName("assetGroup"),a=null===(n=e.fieldsIndex)||void 0===n?void 0:n.normalizeFieldName("assetType"),u=o?t.attributes[o]:null,s=a?t.attributes[a]:null,l=this.rulesHash[i];if(l){var p=l.assetGroupHash[u];if(p)return p.assetTypeHash[s]||null}return null}},{key:"_initializeRulesTable",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(){var t,r,n,i,o,a,u,p,c,d,y,v,f,h,m,g,w,b,k,S,Z,T,I,x,_,j,N,O,A,E,R,C,L,F,U,V,P;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},function(e){e[e.from=0]="from",e[e.to=1]="to",e[e.via=2]="via"}(r||(r={})),n=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}],i=(0,s.Z)(this.rules),e.prev=4,i.s();case 6:if((o=i.n()).done){e.next=35;break}if((a=o.value).ruleType===te.RTJunctionJunctionConnectivity||a.ruleType===te.RTJunctionEdgeConnectivity||a.ruleType===te.RTEdgeJunctionEdgeConnectivity){e.next=10;break}return e.abrupt("continue",33);case 10:u=[[r.from,r.to],[r.to,r.from]],a.ruleType===te.RTEdgeJunctionEdgeConnectivity&&(u=[[r.from,r.via],[r.via,r.from],[r.to,r.via],[r.via,r.to]]),p=0,c=u;case 13:if(!(p<c.length)){e.next=33;break}k=c[p],S=k.shift(),Z=k.shift(),T=!1,e.t0=a.ruleType,e.next=e.t0===te.RTEdgeJunctionEdgeConnectivity?20:e.t0===te.RTJunctionEdgeConnectivity?22:23;break;case 20:return T=S===r.from||S===r.to,e.abrupt("break",23);case 22:T=S===r.to;case 23:if(I=n[S],x=a[I.networkSourceId].layerId.toString(),_=null===(d=a[I.assetGroupId])||void 0===d||null===(y=d.assetGroupCode)||void 0===y?void 0:y.toString(),j=null===(v=a[I.assetTypeId])||void 0===v||null===(f=v.assetTypeCode)||void 0===f?void 0:f.toString(),N=n[Z],O=a[N.networkSourceId].layerId.toString(),A=null===(h=a[N.assetGroupId])||void 0===h||null===(m=h.assetGroupCode)||void 0===m?void 0:m.toString(),E=a[N.assetTypeId],R=null===E||void 0===E||null===(g=E.assetTypeCode)||void 0===g?void 0:g.toString(),C=t[x]?t[x]:{assetGroupHash:{}},_&&j&&A&&R){e.next=26;break}return e.abrupt("continue",30);case 26:L=C.assetGroupHash[_]?C.assetGroupHash[_]:{assetTypeHash:{}},(F=L.assetTypeHash[j]?L.assetTypeHash[j]:{})[O]=F[O]?F[O]:{},T&&(F[x]=F[x]?F[x]:{},V="(assetgroup = ".concat(_," AND assettype = ").concat(j,")"),F[x].anyVertex=F[x].anyVertex?"".concat(F[x].anyVertex):"".concat(V),"esriNECPEndVertex"===E.connectivityPolicy&&(F[x].endVertex=null!==(U=F[x])&&void 0!==U&&U.endVertex?"".concat(F[x].endVertex):"".concat(V))),P="(assetgroup = ".concat(A," AND assettype = ").concat(R,")"),F[O].anyVertex=null!==(w=F[O])&&void 0!==w&&w.anyVertex?"".concat(F[O].anyVertex," OR ").concat(P):"".concat(P),"esriNECPEndVertex"===E.connectivityPolicy&&(F[O].endVertex=null!==(b=F[O])&&void 0!==b&&b.endVertex?"".concat(F[O].endVertex," OR ").concat(P):"".concat(P)),L.assetTypeHash[j]=F,C.assetGroupHash[_]=L,t[x]=C;case 30:p++,e.next=13;break;case 33:e.next=6;break;case 35:e.next=40;break;case 37:e.prev=37,e.t1=e.catch(4),i.e(e.t1);case 40:return e.prev=40,i.f(),e.finish(40);case 43:this.rulesHash=t;case 44:case"end":return e.stop()}}),e,this,[[4,37,40,43]])})));return function(){return e.apply(this,arguments)}}()}]),r}((0,j.u)(b.m));(0,f.e)([(0,f.y)({constructOnly:!0})],le.prototype,"layer",void 0),(0,f.e)([(0,f.y)({constructOnly:!0})],le.prototype,"rules",void 0),(0,f.e)([(0,f.y)()],le.prototype,"rulesHash",void 0),(0,f.e)([(0,f.y)({constructOnly:!0})],le.prototype,"request",void 0);var pe=le=(0,f.e)([(0,f.n)("esri.networks.RulesTable")],le),ce=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).conditionBarriers=[],n.outputConditions=[],n.functions=[],n.functionBarriers=[],n.traversabilityScope=null,n.shortestPathNetworkAttributeName=null,n.includeBarriers=null,n.validateConsistency=null,n.ignoreBarriersAtStartingPoints=null,n}return(0,p.Z)(r)}(j.l);(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],ce.prototype,"conditionBarriers",void 0),(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],ce.prototype,"outputConditions",void 0),(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],ce.prototype,"functions",void 0),(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],ce.prototype,"functionBarriers",void 0),(0,f.e)([(0,f.y)({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],ce.prototype,"traversabilityScope",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],ce.prototype,"shortestPathNetworkAttributeName",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],ce.prototype,"includeBarriers",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],ce.prototype,"validateConsistency",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],ce.prototype,"ignoreBarriersAtStartingPoints",void 0);var de=ce=(0,f.e)([(0,f.n)("esri.networks.support.TraceConfiguration")],ce),ye=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).filterBarriers=[],n.domainNetworkName=null,n.filterBitsetNetworkAttributeName=null,n.filterFunctionBarriers=[],n.filterScope=null,n.includeContainers=null,n.includeContent=null,n.includeIsolated=null,n.includeStructures=null,n.includeUpToFirstSpatialContainer=null,n.nearestNeighbor=null,n.outputFilterCategories=[],n.outputFilters=[],n.propagators=[],n.subnetworkName=null,n.targetTierName=null,n.tierName=null,n.validateLocatability=null,n}return(0,p.Z)(r)}(de);(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],ye.prototype,"filterBarriers",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],ye.prototype,"domainNetworkName",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],ye.prototype,"filterBitsetNetworkAttributeName",void 0),(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],ye.prototype,"filterFunctionBarriers",void 0),(0,f.e)([(0,f.y)({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],ye.prototype,"filterScope",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],ye.prototype,"includeContainers",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],ye.prototype,"includeContent",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],ye.prototype,"includeIsolated",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],ye.prototype,"includeStructures",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],ye.prototype,"includeUpToFirstSpatialContainer",void 0),(0,f.e)([(0,f.y)({type:Object,json:{write:!0}})],ye.prototype,"nearestNeighbor",void 0),(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],ye.prototype,"outputFilterCategories",void 0),(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],ye.prototype,"outputFilters",void 0),(0,f.e)([(0,f.y)({type:[Object],json:{write:!0}})],ye.prototype,"propagators",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],ye.prototype,"subnetworkName",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],ye.prototype,"targetTierName",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],ye.prototype,"tierName",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],ye.prototype,"validateLocatability",void 0);var ve=ye=(0,f.e)([(0,f.n)("esri.networks.support.UNTraceConfiguration")],ye),fe=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).globalId=null,n.title=null,n.traceConfiguration=null,n.creationDate=null,n.creator=null,n.description=null,n.minStartingPoints=null,n.resultTypes=[],n.tags=[],n.traceType=null,n}return(0,p.Z)(r,[{key:"readTraceConfiguration",value:function(e,t){return void 0!==e.tierName?ve.fromJSON(e):de.fromJSON(e)}}]),r}(Z.S);(0,f.e)([(0,f.y)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],fe.prototype,"globalId",void 0),(0,f.e)([(0,f.y)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],fe.prototype,"title",void 0),(0,f.e)([(0,f.y)({type:de,json:{origins:{service:{read:!0,write:!0}},read:!1}})],fe.prototype,"traceConfiguration",void 0),(0,f.e)([(0,x.o)("service","traceConfiguration")],fe.prototype,"readTraceConfiguration",null),(0,f.e)([(0,f.y)({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],fe.prototype,"creationDate",void 0),(0,f.e)([(0,f.y)({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],fe.prototype,"creator",void 0),(0,f.e)([(0,f.y)({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],fe.prototype,"description",void 0),(0,f.e)([(0,f.y)({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],fe.prototype,"minStartingPoints",void 0),(0,f.e)([(0,f.y)({type:[Object],json:{origins:{service:{read:!0,write:!0}},read:!1}})],fe.prototype,"resultTypes",void 0),(0,f.e)([(0,f.y)({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],fe.prototype,"tags",void 0),(0,f.e)([(0,f.y)({type:ne.apiValues,json:{type:ne.jsonValues,origins:{service:{read:ne.read,write:ne.write}},read:!1}})],fe.prototype,"traceType",void 0);var he=fe=(0,f.e)([(0,f.n)("esri.networks.support.NamedTraceConfiguration")],fe),me=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).rulesTableId=null,n.rulesTableUrl=null,n.subnetworksTableId=null,n.subnetworksTableUrl=null,n.dirtyAreasLayerId=null,n.dirtyAreasLayerUrl=null,n}return(0,p.Z)(r)}(f.m);(0,f.e)([(0,f.y)({constructOnly:!0})],me.prototype,"rulesTableId",void 0),(0,f.e)([(0,f.y)({constructOnly:!0})],me.prototype,"rulesTableUrl",void 0),(0,f.e)([(0,f.y)({constructOnly:!0})],me.prototype,"subnetworksTableId",void 0),(0,f.e)([(0,f.y)({constructOnly:!0})],me.prototype,"subnetworksTableUrl",void 0),(0,f.e)([(0,f.y)({constructOnly:!0})],me.prototype,"dirtyAreasLayerId",void 0),(0,f.e)([(0,f.y)({constructOnly:!0})],me.prototype,"dirtyAreasLayerUrl",void 0);var ge=me=(0,f.e)([(0,f.n)("esri.networks.support.NetworkSystemLayers")],me),we=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).id=null,n.name=null,n}return(0,p.Z)(r)}(j.l);(0,f.e)([(0,f.y)({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],we.prototype,"id",void 0),(0,f.e)([(0,f.y)({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],we.prototype,"name",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{write:!0}})],we.prototype,"isUpstreamTerminal",void 0);var be=we=(0,f.e)([(0,f.n)("esri.networks.support.Terminal")],we),ke=new h.s({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"}),Se=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).defaultConfiguration=null,n.id=null,n.name=null,n.terminals=[],n.traversabilityModel=null,n}return(0,p.Z)(r)}(j.l);(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],Se.prototype,"defaultConfiguration",void 0),(0,f.e)([(0,f.y)({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],Se.prototype,"id",void 0),(0,f.e)([(0,f.y)({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],Se.prototype,"name",void 0),(0,f.e)([(0,f.y)({type:[be],json:{write:!0}})],Se.prototype,"terminals",void 0),(0,f.e)([(0,f.y)({type:ke.apiValues,json:{type:ke.jsonValues,read:ke.read,write:ke.write}})],Se.prototype,"traversabilityModel",void 0);var Ze=Se=(0,f.e)([(0,f.n)("esri.networks.support.TerminalConfiguration")],Se),Te=f.a.getLogger("esri.networks.UtilityNetwork"),Ie=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).sharedNamedTraceConfigurations=[],n.type="utility",n}return(0,p.Z)(r,[{key:"serviceTerritoryFeatureLayerId",get:function(){var e,t;return null!==(e=null===(t=this.dataElement)||void 0===t?void 0:t.serviceTerritoryFeatureLayerId)&&void 0!==e?e:null}},{key:"networkSystemLayers",get:function(){var e,t,r,n,i,o;return new ge({rulesTableId:null===(e=this.sourceJSON)||void 0===e?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(null===(t=this.sourceJSON)||void 0===t?void 0:t.systemLayers.rulesTableId):null,subnetworksTableId:null===(r=this.sourceJSON)||void 0===r?void 0:r.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(null===(n=this.sourceJSON)||void 0===n?void 0:n.systemLayers.subnetworksTableId):null,dirtyAreasLayerId:null===(i=this.sourceJSON)||void 0===i?void 0:i.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(null===(o=this.sourceJSON)||void 0===o?void 0:o.systemLayers.dirtyAreasLayerId):null})}},{key:"rulesTableId",get:function(){var e;return(0,A.t)(Te,"rulesTableId",{replacement:"networkSystemLayers.rulesTableId"}),null===(e=this.sourceJSON)||void 0===e?void 0:e.systemLayers.rulesTableId}},{key:"rulesTableUrl",get:function(){return(0,A.t)(Te,"rulesTableUrl",{replacement:"networkSystemLayers.rulesTableUrl"}),this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(this.networkSystemLayers.rulesTableId):null}},{key:"subnetworksTableId",get:function(){var e;return(0,A.t)(Te,"subnetworksTableId",{replacement:"networkSystemLayers.subnetworksTableId"}),null===(e=this.sourceJSON)||void 0===e?void 0:e.systemLayers.subnetworksTableId}},{key:"subnetworksTableUrl",get:function(){return(0,A.t)(Te,"subnetworksTableUrl",{replacement:"networkSystemLayers.subnetworksTableUrl"}),this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(this.networkSystemLayers.subnetworksTableId):null}},{key:"terminalConfigurations",get:function(){var e;return(null===(e=this.dataElement)||void 0===e?void 0:e.terminalConfigurations.map((function(e){return Ze.fromJSON(e)})))||[]}},{key:"domainNetworkNames",get:function(){var e;return(null===(e=this.dataElement)||void 0===e?void 0:e.domainNetworks.map((function(e){return e.domainNetworkName})))||[]}},{key:"_utilityLayerList",get:function(){var e,t,r=new Set;return null!==(e=this.dataElement)&&void 0!==e&&null!==(t=e.domainNetworks)&&void 0!==t&&t.map((function(e){e.edgeSources.map((function(e){r.add(e.layerId)})),e.junctionSources.map((function(e){r.add(e.layerId)}))})),r}},{key:"load",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.addResolvingPromise((0,o.Z)((0,a.Z)(r.prototype),"load",this).call(this,t)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(t)),this));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTerminalConfiguration",value:function(e){var t,r=null,n=null,i=e.layer;if("feature"!==(null===i||void 0===i?void 0:i.type))return null;if(null===(t=i.layerId))return null;var o=e.attributes;if(null==o)return null;for(var a=0,u=Object.keys(o);a<u.length;a++){var l=u[a];"ASSETGROUP"===l.toUpperCase()&&(r=e.getAttribute(l)),"ASSETTYPE"===l.toUpperCase()&&(n=e.getAttribute(l))}if(!this.dataElement)return null;var p,c=null,d=this.dataElement.domainNetworks,y=(0,s.Z)(d);try{for(y.s();!(p=y.n()).done;){var v,f=null===(v=p.value.junctionSources)||void 0===v?void 0:v.find((function(e){return e.layerId===t}));if(f){var h,m=null===(h=f.assetGroups)||void 0===h?void 0:h.find((function(e){return e.assetGroupCode===r}));if(m){var g,w=null===(g=m.assetTypes)||void 0===g?void 0:g.find((function(e){return e.assetTypeCode===n}));if(w){c=w.terminalConfigurationId;break}}}}}catch(S){y.e(S)}finally{y.f()}if(null!=c){var b,k=null===(b=this.dataElement.terminalConfigurations)||void 0===b?void 0:b.find((function(e){return e.terminalConfigurationId===c}));return k?Ze.fromJSON(k):null}return null}},{key:"getTierNames",value:function(e){var t,r=null===(t=this.dataElement)||void 0===t?void 0:t.domainNetworks.find((function(t){return t.domainNetworkName===e}));return(null===r||void 0===r?void 0:r.tiers.map((function(e){return e.name})))||[]}},{key:"getRulesTable",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createRulesTable());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUtilityLayer",value:function(e){return this._utilityLayerList.has(e.layerId)}},{key:"_loadNamedTraceConfigurationsFromNetwork",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){var r,n,i,o,a,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(null===(r=this.sharedNamedTraceConfigurations)||void 0===r?void 0:r.length)){e.next=2;break}return e.abrupt("return");case 2:return n=this.sharedNamedTraceConfigurations.map((function(e){return e.globalId})),e.next=5,this.queryNamedTraceConfigurations({globalIds:n},t);case 5:i=e.sent,o=(0,s.Z)(this.sharedNamedTraceConfigurations);try{for(u=function(){var e=a.value,t=null===i||void 0===i?void 0:i.find((function(t){return t.globalId===e.globalId}));if(t){var r=t.write({},{origin:"service"});e.read(r,{origin:"service"})}},o.s();!(a=o.n()).done;)u()}catch(l){o.e(l)}finally{o.f()}case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createRulesTable",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(){var t,r,n,o,a,u=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new E.default({url:this.rulesTableUrl}),e.next=3,r.load();case 3:if(n=null===(t=this.dataElement)||void 0===t?void 0:t.domainNetworks){e.next=6;break}return e.abrupt("return",null);case 6:return o=n.flatMap((function(e){return[].concat((0,i.Z)(e.edgeSources),(0,i.Z)(e.junctionSources))})),e.next=9,this._queryRulesTable(r);case 9:return a=e.sent.map((function(e){return u._hydrateRuleInfo(r,o,e)})),e.abrupt("return",new pe({layer:r,rules:a}));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryRulesTable",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new F.x({where:"1=1",outFields:["*"]}),e.next=3,(0,R.t)(t,r);case 3:return e.abrupt("return",e.sent.features);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_hydrateRuleInfo",value:function(e,t,r){var n,i=this,o=e.fieldsIndex,a=o.get("RULETYPE"),u=o.get("CREATIONDATE"),s=o.get("FROMNETWORKSOURCEID"),l=o.get("FROMASSETGROUP"),p=o.get("FROMASSETTYPE"),c=o.get("FROMTERMINALID"),d=o.get("TONETWORKSOURCEID"),y=o.get("TOASSETGROUP"),v=o.get("TOASSETTYPE"),f=o.get("TOTERMINALID"),h=o.get("VIANETWORKSOURCEID"),m=o.get("VIAASSETGROUP"),g=o.get("VIAASSETTYPE"),w=o.get("VIATERMINALID"),b=r.attributes[a.name],k=new Date(r.attributes[u.name]),S=[{networkSourceId:r.attributes[s.name],assetGroupId:r.attributes[l.name],assetTypeId:r.attributes[p.name],terminalId:r.attributes[c.name]},{networkSourceId:r.attributes[d.name],assetGroupId:r.attributes[y.name],assetTypeId:r.attributes[v.name],terminalId:r.attributes[f.name]},{networkSourceId:r.attributes[h.name],assetGroupId:r.attributes[m.name],assetTypeId:r.attributes[g.name],terminalId:r.attributes[w.name]}];!function(e){e[e.from=0]="from",e[e.to=1]="to",e[e.via=2]="via"}(n||(n={}));for(var Z={ruleType:b,creationDate:k},T=function(){var e=x[I];if(b!==te.RTEdgeJunctionEdgeConnectivity&&e===n.via)return"continue";var r=S[e],o=t.find((function(e){return e.sourceId===r.networkSourceId})),a=null===o||void 0===o?void 0:o.assetGroups.find((function(e){return e.assetGroupCode===r.assetGroupId})),u=null===a||void 0===a?void 0:a.assetTypes.find((function(e){return e.assetTypeCode===r.assetTypeId})),s=i._getTerminal(b,u,r);b!==te.RTContainment&&b!==te.RTAttachment||(s=null);var l="";switch(e){case n.from:l="from";break;case n.to:l="to";break;case n.via:l="via"}Z["".concat(l,"NetworkSource")]=o,Z["".concat(l,"AssetGroup")]=a,Z["".concat(l,"AssetType")]=u,Z["".concat(l,"Terminal")]=s},I=0,x=[n.from,n.to,n.via];I<x.length;I++)T();return Z}},{key:"_getTerminal",value:function(e,t,r){var n,i,o;if(e===te.RTAttachment||e===te.RTContainment)return null;var a=null===t||void 0===t?void 0:t.terminalConfigurationId,u=null===(n=this.terminalConfigurations)||void 0===n?void 0:n.find((function(e){return e.id===a}));return null!==(i=null===u||void 0===u||null===(o=u.terminals)||void 0===o?void 0:o.find((function(e){return e.id===r.terminalId})))&&void 0!==i?i:null}}]),r}(se);(0,f.e)([(0,f.y)({type:[he],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],Ie.prototype,"sharedNamedTraceConfigurations",void 0),(0,f.e)([(0,f.y)({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],Ie.prototype,"type",void 0),(0,f.e)([(0,f.y)({readOnly:!0})],Ie.prototype,"serviceTerritoryFeatureLayerId",null),(0,f.e)([(0,f.y)({readOnly:!0})],Ie.prototype,"networkSystemLayers",null),(0,f.e)([(0,f.y)({readOnly:!0})],Ie.prototype,"rulesTableId",null),(0,f.e)([(0,f.y)({readOnly:!0})],Ie.prototype,"rulesTableUrl",null),(0,f.e)([(0,f.y)({readOnly:!0})],Ie.prototype,"subnetworksTableId",null),(0,f.e)([(0,f.y)({readOnly:!0})],Ie.prototype,"subnetworksTableUrl",null),(0,f.e)([(0,f.y)({readOnly:!0})],Ie.prototype,"terminalConfigurations",null),(0,f.e)([(0,f.y)({readOnly:!0})],Ie.prototype,"domainNetworkNames",null);var xe=Ie=(0,f.e)([(0,f.n)("esri.networks.UtilityNetwork")],Ie),_e=Object.freeze({__proto__:null,default:xe}),je=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).expression=null,n.returnType="string",n.title=null,n}return(0,p.Z)(r)}((0,D.i)(j.l));(0,f.e)([(0,f.y)({type:String,json:{write:{isRequired:!0}}})],je.prototype,"expression",void 0),(0,f.e)([(0,f.y)({type:["number","string"],json:{write:!0}})],je.prototype,"returnType",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],je.prototype,"title",void 0);var Ne=je=(0,f.e)([(0,f.n)("esri.webdoc.geotriggersInfo.ExpressionInfo")],je),Oe=new h.s({deviceLocation:"device-location"}),Ae=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).filterExpression=null,n.type="device-location",n}return(0,p.Z)(r)}((0,D.i)(j.l));(0,f.e)([(0,f.y)({type:Ne,json:{write:!0}})],Ae.prototype,"filterExpression",void 0),(0,f.e)([(0,f.y)({type:Oe.apiValues,readOnly:!0,json:{type:Oe.jsonValues,read:Oe.read,write:Oe.write}})],Ae.prototype,"type",void 0);var Ee=Ae=(0,f.e)([(0,f.n)("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],Ae),Re=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).geometry=null,n.where=null,n}return(0,p.Z)(r)}((0,D.i)(j.l));(0,f.e)([(0,f.y)({types:V.i,json:{read:B.v,write:!0}})],Re.prototype,"geometry",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],Re.prototype,"where",void 0);var Ce=Re=(0,f.e)([(0,f.n)("esri.webdoc.geotriggersInfo.FeatureFilter")],Re),Le=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).layerId=null,n.layerUrl=null,n.type="feature-layer",n}return(0,p.Z)(r)}((0,D.i)(j.l));(0,f.e)([(0,f.y)({type:String,json:{write:{overridePolicy:function(){return{isRequired:null===this.layerUrl}}}}})],Le.prototype,"layerId",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:{overridePolicy:function(){return{isRequired:null===this.layerId}}}}})],Le.prototype,"layerUrl",void 0),(0,f.e)([(0,M.r)({featureLayer:"feature-layer"},{readOnly:!0})],Le.prototype,"type",void 0);var Fe=Le=(0,f.e)([(0,f.n)("esri.webdoc.geotriggersInfo.FeatureLayerSource")],Le),Ue=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).fenceSource=null,n.filter=null,n.bufferDistance=null,n.type="features",n}return(0,p.Z)(r)}((0,D.i)(j.l));(0,f.e)([(0,f.y)({type:Fe,json:{write:{isRequired:!0}}})],Ue.prototype,"fenceSource",void 0),(0,f.e)([(0,f.y)({type:Ce,json:{write:!0}})],Ue.prototype,"filter",void 0),(0,f.e)([(0,f.y)({type:Number,json:{write:!0}})],Ue.prototype,"bufferDistance",void 0),(0,f.e)([(0,M.r)({features:"features"},{readOnly:!0})],Ue.prototype,"type",void 0);var Ve=Ue=(0,f.e)([(0,f.n)("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],Ue),Pe=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).type="fence",n}return(0,p.Z)(r)}((0,D.i)(j.l));(0,f.e)([(0,M.r)({fence:"fence"},{readOnly:!0})],Pe.prototype,"type",void 0);var Je=Pe=(0,f.e)([(0,f.n)("esri.webdoc.geotriggersInfo.Geotrigger")],Pe),Ge=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).expressionInfo=null,n.requestedActions=null,n}return(0,p.Z)(r)}((0,D.i)(j.l));(0,f.e)([(0,f.y)({type:Ne,json:{write:!0}})],Ge.prototype,"expressionInfo",void 0),(0,f.e)([(0,f.y)({type:[String],json:{write:!0}})],Ge.prototype,"requestedActions",void 0);var De=Ge=(0,f.e)([(0,f.n)("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],Ge),Me=new h.s({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),Be=new h.s({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),We=new h.s({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"}),qe=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).enterExitRule="enter-contains-and-exit-does-not-intersect",n.feed=null,n.feedAccuracyMode="use-geometry",n.fenceNotificationRule=null,n.fenceParameters=null,n.name=null,n.notificationOptions=null,n.type="fence",n}return(0,p.Z)(r)}(Je);(0,f.e)([(0,M.r)(Me)],qe.prototype,"enterExitRule",void 0),(0,f.e)([(0,f.y)({type:Ee,json:{write:{isRequired:!0}}})],qe.prototype,"feed",void 0),(0,f.e)([(0,M.r)(Be)],qe.prototype,"feedAccuracyMode",void 0),(0,f.e)([(0,f.y)({type:We.apiValues,json:{type:We.jsonValues,read:We.read,write:{writer:We.write,isRequired:!0}}})],qe.prototype,"fenceNotificationRule",void 0),(0,f.e)([(0,f.y)({type:Ve,json:{write:{isRequired:!0}}})],qe.prototype,"fenceParameters",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:!0}})],qe.prototype,"name",void 0),(0,f.e)([(0,f.y)({type:De,json:{write:!0}})],qe.prototype,"notificationOptions",void 0),(0,f.e)([(0,M.r)({fence:"fence"},{readOnly:!0})],qe.prototype,"type",void 0);var ze={base:Je,key:"type",typeMap:{fence:qe=(0,f.e)([(0,f.n)("esri.webdoc.geotriggersInfo.FenceGeotrigger")],qe)}},Ke=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).geotriggers=null,n}return(0,p.Z)(r)}((0,D.i)(j.l));(0,f.e)([(0,f.y)({types:[ze],json:{write:{isRequired:!0}}})],Ke.prototype,"geotriggers",void 0);var He,Ye=Ke=(0,f.e)([(0,f.n)("esri.webdoc.GeotriggersInfo")],Ke),Xe=He=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).activeRange=null,n.currentRangeExtent=null,n.fullRangeExtent=null,n}return(0,p.Z)(r,[{key:"clone",value:function(){return new He((0,S.y)({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}}]),r}(j.l);(0,f.e)([(0,f.y)({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],Xe.prototype,"activeRange",void 0),(0,f.e)([(0,f.y)({type:[Number],json:{write:!0}})],Xe.prototype,"currentRangeExtent",void 0),(0,f.e)([(0,f.y)({type:[Number],json:{write:!0}})],Xe.prototype,"fullRangeExtent",void 0);var Qe,$e=Xe=He=(0,f.e)([(0,f.n)("esri.webdoc.RangeInfo")],Xe),et=Qe=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).enabled=!1,n.longNames=!1,n.minimized=!1,n.pinnedLevels=!1,n.site=null,n.facility=null,n.level=null,n}return(0,p.Z)(r,[{key:"clone",value:function(){return new Qe((0,S.y)({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}}]),r}(j.l);(0,f.e)([(0,f.y)({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],et.prototype,"enabled",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],et.prototype,"longNames",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],et.prototype,"minimized",void 0),(0,f.e)([(0,f.y)({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],et.prototype,"pinnedLevels",void 0),(0,f.e)([(0,f.y)({type:String,json:{read:{source:"site"},write:{target:"site"}}})],et.prototype,"site",void 0),(0,f.e)([(0,f.y)({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],et.prototype,"facility",void 0),(0,f.e)([(0,f.y)({type:String,json:{read:{source:"level"},write:{target:"level"}}})],et.prototype,"level",void 0);var tt,rt=et=Qe=(0,f.e)([(0,f.n)("esri.webdoc.widgets.FloorFilter")],et),nt=new h.s({slider:"slider",picker:"picker"}),it=tt=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).interactionMode=null,n.numStops=null,n.stopInterval=null,n}return(0,p.Z)(r,[{key:"clone",value:function(){return new tt({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}}]),r}(j.l);(0,f.e)([(0,f.y)({type:nt.apiValues,nonNullable:!0,json:{type:nt.jsonValues,default:null,read:{reader:nt.read},write:{isRequired:!0,writer:nt.write}}})],it.prototype,"interactionMode",void 0),(0,f.e)([(0,f.y)({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy:function(){var e=null!=this.stopInterval;return{enabled:!e,isRequired:!e}}}}})],it.prototype,"numStops",void 0),(0,f.e)([(0,f.y)({type:Number,json:{write:{overridePolicy:function(){return{isRequired:null==this.numStops}}}}})],it.prototype,"stopInterval",void 0);var ot,at=it=tt=(0,f.e)([(0,f.n)("esri.webdoc.widgets.Range")],it),ut=ot=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).currentTimeExtent=null,n.fullTimeExtent=null,n.loop=!1,n.numStops=null,n.numThumbs=null,n.stopDelay=null,n.stopInterval=null,n.stops=null,n}return(0,p.Z)(r,[{key:"readCurrentTimeExtent",value:function(e){if(e){var t=null!=e[0]?new Date(e[0]):null,r=null!=e[1]?new Date(e[1]):null;return new W.T({start:t,end:r})}}},{key:"writeCurrentTimeExtent",value:function(e,t,r){e&&(0,S.o)(r,[(0,S.r)(e.start)?e.start.getTime():null,(0,S.r)(e.end)?e.end.getTime():null],t)}},{key:"readFullTimeExtent",value:function(e,t){var r=t.properties;if(r){var n=null!=r.endTime?new Date(r.endTime):null,i=null!=r.startTime?new Date(r.startTime):null;return new W.T({start:i,end:n})}}},{key:"writeFullTimeExtent",value:function(e,t){if(e){var r=t.properties=t.properties||{},n=e.end,i=e.start;n&&(r.endTime=(0,S.r)(n)?n.getTime():null),i&&(r.startTime=(0,S.r)(i)?i.getTime():null)}}},{key:"readStopInterval",value:function(e,t,r){return e?q.l.fromJSON({value:e.interval,unit:e.units},r):null}},{key:"writeStopInterval",value:function(e,t,r,n){if(e){var i=e.toJSON(n);(0,S.o)(r,{interval:i.value,units:i.unit},t)}}},{key:"readStops",value:function(e){return e&&e.length?e.map((function(e){return new Date(e)})):null}},{key:"writeStops",value:function(e,t,r){e&&e.length&&(0,S.o)(r,e.map((function(e){return e.getTime()})),t)}},{key:"clone",value:function(){return new ot((0,S.y)({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}}]),r}(j.l);(0,f.e)([(0,f.y)({type:W.T,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],ut.prototype,"currentTimeExtent",void 0),(0,f.e)([(0,x.o)("currentTimeExtent")],ut.prototype,"readCurrentTimeExtent",null),(0,f.e)([(0,x.r)("currentTimeExtent")],ut.prototype,"writeCurrentTimeExtent",null),(0,f.e)([(0,f.y)({type:W.T,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],ut.prototype,"fullTimeExtent",void 0),(0,f.e)([(0,x.o)("fullTimeExtent")],ut.prototype,"readFullTimeExtent",null),(0,f.e)([(0,x.r)("fullTimeExtent")],ut.prototype,"writeFullTimeExtent",null),(0,f.e)([(0,f.y)({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],ut.prototype,"loop",void 0),(0,f.e)([(0,f.y)({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy:function(){var e,t=!!this.stopInterval,r=!(null===(e=this.stops)||void 0===e||!e.length),n=!(t||r);return{enabled:n,isRequired:n}}}}})],ut.prototype,"numStops",void 0),(0,f.e)([(0,f.y)({type:[1,2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],ut.prototype,"numThumbs",void 0),(0,f.e)([(0,f.y)({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],ut.prototype,"stopDelay",void 0),(0,f.e)([(0,f.y)({type:q.l,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy:function(){var e,t=null!=this.numStops,r=!(null===(e=this.stops)||void 0===e||!e.length);return{enabled:!r,isRequired:!(t||r)}}}}})],ut.prototype,"stopInterval",void 0),(0,f.e)([(0,x.o)("stopInterval")],ut.prototype,"readStopInterval",null),(0,f.e)([(0,x.r)("stopInterval")],ut.prototype,"writeStopInterval",null),(0,f.e)([(0,f.y)({type:[Date],json:{read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy:function(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],ut.prototype,"stops",void 0),(0,f.e)([(0,x.o)("stops")],ut.prototype,"readStops",null),(0,f.e)([(0,x.r)("stops")],ut.prototype,"writeStops",null);var st,lt=ut=ot=(0,f.e)([(0,f.n)("esri.webdoc.widgets.TimeSlider")],ut),pt=st=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).range=null,n.timeSlider=null,n.floorFilter=null,n}return(0,p.Z)(r,[{key:"clone",value:function(){return new st((0,S.y)({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}}]),r}(j.l);(0,f.e)([(0,f.y)({type:at,json:{write:!0}})],pt.prototype,"range",void 0),(0,f.e)([(0,f.y)({type:lt,json:{write:!0}})],pt.prototype,"timeSlider",void 0),(0,f.e)([(0,f.y)({type:rt,json:{write:!0}})],pt.prototype,"floorFilter",void 0);var ct,dt=pt=st=(0,f.e)([(0,f.n)("esri.webdoc.Widgets")],pt),yt=ct=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).editing=null,n.offline=null,n.viewing=null,n}return(0,p.Z)(r,[{key:"clone",value:function(){return new ct((0,S.y)({editing:this.editing,offline:this.offline,viewing:this.viewing}))}}]),r}(j.l);(0,f.e)([(0,f.y)({json:{write:!0}})],yt.prototype,"editing",void 0),(0,f.e)([(0,f.y)({json:{write:!0}})],yt.prototype,"offline",void 0),(0,f.e)([(0,f.y)({type:G.i,json:{write:!0}})],yt.prototype,"viewing",void 0);var vt,ft=yt=ct=(0,f.e)([(0,f.n)("esri.webmap.ApplicationProperties")],yt),ht=vt=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).name=null,n.thumbnail=new G.p,n.timeExtent=null,n}return(0,p.Z)(r,[{key:"castThumbnail",value:function(e){return"string"==typeof e?new G.p({url:e}):(0,f.b)(G.p,e)}},{key:"viewpoint",set:function(e){var t=e.targetGeometry,r=e.scale;(0,S.r)(t)&&"point"===t.type&&(0,S.t)(r)&&f.a.getLogger(this.declaredClass).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",e),this._set("viewpoint",e)}},{key:"readViewpoint",value:function(e,t){var r=t.extent,n=t.viewpoint;return g.u.fromJSON(n||{targetGeometry:r})}},{key:"writeViewpoint",value:function(e,t,r,n){if(e){var i=e.targetGeometry;if((0,S.r)(i)&&"extent"!==i.type){var o="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";null!==n&&void 0!==n&&n.messages?n.messages.push(new f.s("property:unsupported",o)):f.a.getLogger(this.declaredClass).error(o)}else(0,S.r)(i)&&(t.extent=i.toJSON()),t[r]=e.toJSON()}}},{key:"clone",value:function(){return new vt((0,S.y)({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}}]),r}((0,K.s)(j.l));(0,f.e)([(0,f.y)({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],ht.prototype,"name",void 0),(0,f.e)([(0,f.y)({type:G.p,json:{write:{overridePolicy:function(e){return{enabled:!(!e||!e.url)}}}}})],ht.prototype,"thumbnail",void 0),(0,f.e)([(0,f.c)("thumbnail")],ht.prototype,"castThumbnail",null),(0,f.e)([(0,f.y)({type:W.T,json:{write:!0}})],ht.prototype,"timeExtent",void 0),(0,f.e)([(0,f.y)({type:g.u,nonNullable:!0,json:{write:!0}})],ht.prototype,"viewpoint",null),(0,f.e)([(0,x.o)("viewpoint",["extent","viewpoint"])],ht.prototype,"readViewpoint",null),(0,f.e)([(0,x.r)("viewpoint")],ht.prototype,"writeViewpoint",null);var mt,gt=ht=vt=(0,f.e)([(0,f.n)("esri.webmap.Bookmark")],ht),wt=mt=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).background=null,n.rangeInfo=null,n.spatialReference=null,n.viewpoint=null,n}return(0,p.Z)(r,[{key:"clone",value:function(){return new mt((0,S.y)({background:this.background,rangeInfo:this.rangeInfo,spatialReference:this.spatialReference,viewpoint:this.viewpoint}))}}]),r}(f.m);(0,f.e)([(0,f.y)({type:H.m})],wt.prototype,"background",void 0),(0,f.e)([(0,f.y)({type:$e})],wt.prototype,"rangeInfo",void 0),(0,f.e)([(0,f.y)({type:x.k})],wt.prototype,"spatialReference",void 0),(0,f.e)([(0,f.y)({type:g.u})],wt.prototype,"viewpoint",void 0);var bt=wt=mt=(0,f.e)([(0,f.n)("esri.webmap.InitialViewProperties")],wt),kt=function(e){(0,d.Z)(r,e);var t=(0,y.Z)(r);function r(e,n){return(0,c.Z)(this,r),t.call(this,e,n,"webmap")}return(0,p.Z)(r)}(Y.r),St=new kt(2,26),Zt="Web Map",Tt=w.j.ofType(gt),It=w.j.ofType(xe),xt=new Map;xt.set("image/jpeg","jpeg"),xt.set("image/jpg","jpg"),xt.set("image/png","png"),xt.set("image/gif","gif");var _t=P.f.JSAPI,jt="CollectorDisabled",Nt="Collector",Ot="Data Editing",At="OfflineDisabled",Et="Offline",Rt="Workforce Project",Ct="Workforce Worker",Lt="Workforce Dispatcher",Ft=P.f.DEVELOPER_BASEMAP,Ut="UtilityNetwork",Vt=["NatGeo_World_Map","Ocean_Basemap","USA_Topo_Maps","World_Imagery","World_Street_Map","World_Terrain_Base","World_Topo_Map","World_Hillshade","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Reference/World_Boundaries_and_Places","Reference/World_Reference_Overlay","Reference/World_Transportation"].map((function(e){return e.toLowerCase()})),Pt=function(e){(0,d.Z)(w,e);var t=(0,y.Z)(w);function w(e){var r;return(0,c.Z)(this,w),(r=t.call(this,e)).applicationProperties=null,r.bookmarks=new Tt,r.floorInfo=null,r.geotriggersInfo=null,r.initialViewProperties=new bt,r.portalItem=null,r.presentation=null,r.sourceVersion=null,r.widgets=null,r.utilityNetworks=null,r.authoringApp=r.authoringAppVersion=null,r._isAuthoringAppSetByUser=r._isAuthoringAppVersionSetByUser=!1,r}return(0,p.Z)(w,[{key:"destroy",value:function(){var e=this.portalItem;this.portalItem=null,null===e||void 0===e||e.destroy()}},{key:"initialize",value:function(){var e=this;if(this.when().catch((function(t){f.a.getLogger(e.declaredClass).error("#load()","Failed to load web map",t)})),this.resourceInfo){var t;try{t=this._validateJSON(this.resourceInfo)}catch(me){return void this.addResolvingPromise(Promise.reject(me))}this.read(t)}}},{key:"authoringApp",set:function(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}},{key:"writeAuthoringApp",value:function(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp=_t}},{key:"authoringAppVersion",set:function(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}},{key:"writeAuthoringAppVersion",value:function(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=h.a}},{key:"readInitialViewProperties",value:function(e,t){var r,n=new bt;t.background&&(n.background=H.m.fromJSON(t.background));var i=null===(r=t.initialState)||void 0===r?void 0:r.viewpoint;return i&&(i.rotation&&kt.parse(t.version||"","webmap").lessThan(2,20)&&"ArcGIS Pro"===t.authoringApp&&(i.rotation*=-1),n.viewpoint=g.u.fromJSON(i)),t.mapRangeInfo&&(n.rangeInfo=$e.fromJSON(t.mapRangeInfo)),t.spatialReference&&(n.spatialReference=x.k.fromJSON(t.spatialReference)),n}},{key:"writeInitialViewProperties",value:function(e,t,r,n){if(e){var i=e.background;i&&i.color&&(t.background=i.write({},n)),e.viewpoint&&(t.initialState={viewpoint:e.viewpoint.write({},n)}),e.rangeInfo&&(t.mapRangeInfo=e.rangeInfo.toJSON(n)),e.spatialReference&&(t.spatialReference=e.spatialReference.write({},n))}}},{key:"writeLayers",value:function(e,t,r,n){t[r]=this._writeLayers(e,n,"operational-layers")}},{key:"readSourceVersion",value:function(e,t){var r=t.version.split("."),i=(0,n.Z)(r,2),o=i[0],a=i[1];return new kt(parseInt(o,10),parseInt(a,10))}},{key:"writeSourceVersion",value:function(e,t,r){t[r]="".concat(St.major,".").concat(St.minor)}},{key:"writeTables",value:function(e,t,r,n){var i=this._writeLayers(e,n,"tables");i.length&&(t[r]=i)}},{key:"thumbnailUrl",get:function(){return this.portalItem&&this.portalItem.thumbnailUrl||null},set:function(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride()}},{key:"load",value:function(e){return this.addResolvingPromise(this._loadFromSource()),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return(0,k.n)(this,(function(t){t(e.ground,e.basemap,e.layers,e.tables)}))}},{key:"read",value:function(e,t){var r=this;t=(0,u.Z)((0,u.Z)({},t),{},{origin:"web-map"});var n=this._getAuthoringPropsState();(0,j.d)(this,e,(function(t){return(0,o.Z)((0,a.Z)(w.prototype),"read",r).call(r,e,t)}),t),this._restoreAuthoringPropsFromState(n)}},{key:"write",value:function(e,t){if("loaded"!==this.loadStatus){var r=new f.s("webmap:not-loaded","Web map must be loaded before it can be serialized");throw f.a.getLogger(this.declaredClass).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),r}return this._removeDanglingLayerRefs(),t=(0,u.Z)((0,u.Z)({},t),{},{origin:"web-map",restrictedWebMapWriting:!0,webmap:this}),(0,o.Z)((0,a.Z)(w.prototype),"write",this).call(this,e,t)}},{key:"save",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){var r,n,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},this._validateItem(),e.next=4,this._updateFromPromise;case 4:return e.next=6,this.load();case 6:return e.next=8,this._loadLayerContainers();case 8:return e.next=10,this._beforeSave();case 10:return e.next=12,this._validateMap();case 12:return r=this.portalItem,n={origin:"web-map",messages:[],writtenProperties:[],url:r.itemUrl&&(0,h.j)(r.itemUrl),portal:r.portal||b.j.getDefault()},i=this.write({},n),this._validateJSONForWriting(n,t),e.next=16,this._updateItemProperties(r);case 16:return e.next=18,this._updateItem(r,i,n);case 18:return e.next=20,this._updateItemThumbnail();case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveAs",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,r){var n,i,o,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||{},n=this._getPortalItem(t),e.next=4,this._updateFromPromise;case 4:return e.next=6,this.load();case 6:return e.next=8,this._loadLayerContainers();case 8:return e.next=10,this._beforeSave();case 10:return e.next=12,this._validateMap();case 12:return i={origin:"web-map",messages:[],writtenProperties:[],url:null,portal:n.portal},o=this.write({},i),this._validateJSONForWriting(i,r),e.next=16,this._updateItemPropertiesForSaveAs(n);case 16:return a=this._getThumbnailState(),e.next=19,this._createItem(n,o,i,r);case 19:return this._restoreThumbnailFromState(a),e.next=22,this._updateItemThumbnail();case 22:return e.abrupt("return",n);case 23:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateFrom",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,r){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._updateFromInternal(t,r),this._updateFromPromise=n,e.next=4,n;case 4:n===this._updateFromPromise&&(this._updateFromPromise=null);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getLayerJSONFromResourceInfo",value:function(e){var t,r,n,o,a=this.resourceInfo;return this._collectAllLayersJSON([].concat((0,i.Z)((null===a||void 0===a||null===(t=a.baseMap)||void 0===t?void 0:t.baseMapLayers)||[]),(0,i.Z)((null===a||void 0===a?void 0:a.operationalLayers)||[]),(0,i.Z)((null===(r=this.basemap)||void 0===r||null===(n=r.resourceInfo)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.baseMapLayers)||[]))).find((function(t){return t.id===e.id}))}},{key:"_collectAllLayersJSON",value:function(e){var t=this;return e.reduce((function(e,r){return e.push(r),"GroupLayer"===r.layerType&&(e=e.concat(t._collectAllLayersJSON(r.layers||[]))),e}),[])}},{key:"_writeLayers",value:function(e,t,r){var n=this;return t=(0,u.Z)((0,u.Z)({},t),{},{layerContainerType:r}),e.map((function(e){return(0,S.e)((0,z.y)(e,"tables"===r?null:n.getLayerJSONFromResourceInfo(e),t))})).filter(Boolean).toArray()}},{key:"_loadFromSource",value:function(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):Promise.resolve(null)}},{key:"_loadFromItem",value:function(e){var t=this;return e.load().catch((function(e){throw new f.s("webmap:load-portal-item","Failed to load portal item",{error:e})})).then((function(){if("Web Map"!==e.type)throw new f.s("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:e.type})})).then((function(){return e.fetchData()})).then((function(r){return t.resourceInfo=r,t._readAndLoadFromJSON(r,{origin:"web-map",portal:e.portal||b.j.getDefault()})})).then((function(){return t._computeInitialViewpoint()}))}},{key:"_readAndLoadFromJSON",value:function(e,t){var r=this._validateJSON(e);return this.read(r,t),this._loadFromJSON(r,t)}},{key:"_validateJSON",value:function(e){var t=kt.parse(e.version||"","webmap");return St.validate(t),e.version="".concat(t.major,".").concat(t.minor),e}},{key:"_loadFromJSON",value:function(e,t){var n=this,i={context:(0,u.Z)((0,u.Z)({},t),{},{layerContainerType:"operational-layers"})};return this.portalItem&&(i.context.portal=this.portalItem.portal||b.j.getDefault()),Promise.all([r.e(5224),r.e(6471),r.e(5091)]).then(r.bind(r,11318)).then((function(t){var r=t.populateOperationalLayers,o=[],a=e.operationalLayers;a&&a.length&&o.push(r(n.layers,a,i));var s=(0,u.Z)((0,u.Z)({},i),{},{context:(0,u.Z)((0,u.Z)({},i.context),{},{layerContainerType:"tables"}),defaultLayerType:"ArcGISFeatureLayer"}),l=e.tables;return l&&l.length&&o.push(r(n.tables,l,s)),(0,f.E)(o).then((function(){}))}))}},{key:"_computeInitialViewpoint",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(){var t,r,n,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.initialViewProperties,!(null===(t=n)||void 0===t||null===(r=t.viewpoint)||void 0===r?void 0:r.targetGeometry)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this._getExtentFromItem();case 6:(i=e.sent)&&((n=n?n.clone():new bt).viewpoint=new g.u,n.viewpoint.targetGeometry=i,this.initialViewProperties=n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getExtentFromItem",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(){var t,n,i,o,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null===(t=this.initialViewProperties)||void 0===t?void 0:t.spatialReference,o=null===(n=this.portalItem)||void 0===n?void 0:n.extent,!i||!o){e.next=9;break}if(!i.isWGS84){e.next=4;break}return e.abrupt("return",o.clone());case 4:if(!i.isWebMercator){e.next=6;break}return e.abrupt("return",(0,x.R)(o));case 6:return e.next=8,r.e(4904).then(r.bind(r,5526));case 8:return e.abrupt("return",e.sent.getGeometryServiceURL(this.portalItem).then((function(e){var t=new J.a;return t.geometries=[o],t.outSpatialReference=i,(0,J.n)(e,t)})).then((function(e){return e[0]})).catch((function(e){return f.a.getLogger(a.declaredClass).error("Error projecting item's extent:",e),null})));case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_removeDanglingLayerRefs",value:function(){var e=this,t=this.applicationProperties,r=t&&t.viewing&&t.viewing.search,n=function(t){return e.allLayers.some((function(e){return e.id===t}))};r&&r.layers&&(r.layers=r.layers.filter((function(e){return n(e.id)}))),r&&r.tables&&(r.tables=r.tables.filter((function(t){return e.tables.some((function(e){return e.id===t.id}))})));var i=t&&t.editing&&t.editing.locationTracking;i&&i.info&&!n(i.info.layerId)&&(t.editing=null);var o=this.presentation&&this.presentation.slides;o&&o.forEach((function(e){e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((function(e){return n(e.id)})))}))}},{key:"_validateMap",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(){var t,r,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=this.basemap)&&void 0!==t&&t.baseLayers.length){e.next=2;break}throw new f.s("webmap:save","Map does not have a valid basemap with a base layer.");case 2:return r=null,e.next=5,(0,I.j)((function(){var e=(0,m.h)(n.initialViewProperties,n.basemap);return r=e.spatialReference,!e.updating}));case 5:if((0,x.E)(r,this.initialViewProperties.spatialReference)){e.next=7;break}throw new f.s("webmap:save","The spatial reference of the basemap is not compatible with the one from the map.",{expected:this.initialViewProperties.spatialReference,actual:r});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_validateItem",value:function(){if(!this.portalItem)throw f.a.getLogger(this.declaredClass).error("save: requires the portalItem property to be set"),new f.s("webmap:portal-item-not-set","Portal item to save to has not been set on the WebMap");this._validateItemType(this.portalItem)}},{key:"_validateItemType",value:function(e){if(e.type!==Zt)throw new f.s("webmap:portal-item-wrong-type",'Portal item needs to have type "'.concat(Zt,'"'))}},{key:"_loadLayerContainers",value:function(){var e=[];return this.basemap&&e.push(this.basemap.load()),this.ground&&e.push(this.ground.load()),(0,f.E)(e).then((function(){}))}},{key:"_beforeSave",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(){var t,r,n,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],r=(0,s.Z)(this.allLayers);try{for(r.s();!(n=r.n()).done;)"beforeSave"in(i=n.value)&&"function"==typeof i.beforeSave&&(o=i.beforeSave())&&t.push(o)}catch(a){r.e(a)}finally{r.f()}return e.next=5,(0,f.E)(t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_loadAllLayers",value:function(){var e=this._getAllLayersAndTables().map((function(e){return e.load()}));return(0,f.E)(e).then((function(){}))}},{key:"_getAllLayersAndTables",value:function(){return this.allLayers.concat(this.allTables)}},{key:"_validateJSONForWriting",value:function(e,t){var r=e.messages.filter((function(e){return"error"===e.type})).map((function(e){return new f.s(e.name,e.message,e.details)}));if(t.ignoreUnsupported&&(r=r.filter((function(e){return"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name}))),r.length>0)throw new f.s("webmap:save","Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:r})}},{key:"_updateItemProperties",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry);case 2:return t.extent=e.sent,e.next=5,this._updateTypeKeywords(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateItemPropertiesForSaveAs",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,P.c)(t,jt),(0,P.c)(t,"FieldMapsDisabled"),(0,P.c)(t,P.f.METADATA),(0,P.c)(t,At),(0,P.c)(t,"Offline Map Areas"),(0,P.c)(t,Lt),(0,P.c)(t,Rt),(0,P.c)(t,Ct),e.next=10,this._updateItemProperties(t);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getWGS84Extent",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){var r,n,i,o,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.clone().normalize()).length>1){i=(0,s.Z)(r);try{for(i.s();!(o=i.n()).done;)a=o.value,n?a.width>n.width&&(n=a):n=a}catch(u){i.e(u)}finally{i.f()}}else n=r[0];return e.abrupt("return",this._projectToWGS84(n));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_projectToWGS84",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){var n,i,o,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.spatialReference).isWGS84){e.next=3;break}return e.abrupt("return",t.clone());case 3:if(!n.isWebMercator){e.next=5;break}return e.abrupt("return",(0,x.j)(t));case 5:return e.next=7,r.e(4904).then(r.bind(r,5526));case 7:return i=e.sent,e.next=10,i.getGeometryServiceURL(this.portalItem);case 10:return o=e.sent,(a=new J.a).geometries=[t],a.outSpatialReference=x.k.WGS84,e.next=15,(0,J.n)(o,a);case 15:return e.abrupt("return",e.sent[0]);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateTypeKeywords",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,P.i)(t,_t),e.next=3,this._loadAllLayers();case 3:this._evalCollectorKeyword(t),this._evalDataEditingKeyword(t),this._evalOfflineKeyword(t),this._evalDeveloperBasemapKeyword(t),this._evalUtilityNetworkKeyword(t),t.typeKeywords&&(t.typeKeywords=t.typeKeywords.filter((function(e,t,r){return r.indexOf(e)===t})));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_evalCollectorKeyword",value:function(e){(0,P.s)(e,jt)||(0,P.s)(e,Rt)||(0,P.s)(e,Ct)||(0,P.s)(e,Lt)||!this._hasEditableFeatureLayer()?(0,P.c)(e,Nt):(0,P.i)(e,Nt)}},{key:"_evalDataEditingKeyword",value:function(e){this._hasEditableFeatureLayer()?(0,P.i)(e,Ot):(0,P.c)(e,Ot)}},{key:"_evalOfflineKeyword",value:function(e){!(0,P.s)(e,At)&&this._isOfflineCapableMap()?(0,P.i)(e,Et):(0,P.c)(e,Et)}},{key:"_evalDeveloperBasemapKeyword",value:function(e){(0,m.v)(this.basemap)?(0,P.i)(e,Ft):(0,P.c)(e,Ft)}},{key:"_evalUtilityNetworkKeyword",value:function(e){var t;null!==(t=this.utilityNetworks)&&void 0!==t&&t.length?(0,P.i)(e,Ut):(0,P.c)(e,Ut)}},{key:"_hasEditableFeatureLayer",value:function(){return this._getAllLayersAndTables().some((function(e){return e.loaded&&(0,O.o)(e)&&e.capabilities.operations.supportsEditing&&e.editingEnabled}))}},{key:"_isOfflineCapableMap",value:function(){var e=this;return this._getAllLayersAndTables().filter((function(e){return"group"!==e.type})).every((function(t){return t.loaded&&e._isOfflineCapableLayer(t)}))}},{key:"_isFeatureCollectionLike",value:function(e){return(0,O.l)(e)||"map-notes"===e.type||"route"===e.type}},{key:"_isOfflineCapableLayer",value:function(e){return(0,O.o)(e)&&e.capabilities.operations.supportsSync||this._isFeatureCollectionLike(e)&&!e.portalItem||("tile"===e.type||"vector-tile"===e.type)&&(e.capabilities.operations.supportsExportTiles||this._isExportableAGOLTileLayer(e)||(0,m.S)(e))&&e.spatialReference.equals(this.initialViewProperties.spatialReference)}},{key:"_isExportableAGOLTileLayer",value:function(e){return"tile"===e.type&&(0,N.j)(e.url)&&Vt.some((function(t){return e.url.toLowerCase().includes("/"+t+"/")}))}},{key:"_updateItem",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,r,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update({data:r});case 2:this._syncUpInstanceWithItem(t,r,n);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_createItem",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,r,n,i){var o,a,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.portalItem,a=!!(o&&o.id&&o.portal.user),u=t.portal,e.next=3,u._signIn();case 3:return e.next=5,this._canCopyItem(o,a,u);case 5:if(e.sent){e.next=7;break}throw new f.s("webmap:save-as-copy-not-allowed","Owner of this map does not allow others to save a copy");case 7:return e.next=9,u.user.addItem({item:t,folder:i.folder,data:r});case 9:this.portalItem=t,this._syncUpInstanceWithItem(t,r,n);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"_canCopyItem",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,r,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!((0,S.r)(t)&&t.id&&t.typeKeywords&&t.typeKeywords.includes("useOnly")),e.t0){e.next=10;break}if(e.t1=t.portal.portalHostname===n.portalHostname,!e.t1){e.next=9;break}if(e.t2=r,e.t2){e.next=8;break}return e.next=8,t.reload();case 8:e.t1="admin"===t.itemControl||"update"===t.itemControl;case 9:e.t0=e.t1;case 10:return e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_syncUpInstanceWithItem",value:function(e,t,r){Z.S.prototype.read.call(this,{version:t.version,authoringApp:t.authoringApp,authoringAppVersion:t.authoringAppVersion},{origin:"web-map",ignoreDefaults:!0,url:e.itemUrl&&(0,h.j)(e.itemUrl)}),(0,_.i)(r),this.resourceInfo=t}},{key:"_updateItemThumbnail",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.thumbnailUrl&&this._isOverridden("thumbnailUrl"),!e.t0){e.next=5;break}return e.next=4,this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename});case 4:this._clearThumbnailOverride();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getPortalItem",value:function(e){var t=U.default.from(e);return t.id&&((t=t.clone()).id=null),t.type||(t.type=Zt),t.portal||(t.portal=b.j.getDefault()),this._validateItemType(t),t}},{key:"_updateFromInternal",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,r){var n,i,o,a,u,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||{},e.next=3,(0,I.j)((function(){return t.ready}));case 3:if(this._updateInitialViewProperties(t,r),t.map!==this){e.next=7;break}n=(0,s.Z)(t.allLayerViews);try{for(n.s();!(i=n.n()).done;)for(o=i.value,a=0,u=["visible","featureEffect"];a<u.length;a++)(p=u[a])in o&&p in o.layer&&o._isOverridden(p)&&(o.layer[p]=o[p])}catch(l){n.e(l)}finally{n.f()}case 7:return e.next=9,this._updateThumbnailUrl(t,r);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_updateInitialViewProperties",value:function(e,t){var r;if(t.backgroundExcluded||(this.initialViewProperties.background=null===(r=e.background)||void 0===r?void 0:r.clone()),this.initialViewProperties.spatialReference=e.spatialReference.clone(),t.viewpointExcluded||(this.initialViewProperties.viewpoint=new g.u({rotation:e.rotation,scale:t.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)})),!t.widgetsExcluded){var n,i=(0,s.Z)(e.persistableViewModels);try{for(i.s();!(n=i.n()).done;){n.value.updateWebDocument(this)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"_getViewExtent",value:function(e){var t=e.center.clone().normalize(),r=e.extent.clone(),n=r.width/2;return r.xmin=t.x-n,r.xmax=t.x+n,r}},{key:"_updateThumbnailUrl",value:function(){var e=(0,v.Z)((0,l.Z)().mark((function e(t,r){var n,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.thumbnailExcluded){e.next=2;break}return e.abrupt("return");case 2:return n=(0,G.a)(t,r.thumbnailSize),e.next=5,t.takeScreenshot({format:"png",width:n.width,height:n.height});case 5:i=e.sent,this._setAutoGeneratedThumbnail(i.dataUrl);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_setAutoGeneratedThumbnail",value:function(e){this.thumbnailUrl=e,this._thumbnailFilename=null}},{key:"_clearThumbnailOverride",value:function(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}},{key:"_generateCustomThumbnailFilename",value:function(e){if((0,h.X)(e)){var t=(0,h.n)(e),r=t&&t.mediaType,n=r&&xt.get(r.toLowerCase())||null,i="thumbnail".concat(Date.now());return n?"".concat(i,".").concat(n):i}return null}},{key:"_getThumbnailState",value:function(){var e=this.thumbnailUrl;return e&&(e=this._isOverridden("thumbnailUrl")?e:(0,h.S)(e,"w","8192")),{thumbnailUrl:e,filename:this._thumbnailFilename}}},{key:"_restoreThumbnailFromState",value:function(e){this.thumbnailUrl=e.thumbnailUrl,this._thumbnailFilename=e.filename}},{key:"_getAuthoringPropsState",value:function(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}},{key:"_restoreAuthoringPropsFromState",value:function(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1,e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}}],[{key:"fromJSON",value:function(e){var t=e;if(!t)throw new f.s("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:t})}}]),w}((0,Z.O)(b.m.LoadableMixin((0,T.m)(m.L))));Pt.VERSION=St,(0,f.e)([(0,f.y)({type:ft,json:{write:!0}})],Pt.prototype,"applicationProperties",void 0),(0,f.e)([(0,f.y)({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],Pt.prototype,"authoringApp",null),(0,f.e)([(0,x.r)("authoringApp")],Pt.prototype,"writeAuthoringApp",null),(0,f.e)([(0,f.y)({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],Pt.prototype,"authoringAppVersion",null),(0,f.e)([(0,x.r)("authoringAppVersion")],Pt.prototype,"writeAuthoringAppVersion",null),(0,f.e)([(0,f.y)({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Pt.prototype,"basemap",void 0),(0,f.e)([(0,f.y)({type:Tt,json:{write:{overridePolicy:function(e){return{enabled:!!(e&&e.length>0),ignoreOrigin:!0}}}}})],Pt.prototype,"bookmarks",void 0),(0,f.e)([(0,f.y)({type:G.l,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],Pt.prototype,"floorInfo",void 0),(0,f.e)([(0,f.y)({type:Ye,json:{write:!0}})],Pt.prototype,"geotriggersInfo",void 0),(0,f.e)([(0,f.y)({type:bt,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference"]},write:{ignoreOrigin:!0,target:{background:{type:H.m},"initialState.viewpoint":{type:g.u},mapRangeInfo:{type:$e},spatialReference:{type:x.k}}}}})],Pt.prototype,"initialViewProperties",void 0),(0,f.e)([(0,x.o)("initialViewProperties")],Pt.prototype,"readInitialViewProperties",null),(0,f.e)([(0,x.r)("initialViewProperties")],Pt.prototype,"writeInitialViewProperties",null),(0,f.e)([(0,f.y)({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],Pt.prototype,"layers",void 0),(0,f.e)([(0,x.r)("layers")],Pt.prototype,"writeLayers",null),(0,f.e)([(0,f.y)({type:U.default})],Pt.prototype,"portalItem",void 0),(0,f.e)([(0,f.y)({json:{write:!0}})],Pt.prototype,"presentation",void 0),(0,f.e)([(0,f.y)()],Pt.prototype,"resourceInfo",void 0),(0,f.e)([(0,f.y)({readOnly:!0,type:kt,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],Pt.prototype,"sourceVersion",void 0),(0,f.e)([(0,x.o)("sourceVersion")],Pt.prototype,"readSourceVersion",null),(0,f.e)([(0,x.r)("sourceVersion")],Pt.prototype,"writeSourceVersion",null),(0,f.e)([(0,f.y)({json:{read:!1,write:{ignoreOrigin:!0}}})],Pt.prototype,"tables",void 0),(0,f.e)([(0,x.r)("tables")],Pt.prototype,"writeTables",null),(0,f.e)([(0,f.y)()],Pt.prototype,"thumbnailUrl",null),(0,f.e)([(0,f.y)({type:dt,json:{write:!0}})],Pt.prototype,"widgets",void 0),(0,f.e)([(0,f.y)({type:It,json:{read:!0,write:!0}})],Pt.prototype,"utilityNetworks",void 0);var Jt=Pt=(0,f.e)([(0,f.n)("esri.WebMap")],Pt),Gt=Object.freeze({__proto__:null,default:Jt})},64854:function(e,t,r){r.d(t,{S:function(){return u},e:function(){return n},i:function(){return i},l:function(){return o},o:function(){return a},r:function(){return l},s:function(){return p},t:function(){return s},y:function(){return c}});var n=[252,146,31,255],i=[153,153,153,255],o={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},a={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},u={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},s={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},l={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},p={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},c={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},20302:function(e,t,r){r.d(t,{r:function(){return o}});var n=r(40558),i=r(48848);function o(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e instanceof n.s?e:new n.s(e,r),a={type:null===(t=null===r||void 0===r?void 0:r.ignoreUnknown)||void 0===t||t?o.apiValues:String,json:{type:o.jsonValues,read:!(null!==r&&void 0!==r&&r.readOnly)&&{reader:o.read},write:{writer:o.write}}};return void 0!==(null===r||void 0===r?void 0:r.readOnly)&&(a.readOnly=!!r.readOnly),void 0!==(null===r||void 0===r?void 0:r.default)&&(a.json.default=r.default),void 0!==(null===r||void 0===r?void 0:r.name)&&(a.json.name=r.name),(0,i.y)(a)}},477:function(e,t,r){r.d(t,{a:function(){return l},t:function(){return u}});var n=r(74165),i=r(15861),o=r(93661),a=r(35237);function u(e,t,r){return s.apply(this,arguments)}function s(){return s=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){var a,u,s,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=r.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(r.maxRecordCountFactor=p(t)),a=l(t),u=t.capabilities.query.supportsPagination,r.start=0,r.num=a,s=null;case 4:return e.next=6,t.source.queryFeaturesJSON(r,i);case 6:if(c=e.sent,(0,o.t)(s)?s=c:s.features=s.features.concat(c.features),s.exceededTransferLimit=c.exceededTransferLimit,u&&c.exceededTransferLimit){e.next=9;break}return e.abrupt("break",12);case 9:r.start+=a;case 10:e.next=4;break;case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function l(e){return p(e)*function(e){return e.capabilities.query.maxRecordCount||2e3}(e)}function p(e){return e.capabilities.query.supportsMaxRecordCountFactor?a.x.MAX_MAX_RECORD_COUNT_FACTOR:1}},56162:function(e,t,r){r.d(t,{c:function(){return y},d:function(){return f},f:function(){return p},l:function(){return s},s:function(){return l},u:function(){return u},v:function(){return d},y:function(){return c}});var n=r(93661),i=r(46817),o=r(82474),a=r(74384);function u(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}function s(e){return void 0!==e.points}function l(e){return void 0!==e.x&&void 0!==e.y}function p(e){return void 0!==e.paths}function c(e){return void 0!==e.rings}function d(e){return(0,n.t)(e)?null:e instanceof o.p?e:l(e)?o.w.fromJSON(e):p(e)?a.m.fromJSON(e):c(e)?a.v.fromJSON(e):s(e)?a.u.fromJSON(e):u(e)?i.w.fromJSON(e):null}function y(e){return e?l(e)?"esriGeometryPoint":p(e)?"esriGeometryPolyline":c(e)?"esriGeometryPolygon":u(e)?"esriGeometryEnvelope":s(e)?"esriGeometryMultipoint":null:null}var v={esriGeometryPoint:o.w,esriGeometryPolyline:a.m,esriGeometryPolygon:a.v,esriGeometryEnvelope:i.w,esriGeometryMultipoint:a.u};function f(e){return e&&v[e]||null}},94518:function(e,t,r){r.d(t,{a:function(){return y},c:function(){return d},f:function(){return f},i:function(){return p},s:function(){return c}});var n=r(37762),i=r(74165),o=r(15861),a=r(95249),u=r(82474);function s(e){return l.apply(this,arguments)}function l(){return l=(0,o.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.spatialReference).isWGS84){e.next=3;break}return e.abrupt("return",t.clone());case 3:if(!r.isWebMercator){e.next=5;break}return e.abrupt("return",(0,u.j)(t));case 5:return n=u.k.WGS84,e.next=8,(0,a._)(r,n);case 8:return e.abrupt("return",(0,a.r)(t,n));case 9:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function p(e,t){if(!c(e,t)){var r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function c(e,t){var r;return!(null===(r=e.typeKeywords)||void 0===r||!r.includes(t))}function d(e,t){var r=e.typeKeywords;if(r){var n=r.indexOf(t);n>-1&&r.splice(n,1)}}function y(e){return v.apply(this,arguments)}function v(){return(v=(0,o.Z)((0,i.Z)().mark((function e(t){var r,o,a,u,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.clone().normalize()).length>1){a=(0,n.Z)(r);try{for(a.s();!(u=a.n()).done;)l=u.value,o?l.width>o.width&&(o=l):o=l}catch(i){a.e(i)}finally{a.f()}}else o=r[0];return e.abrupt("return",s(o));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var f={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table"}},2473:function(e,t,r){r.d(t,{a:function(){return m},n:function(){return w}});var n=r(74165),i=r(1413),o=r(15861),a=r(15671),u=r(43144),s=r(60136),l=r(29388),p=r(40558),c=r(48848),d=r(56162),y=r(39994),v=r(69717),f=r(40114),h=(r(93661),function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).geometries=null,n.outSpatialReference=null,n.transformation=null,n.transformForward=null,n}return(0,u.Z)(r,[{key:"toJSON",value:function(){var e=this.geometries.map((function(e){return e.toJSON()})),t=this.geometries[0],r={};return r.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),r.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),r.geometries=JSON.stringify({geometryType:(0,d.c)(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(r.transformForward=this.transformForward),r}}]),r}(f.l));(0,c.e)([(0,c.y)()],h.prototype,"geometries",void 0),(0,c.e)([(0,c.y)({json:{read:{source:"outSR"}}})],h.prototype,"outSpatialReference",void 0),(0,c.e)([(0,c.y)()],h.prototype,"transformation",void 0),(0,c.e)([(0,c.y)()],h.prototype,"transformForward",void 0);var m=h=(0,c.e)([(0,c.n)("esri.rest.support.ProjectParameters")],h),g=(0,c.b)(m);function w(e,t,r){return b.apply(this,arguments)}function b(){return b=(0,o.Z)((0,n.Z)().mark((function e(t,r,o){var a,u,s,l,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=g(r),a=(0,y.f)(t),u=(0,i.Z)((0,i.Z)({},a.query),{},{f:"json"},r.toJSON()),s=r.outSpatialReference,l=(0,d.c)(r.geometries[0]),c=(0,y.i)(u,o),e.abrupt("return",(0,p.U)(a.path+"/project",c).then((function(e){var t=e.data.geometries;return(0,v.o)(t,l,s)})));case 3:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}},51816:function(e,t,r){r.d(t,{r:function(){return a}});var n=r(37762),i=r(93661),o=r(65415);function a(e,t,r){if(r&&r.features&&r.hasZ){var a=(0,o.o)(r.geometryType,t,e.outSpatialReference);if(!(0,i.t)(a)){var u,s=(0,n.Z)(r.features);try{for(s.s();!(u=s.n()).done;){a(u.value.geometry)}}catch(l){s.e(l)}finally{s.f()}}}}},84186:function(e,t,r){var n,i;function o(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function a(e){return null!=e&&!isNaN(e)&&isFinite(e)}function u(e){return e.valueExpression?n.Expression:e.field&&"string"==typeof e.field?n.Field:n.Unknown}function s(e,t){var r=t||u(e),o=e.valueUnit||"unknown";return r===n.Unknown?i.Constant:e.stops?i.Stops:null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?i.ClampedLinear:"unknown"===o?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?i.Proportional:i.Additive:i.Identity:i.RealWorldSize}r.d(t,{a:function(){return s},e:function(){return o},i:function(){return i},l:function(){return a},n:function(){return n},t:function(){return u}}),function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"}(n||(n={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(i||(i={}))},87753:function(e,t,r){r.d(t,{r:function(){return a},t:function(){return s}});var n=r(74165),i=r(15861),o=r(93661);function a(e,t){return u.apply(this,arguments)}function u(){return u=(0,i.Z)((0,n.Z)().mark((function e(t,i){var o,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(2470).then(r.bind(r,62470));case 2:return o=e.sent,a=o.WhereClause,e.abrupt("return",a.create(t,i));case 5:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function s(e,t){return(0,o.r)(e)?(0,o.r)(t)?"(".concat(e,") AND (").concat(t,")"):e:t}},69717:function(e,t,r){r.d(t,{o:function(){return o},r:function(){return i}});var n=r(56162);function i(e){return{geometryType:(0,n.c)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function o(e,t,r){var i=(0,n.d)(t);return e.map((function(e){var t=i.fromJSON(e);return t.spatialReference=r,t}))}},39994:function(e,t,r){r.d(t,{f:function(){return u},i:function(){return a},s:function(){return s}});var n=r(1413),i=r(93661),o=r(40558);function a(e,t){return t?(0,n.Z)((0,n.Z)({},t),{},{query:(0,n.Z)((0,n.Z)({},e),t.query)}):{query:e}}function u(e){return"string"==typeof e?(0,o.j)(e):(0,i.y)(e)}function s(e,t,r){var n={};for(var i in e)if("declaredClass"!==i){var o=e[i];if(null!=o&&"function"!=typeof o)if(Array.isArray(o)){n[i]=[];for(var a=0;a<o.length;a++)n[i][a]=s(o[a])}else if("object"==typeof o)if(o.toJSON){var u=o.toJSON(r&&r[i]);n[i]=t?u:JSON.stringify(u)}else n[i]=t?o:JSON.stringify(o);else n[i]=o}return n}},65415:function(e,t,r){r.d(t,{o:function(){return u}});var n=r(37762),i=r(93661),o=r(47855),a=r(82474);function u(e,t,r){if((0,i.t)(t)||(0,i.t)(r)||r.vcsWkid||(0,a.E)(t,r))return null;var u=(0,o.L)(t)/(0,o.L)(r);if(1===u)return null;switch(e){case"point":case"esriGeometryPoint":return function(e){return function(e,t){e&&null!=e.z&&(e.z*=t)}(e,u)};case"polyline":case"esriGeometryPolyline":return function(e){return function(e,t){if(e){var r,i=(0,n.Z)(e.paths);try{for(i.s();!(r=i.n()).done;){var o,a=r.value,u=(0,n.Z)(a);try{for(u.s();!(o=u.n()).done;){var s=o.value;s.length>2&&(s[2]*=t)}}catch(l){u.e(l)}finally{u.f()}}}catch(l){i.e(l)}finally{i.f()}}}(e,u)};case"polygon":case"esriGeometryPolygon":return function(e){return function(e,t){if(e){var r,i=(0,n.Z)(e.rings);try{for(i.s();!(r=i.n()).done;){var o,a=r.value,u=(0,n.Z)(a);try{for(u.s();!(o=u.n()).done;){var s=o.value;s.length>2&&(s[2]*=t)}}catch(l){u.e(l)}finally{u.f()}}}catch(l){i.e(l)}finally{i.f()}}}(e,u)};case"multipoint":case"esriGeometryMultipoint":return function(e){return function(e,t){if(e){var r,i=(0,n.Z)(e.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.length>2&&(o[2]*=t)}}catch(a){i.e(a)}finally{i.f()}}}(e,u)};case"extent":case"esriGeometryExtent":return function(e){return function(e,t){e&&null!=e.zmin&&null!=e.zmax&&(e.zmin*=t,e.zmax*=t)}(e,u)};default:return null}}}}]);
//# sourceMappingURL=530.823bf85e.chunk.js.map