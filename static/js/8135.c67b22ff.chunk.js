"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[8135],{74558:function(e,t,r){r.d(t,{p:function(){return c}});var n=r(15671),i=r(43144),o=r(60136),a=r(29388),u=r(50165),f=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"initialize",value:function(){}},{key:"destroy",value:function(){}},{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){var e=this.get("tileStore.tileScheme.spatialReference");return e&&e.toJSON()||null}}]),r}(r(22984).d);(0,u.e)([(0,u.d)({readOnly:!0})],f.prototype,"supportsTileUpdates",null),(0,u.e)([(0,u.d)({constructOnly:!0})],f.prototype,"remoteClient",void 0),(0,u.e)([(0,u.d)({constructOnly:!0})],f.prototype,"service",void 0),(0,u.e)([(0,u.d)()],f.prototype,"spatialReference",null),(0,u.e)([(0,u.d)({constructOnly:!0})],f.prototype,"tileInfo",void 0),(0,u.e)([(0,u.d)({constructOnly:!0})],f.prototype,"tileStore",void 0);var c=f=(0,u.e)([(0,u.n)("esri.views.2d.layers.features.processors.BaseProcessor")],f)},48135:function(e,t,r){r.r(t);var n=r(1413),i=r(29439),o=r(37762),a=r(74165),u=r(15861),f=r(60136),c=r(29388),s=r(43144),l=r(15671),d=r(50165),h=r(89354),p=r(94872),y=r(45578),v=r(74558),w=r(89324),m=(r(40133),r(2760),r(3969),r(22984),r(69738),r(73627),r(96263),r(77322),r(32335),r(53089),r(33530),r(31278),r(13994),r(83172),r(79747),r(78664),r(49961),r(31412),r(49510),(0,s.Z)((function e(t,r){(0,l.Z)(this,e),this.offset=t,this.extent=r})));function k(e){var t=e.key,r=new Map,n=256,i=y.o,o=e.tileInfoView.tileInfo.isWrappable;return r.set((0,w.l)(t,-1,-1,o).id,new m([-i,-i],[i-n,i-n,i,i])),r.set((0,w.l)(t,0,-1,o).id,new m([0,-i],[0,i-n,i,i])),r.set((0,w.l)(t,1,-1,o).id,new m([i,-i],[0,i-n,n,i])),r.set((0,w.l)(t,-1,0,o).id,new m([-i,0],[i-n,0,i,i])),r.set((0,w.l)(t,1,0,o).id,new m([i,0],[0,0,n,i])),r.set((0,w.l)(t,-1,1,o).id,new m([-i,i],[i-n,0,i,n])),r.set((0,w.l)(t,0,1,o).id,new m([0,i],[0,0,i,n])),r.set((0,w.l)(t,1,1,o).id,new m([i,i],[0,0,n,n])),r}var g=function(e){(0,f.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,l.Z)(this,r),(e=t.apply(this,arguments)).type="heatmap",e._tileKeyToFeatureSets=new Map,e}return(0,s.Z)(r,[{key:"initialize",value:function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}},{key:"update",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,r){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("heatmap"===(n=r.schema.processors[0]).type){e.next=3;break}return e.abrupt("return");case 3:(0,h.m)(this._schema,n)&&(t.mesh=!0,this._schema=n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"onTileUpdate",value:function(e){var t,r=(0,o.Z)(e.removed);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._tileKeyToFeatureSets.delete(n.key.id)}}catch(i){r.e(i)}finally{r.f()}}},{key:"onTileClear",value:function(e){return this._tileKeyToFeatureSets.delete(e.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:{clear:!0}})}},{key:"onTileMessage",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,r,o){var u,f,c,s,l,h;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._tileKeyToFeatureSets.has(t.key.id)||this._tileKeyToFeatureSets.set(t.key.id,new Map),u=this._tileKeyToFeatureSets.get(t.key.id),(0,d.r)(r.addOrUpdate)&&r.addOrUpdate.hasFeatures&&u.set(r.addOrUpdate.instance,r),!r.end){e.next=7;break}return f=[],c=k(t),this._tileKeyToFeatureSets.forEach((function(e,r){if(r===t.key.id)e.forEach((function(e){return(0,d.aq)(e.addOrUpdate,(function(e){return f.push(e)}))}));else if(c.has(r)){var n=c.get(r),o=(0,i.Z)(n.offset,2),a=o[0],u=o[1];e.forEach((function(e){return(0,d.aq)(e.addOrUpdate,(function(e){var t=e.transform(a,u,1,1);f.push(t)}))}))}})),s=(0,p.l)(f,this._schema.mesh,512,512),l={tileKey:t.key.id,intensityInfo:s},h=[s.matrix],e.abrupt("return",this.remoteClient.invoke("tileRenderer.onTileData",l,(0,n.Z)((0,n.Z)({},o),{},{transferList:h})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"onTileError",value:function(e,t,r){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:e.id,error:t},r)}}]),r}(v.p),M=g=(0,d.e)([(0,d.n)("esri.views.2d.layers.features.processors.HeatmapProcessor")],g);t.default=M},94872:function(e,t,r){r.d(t,{a:function(){return u},d:function(){return y},f:function(){return c},i:function(){return f},l:function(){return d},m:function(){return h},s:function(){return l},y:function(){return p}});var n=r(37762),i=r(2760),o=r(78880),a=r(3969),u=2.4;function f(e){return(0,o.e)(e*u)}function c(e){return(0,o.u)(e)/u}function s(e,t,r,n){var o=t.color,a=t.ratio,u=r.color,f=r.ratio;if(f===a){var c=1e-6;1===f?a-=c:f+=c}var s=(0,i.o)((n-a)/(f-a),0,1);(0,i.j)(e,o.toArray(),u.toArray(),s)}function l(e){var t=new Uint8ClampedArray(2048);if(e=e.filter((function(e){var t=e.ratio;return t>=0&&t<=1})).sort((function(e,t){return e.ratio-t.ratio})).map((function(e){var t=e.color,r=e.ratio;return{color:t,ratio:Math.max(r,.001)}})),e.length<1)return t;for(var r=e[0],n=e[0],i=1,o=(0,a.n)(),u=0;u<512;u++){for(var f=(u+.5)/512;f>n.ratio&&i<e.length;)r=n,n=e[i++];s(o,r,n,f),t.set(o,4*u)}return t}function d(e,t,r,i){var a,u,f=t.radius,c=t.fieldOffset,s=t.field,l=Math.round((0,o.u)(f)),d=new Float64Array(r*i),h=Number.NEGATIVE_INFINITY,y=function(e,t){return null!=e?"string"==typeof t?function(t){return-1*+t.readAttribute(e)}:function(r){return+r.readAttribute(e)+t}:function(e){return 1}}(s,c),v=new Set,w=(0,n.Z)(e);try{for(w.s();!(u=w.n()).done;)for(var m=u.value.getCursor();m.next();){var k=m.getObjectId();if(!v.has(k)){v.add(k);var g=m.readLegacyPointGeometry(),M=128;if(!(g.x<-M||g.x>=r+M||g.y<-M||g.y>i+M))for(var T=+y(m),Z=Math.max(0,Math.round(g.x)-l),_=Math.max(0,Math.round(g.y)-l),b=Math.min(i,Math.round(g.y)+l),U=Math.min(r,Math.round(g.x)+l),x=_;x<b;x++)for(var O=Z;O<U;O++){var S=x*r+O,I=p(g.x-O,g.y-x,l);(a=d[S]+=I*T)>h&&(h=a)}}}}catch(A){w.e(A)}finally{w.f()}return{matrix:d.buffer,max:h}}function h(e,t,r,n,o,a){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);var u=e.getImageData(0,0,t,t);r&&n&&u.data.set(new Uint8ClampedArray(function(e,t,r,n,o){for(var a=new Uint32Array(e*e),u=("buffer"in t?t:new Float64Array(t)),f=("buffer"in r?new Uint32Array(r.buffer):new Uint32Array(new Uint8Array(r).buffer)),c=f.length/(o-n),s=0;s<u.length;s++){var l=u[s],d=Math.floor((l-n)*c);a[s]=f[(0,i.o)(d,0,f.length-1)]}return a.buffer}(t,r,n,o,a))),e.putImageData(u,0,0)}function p(e,t,r){var n=Math.sqrt(Math.pow(e,2)+Math.pow(t,2))/r;return n>1?0:3/(Math.PI*Math.pow(r,2))*Math.pow(1-Math.pow(n,2),2)}function y(e,t){return"function"==typeof e?e:e?"string"==typeof t?function(t){return-1*+t[e]}:function(r){return+r[e]+t}:function(){return 1}}},89324:function(e,t,r){r.d(t,{l:function(){return n}});r(50165),r(96263),r(2760),r(53089),r(49510);function n(e,t,r,n){var i=e.clone(),o=1<<i.level,a=i.col+t,u=i.row+r;return n&&a<0?(i.col=a+o,i.world-=1):a>=o?(i.col=a-o,i.world+=1):i.col=a,i.row=u,i}},3969:function(e,t,r){function n(){return[0,0,0,0]}function i(e){return[e[0],e[1],e[2],e[3]]}function o(e,t,r,n){return[e,t,r,n]}function a(e){for(var t=[0,0,0,0],r=Math.min(4,e.length),n=0;n<r;++n)t[n]=e[n];return t}function u(e,t){return new Float64Array(e,t,4)}function f(){return[0,0,0,0]}function c(){return o(1,1,1,1)}function s(){return o(1,0,0,0)}function l(){return o(0,1,0,0)}function d(){return o(0,0,1,0)}function h(){return o(0,0,0,1)}r.d(t,{_:function(){return y},e:function(){return a},l:function(){return p},n:function(){return n},r:function(){return o},t:function(){return i},u:function(){return u}});var p=[0,0,0,0],y=c(),v=s(),w=l(),m=d(),k=h();Object.freeze(Object.defineProperty({__proto__:null,create:n,clone:i,fromValues:o,fromArray:a,createView:u,zeros:f,ones:c,unitX:s,unitY:l,unitZ:d,unitW:h,ZEROS:p,ONES:y,UNIT_X:v,UNIT_Y:w,UNIT_Z:m,UNIT_W:k},Symbol.toStringTag,{value:"Module"}))}}]);
//# sourceMappingURL=8135.c67b22ff.chunk.js.map