"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[8442],{58442:function(e,t,r){r.r(t),r.d(t,{SceneLayerSnappingSource:function(){return b}});var n=r(37762),i=r(74165),a=r(15861),o=r(15671),u=r(43144),s=r(60136),c=r(29388),d=r(48848),l=r(93661),p=r(630),f=r(28390),h=r(71802),y=r(59929),v=r(64772),w=r(52638),k=r(21078),g=r(43486),Z=(r(50690),r(17455),r(62610),r(1500),r(40114),r(82474),r(74384),r(46817),r(40558),r(56162),r(64998),r(25577),r(93314),r(37856),r(15751),r(59984),r(20302),r(53586),r(65094),r(60369),r(92072),r(37944),r(86086),r(21385),r(89794),r(48200),r(85253),r(93209),r(25456),r(46337),r(81556),r(93116),r(42467),r(46737),r(52113),r(75255),r(42667),r(61118),r(85113),r(23585),r(82396),r(47855),r(95249),r(79557),r(65415),r(25747),r(59389),r(26313),r(37077),r(49228),r(41723),r(91681),r(24093),r(6189),r(17332),r(87750),r(13239),r(20846),r(67430),r(76291),r(87424),r(10464),r(32043),r(98598),r(43955),r(19941),r(39994),r(49871),r(63212),r(69717),r(53409),r(35182),r(62466),r(51816),r(68781),r(69641),r(15436),r(35237),r(89181),r(69768),r(35865),r(51219),r(66577),r(95643),r(33795),r(43976),r(6762),r(2959),r(2821),r(33794),r(71147),r(84186),r(15529),r(70449),r(22603),r(56546),r(39926),r(8141),r(26151),r(90429),r(52559),r(95399),r(98987),r(99795),r(87753),r(29130),r(1685),r(12953),r(74797),r(45999),r(72973),r(62710),r(52721),r(61903),r(23444),r(40811),r(51920),r(63393),r(90442),r(64854),r(24623),r(64264),r(6379),r(21015),r(23341),r(41820),r(20086),r(92982),r(61416),r(77880),r(74494),r(77755),r(71645),r(89311),r(67066),r(39769),r(70607),r(85700),r(3719),r(32161),r(37686),r(16641),r(62642),r(90316),r(19891),r(47748),r(70522),r(43066),r(29048),r(68136),r(50253),r(27205),r(16263),r(3356),r(70381),r(20675),r(85026),r(33973),r(42233),r(93122),r(70288),r(95414),r(57791),r(43345),r(75833),r(31698),r(94777),r(4937),r(87440),r(21744),r(18936),r(4397),r(25217),r(43406),r(45184),r(72361),r(22159),r(73911),r(87917),r(46018),r(70863),r(62312),r(24648),r(63999),r(1797),r(5526),r(2473),r(2467),r(75257),r(26789),r(64095),r(51732),r(2851),r(70285),r(75016),r(52102),r(8586),r(82509),r(42947),r(92251),r(91386),r(18668),r(15132),r(2352),r(62470),r(54622),r(73679),r(62753),r(83948),r(94663),r(40345),r(66633),function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).availability=0,n._ids=new Set,n._tmpP=(0,h.n)(),n}return(0,u.Z)(r,[{key:"destroy",value:function(){this._workerHandle.destroy(),this._workerHandle=null}},{key:"initialize",value:function(){var e=this;this._workerHandle=new _(this.schedule,{fetchAllEdgeLocations:function(t,r){return e._fetchAllEdgeLocations(t,r)}})}},{key:"fetchCandidates",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,o,u,s,c=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.coordinateHelper,a=n.toXYZ(t.point),this.renderCoordsHelper.toRenderCoords(a,n.spatialReference,a),o=t.distance,u="number"==typeof o?o:o.distance,e.next=6,this._workerHandle.invoke({bounds:(0,v.E)(a[0],a[1],a[2],u),types:t.types},r);case 6:return s=e.sent,e.abrupt("return",(s.candidates.sort((function(e,t){return e.distance-t.distance})),s.candidates.map((function(e){return c._convertCandidate(n,e)}))));case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._ids.add(t.id),e.next=3,this._workerHandle.invokeMethod("add",t,r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._ids.delete(t.id),e.next=3,this._workerHandle.invokeMethod("remove",t,r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_convertCandidate",value:function(e,t){switch(t.type){case"edge":return new k.e({coordinateHelper:e,objectId:t.objectId,targetPoint:this._convertRenderCoordinate(e,t.target),edgeStart:this._convertRenderCoordinate(e,t.start),edgeEnd:this._convertRenderCoordinate(e,t.end),elevationInfo:w.E});case"vertex":return new g.o({coordinateHelper:e,objectId:t.objectId,targetPoint:this._convertRenderCoordinate(e,t.target),elevationInfo:w.E})}}},{key:"_convertRenderCoordinate",value:function(e,t){return this.renderCoordsHelper.fromRenderCoords(t,this._tmpP,e.spatialReference),e.fromXYZ(this._tmpP)}},{key:"_fetchAllEdgeLocations",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var o,u,s,c,d,l=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=[],u=[],s=(0,n.Z)(t.components);try{for(d=function(){var e=c.value,t=e.id,n=e.uid;l._ids.has(t)&&o.push((0,a.Z)((0,i.Z)().mark((function e(){var a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.fetchEdgeLocations(t,r.signal);case 2:return a=e.sent,e.abrupt("return",(u.push(a.locations.buffer),{id:t,uid:n,objectIds:a.objectIds,locations:a.locations.buffer,origin:a.origin,type:a.type}));case 4:case"end":return e.stop()}}),e)})))())},s.s();!(c=s.n()).done;)d()}catch(p){s.e(p)}finally{s.f()}return e.next=5,Promise.all(o);case 5:return e.t0=e.sent.filter((function(e){var t=e.id;return l._ids.has(t)})),e.t1={components:e.t0},e.t2=u,e.abrupt("return",{result:e.t1,transferList:e.t2});case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(p.d));(0,d.e)([(0,d.y)({constructOnly:!0})],Z.prototype,"renderCoordsHelper",void 0),(0,d.e)([(0,d.y)({constructOnly:!0})],Z.prototype,"fetchEdgeLocations",void 0),(0,d.e)([(0,d.y)({constructOnly:!0})],Z.prototype,"schedule",void 0),(0,d.e)([(0,d.y)({readOnly:!0})],Z.prototype,"availability",void 0),Z=(0,d.e)([(0,d.n)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],Z);var _=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e,n){return(0,o.Z)(this,r),t.call(this,"SceneLayerSnappingSourceWorker","fetchCandidates",{},e,{strategy:"dedicated",client:n})}return(0,u.Z)(r)}(y.h),S=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).availability=1,n._abortController=new AbortController,n}return(0,u.Z)(r,[{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"destroy",value:function(){this._tracker=(0,l.f)(this._tracker),this._abortController=(0,l.l)(this._abortController)}},{key:"initialize",value:function(){var e=this,t=this.view.resourceController;this._edgeWorker=new f.bv((function(e){return t.schedule(e)})),this._workerHandle=new Z({renderCoordsHelper:this.view.renderCoordsHelper,schedule:function(e){return t.schedule(e)},fetchEdgeLocations:function(){var t=(0,a.Z)((0,i.Z)().mark((function t(r,n){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,l.t)(e._tracker)){t.next=2;break}throw new Error("tracker-not-initialized");case 2:return t.abrupt("return",e._tracker.fetchEdgeLocations(r,e._edgeWorker,n));case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()}),this.updatingHandles.addPromise(this._setupLayerView()),this.handles.add([(0,d.aF)(this._workerHandle),(0,d.aF)(this._edgeWorker)])}},{key:"fetchCandidates",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._workerHandle.fetchCandidates(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){}},{key:"_setupLayerView",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,r,n=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.destroyed){e.next=2;break}return e.abrupt("return");case 2:return t=(0,l.n)(this._abortController,(function(e){return e.signal})),e.next=5,this.getLayerView();case 5:r=e.sent,(0,l.t)(r)||(0,d.p)(t)||(this._tracker=r.trackSnappingSources({add:function(e,r){n.updatingHandles.addPromise(n._workerHandle.add({id:e,bounds:r},t))},remove:function(e){n.updatingHandles.addPromise(n._workerHandle.remove({id:e},t))}}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(p.d);(0,d.e)([(0,d.y)({constructOnly:!0})],S.prototype,"getLayerView",void 0),(0,d.e)([(0,d.y)({constructOnly:!0})],S.prototype,"view",void 0),(0,d.e)([(0,d.y)({readOnly:!0})],S.prototype,"updating",null),(0,d.e)([(0,d.y)({readOnly:!0})],S.prototype,"availability",void 0),S=(0,d.e)([(0,d.n)("esri.views.interactive.snapping.featureSources.I3SSnappingSource")],S);var b=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).availability=1,n._i3sSources=[],n}return(0,u.Z)(r,[{key:"updating",get:function(){return this._i3sSources.some((function(e){return e.updating}))}},{key:"destroy",value:function(){this._i3sSources.forEach((function(e){return e.destroy()})),this._i3sSources.length=0}},{key:"initialize",value:function(){var e=this.view,t=this.layerSource.layer;this._i3sSources="building-scene"===t.type?this._getBuildingSceneI3SSources(e,t):[this._getSceneLayerI3SSource(e,t)]}},{key:"fetchCandidates",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this._i3sSources.map((function(e){return e.fetchCandidates(t,r)})));case 2:return n=e.sent,e.abrupt("return",((0,d.f)(r),n.flat()));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){this._i3sSources.forEach((function(e){return e.refresh()}))}},{key:"_getBuildingSceneI3SSources",value:function(e,t){return t.allSublayers.toArray().map((function(r){return"building-component"===r.type?new S({getLayerView:function(){var n=(0,a.Z)((0,i.Z)().mark((function n(){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.whenLayerView(t);case 2:return n.abrupt("return",n.sent.whenSublayerView(r));case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),view:e}):null})).filter(l.r)}},{key:"_getSceneLayerI3SSource",value:function(e,t){return new S({getLayerView:function(){var r=(0,a.Z)((0,i.Z)().mark((function r(){var n;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.whenLayerView(t);case 2:return n=r.sent,r.abrupt("return","scene-layer-graphics-3d"===n.type?void 0:n);case 4:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),view:e})}}]),r}(d.m);(0,d.e)([(0,d.y)({constructOnly:!0})],b.prototype,"layerSource",void 0),(0,d.e)([(0,d.y)({constructOnly:!0})],b.prototype,"view",void 0),(0,d.e)([(0,d.y)({readOnly:!0})],b.prototype,"updating",null),(0,d.e)([(0,d.y)({readOnly:!0})],b.prototype,"availability",void 0),b=(0,d.e)([(0,d.n)("esri.views.interactive.snapping.featureSources.SceneLayerSnappingSource")],b)},43486:function(e,t,r){r.d(t,{o:function(){return c}});var n=r(1413),i=r(15671),a=r(43144),o=r(60136),u=r(29388),s=r(21078),c=function(e){(0,o.Z)(r,e);var t=(0,u.Z)(r);function r(e){return(0,i.Z)(this,r),t.call(this,(0,n.Z)((0,n.Z)({},e),{},{constraint:new s.j(e.coordinateHelper,e.targetPoint)}))}return(0,a.Z)(r,[{key:"hints",get:function(){return[new s.a(this.targetPoint,this.elevationInfo,this.domain)]}}]),r}(s.n)}}]);
//# sourceMappingURL=8442.4fc6e79c.chunk.js.map