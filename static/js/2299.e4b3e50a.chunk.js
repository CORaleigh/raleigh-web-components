"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[2299],{42947:function(e,t,i){i.d(t,{f:function(){return O},p:function(){return C}});var n,r,a,o=i(1413),s=i(15671),l=i(43144),c=i(11752),u=i(61120),h=i(60136),d=i(29388),f=i(30168),v=i(70381),p=i(57791),_=i(28390),y=i(48848),g=i(93661),m=i(13239),b=i(43345),w=i(93122);function O(e){var t=new v.o,i=t.vertex,o=t.fragment;return(0,v.T)(i,e),t.include(v.K,e),t.attributes.add(b.O.POSITION,"vec3"),t.attributes.add(b.O.UV0,"vec2"),t.varyings.add("vpos","vec3"),e.hasMultipassTerrain&&t.varyings.add("depth","float"),i.uniforms.add(new v.b("textureCoordinateScaleFactor",(function(e){return(0,g.r)(e.texture)&&(0,g.r)(e.texture.descriptor.textureCoordinateScaleFactor)?e.texture.descriptor.textureCoordinateScaleFactor:m.i}))),i.code.add((0,v.n)(n||(n=(0,f.Z)(["\n    void main(void) {\n      vpos = position;\n      ","\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  "])),e.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":"")),t.include(v.a0,e),t.include(v.aw,e),o.uniforms.add([new v.h("tex",(function(e){return e.texture})),new v.g("opacity",(function(e){return e.opacity}))]),t.varyings.add("vTexCoord","vec2"),e.output===v.O.Alpha?o.code.add((0,v.n)(r||(r=(0,f.Z)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ",") {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    "])),e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":"",v.n.float(v.a8))):(o.include(v.x),o.code.add((0,v.n)(a||(a=(0,f.Z)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ",") {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ","\n    }\n    "])),e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":"",v.n.float(v.a8),e.transparencyPassType===p.o.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),t}var S=Object.freeze(Object.defineProperty({__proto__:null,build:O},Symbol.toStringTag,{value:"Module"})),k=function(e){(0,h.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,s.Z)(this,i),t.apply(this,arguments)}return(0,l.Z)(i,[{key:"initializeProgram",value:function(e){return new v.l(e.rctx,i.shader.get().build(this.configuration),v.E)}},{key:"_setPipelineState",value:function(e,t){var i=this.configuration,n=e===p.o.NONE,r=e===p.o.FrontFace;return(0,p.W)({blending:i.output!==v.O.Color&&i.output!==v.O.Alpha||!i.transparent?null:n?E:(0,p.A)(e),culling:(0,p.k)(i.cullFace),depthTest:{func:(0,p.e)(e)},depthWrite:n?i.writeDepth&&p.b:(0,p.E)(e),colorWrite:p._,stencilWrite:i.hasOccludees?v.ax:null,stencilTest:i.hasOccludees?t?v.ay:v.az:null,polygonOffset:n||r?null:(0,p.g)(i.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(e,t){return t?this._occludeePipelineState:(0,c.Z)((0,u.Z)(i.prototype),"getPipelineState",this).call(this,e,t)}}]),i}(v.k);k.shader=new v.m(S,(function(){return i.e(8168).then(i.bind(i,58168))}));var E=(0,p.s)(w.R.ONE,w.R.ONE_MINUS_SRC_ALPHA),T=function(e){(0,h.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;return(0,s.Z)(this,i),(e=t.apply(this,arguments)).output=v.O.Color,e.cullFace=p.n.None,e.hasSlicePlane=!1,e.transparent=!1,e.enableOffset=!0,e.writeDepth=!0,e.hasOccludees=!1,e.transparencyPassType=p.o.NONE,e.hasMultipassTerrain=!1,e.cullAboveGround=!1,e}return(0,l.Z)(i)}(v.J);(0,y.e)([(0,v.p)({count:v.O.COUNT})],T.prototype,"output",void 0),(0,y.e)([(0,v.p)({count:p.n.COUNT})],T.prototype,"cullFace",void 0),(0,y.e)([(0,v.p)()],T.prototype,"hasSlicePlane",void 0),(0,y.e)([(0,v.p)()],T.prototype,"transparent",void 0),(0,y.e)([(0,v.p)()],T.prototype,"enableOffset",void 0),(0,y.e)([(0,v.p)()],T.prototype,"writeDepth",void 0),(0,y.e)([(0,v.p)()],T.prototype,"hasOccludees",void 0),(0,y.e)([(0,v.p)({count:p.o.COUNT})],T.prototype,"transparencyPassType",void 0),(0,y.e)([(0,v.p)()],T.prototype,"hasMultipassTerrain",void 0),(0,y.e)([(0,v.p)()],T.prototype,"cullAboveGround",void 0);var C=function(e){(0,h.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,s.Z)(this,i),(n=t.call(this,e,new P)).supportsEdges=!0,n._configuration=new T,n}return(0,l.Z)(i,[{key:"getConfiguration",value:function(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<p.S,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}},{key:"intersect",value:function(e,t,i,n,r,a,o){(0,v.aN)(e,t,n,r,a,void 0,o)}},{key:"requiresSlot",value:function(e,t){return(t===v.O.Color||t===v.O.Alpha||t===v.O.Highlight)&&(e===v.H.DRAPED_MATERIAL||(t===v.O.Highlight?e===v.H.OPAQUE_MATERIAL:e===(this.parameters.transparent?this.parameters.writeDepth?v.H.TRANSPARENT_MATERIAL:v.H.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:v.H.OPAQUE_MATERIAL)))}},{key:"createGLMaterial",value:function(e){return new A(e)}},{key:"createBufferWriter",value:function(){return new _.D(_.F)}}]),i}(v.aa),A=function(e){(0,h.Z)(i,e);var t=(0,d.Z)(i);function i(e){return(0,s.Z)(this,i),t.call(this,(0,o.Z)((0,o.Z)({},e),e.material.parameters))}return(0,l.Z)(i,[{key:"_updateParameters",value:function(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(k,e)}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:e.hasOccludees}),this._updateParameters(e))}},{key:"beginSlot",value:function(e){return this._output!==v.O.Color&&this._output!==v.O.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}}]),i}(v.af),P=function(e){(0,h.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;return(0,s.Z)(this,i),(e=t.apply(this,arguments)).transparent=!1,e.writeDepth=!0,e.hasSlicePlane=!1,e.cullFace=p.n.None,e.hasOccludees=!1,e.opacity=1,e.textureId=null,e.initTextureTransparent=!0,e}return(0,l.Z)(i)}(v.ar)},75016:function(e,t,i){i.d(t,{a:function(){return S},b:function(){return w},c:function(){return T},d:function(){return O},n:function(){return E},t:function(){return k}});var n=i(37762),r=i(15671),a=i(43144),o=i(60136),s=i(29388),l=i(48848),c=i(93661),u=i(65094),h=i(95249),d=i(25747),f=i(79557),v=i(49228),p=i(71802),_=i(1797),y=i(50690),g=i(57791),m=i(28390),b=i(70381),w=function(e){var t=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,r.Z)(this,i),(e=t.apply(this,arguments)).parent=null,e._userInteractive=!1,e._interactiveViewModelCount=0,e}return(0,a.Z)(i,[{key:"interactive",get:function(){return this._interactiveViewModelCount>0||this._userInteractive},set:function(e){this._userInteractive=e}},{key:"updating",get:function(){return!1}},{key:"visible",get:function(){return!(0,c.r)(this.parent)||this.parent.visible&&!this.parent.suspended},set:function(e){this._overrideIfSome("visible",e)}},{key:"forceInteractiveForViewModel",value:function(){var e=this;return this._interactiveViewModelCount++,(0,l.D)((function(){return e._interactiveViewModelCount--}))}}]),i}((0,u.m)(e));return(0,l.e)([(0,l.y)({readOnly:!0})],t.prototype,"type",void 0),(0,l.e)([(0,l.y)({constructOnly:!0})],t.prototype,"analysis",void 0),(0,l.e)([(0,l.y)({constructOnly:!0})],t.prototype,"parent",void 0),(0,l.e)([(0,l.y)({constructOnly:!0})],t.prototype,"view",void 0),(0,l.e)([(0,l.y)({type:Boolean})],t.prototype,"interactive",null),(0,l.e)([(0,l.y)()],t.prototype,"_userInteractive",void 0),(0,l.e)([(0,l.y)({readOnly:!0})],t.prototype,"updating",null),(0,l.e)([(0,l.y)()],t.prototype,"visible",null),(0,l.e)([(0,l.y)()],t.prototype,"_interactiveViewModelCount",void 0),t=(0,l.e)([(0,l.n)("esri.views.3d.analysis.AnalysisView3D")],t)};function O(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=(0,h.n)(e,t);return(0,c.t)(r)?null:(r.hasZ&&!n||!(0,c.r)(i)||(r.z=(0,c.v)((0,d.C)(i,r),0)),r)}function S(e,t,i){i.warnOnce("Failed to project analysis geometry (id: '".concat(e.id,"'), projection from spatial reference (wkid: '").concat(t.wkid,"') to view spatial reference is not supported. Projection may be possible after calling projection.load()."))}var k=function(){function e(t){var i=this;(0,r.Z)(this,e),this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this._handle=(0,y.l)((function(){return i.view.ready}),(function(e){i._resourcesCreated&&(e?i._createResources():i._destroyResources())}))}return(0,a.Z)(e,[{key:"applyProps",value:function(e){var t=!1;for(var i in e)i in this?"attached"===i?t=e[i]:this[i]=e[i]:console.error("Cannot set unknown property",i);this.attached=t}},{key:"destroy",value:function(){this.attached=!1,this._handle.remove()}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}},{key:"_createResources",value:function(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}},{key:"_destroyResources",value:function(){this.destroyResources(),this._resourcesCreated=!1}}]),e}(),E=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e.view))._resources=null,n._transform=(0,v.e)(),n}return(0,a.Z)(i,[{key:"object",get:function(){return(0,c.r)(this._resources)?this._resources.object:null}},{key:"transform",get:function(){return this._transform},set:function(e){(0,f.n)(this._transform,e),(0,c.r)(this._resources)&&(this._resources.object.transformation=this._transform)}},{key:"recreate",value:function(){this.attached&&this.createResources()}},{key:"recreateGeometry",value:function(){if(!(0,c.t)(this._resources)){var e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),t.addMany(e.geometries)}}},{key:"createResources",value:function(){this.destroyResources();var e=this.view._stage;if(e){var t=new m.l({isPickable:!1,updatePolicy:g.i.SYNC});e.add(t);var i=new m.a6({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((function(t){return e.add(t)})),e.add(i),t.add(i),this.visible||i.setVisible(!1),this._resources={layer:t,object:i}}}},{key:"destroyResources",value:function(){var e=this.view._stage;!(0,c.t)(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((function(t){e.remove(t),t.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}},{key:"updateVisibility",value:function(e){(0,c.t)(this._resources)||this._resources.object.setVisible(e)}}]),i}(k),T=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e,n){var a;return(0,r.Z)(this,i),(a=t.call(this,e))._hasExternalMaterial=!1,a._renderOccluded=b.ah.OccludeAndTransparent,a._width=1,a._color=(0,_.r)(1,0,1,1),a._innerWidth=1,a._innerColor=null,a._stipplePattern=null,a._stippleOffColor=null,a._stipplePreferContinuous=!0,a._writeDepthEnabled=!0,a._falloff=0,a._polygonOffset=!1,a._material=n,a._hasExternalMaterial=(0,c.r)(n),a.applyProps(e),a}return(0,a.Z)(i,[{key:"setGeometryFromRenderSpacePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=[];i.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),i.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),i.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=i}},{key:"setGeometryFromExtent",value:function(e){var t=this.view.spatialReference,i=(0,p.n)(),n=(0,p.n)(),r=100,a=[];(0,p.o)(i,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),a.push([n[0],n[1],n[2]]),(0,p.o)(i,e[2],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),a.push([n[0],n[1],n[2]]),(0,p.o)(i,e[2],e[3],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),a.push([n[0],n[1],n[2]]),(0,p.o)(i,e[0],e[3],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),a.push([n[0],n[1],n[2]]),(0,p.o)(i,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),a.push([n[0],n[1],n[2]]),(0,p.o)(i,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),a.push([n[0],n[1],n[2]]),this.geometry=[a]}},{key:"setGeometryFromFrustum",value:function(e){var t=[];e.lines.forEach((function(e){t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}},{key:"setGeometryFromBoundedPlane",value:function(e){var t=[],i=e.origin,n=e.basis1,r=e.basis2,a=.5,o=(0,p.n)(),s=(0,p.n)(),l=(0,p.n)(),c=(0,p.n)();o[0]=i[0]-n[0]*a-r[0]*a,o[1]=i[1]-n[1]*a-r[1]*a,o[2]=i[2]-n[2]*a-r[2]*a,s[0]=i[0]-n[0]*a+r[0]*a,s[1]=i[1]-n[1]*a+r[1]*a,s[2]=i[2]-n[2]*a+r[2]*a,l[0]=i[0]+n[0]*a+r[0]*a,l[1]=i[1]+n[1]*a+r[1]*a,l[2]=i[2]+n[2]*a+r[2]*a,c[0]=i[0]+n[0]*a-r[0]*a,c[1]=i[1]+n[1]*a-r[1]*a,c[2]=i[2]+n[2]*a-r[2]*a,t.push([o[0],o[1],o[2]]),t.push([s[0],s[1],s[2]]),t.push([l[0],l[1],l[2]]),t.push([c[0],c[1],c[2]]),t.push([o[0],o[1],o[2]]),this.geometry=[t]}},{key:"setGeometryFromSegment",value:function(e){var t=e.endRenderSpace;this.transform=(0,f.x)(C,t);var i=e.createRenderGeometry(t,this.view.renderCoordsHelper).points;this.geometry=[i]}},{key:"setGeometryFromSegments",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.a7;this.transform=(0,f.x)(C,i),this.geometry=e.map((function(e){return e.createRenderGeometry(i,t.view.renderCoordsHelper).points}))}},{key:"getTransformedGeometry",value:function(){var e=this;return(0,c.t)(this._geometry)?null:this._geometry.map((function(t){return t.map((function(t){return(0,p.O)((0,p.n)(),t,e.transform)}))}))}},{key:"renderOccluded",get:function(){return(0,c.r)(this._material)?this._material.parameters.renderOccluded:this._renderOccluded},set:function(e){this._renderOccluded=e,(0,c.r)(this._material)&&this._material.setParameters({renderOccluded:e})}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.recreateGeometry()}},{key:"width",get:function(){return(0,c.r)(this._material)?this._material.parameters.width:this._width},set:function(e){this._width=e,(0,c.r)(this._material)&&this._material.setParameters({width:e})}},{key:"color",get:function(){return(0,c.r)(this._material)?this._material.parameters.color:this._color},set:function(e){this._color=(0,_.d)(e),(0,c.r)(this._material)&&this._material.setParameters({color:this._color})}},{key:"innerWidth",get:function(){return(0,c.r)(this._material)?this._material.parameters.innerWidth:this._innerWidth},set:function(e){this._innerWidth=e,(0,c.r)(this._material)&&this._material.setParameters({innerWidth:e})}},{key:"innerColor",get:function(){return(0,c.r)(this._material)?this._material.parameters.innerColor:this._innerColor},set:function(e){this._innerColor=(0,c.r)(e)?(0,_.d)(e):e,(0,c.r)(this._material)&&this._material.setParameters({innerColor:this._innerColor})}},{key:"stipplePattern",get:function(){return(0,c.r)(this._material)?this._material.parameters.stipplePattern:this._stipplePattern},set:function(e){this._stipplePattern=e,(0,c.r)(this._material)&&this._material.setParameters({stipplePattern:e})}},{key:"stippleOffColor",get:function(){return(0,c.r)(this._material)?this._material.parameters.stippleOffColor:this._stippleOffColor},set:function(e){this._stippleOffColor=(0,c.r)(e)?(0,_.d)(e):null,(0,c.r)(this._material)&&this._material.setParameters({stippleOffColor:this._stippleOffColor})}},{key:"stipplePreferContinuous",get:function(){return(0,c.r)(this._material)?this._material.parameters.stipplePreferContinuous:this._stipplePreferContinuous},set:function(e){this._stipplePreferContinuous=e,(0,c.r)(this._material)&&this._material.setParameters({stipplePreferContinuous:e})}},{key:"writeDepthEnabled",get:function(){return(0,c.r)(this._material)?this._material.parameters.writeDepth:this._writeDepthEnabled},set:function(e){this._writeDepthEnabled=e,(0,c.r)(this._material)&&this._material.setParameters({writeDepth:e})}},{key:"falloff",get:function(){return(0,c.r)(this._material)?this._material.parameters.falloff:this._falloff},set:function(e){this._falloff=e,(0,c.r)(this._material)&&this._material.setParameters({falloff:e})}},{key:"polygonOffset",get:function(){return(0,c.r)(this._material)?this._material.parameters.hasPolygonOffset:this._polygonOffset},set:function(e){this._polygonOffset=e,(0,c.r)(this._material)&&this._material.setParameters({hasPolygonOffset:e})}},{key:"createExternalResources",value:function(){this._hasExternalMaterial||(this._material=new m.a7({width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,hasPolygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}))}},{key:"destroyExternalResources",value:function(){this._hasExternalMaterial||(this._material=null)}},{key:"createGeometries",value:function(e){var t,i=(0,n.Z)((0,m.a8)(this.geometry));try{for(i.s();!(t=i.n()).done;){var r=t.value,a=(0,m.a9)(r);e.addGeometry(a,(0,c.e)(this._material))}}catch(o){i.e(o)}finally{i.f()}}},{key:"forEachExternalMaterial",value:function(e){this._hasExternalMaterial||e((0,c.e)(this._material))}}]),i}(E),C=(0,v.e)()},82509:function(e,t,i){i.d(t,{A:function(){return Pe},D:function(){return De},G:function(){return We},R:function(){return Me},T:function(){return Fe},U:function(){return Le},a:function(){return He},b:function(){return _e},c:function(){return Ue},d:function(){return je},i:function(){return $},m:function(){return qe},s:function(){return Be},v:function(){return Se},w:function(){return Ie},x:function(){return Ze},z:function(){return xe}});var n,r,a,o,s,l,c,u,h,d,f=i(74165),v=i(15861),p=i(60136),_=i(29388),y=i(30168),g=i(37762),m=i(15671),b=i(43144),w=i(79557),O=i(71802),S=i(91681),k=i(64772),E=(i(74384),i(64998),i(93661)),T=(i(46817),i(82474)),C=(i(43955),i(69641),i(37856)),A=i(77956),P=i(48848),R=i(26313),M=i(37077),F=i(49228),L=i(29048),Z=i(95249),x=i(47855),D=i(25456),j=i(87750),I=i(24093),z=i(28390),N=i(25747),W=i(57791),G=i(32043),V=i(43345),H=i(70381),U=i(42947),B=i(93209),q=i(85026),Q=i(94777),Y=i(93122),J=(i(15529),i(17332),i(50690)),K=i(93314),X=i(59389),$=function(){function e(t){for(var i in(0,m.Z)(this,e),this._camera=new z.ai,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,F.e)(),this._worldFrame=null,this._renderLocation=(0,O.n)(),this._renderLocationDirty=!0,this._location=new T.w({x:0,y:0,z:0}),this._elevationAlignedLocation=new T.w,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=G.a5.None,this._focused=!1,this.events=new C.n.EventEmitter,this._screenLocation={screenPointArray:(0,A.i)(),renderScreenPointArray:(0,A.x)(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=t.view.spatialReference,t)this[i]=t[i];this.view.state&&this.view.state.camera&&this._camera.copyFrom(this.view.state.camera)}return(0,b.Z)(e,[{key:"destroy",value:function(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}},{key:"renderObjects",get:function(){return this._renderObjects},set:function(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}},{key:"available",get:function(){return this._available},set:function(e){e!==this._available&&(this._available=e,this._updateEngineObject())}},{key:"disableDisplay",value:function(){var e=this;return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:(0,P.av)((function(){e._noDisplayCount--,0===e._noDisplayCount&&e._updateEngineObject()}))}}},{key:"radius",get:function(){return this._radius},set:function(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}},{key:"worldSized",get:function(){return this._worldSized},set:function(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}},{key:"modelTransform",get:function(){return this._modelTransform},set:function(e){ee(e)&&(this._screenLocationDirty=!0),(0,w.n)(this._modelTransform,e),this._updateEngineObject()}},{key:"renderLocation",get:function(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,F.e)()),function(e,t,i){switch(e.viewingMode){case"local":return(0,w.r)(i),!0;case"global":var n=(0,x.u)(e.renderCoordsHelper.spatialReference);(0,Z.D)(t,0,le,0,n.radius),(0,Z.X)((0,O.m)(le[0]),(0,O.m)(le[1]),i)}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation},set:function(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}},{key:"location",get:function(){return this._location},set:function(e){(0,z.aa)(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"elevationAlignedLocation",get:function(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation},set:function(e){(0,z.aa)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"_updateElevationAlignedLocation",value:function(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;var e=(0,E.r)(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,z.aj)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}},{key:"grabbableForEvent",value:function(){return!0}},{key:"grabbing",get:function(){return this._grabbing},set:function(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"hovering",get:function(){return this._hovering},set:function(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"selected",get:function(){return this._selected},set:function(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}},{key:"state",get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,this._updateEngineObject())}},{key:"updateStateEnabled",value:function(e,t){t?this.state|=e:this.state&=~e}},{key:"_setFocused",value:function(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}},{key:"focused",get:function(){return this._focused}},{key:"screenLocation",get:function(){return this._ensureScreenLocation(),this._screenLocation}},{key:"_ensureScreenLocation",value:function(){if(this._screenLocationDirty){var e;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,ee(this._modelTransform)){var t=this._calculateModelTransformOffset(fe);e=(0,O.u)(t,t,this.renderLocation)}else e=this.renderLocation;this._camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}}},{key:"applyObjectTransform",get:function(){return this._applyObjectTransform},set:function(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"attached",get:function(){return this._attached}},{key:"intersectionDistance",value:function(e,t){if(!this.available)return null;var i=(0,A.d)(e,te),n=this._getCollisionRadius(t),r=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,L.b)(this.screenLocation.screenPointArray,i)<n*n)return this.screenLocation.renderScreenPointArray[2]+r;break;case"line":var a=this.collisionType.paths,o=this._getWorldToScreenObjectScale(),s=this._calculateObjectTransform(o,oe),l=n*this.screenLocation.pixelSize,c=(0,z.ak)(this._camera,i,ne);if((0,E.t)(c))return null;var u,h=(0,g.Z)(a);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(0!==d.length)for(var f=(0,O.O)(le,d[0],s),v=1;v<d.length;v++){var p=(0,O.O)(ce,d[v],s),_=(0,j.B)((0,j.b)(f,p,ie),c);if(null!=_&&_<l*l){var y=(0,O.u)(k.c.get(),f,p);(0,O.g)(y,y,.5);var m=(0,A.y)(k.c.get());return this._camera.projectToRenderScreen(y,m),m[2]+r}(0,O.r)(f,p)}}}catch(ye){h.e(ye)}finally{h.f()}break;case"disc":var b,w=this.collisionType.direction,S=null!==(b=this.collisionType.offset)&&void 0!==b?b:O.a7,T=this._getWorldToScreenObjectScale(),C=this._calculateObjectTransform(T,oe),P=n*this.screenLocation.pixelSize,M=(0,z.ak)(this._camera,i,ne);if((0,E.t)(M))return null;var F=(0,R.a)(re,C),Z=(0,O.S)(he,w,F),x=(0,O.O)(de,S,C);(0,I._)(x,Z,se);var D=ue;if((0,I.q)(se,M,D)&&(0,O.p)(D,x)<P*P)return this.screenLocation.renderScreenPointArray[2]+r;break;case"ribbon":var N=this.collisionType,W=N.paths,G=N.direction,V=this._getWorldToScreenObjectScale(),H=this._calculateObjectTransform(V,oe),U=n*this._camera.computeScreenPixelSizeAt(this.renderLocation),B=(0,z.ak)(this._camera,i,ne);if((0,E.t)(B))return null;var q=(0,R.a)(re,H),Q=(0,O.S)(he,G,q),Y=this._calculateModelTransformPosition(de);(0,I._)(Y,Q,se);var J=ue;if(!(0,I.q)(se,B,J))break;var K,X=(0,g.Z)(W);try{for(X.s();!(K=X.n()).done;){var $=K.value;if(0!==$.length)for(var ee=(0,O.O)(le,$[0],H),ae=1;ae<$.length;ae++){var fe=(0,O.O)(ce,$[ae],H),ve=(0,j.M)((0,j.b)(ee,fe,ie),J);if(null!=ve&&ve<U*U){var pe=(0,O.u)(k.c.get(),ee,fe);(0,O.g)(pe,pe,.5);var _e=(0,A.y)(k.c.get());return this._camera.projectToRenderScreen(pe,_e),_e[2]+r}(0,O.r)(ee,fe)}}}catch(ye){X.e(ye)}finally{X.f()}}return null}},{key:"attach",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}};if(this.view._stage){var i=t.manipulator3D;if((0,E.t)(i.engineLayerId)){var n=new z.l({isPickable:!1,updatePolicy:W.i.SYNC});this.view._stage.add(n),i.engineLayerId=n.id,this._engineLayer=n}else(null===(e=this.view._stage)||void 0===e?void 0:e.getObject)&&(this._engineLayer=this.view._stage.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,(0,E.t)(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,Z.A)(this._location.spatialReference,this.view.spatialReference)||(this.location=new T.w({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}}},{key:"detach",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}},t=e.manipulator3D;t.engineLayerReferences--;var i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}},{key:"onViewChange",value:function(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"onElevationChange",value:function(e){(0,Z.p)(this.location,ve,e.spatialReference),(0,D.F)(e.extent,ve)&&(this.location=this._location)}},{key:"_evaluateElevationAlignment",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.location;if((0,E.t)(this.elevationInfo))return!1;var t=null,i=0,n=(0,E.v)(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":t=(0,E.v)((0,N.C)(this.view.elevationProvider,e,"ground"),0);break;case"relative-to-ground":i=(0,E.v)((0,N.C)(this.view.elevationProvider,e,"ground"),0)+n;break;case"relative-to-scene":i=(0,E.v)((0,N.C)(this.view.elevationProvider,e,"scene"),0)+n;break;case"absolute-height":i=n}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}},{key:"_updateEngineObject",value:function(){if(this._attached)if(this.available){var e=this._getWorldToScreenObjectScale(),t=oe;if(!0===this.autoScaleRenderObjects){var i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);var n,r=this._ensureEngineResources().objectsByState,a=(this.focused?G.a4.Focused:G.a4.Unfocused)|(this.selected?G.a4.Selected:G.a4.Unselected),o=this._noDisplayCount>0,s=(0,g.Z)(r);try{for(s.s();!(n=s.n()).done;){var l=n.value,c=l.stateMask,u=l.objects;if(o){var h,d=(0,g.Z)(u);try{for(d.s();!(h=d.n()).done;){h.value.setVisible(!1)}}catch(S){d.e(S)}finally{d.f()}}else{var f=(c&G.a4.All)!==G.a4.None,v=(c&G.a5.All)!==G.a5.None,p=!f||(a&c)==(c&G.a4.All),_=!v||(this.state&c)==(c&G.a5.All);if(p&&_){var y,m=(0,g.Z)(u);try{for(m.s();!(y=m.n()).done;){var b=y.value;b.setVisible(!0),b.transformation=t}}catch(S){m.e(S)}finally{m.f()}}else{var w,O=(0,g.Z)(u);try{for(O.s();!(w=O.n()).done;){w.value.setVisible(!1)}}catch(S){O.e(S)}finally{O.f()}}}}}catch(S){s.e(S)}finally{s.f()}}else this._removeResourcesFromStage()}},{key:"_ensureEngineResources",value:function(){if((0,E.t)(this._engineResources)){var e=(0,E.e)(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach((function(e){var n=e.material;i.has(n)||(t.push(n),i.add(n))}));var n=new Map;this._renderObjects.forEach((function(e){var t=new z.a6({castShadow:!1});!function(e,t){var i=t.geometry,n=t.material,r=t.transform;Array.isArray(i)?i.forEach((function(t){return e.addGeometry(t,n,r)})):e.addGeometry(i,n,r)}(t,e);var i=e.stateMask||0,r=n.get(i)||[];r.push(t),n.set(i,r)}));var r=[];n.forEach((function(e,t){return r.push({stateMask:t,objects:e})})),this._engineResources={objectsByState:r,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}},{key:"_addResourcesToStage",value:function(){var e=this;if(!this._engineResourcesAddedToStage&&!(0,E.t)(this._engineResources)){var t=this._engineResources,i=t.objectsByState,n=t.layer;t.materials.forEach((function(t){var i=(0,E.e)(e._materialIdReferences),n=i.get(t.id)||0;0===n&&e.view._stage.add(t),i.set(t.id,n+1)})),i.forEach((function(t){var i=t.objects;n.addMany(i),e.view._stage.addMany(i)})),this._engineResourcesAddedToStage=!0}}},{key:"_removeResourcesFromStage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._engineResourcesAddedToStage&&!(0,E.t)(this._engineResources)&&this.view._stage){var i=this._engineResources,n=i.objectsByState,r=i.layer,a=i.materials;n.forEach((function(t){var i=t.objects;r.removeMany(i),e.view._stage.removeMany(i)})),a.forEach((function(t){var i=(0,E.e)(e._materialIdReferences),n=i.get(t.id);1===n?(e.view._stage.remove(t),i.delete(t.id)):i.set(t.id,n-1)})),t&&this.view._stage.remove(r),this._engineResourcesAddedToStage=!1}}},{key:"_getCollisionRadius",value:function(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}},{key:"_getFocusedSize",value:function(e,t){return e*(t?this.focusMultiplier:1)}},{key:"_getWorldToScreenObjectScale",value:function(){return this._worldSized?1:this.screenLocation.pixelSize}},{key:"_calculateModelTransformPosition",value:function(e){var t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,ae);return(0,O.o)(e,i[12],i[13],i[14])}},{key:"_calculateModelTransformOffset",value:function(e){var t=this._calculateModelTransformPosition(e);return(0,O.e)(e,t,this.renderLocation)}},{key:"_calculateObjectTransform",value:function(e,t){return(0,w.s)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&(0,w.u)(t,t,this._worldFrame),(0,w.u)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,(0,E.r)(this._applyObjectTransform)&&this._applyObjectTransform(t),t}},{key:"test",get:function(){var e=!1;if((0,E.r)(this._engineResources))for(var t in this._engineResources.objectsByState){var i,n=this._engineResources.objectsByState[t],r=(0,g.Z)(n.objects);try{for(r.s();!(i=r.n()).done;){if(i.value.isVisible){e=!0;break}}}catch(a){r.e(a)}finally{r.f()}if(e)break}return{areAnyResourcesVisible:e}}}]),e}();function ee(e){return 0!==e[12]||0!==e[13]||0!==e[14]}var te=(0,A.i)(),ie=(0,j.v)(),ne=(0,k.d)(),re=(0,M.e)(),ae=(0,F.e)(),oe=(0,F.e)(),se=(0,I.p)(),le=(0,O.n)(),ce=(0,O.n)(),ue=(0,O.n)(),he=(0,O.n)(),de=(0,O.n)(),fe=(0,O.n)(),ve=new T.w({x:0,y:0,z:0,spatialReference:null});function pe(e,t){if(t.screenSizeEnabled){var i=e.vertex;(0,H.U)(i,t),i.uniforms.add(new H.g("perScreenPixelRatio",(function(e,t){return t.camera.perScreenPixelRatio}))),i.uniforms.add(new H.g("screenSizeScale",(function(e){return e.screenSizeScale}))),i.code.add((0,H.n)(n||(n=(0,y.Z)(["float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));\nreturn viewDirectionDistance * perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;\n}"]))))}}function _e(e){var t=new H.o,i=e.hasMultipassTerrain&&(e.output===H.O.Color||e.output===H.O.Alpha);t.include(H.K,e),t.include(pe,e),t.include(H.a0,e);var n=t.vertex,f=t.fragment;return f.include(H.x),(0,H.T)(n,e),f.uniforms.add(new H.f("uColor",(function(e){return e.color}))),t.attributes.add(V.O.POSITION,"vec3"),t.varyings.add("vWorldPosition","vec3"),i&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add(V.O.OFFSET,"vec3"),e.shadingEnabled&&((0,H.W)(n),t.attributes.add(V.O.NORMAL,"vec3"),t.varyings.add("vViewNormal","vec3")),n.code.add((0,H.n)(r||(r=(0,y.Z)(["\n    void main(void) {\n      vWorldPosition = ",";\n  "])),e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position")),e.shadingEnabled&&n.code.add((0,H.n)(a||(a=(0,y.Z)(["vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;"])))),n.code.add((0,H.n)(o||(o=(0,y.Z)(["\n    ","\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  "])),i?"depth = (view * vec4(vWorldPosition, 1.0)).z;":"")),i&&t.include(H.aw,e),f.code.add((0,H.n)(s||(s=(0,y.Z)(["\n    void main() {\n      discardBySlice(vWorldPosition);\n      ","\n    "])),i?"terrainDepthTest(gl_FragCoord, depth);":"")),e.shadingEnabled?(f.uniforms.add(new H.c("shadingDirection",(function(e){return e.shadingDirection}))),f.uniforms.add(new H.f("shadedColor",(function(e){return ye(e.shadingTint,e.color)}))),f.code.add((0,H.n)(l||(l=(0,y.Z)(["vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(uColor, shadedColor, shadingFactor);"]))))):f.code.add((0,H.n)(c||(c=(0,y.Z)(["vec4 finalColor = uColor;"])))),f.code.add((0,H.n)(u||(u=(0,y.Z)(["\n      if (finalColor.a < ",") {\n        discard;\n      }\n      ","\n\n      ","\n    }\n    "])),H.n.float(H.a7),e.output===H.O.Alpha?(0,H.n)(h||(h=(0,y.Z)(["gl_FragColor = vec4(finalColor.a);"]))):"",e.output===H.O.Color?(0,H.n)(d||(d=(0,y.Z)(["gl_FragColor = highlightSlice(finalColor, vWorldPosition); ",""])),e.transparencyPassType===W.o.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"")),t}function ye(e,t){var i=1-e[3],n=e[3]+t[3]*i;return 0===n?(ge[3]=n,ge):(ge[0]=(e[0]*e[3]+t[0]*t[3]*i)/n,ge[1]=(e[1]*e[3]+t[1]*t[3]*i)/n,ge[2]=(e[2]*e[3]+t[2]*t[3]*i)/n,ge[3]=t[3],ge)}var ge=(0,S.n)(),me=Object.freeze(Object.defineProperty({__proto__:null,build:_e},Symbol.toStringTag,{value:"Module"})),be=function(e){(0,p.Z)(i,e);var t=(0,_.Z)(i);function i(){return(0,m.Z)(this,i),t.apply(this,arguments)}return(0,b.Z)(i,[{key:"initializeProgram",value:function(e){return new H.l(e.rctx,i.shader.get().build(this.configuration),Oe)}},{key:"_setPipelineState",value:function(e){var t=this.configuration,i=e===W.o.NONE,n=e===W.o.FrontFace;return(0,W.W)({blending:t.output!==H.O.Color&&t.output!==H.O.Alpha||!t.transparent?null:i?W.d:(0,W.A)(e),culling:(0,W.k)(t.cullFace),depthTest:{func:n?Y.I.LESS:t.shadingEnabled?Y.I.LEQUAL:Y.I.LESS},depthWrite:i?t.writeDepth&&W.b:(0,W.E)(e),colorWrite:W._,polygonOffset:i||n?null:W.f})}},{key:"initializePipeline",value:function(){return this._setPipelineState(this.configuration.transparencyPassType)}}]),i}(H.k);be.shader=new H.m(me,(function(){return i.e(8829).then(i.bind(i,68829))}));var we=function(e){(0,p.Z)(i,e);var t=(0,_.Z)(i);function i(){var e;return(0,m.Z)(this,i),(e=t.apply(this,arguments)).output=H.O.Color,e.cullFace=W.n.None,e.transparencyPassType=W.o.NONE,e.hasSlicePlane=!1,e.transparent=!1,e.writeDepth=!0,e.screenSizeEnabled=!0,e.shadingEnabled=!0,e.hasMultipassTerrain=!1,e.cullAboveGround=!1,e}return(0,b.Z)(i)}(H.J);(0,P.e)([(0,H.p)({count:H.O.COUNT})],we.prototype,"output",void 0),(0,P.e)([(0,H.p)({count:W.n.COUNT})],we.prototype,"cullFace",void 0),(0,P.e)([(0,H.p)({count:W.o.COUNT})],we.prototype,"transparencyPassType",void 0),(0,P.e)([(0,H.p)()],we.prototype,"hasSlicePlane",void 0),(0,P.e)([(0,H.p)()],we.prototype,"transparent",void 0),(0,P.e)([(0,H.p)()],we.prototype,"writeDepth",void 0),(0,P.e)([(0,H.p)()],we.prototype,"screenSizeEnabled",void 0),(0,P.e)([(0,H.p)()],we.prototype,"shadingEnabled",void 0),(0,P.e)([(0,H.p)()],we.prototype,"hasMultipassTerrain",void 0),(0,P.e)([(0,H.p)()],we.prototype,"cullAboveGround",void 0);var Oe=new Map([[V.O.POSITION,0],[V.O.NORMAL,1],[V.O.OFFSET,2]]),Se=function(e){(0,p.Z)(i,e);var t=(0,_.Z)(i);function i(e){var n;return(0,m.Z)(this,i),(n=t.call(this,e,new Ee)).supportsEdges=!0,n._configuration=new we,n._vertexAttributeLocations=Oe,n}return(0,b.Z)(i,[{key:"getConfiguration",value:function(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}},{key:"intersect",value:function(e,t,i,n,r,a,o){var s=this;if(this.parameters.screenSizeEnabled){var l=e.vertexAttributes.get(V.O.OFFSET),c={applyToVertex:function(e,t,i,r){var a=(0,O.o)(Ce,l.data[3*r+0],l.data[3*r+1],l.data[3*r+2]),o=(0,O.o)(Ae,e,t,i);return(0,O.g)(a,a,s.parameters.screenSizeScale*n.camera.computeRenderPixelSizeAt(a)),(0,O.u)(o,o,a),[o[0],o[1],o[2]]},applyToAabb:function(e){var t=(0,B.p)(e,Ce);return(0,B.Y)(e,s.parameters.screenSizeScale*n.camera.computeRenderPixelSizeAt(t))}};(0,H.aN)(e,t,n,r,a,c,o)}else(0,H.aN)(e,t,n,r,a,void 0,o)}},{key:"requiresSlot",value:function(e,t){if(t===H.O.Highlight)return e===H.H.OPAQUE_MATERIAL;if(t===H.O.Color||t===H.O.Alpha||t===H.O.ObjectAndLayerIdColor){var i=H.H.OPAQUE_MATERIAL;return this.parameters.transparent&&(i=this.parameters.writeDepth?H.H.TRANSPARENT_MATERIAL:H.H.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===i||e===H.H.DRAPED_MATERIAL}return!1}},{key:"createGLMaterial",value:function(e){return new ke(e)}},{key:"createBufferWriter",value:function(){return new Te(this.parameters.screenSizeEnabled)}}]),i}(H.aa),ke=function(e){(0,p.Z)(i,e);var t=(0,_.Z)(i);function i(){return(0,m.Z)(this,i),t.apply(this,arguments)}return(0,b.Z)(i,[{key:"beginSlot",value:function(e){return this.ensureTechnique(be,e)}}]),i}(H.aq),Ee=function(e){(0,p.Z)(i,e);var t=(0,_.Z)(i);function i(){var e;return(0,m.Z)(this,i),(e=t.apply(this,arguments)).color=(0,S.r)(1,1,1,1),e.shadingTint=(0,S.r)(0,0,0,.25),e.shadingDirection=(0,O.z)((0,O.n)(),[.5,-.5,-.5]),e.screenSizeScale=14,e.transparent=!1,e.writeDepth=!0,e.hasSlicePlane=!1,e.cullFace=W.n.None,e.screenSizeEnabled=!1,e.shadingEnabled=!0,e}return(0,b.Z)(i)}(H.ar),Te=function(){function e(t){(0,m.Z)(this,e),this.screenSizeEnabled=t;var i=(0,Q.T)().vec3f(V.O.POSITION).vec3f(V.O.NORMAL);this.screenSizeEnabled&&i.vec3f(V.O.OFFSET),this.vertexBufferLayout=i}return(0,b.Z)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get(V.O.POSITION).length}},{key:"write",value:function(e,t,i,n,r){if((0,H.aM)(i,this.vertexBufferLayout,e,t,n,r),this.screenSizeEnabled){if(!i.vertexAttributes.has(V.O.OFFSET))throw new Error("".concat(V.O.OFFSET," vertex attribute required for screenSizeEnabled ShadedColorMaterial"));var a=i.vertexAttributes.get(V.O.OFFSET),o=i.indices.get(V.O.OFFSET);(0,j.e)(3===a.size);var s=n.getField(V.O.OFFSET,q.i);if(!s)throw new Error("unable to acquire view for "+V.O.OFFSET);(0,H.ai)(o,a.data,t,s,r)}}}]),e}(),Ce=(0,O.n)(),Ae=(0,O.n)();function Pe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H.ah.OccludeAndTransparent,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=(0,S.r)(e[0],e[1],e[2],e.length>3?e[3]:1),r=e[3]<1;return i?new Se({color:n,transparent:r,writeDepth:!0,cullFace:W.n.Back,renderOccluded:t}):new z.al({color:n,transparent:r,writeDepth:!0,cullFace:W.n.Back,renderOccluded:t})}var Re=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1,calloutColor:(0,O.c)(1,.5,0)});function Me(e,t){var i=new $({view:e,autoScaleRenderObjects:!1,collisionPriority:1,metadata:t.metadata});return Fe(i,t),i}function Fe(e,t){var i,n,r,a,o,s,l,c,u=null!==(i=t.material)&&void 0!==i?i:new U.p({transparent:!0,writeDepth:!1,textureId:null===(n=t.texture)||void 0===n?void 0:n.id,renderOccluded:H.ah.Opaque}),h=null!==(r=t.focusMultiplier)&&void 0!==r?r:Re.focusMultiplier,d=null!==(a=t.calloutLength)&&void 0!==a?a:Re.calloutLength,f=Re.discRadius*(null!==(o=t.discScale)&&void 0!==o?o:1),v=f*h,p=function(e){var t=[0,1,2,2,3,0];return new H.M([[V.O.POSITION,{size:3,data:[d-e,-e,0,d+e,-e,0,d+e,e,0,d-e,e,0],exclusive:!0}],[V.O.UV0,{size:2,data:[0,0,1,0,1,1,0,1]}]],[[V.O.POSITION,t],[V.O.UV0,t]])},_=(0,z.ab)([[0,0,0],[d-f,0,0]]),y=(0,z.ab)([[0,0,0],[d-v,0,0]]),g=Re.calloutColor,m=null!==(s=t.calloutWidth)&&void 0!==s?s:Re.calloutWidth,b=new(m>1?z.a7:z.am)({width:m,color:(0,S.r)(g[0],g[1],g[2],null!==(l=t.calloutOpacity)&&void 0!==l?l:1),renderOccluded:H.ah.OccludeAndTransparent}),w=null!==(c=t.customStateMask)&&void 0!==c?c:G.a5.None;e.collisionType={type:"disc",direction:[0,0,1],offset:[d,0,0]},e.focusMultiplier=h,e.metadata=t.metadata,e.radius=f,e.renderObjects=[{geometry:p(f),material:u,stateMask:G.a4.Unfocused|w},{geometry:_,material:b,stateMask:G.a4.Unfocused|w},{geometry:p(v),material:u,stateMask:G.a4.Focused|w},{geometry:y,material:b,stateMask:G.a4.Focused|w}]}function Le(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:G.a5.None;return new $({view:e,renderObjects:[{geometry:(0,z.ae)(1,32,32),material:Pe((0,S.r)(t[0],t[1],t[2],null!=i?i:1)),stateMask:n}]})}var Ze=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function xe(e,t,i,n){var r=(0,O.e)(k.c.get(),e,i),a=De(r,(0,O._)(k.c.get(),n,r),i,k.a.get());(0,w.h)(a,a);var o=(0,O.O)(k.c.get(),t,a);return Math.atan2(o[1],o[0])}function De(e,t,i,n){var r=(0,O.z)(k.c.get(),e),a=(0,O.z)(k.c.get(),t),o=(0,O._)(k.c.get(),r,a);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=0,n[4]=a[0],n[5]=a[1],n[6]=a[2],n[7]=0,n[8]=o[0],n[9]=o[1],n[10]=o[2],n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n}function je(e,t){return e.events.on("drag",function(e,t){var i=null,n=null;return function(r){if("cancel"!==r.action){var a={action:r.action,screenStart:r.start,screenEnd:r.screenPoint};"start"===r.action&&(0,E.t)(i)&&(i=new We,n=new We,t(e,i,n,r.pointerType,a)),(0,E.r)(i)&&i.execute(a),"end"===r.action&&(0,E.r)(i)&&(i=null,n=null)}else(0,E.r)(n)&&(n.execute({action:"cancel"}),i=null,n=null)}}(e,t))}function Ie(e,t){var i,n=new Map,r=(0,g.Z)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;n.set(a,(0,E.y)(e[a]))}}catch(o){r.e(o)}finally{r.f()}return function(t){return n.forEach((function(t,i){e[i]=t})),t}}var ze,Ne,We=function(){function e(){(0,m.Z)(this,e),this.execute=function(){}}return(0,b.Z)(e,[{key:"next",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return(0,E.r)(t)&&(this.execute=function(e){var n=t(e);(0,E.r)(n)&&i.execute(n)}),i}}]),e}();(Ne=ze||(ze={}))[Ne.WhenToolEditable=0]="WhenToolEditable",Ne[Ne.WhenToolNotEditable=1]="WhenToolNotEditable",Ne[Ne.Always=2]="Always";var Ge=function(){function e(){(0,m.Z)(this,e),this._isToolEditable=!0,this._manipulators=new K.j,this._resourceContexts={manipulator3D:{}},this._attached=!1}return(0,b.Z)(e,[{key:"isToolEditable",set:function(e){this._isToolEditable=e}},{key:"length",get:function(){return this._manipulators.length}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ze.WhenToolEditable;this.addMany([e],t)}},{key:"addMany",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ze.WhenToolEditable,n=(0,g.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a={manipulator:r,visibilityPredicate:i,attached:!1};this._manipulators.add(a),this._attached&&this._updateManipulatorAttachment(a)}}catch(o){n.e(o)}finally{n.f()}}},{key:"remove",value:function(e){for(var t=0;t<this._manipulators.length;t++)if(this._manipulators.getItemAt(t).manipulator===e){var i=this._manipulators.splice(t,1)[0];this._detachManipulator(i);break}}},{key:"removeAll",value:function(){var e=this;this._manipulators.forEach((function(t){e._detachManipulator(t)})),this._manipulators.removeAll()}},{key:"attach",value:function(){var e=this;this._manipulators.forEach((function(t){e._updateManipulatorAttachment(t)})),this._attached=!0}},{key:"detach",value:function(){var e=this;this._manipulators.forEach((function(t){e._detachManipulator(t)})),this._attached=!1}},{key:"destroy",value:function(){this.detach(),this._manipulators.forEach((function(e){var t=e.manipulator;t.destroy&&t.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}},{key:"on",value:function(e,t){return this._manipulators.on(e,(function(e){t(e)}))}},{key:"forEach",value:function(e){var t,i=(0,g.Z)(this._manipulators.items);try{for(i.s();!(t=i.n()).done;){e(t.value)}}catch(n){i.e(n)}finally{i.f()}}},{key:"some",value:function(e){return this._manipulators.items.some(e)}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){return e.push(t.manipulator)})),e}},{key:"intersect",value:function(e,t){var i=null,n=Number.MAX_VALUE;return this._manipulators.forEach((function(r){var a=r.manipulator;if(r.attached&&a.interactive){var o=a.intersectionDistance(e,t);(0,E.r)(o)&&o<n&&(n=o,i=a)}})),i}},{key:"_updateManipulatorAttachment",value:function(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}},{key:"_attachManipulator",value:function(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}},{key:"_detachManipulator",value:function(e){if(e.attached){var t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}}},{key:"_isManipulatorItemVisible",value:function(e){return e.visibilityPredicate===ze.Always||(this._isToolEditable?e.visibilityPredicate===ze.WhenToolEditable:e.visibilityPredicate===ze.WhenToolNotEditable)}}]),e}(),Ve=function(e){(0,p.Z)(i,e);var t=(0,_.Z)(i);function i(e){var n;return(0,m.Z)(this,i),(n=t.call(this,e)).manipulators=new Ge,n.automaticManipulatorSelection=!0,n.hasGrabbedManipulators=!1,n.hasHoveredManipulators=!1,n.firstGrabbedManipulator=null,n.created=!1,n.removeIncompleteOnCancel=!0,n._editableFlags=new Map([[G.a7.MANAGER,!0],[G.a7.USER,!0]]),n._creationFinishedResolver=(0,P.ap)(),n}return(0,b.Z)(i,[{key:"active",get:function(){return null!=this.view&&this.view.activeTool===this}},{key:"visible",set:function(e){this._get("visible")!==e&&(this._set("visible",e),this._syncVisible())}},{key:"editable",get:function(){return this.getEditableFlag(G.a7.USER)},set:function(e){this.setEditableFlag(G.a7.USER,e)}},{key:"updating",get:function(){return!1}},{key:"cursor",get:function(){return null}},{key:"hasFocusedManipulators",get:function(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}},{key:"destroy",value:function(){this.manipulators.destroy(),this._set("view",null)}},{key:"onAdd",value:function(){this._syncVisible()}},{key:"activate",value:function(){(0,E.t)(this.view)?P.a.getLogger(this.declaredClass).error("Can't activate tool if view is not defined."):(this.view.focus(),this.onActivate())}},{key:"deactivate",value:function(){this.onDeactivate()}},{key:"handleInputEvent",value:function(e){this.onInputEvent(e)}},{key:"handleInputEventAfter",value:function(e){this.onInputEventAfter(e)}},{key:"setEditableFlag",value:function(e,t){this._editableFlags.set(e,t),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),e===G.a7.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}},{key:"getEditableFlag",value:function(e){return this._editableFlags.get(e)}},{key:"whenCreated",value:function(){return this._creationFinishedResolver.promise}},{key:"onManipulatorSelectionChanged",value:function(){}},{key:"onActivate",value:function(){}},{key:"onDeactivate",value:function(){}},{key:"onShow",value:function(){}},{key:"onHide",value:function(){}},{key:"onEditableChange",value:function(){}},{key:"onInputEvent",value:function(e){}},{key:"onInputEventAfter",value:function(e){}},{key:"internallyEditable",get:function(){return this.getEditableFlag(G.a7.USER)&&this.getEditableFlag(G.a7.MANAGER)}},{key:"finishToolCreation",value:function(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}},{key:"_syncVisible",value:function(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}},{key:"_show",value:function(){this._updateManipulatorAttachment(),this.onShow()}},{key:"_hide",value:function(){this._updateManipulatorAttachment(),this.onHide()}},{key:"_updateManipulatorAttachment",value:function(){this.visible?this.manipulators.attach():this.manipulators.detach()}}]),i}(P.m);(0,P.e)([(0,P.y)({constructOnly:!0})],Ve.prototype,"view",void 0),(0,P.e)([(0,P.y)({readOnly:!0})],Ve.prototype,"active",null),(0,P.e)([(0,P.y)({value:!0})],Ve.prototype,"visible",null),(0,P.e)([(0,P.y)({value:!0})],Ve.prototype,"editable",null),(0,P.e)([(0,P.y)({readOnly:!0})],Ve.prototype,"manipulators",void 0),(0,P.e)([(0,P.y)({readOnly:!0})],Ve.prototype,"updating",null),(0,P.e)([(0,P.y)()],Ve.prototype,"cursor",null),(0,P.e)([(0,P.y)({readOnly:!0})],Ve.prototype,"automaticManipulatorSelection",void 0),(0,P.e)([(0,P.y)()],Ve.prototype,"hasFocusedManipulators",null),(0,P.e)([(0,P.y)()],Ve.prototype,"hasGrabbedManipulators",void 0),(0,P.e)([(0,P.y)()],Ve.prototype,"hasHoveredManipulators",void 0),(0,P.e)([(0,P.y)()],Ve.prototype,"firstGrabbedManipulator",void 0),(0,P.e)([(0,P.y)({readOnly:!0})],Ve.prototype,"created",void 0),(0,P.e)([(0,P.y)({readOnly:!0})],Ve.prototype,"removeIncompleteOnCancel",void 0);var He=function(e){(0,p.Z)(i,e);var t=(0,_.Z)(i);function i(e){return(0,m.Z)(this,i),t.call(this,e)}return(0,b.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles((0,J.l)((function(){return e.analysisViewData.visible}),(function(t){return e.visible=t}),J.w))}},{key:"deactivate",value:function(){this.onDeactivate(),this.created||this.analysis.clear()}},{key:"resetCreated",value:function(){this._set("created",!1)}}]),i}(Ve=(0,P.e)([(0,P.n)("esri.views.interactive.InteractiveToolBase")],Ve));function Ue(e,t){e.interactive=!0;var i=e.tool,n=e.view;n.activeTool=i;var r=(0,P.v)(t,(function(){n.activeTool===i&&(n.activeTool=null)}));return(0,X.j)(function(){var e=(0,v.Z)((0,f.Z)().mark((function e(t){return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.j)((function(){return(0,E.t)(i)||!i.active}),t);case 2:r=(0,E.f)(r);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t)}function Be(e,t){return(0,J.l)((function(){return e.interactive}),(function(){return function(e,t){e.interactive?function(e,t){qe(e);var i=e.view,n=e.analysis,r=new t({view:i,analysis:n,analysisViewData:e});e.tool=r,i.tools.add(r)}(e,t):qe(e)}(e,t)}),J.w)}function qe(e){var t=e.view,i=e.tool;(0,E.t)(i)||(t.tools.remove(i),e.tool=null)}(0,P.e)([(0,P.y)({constructOnly:!0})],He.prototype,"analysis",void 0),(0,P.e)([(0,P.y)()],He.prototype,"analysisViewData",void 0),He=(0,P.e)([(0,P.n)("esri.views.interactive.AnalysisToolBase")],He)}}]);
//# sourceMappingURL=2299.e4b3e50a.chunk.js.map