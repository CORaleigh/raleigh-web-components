"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[6267],{96267:function(e,t,r){r.d(t,{E:function(){return te},a:function(){return Y},b:function(){return $t},e:function(){return j},l:function(){return Jt},n:function(){return Vt},t:function(){return kt},x:function(){return Yt}});var n=r(74165),i=r(15861),a=r(11752),s=r(61120),o=r(82963),u=r(1413),l=r(37762),c=r(60136),h=r(29388),f=r(29439),v=r(4942),p=r(15671),d=r(43144),y=(r(54026),r(38415),r(59819)),_=r(45578),m=r(433),x=r(28329),g=r(10200),w=r(75610),M=r(23132),k=r(46471),b=r(2760),Z=r(78880),S=r(77372),L=r(65081),P=r(85331),T=r(28080),z=r(61495),I=r(93092),W=r(22225),C=r(21523),E=r(87833),A=r(50338),R=r(38802),F=(r(66156),r(33642)),B=r(98057),V=r(38511),O=r(17436),D=r(50526),G=r(77787),K=r(25715),N=r(57714),U=r(79611),X=r(96349),H=r(33976);function j(e,t){if(e&&"name"in e){var r=e;return t&&t.error(new M.a(r.name,r.message,r.details)),!1}return!0}var Y=function(){function e(t,r){(0,p.Z)(this,e),this._pos=0;var n=r?this._roundToNearest(r,t.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(n),this._buffer=new t(this._array),this._ctor=t,this._i16View=new Int16Array(this._array)}return(0,d.Z)(e,[{key:"length",get:function(){return this._pos}},{key:"_roundToNearest",value:function(e,t){var r=Math.round(e);return r+(t-r%t)}},{key:"_ensureSize",value:function(e){if(this._pos+e>=this._buffer.length){var t=this._roundToNearest(1.25*(this._array.byteLength+e*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),r=new ArrayBuffer(t),n=new this._ctor(r);n.set(this._buffer,0),this._array=r,this._buffer=n,this._i16View=new Int16Array(this._array)}}},{key:"ensureSize",value:function(e){this._ensureSize(e)}},{key:"writeF32",value:function(e){this._ensureSize(1);var t=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=e,this._pos++,t}},{key:"push",value:function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t}},{key:"writeFixed",value:function(e){this._buffer[this._pos++]=e}},{key:"setValue",value:function(e,t){this._buffer[e]=t}},{key:"i1616Add",value:function(e,t,r){this._i16View[2*e]+=t,this._i16View[2*e+1]+=r}},{key:"getValue",value:function(e){return this._buffer[e]}},{key:"incr",value:function(e){if(this._buffer.length<e)throw new Error("Increment index overflows the target buffer");this._buffer[e]++}},{key:"decr",value:function(e){this._buffer[e]--}},{key:"writeRegion",value:function(e){this._ensureSize(e.length);var t=this._pos;return this._buffer.set(e,this._pos),this._pos+=e.length,t}},{key:"writeManyFrom",value:function(e,t,r){this._ensureSize(r-t);for(var n=t;n!==r;n++)this.writeFixed(e._buffer[n])}},{key:"buffer",value:function(){var e=this._array.slice(0,4*this._pos);return this.destroy(),e}},{key:"toArray",value:function(){for(var e=this._array,t=[],r=0;r<e.byteLength/4;r++)t.push(e[r]);return t}},{key:"seek",value:function(e){this._pos=e}},{key:"destroy",value:function(){this._array=null,this._buffer=null}}]),e}(),q=new Map;q.set(x.c.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4}),q.set(x.c.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8}),q.set(x.c.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10}),q.set(x.c.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4}),q.set(x.c.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});var $=function(){function e(t,r,n){(0,p.Z)(this,e),this._start={index:0,vertex:0};var i=function(e,t,r){var n=q.get(e),i=n.indicesPerRecord,a=n.multiplier,s=n.verticesPerRecord;return{recordBytes:r*_.G*Uint32Array.BYTES_PER_ELEMENT,indexBytes:a*i*r*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:a*s*r*t}}(t,r,n),a=r/4;this.geometryType=t,this._records=new Y(Int32Array,i.recordBytes),this._indices=new Y(Uint32Array,i.indexBytes),this._vertices=new Y(Uint32Array,i.vertexBytes),this._metrics=new Y(Float32Array,0),this._strideInt=a}return(0,d.Z)(e,[{key:"serialize",value:function(e){var t=this._records.buffer(),r=this._indices.buffer(),n=this._vertices.buffer(),i=this._metrics.length?this._metrics.buffer():null,a=4*this._strideInt;return e.push(t,r,n),{stride:a,records:t,indices:r,vertices:n,metrics:i}}},{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/_.G}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}},{key:"vertexEnsureSize",value:function(e){this._vertices.ensureSize(e)}},{key:"indexEnsureSize",value:function(e){this._indices.ensureSize(e)}},{key:"recordStart",value:function(){this._start.index=this._indices.length,this._start.vertex=this._vertices.length}},{key:"recordEnd",value:function(e,t,r,n,i,a,s,o){this._records.push(e),this._records.push(t),this._records.push(r),this._records.push(n),this._records.push(i),this._records.push(a),this._records.push(s),this._records.writeF32(o)}},{key:"writeIndex",value:function(e){this._indices.push(e)}},{key:"writeVertex",value:function(e){this._vertices.push(e)}},{key:"writeVertexF32",value:function(e){this._vertices.writeF32(e)}},{key:"copyLastFrom",value:function(e,t,r){for(var n=e._records.length-_.G,i=e._records.getValue(n),a=e._records.getValue(n+1),s=e._records.getValue(n+2),o=e._records.getValue(n+4),u=e._records.getValue(n+6),l=e._records.getValue(n+7),c=this._vertices.length,h=(e._start.vertex-this._vertices.length)/this._strideInt,f=this._indices.length,v=this.vertexCount,p=e._start.index;p!==e._indices.length;p++){var d=e._indices.getValue(p);this._indices.push(d-h)}for(var y=e._start.vertex;y!==e._vertices.length;y++){var m=e._vertices.getValue(y);this._vertices.push(m)}for(var x=c;x<=this._vertices.length;x+=this._strideInt)this._vertices.i1616Add(x,t,r);this._records.push(i),this._records.push(a),this._records.push(s),this._records.push(f),this._records.push(o),this._records.push(v),this._records.push(u),this._records.push(l)}}]),e}(),Q=128;function J(e){switch(e){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case Q:return 1}}function ee(e){switch(e){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case Q:return 1}}var te=function(){function e(t,r,n,i,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;(0,p.Z)(this,e),this._hasAggregate=!1,this.hasRecords=!1,this._data={self:new Map,neighbors:new Array},this._version=0,this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0},this.hint=r,this.tileKey=t,this._hasAggregate=i,this._pixelBufferEnabled=a,this._version=s,this._symbologyType=n}return(0,d.Z)(e,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}},{key:"serialize",value:function(e){var t=this,r=[];return r.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self)),this._data.neighbors.forEach((function(n,i){var a=1<<i,s=J(a),o=ee(a),u=(0,g.l)(new y.e(t.tileKey),s,o,e),l=t._serializeTileVertexData(t.tileKey,u.id,n.vertexData);l.message.bufferIds=n.displayIds,r.push(l)})),r}},{key:"_serializeTileVertexData",value:function(e,t,r){var n,i,a,s,o,u,l=new Array;return{message:{tileKeyOrigin:e,tileKey:t,data:(u={},(0,v.Z)(u,x.c.MARKER,null===(n=r.get(x.c.MARKER))||void 0===n?void 0:n.serialize(l)),(0,v.Z)(u,x.c.FILL,null===(i=r.get(x.c.FILL))||void 0===i?void 0:i.serialize(l)),(0,v.Z)(u,x.c.LINE,null===(a=r.get(x.c.LINE))||void 0===a?void 0:a.serialize(l)),(0,v.Z)(u,x.c.TEXT,null===(s=r.get(x.c.TEXT))||void 0===s?void 0:s.serialize(l)),(0,v.Z)(u,x.c.LABEL,null===(o=r.get(x.c.LABEL))||void 0===o?void 0:o.serialize(l)),u),version:this._version},transferList:l}}},{key:"featureStart",value:function(e,t){this._current.insertAfter=e,this._current.sortKey=t}},{key:"featureEnd",value:function(){}},{key:"recordStart",value:function(e,t,r,n){this._current.writer=this._getVertexWriter(r),this._current.overlaps=0,this._current.indexStart=this._current.writer.indexCount,this._current.vertStart=this._current.writer.vertexCount,this._current.bufferingEnabled=n,this._current.id=e,this._current.materialKey=t,this._current.geometryType=r,this._current.isDotDensity=!1,this._current.writer.recordStart()}},{key:"recordCount",value:function(){return this._current.writer.recordCount}},{key:"vertexCount",value:function(){return this._current.writer.vertexCount}},{key:"indexCount",value:function(){return this._current.writer.indexCount}},{key:"vertexEnsureSize",value:function(e){this._current.writer.vertexEnsureSize(e)}},{key:"indexEnsureSize",value:function(e){this._current.writer.indexEnsureSize(e)}},{key:"vertexBounds",value:function(e,t,r,n){this._current.bufferingEnabled&&this._addOverlap(e,t,r,n)}},{key:"vertexWrite",value:function(e){this._current.writer.writeVertex(e)}},{key:"vertexWriteF32",value:function(e){this._current.writer.writeVertexF32(e)}},{key:"vertexEnd",value:function(){}},{key:"vertexWriter",value:function(){return this._current.writer.vertexWriter}},{key:"indexWrite",value:function(e){this._current.writer.writeIndex(e)}},{key:"indexWriter",value:function(){return this._current.writer.indexWriter}},{key:"metricWriter",value:function(){return this._current.writer.metricWriter}},{key:"metricStart",value:function(e,t,r,n,i,a,s,o){this._current.writer=this._getVertexWriter(x.c.LABEL);var u=this._current.writer.metricWriter;u.push((0,m.f)(e)),u.push(t),u.push(r),u.push(n),u.push(i),u.push(a),u.push(s),u.push(o),u.push(255),this._current.metricBoxLenPointer=u.push(0)}},{key:"metricEnd",value:function(){var e=this._current.writer.metricWriter;0===e.getValue(this._current.metricBoxLenPointer)&&e.seek(e.length-10)}},{key:"metricBoxWrite",value:function(e,t,r,n){var i=this._current.writer.metricWriter;i.incr(this._current.metricBoxLenPointer),i.push(0),i.push(0),i.push(e),i.push(t),i.push(r),i.push(n)}},{key:"recordEnd",value:function(){var e=this._current.vertStart,t=this._current.writer.vertexCount-e;if(!t)return!1;this.hasRecords=!0;var r=this._current.indexStart,n=this._current.writer.indexCount-r;if(this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,r,n,e,t,this._current.sortKey),!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===x.c.LABEL)return!0;for(var i=this._current.writer,a=0;a<8;a++){var s=1<<a;if(this._current.overlaps&s){this._data.neighbors[a]||(this._data.neighbors[a]={vertexData:new Map,displayIds:new Set});var o=this._data.neighbors[a],u=this._current.geometryType;if(!o.vertexData.has(u)){var l=(0,x.G)(u,this._symbologyType).geometry,c=new $(u,l,_.H);o.vertexData.set(u,c)}var h=o.vertexData.get(this._current.geometryType),f=512*-J(s)*8,v=512*-ee(s)*8;h.copyLastFrom(i,f,v),o.displayIds.add(this._current.id)}}return!0}},{key:"_addOverlap",value:function(e,t,r,n){var i=255^((e<0+r?148:e>=_.o-r?41:189)|(t<0+n?224:t>=_.o-n?7:231));this._current.overlaps|=i}},{key:"_getVertexWriter",value:function(e){if(!this._data.self.has(e)){var t=this._data.self,r=(0,x.G)(e,this._symbologyType).geometry;t.set(e,new $(e,r,this.hint.records))}return this._data.self.get(e)}}]),e}(),re=100;function ne(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function ie(e,t){return Math.sqrt(e*e+t*t)}function ae(e){var t=ie(e[0],e[1]);e[0]/=t,e[1]/=t}function se(e,t){return ie(e[0]-t[0],e[1]-t[1])}function oe(e){return"function"==typeof e}function ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return 1/Math.max(e,1)}function le(e,t){return[!!e.minScale&&t.scaleToZoom(e.minScale)||0,!!e.maxScale&&t.scaleToZoom(e.maxScale)||re]}function ce(e,t){return e[t+1]}function he(e){return e.length-1}function fe(e){for(var t=0,r=0;r<he(e);r++)t+=ve(e,r);return t}function ve(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=ce(e,t),i=(0,f.Z)(n,2),a=i[0],s=i[1];return Math.sqrt(a*a+s*s)*r}var pe=function(){function e(t,r,n,i,a){(0,p.Z)(this,e),this._segments=t,this._index=r,this._distance=n,this._xStart=i,this._yStart=a,this._done=!1}return(0,d.Z)(e,[{key:"clone",value:function(){return new e(this._segments,this._index,this._distance,this.xStart,this.yStart)}},{key:"equals",value:function(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}},{key:"leq",value:function(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}},{key:"geq",value:function(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}},{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){var e=this.dy,t=(0*e+-1*-this.dx)/(1*this.length),r=Math.acos(t);return e>0&&(r=2*Math.PI-r),r}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){var e=this.dx,t=this.dy;return Math.sqrt(e*e+t*t)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}},{key:"hasPrev",value:function(){return this._index-1>=0}},{key:"hasNext",value:function(){return this._index+1<he(this._segments)}},{key:"next",value:function(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}},{key:"prev",value:function(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}},{key:"_seekBackwards",value:function(e,t){var r=this.backwardLength;if(e<=r)return this._distance=(r-e)/this.length,this;for(var n=this.backwardLength;this.prev();){if(n+this.length>e)return this._seekBackwards(e-n);n+=this.length}return this._distance=0,t?this:null}},{key:"seek",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<0)return this._seekBackwards(Math.abs(e),t);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;for(var r=this.remainingLength;this.next();){if(r+this.length>e)return this.seek(e-r,t);r+=this.length}return this._distance=1,t?this:null}}],[{key:"create",value:function(t){return new e(t,0,0,t[0][0],t[0][1])}}]),e}();function de(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=fe(e),a=pe.create(e),s=i/2;if(!n)return a.seek(s),void r(a.clone(),0,s+0*t,i);var o=Math.max((i-t)/2,0),u=Math.floor(o/t),l=s-u*t;a.seek(l);for(var c=-u;c<=u;c++)a.x<512&&a.x>=0&&a.y<512&&a.y>=0&&r(a.clone(),c,s+c*t,i),a.seek(t)}function ye(e,t){var r=1e-6;if(!(t<=0)){var n=e.length;if(!(n<3)){var i=[],a=0;i.push(0);for(var s=1;s<n;s++)a+=se(e[s],e[s-1]),i.push(a);t=Math.min(t,.2*a);var o=[];o.push(e[0][0]),o.push(e[0][1]);var u=e[n-1][0],l=e[n-1][1],c=ne([0,0],e[0],e[1]);ae(c),e[0][0]+=t*c[0],e[0][1]+=t*c[1],ne(c,e[n-1],e[n-2]),ae(c),e[n-1][0]+=t*c[0],e[n-1][1]+=t*c[1];for(var h=1;h<n;h++)i[h]+=t;i[n-1]+=t;for(var f=.5*t,v=1;v<n-1;v++){for(var p=0,d=0,y=0,_=v-1;_>=0&&!(i[_+1]<i[v]-f);_--){var m=f+i[_+1]-i[v],x=i[_+1]-i[_],g=i[v]-i[_]<f?1:m/x;if(Math.abs(g)<r)break;var w=g*g,M=g*m-.5*w*x,k=g*x/t,b=e[_+1],Z=e[_][0]-b[0],S=e[_][1]-b[1];p+=k/M*(b[0]*g*m+.5*w*(m*Z-x*b[0])-w*g*x*Z/3),d+=k/M*(b[1]*g*m+.5*w*(m*S-x*b[1])-w*g*x*S/3),y+=k}for(var L=v+1;L<n&&!(i[L-1]>i[v]+f);L++){var P=f-i[L-1]+i[v],T=i[L]-i[L-1],z=i[L]-i[v]<f?1:P/T;if(Math.abs(z)<r)break;var I=z*z,W=z*P-.5*I*T,C=z*T/t,E=e[L-1],A=e[L][0]-E[0],R=e[L][1]-E[1];p+=C/W*(E[0]*z*P+.5*I*(P*A-T*E[0])-I*z*T*A/3),d+=C/W*(E[1]*z*P+.5*I*(P*R-T*E[1])-I*z*T*R/3),y+=C}o.push(p/y),o.push(d/y)}o.push(u),o.push(l);for(var F=0,B=0;F<n;F++)e[F][0]=o[B++],e[F][1]=o[B++]}}}var _e=function(){function e(){(0,p.Z)(this,e)}return(0,d.Z)(e,null,[{key:"getPlacement",value:function(e,t,r,n){var i=(0,T.g)(t);if(!i)return null;var a=(0,T.a)(e);return i.execute(a,t,r,n)}}]),e}(),me=function(e){return function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(){var e;(0,p.Z)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i)))._isCIM=!1,e._vertexBoundsScale=1,e.geometryType=x.c.TEXT,e._aux=(0,L.x)(0,0,e._referenceSize,e._bitset),e}return(0,d.Z)(r,[{key:"bindTextInfo",value:function(e,t){var r=this;e&&e.length?this._shapingInfo=(0,w.h)(e,(function(e){return(0,T.b)(e,t,{scale:r._scale,angle:r._angle,xOffset:r._xOffset,yOffset:r._yOffset,hAlign:r._xAlignD,vAlign:r._yAlignD,maxLineWidth:Math.max(32,Math.min(r._lineWidth,512)),lineHeight:_.m*Math.max(.25,Math.min(r._lineHeight,4)),decoration:r._decoration,isCIM:r._isCIM})})):this._shapingInfo=null}},{key:"_write",value:function(e,t,r,n){var i=t.getDisplayId();this._writeGeometry(e,t,i,r,n)}},{key:"_writeGeometry",value:function(e,t,r,n,i){var a=this,s=this._shapingInfo;if(!(0,w.t)(s)){if((0,w.r)(this._textPlacement)){var o=null!==i&&void 0!==i?i:t.readLegacyGeometryForDisplay();return this._writePlacedText(e,r,o,s,n)}var u=i?(0,z.w)((0,z.t)(i),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readGeometryForDisplay();if(!(0,w.t)(u)){if(u.isPoint){var l=(0,f.Z)(u.coords,2),c=l[0],h=l[1];if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(c<0||c>=512||h<0||h>=512))return;return this._writeGlyphs(e,r,{x:c,y:h},s)}u.forEachVertex((function(t,n){return a._writeGlyphs(e,r,{x:t,y:n},s)}))}}}},{key:"_writePlacedText",value:function(e,t,r,n,i){var a=(0,w.e)(this._textPlacement),s=_e.getPlacement(r,a,(0,Z.u)(1),i.geometryEngine);if(s)for(var o=s.next();null!=o;){var u=-o.getAngle();n.setRotation(u);var l=o.tx,c=-o.ty;l<0||l>=512||c<0||c>=512||(this._writeGlyphs(e,t,{x:l,y:c},n),n.setRotation(-u)),o=s.next()}}},{key:"_writeGlyphs",value:function(e,t,r,n){var i,a=P.U.load(this._materialKey),s=(0,L.w)(Math.round(8*r.x),Math.round(8*r.y)),o=this._vertexBoundsScale,u=n.bounds,c=2*Math.max(u.width,u.height),h=(0,l.Z)(n.glyphs);try{for(h.s();!(i=h.n()).done;){var f=i.value;a.textureBinding=f.textureBinding,e.recordStart(t,a.data,this.geometryType,!0),e.vertexBounds(r.x+u.x+this._xOffset,r.y+u.y-this._yOffset,c*o,c*o),this._writeVertices(e,t,s,f),e.recordEnd()}}catch(v){h.e(v)}finally{h.f()}}},{key:"_writeGlyph",value:function(e,t,r,n,i){var a=P.U.load(this._materialKey),s=(0,L.w)(Math.round(8*r),Math.round(8*n));a.textureBinding=i.textureBinding,e.recordStart(t,a.data,this.geometryType,!0);var o=i.bounds,u=this._vertexBoundsScale;e.vertexBounds(r+o.x*u,n+o.y*u,o.width*u,o.height*u),this._writeVertices(e,t,s,i),e.recordEnd()}},{key:"_writeVertices",value:function(e,t,r,n){var i=e.vertexCount();this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.upperLeft),e.vertexWrite(n.texcoords.upperLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.upperRight),e.vertexWrite(n.texcoords.upperRight),e.vertexEnd(),this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.lowerLeft),e.vertexWrite(n.texcoords.lowerLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.lowerRight),e.vertexWrite(n.texcoords.lowerRight),e.vertexEnd(),e.indexWrite(i+0),e.indexWrite(i+1),e.indexWrite(i+2),e.indexWrite(i+1),e.indexWrite(i+3),e.indexWrite(i+2)}},{key:"_writeVertexCommon",value:function(e,t,r,n){var i=this._color,a=this._haloColor,s=(0,L.x)(0,0,this._referenceSize,this._bitset),o=(0,L.x)(0,0,this._size,this._haloSize);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(i),e.vertexWrite(a),e.vertexWrite(o),e.vertexWrite(s),e.vertexWrite(this._minMaxZoom)}}]),r}(e)},xe=function(){function e(){(0,p.Z)(this,e)}return(0,d.Z)(e,[{key:"bindFeature",value:function(e,t,r){}},{key:"write",value:function(e,t,r,n){var i;if((0,w.t)(this._effects)||0===(null===(i=this._effects)||void 0===i?void 0:i.length))return this._write(e,t,n);for(var a=I.f.executeEffects(this._effects,t.readLegacyGeometryForDisplay(),n.geometryEngine),s=I.f.next(a);s;)this._write(e,t,n,s),s=I.f.next(a)}},{key:"_write",value:function(e,t,r,n){}}]),e}(),ge=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i,a,s,o,u,l,c,h,f,v,d,y,m,x,g,w){var M,k=arguments.length>18&&void 0!==arguments[18]&&arguments[18],b=arguments.length>19?arguments[19]:void 0,T=arguments.length>20?arguments[20]:void 0;(0,p.Z)(this,r),(M=t.call(this))._xOffset=(0,Z.u)(d),M._yOffset=(0,Z.u)(y),M._decoration=h||"none",M._color=s,M._haloColor=o,M._haloSize=Math.min(Math.floor(5*(0,Z.u)((0,Z.o)(i))),127),M._size=Math.min(Math.round((0,Z.u)(n)),127);var z=Math.min(Math.round((0,Z.u)(a||n)),127);M._referenceSize=Math.round(Math.sqrt(256*z)),M._scale=M._size/_.l,M._angle=v,M._justify=(0,S.s)(u||"center"),M._xAlignD=(0,S.r)(u||"center"),M._yAlignD=(0,S.n)(l||"baseline"),M._baseline="baseline"===(l||"baseline"),M._bitset=(c===_.L.MAP?1:0)|(f?1:0)<<1;var I=P.U.load(e);return I.sdf=!0,M._materialKey=I.data,M._lineWidth=(0,Z.u)(m)||512,M._lineHeight=x||1,M._textPlacement=g,M._effects=w,M._isCIM=k,M._minMaxZoom=(0,L.w)(Math.round(b*_.M),Math.round(T*_.M)),M}return(0,d.Z)(r,null,[{key:"fromText",value:function(e,t){var n=new r(e.materialKey,e.font.size,e.haloSize||0,e.font.size,e.color&&(0,x.f)(e.color)||0,e.haloColor&&(0,x.f)(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,_.L.SCREEN,e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.lineWidth,e.lineHeight,null,null,!1,0,re),i=(0,T.n)(e.text),a=(0,f.Z)(i,2)[1];return n.bindTextInfo(t,a),n._vertexBoundsScale=e.maxVVSize?e.maxVVSize/e.font.size:1,n}},{key:"fromCIMText",value:function(e,t,n){var i=e.scaleFactor||1,a=e.size*e.sizeRatio*i,s=le(e.scaleInfo,n),o=(0,f.Z)(s,2),u=o[0],l=o[1],c=new r(e.materialKey,a,e.outlineSize*e.sizeRatio,e.referenceSize,(0,x.j)(e.color),(0,x.j)(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,e.colorLocked,e.angle,e.offsetX*e.sizeRatio*i,e.offsetY*e.sizeRatio*i,512,1,e.markerPlacement,e.effects,!0,u,l),h=(0,T.n)(e.text),v=(0,f.Z)(h,2)[1];return c.bindTextInfo(t,v),c._vertexBoundsScale=e.maxVVSize?e.maxVVSize/a:1,c}}]),r}(me(xe)),we=M.s.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");var Me=function(e){var t=new Map;return function(r){return t.has(r)||t.set(r,e(r)),t.get(r)}}((function(e){var t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t})),ke=function(e){return Math.floor(127*e+127)},be=function(e){return Math.floor(10*e)},Ze=function(e){return Math.round(e*(254/360))},Se=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i,a){var s,o,u,l;(0,p.Z)(this,r),(l=t.call(this,e,i.font.size,i.haloSize||0,i.font.size,i.color&&(0,x.f)(i.color)||0,i.haloColor&&(0,x.f)(i.haloColor)||0,i.horizontalAlignment,i.verticalAlignment,(0,S.i)(n.labelPlacement)?_.L.MAP:_.L.SCREEN,i.font.decoration,!1,i.angle||0,i.xoffset,i.yoffset,i.lineWidth,i.lineHeight,null,null,null,null,null))._outLineLabelAngle=0,l._refPlacementPadding=0,l._refPlacementDirX=0,l._refPlacementDirY=0,l._refOffsetX=0,l._refOffsetY=0,l._zoomLevel=0,l.geometryType=x.c.LABEL,l._allowOverrun=null!==(s=n.allowOverrun)&&void 0!==s&&s,l._repeatLabel=null===(o=n.repeatLabel)||void 0===o||o,l._labelPosition=null!==(u=n.labelPosition)&&void 0!==u?u:"curved";var c=function(e,t){var r=!!e.minScale&&t.scaleToZoom(e.minScale)||0;return(0,b.o)(r,0,25.5)}(n,a),h=function(e,t){var r=!!e.maxScale&&t.scaleToZoom(e.maxScale)||255;return(0,b.o)(r,0,25.5)}(n,a),v=n.labelPlacement,d=(0,S.a)(v),y=(0,f.Z)(d,2),m=y[0],g=y[1];l._xAlignD=m,l._yAlignD=g,l._minZoom=c,l._maxZoom=h,l._refPlacementPadding=(0,Z.u)(i.haloSize)+_.Q,l._repeatLabelDistance=n.repeatLabelDistance?(0,Z.u)(n.repeatLabelDistance):128;var w=P.Z.load(e);return w.sdf=!0,l._materialKey=w.data,l}return(0,d.Z)(r,[{key:"_shapedBox",get:function(){return(0,w.e)(this._shapingInfo).bounds}},{key:"setZoomLevel",value:function(e){this._zoomLevel=e}},{key:"bindReferenceTemplate",value:function(e){var t=(0,S.c)(this._xAlignD),r=(0,S.o)(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,(0,w.t)(e))this._refSymbolAndPlacementOffset=(0,L.x)(0,0,ke(t),ke(r));else{if("circle"===e.boundsType&&(t||r)){var n=Math.sqrt(t*t+r*r);t/=n,r/=n}var i=Math.max(e.height,e.width),a=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=(0,L.x)(a,i,ke(t),ke(r)),this._referenceSize=i,this._refPlacementDirX=t,this._refPlacementDirY=r,this._refOffsetX=e.xOffset,this._refOffsetY=e.yOffset}}},{key:"_write",value:function(e,t){if(!(0,w.t)(this._shapingInfo)){var r=this._shapingInfo,n=t.getDisplayId(),i="esriGeometryPolygon"===t.geometryType?t.readLegacyCentroid():t.readLegacyGeometry();if(i)switch(this.current={out:e,inId:n,inShaping:r,zoomLevel:this._zoomLevel},t.geometryType){case"esriGeometryPolyline":this._placeLineLabels(i);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(i);break;default:!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mapview-labeling";we.error(new M.a(t,e))}("mapview-labeling","Geometry of type ".concat(t.geometryType," is not supported"))}}}},{key:"_isVisible",value:function(e,t){var r=be(this.current.zoomLevel);return be(e)<=r&&r<=be(t)}},{key:"_placePointLabels",value:function(e){var t=this.current,r=t.out,n=t.inId,i=t.inShaping;this._writeGlyphs(r,n,e,i)}},{key:"_placeLineLabels",value:function(e){var t,r=function(e,t){for(var r=t,n=0;n<e.length;n++){var i=e[n],a=[];a.push(i[0]);for(var s=1;s<i.length;s++){var o=(0,f.Z)(a[s-1],2),u=o[0],l=o[1];u+=i[s][0],l+=i[s][1],a.push([u,l])}ye(a,r);var c=[];c.push(a[0]);for(var h=1;h<a.length;h++){var v=(0,f.Z)(a[h-1],2),p=v[0],d=v[1],y=(0,f.Z)(a[h],2),_=y[0],m=y[1],x=Math.round(_-p),g=Math.round(m-d);c.push([x,g])}e[n]=c,i=c}return e}(e.paths,this.current.inShaping.bounds.width),n=this._placeSubdivGlyphs.bind(this),i=(this._shapedBox.width+this._repeatLabelDistance)/2,a=(0,l.Z)(r);try{for(a.s();!(t=a.n()).done;){de(t.value,i,n,this._repeatLabel)}}catch(s){a.e(s)}finally{a.f()}}},{key:"_placeSubdivGlyphs",value:function(e,t,r,n){var i=Me(t),a=this._shapedBox.width/2,s=Math.sqrt(this._repeatLabelDistance)/2,o=Math.min(r,n-r),u=this.current.inShaping.isMultiline?25:Math.log2(o/(s+a/2)),l=0===t?u:Math.min(i,u),c=Math.max(this._minZoom,this.current.zoomLevel+1-l),h=this.current.zoomLevel-c,f=this._shapedBox.width/2*Math.pow(2,h);this.current.inShaping.isMultiline?0===t&&this._placeStraight(e,c):this._allowOverrun&&h<0?this._placeStraightAlong(e,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(e,c):"curved"===this._labelPosition&&this._placeCurved(e,c,f)}},{key:"_placeStraight",value:function(e,t){var r=this.current,n=r.out,i=r.inId,a=r.inShaping,s=Math.ceil(e.angle*(180/Math.PI)%360),o=Math.ceil((e.angle*(180/Math.PI)+180)%360);this._outLineLabelAngle=Ze(s),this._writeGlyphs(n,i,e,a,t),this._outLineLabelAngle=Ze(o),this._writeGlyphs(n,i,e,a,t)}},{key:"_placeCurved",value:function(e,t,r){var n=this.current,i=n.out,a=n.inId;i.metricStart(a,t,e.x,e.y,0,0,0,0);var s=e.clone(),o=e.angle*(180/Math.PI)%360,u=(e.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=Ze(o),this._placeFirst(s,t,1),this._placeBack(e,s,t,r,1),this._placeForward(e,s,t,r,1),this._outLineLabelAngle=Ze(u),this._placeFirst(s,t,0),this._placeBack(e,s,t,r,0),this._placeForward(e,s,t,r,0),i.metricEnd()}},{key:"_placeStraightAlong",value:function(e,t){var r=this.current,n=r.out,i=r.inId;n.metricStart(i,t,e.x,e.y,0,0,0,0);var a=e.clone(),s=e.angle*(180/Math.PI)%360,o=(e.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=Ze(s),this._placeFirst(a,t,1,!0),this._outLineLabelAngle=Ze(o),this._placeFirst(a,t,0,!0),n.metricEnd()}},{key:"_placeBack",value:function(e,t,r,n,i){for(var a=e.clone(),s=e.backwardLength+0;a.prev()&&!(s>=n);)this._placeOnSegment(a,t,s,r,-1,i),s+=a.length+0}},{key:"_placeForward",value:function(e,t,r,n,i){for(var a=e.clone(),s=e.remainingLength+0;a.next()&&!(s>=n);)this._placeOnSegment(a,t,s,r,1,i),s+=a.length+0}},{key:"_placeFirst",value:function(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e,s=this.current.inShaping,o=s.glyphs,u=this.current.zoomLevel,c=this.current,h=c.out,f=c.inId,v=(0,l.Z)(o);try{for(v.s();!(n=v.n()).done;){var p=n.value,d=p.x>s.bounds.x?r:1-r,y=d*e.remainingLength+(1-d)*e.backwardLength,_=Math.abs(p.x+p.width/2-s.bounds.x),m=Math.max(0,u+Math.log2(_/(y+0))),x=Math.max(t,i?0:m);if(p.maxZoom=25,p.angle=e.angle+(1-r)*Math.PI,p.minZoom=x,this._writeGlyph(h,f,a.x,a.y,p),r&&this._isVisible(p.minZoom,p.maxZoom)){var g=p.bounds;h.metricBoxWrite(g.center[0],g.center[1],g.width,g.height)}}}catch(w){v.e(w)}finally{v.f()}}},{key:"_placeOnSegment",value:function(e,t,r,n,i,a){var s,o=this.current.inShaping.glyphs,u=this.current,c=u.out,h=u.inId,f=this.current.inShaping,v=this.current.zoomLevel,p=e.dx/e.length,d=e.dy/e.length,y={x:e.x+r*-i*p,y:e.y+r*-i*d},_=(0,l.Z)(o);try{for(_.s();!(s=_.n()).done;){var m=s.value,x=m.x>f.bounds.x?a:1-a;if(x&&1===i||!x&&-1===i){var g=Math.abs(m.x+m.width/2-f.bounds.x),w=Math.max(0,v+Math.log2(g/r)-.1),M=Math.max(n,v+Math.log2(g/(r+e.length+0)));if(0!==w&&(m.angle=e.angle+(1-a)*Math.PI,m.minZoom=M,m.maxZoom=w,this._writeGlyph(c,h,y.x,y.y,m),a&&this._isVisible(m.minZoom,m.maxZoom))){var k=m.bounds,b=e.x-t.x,Z=e.y-t.y;c.metricBoxWrite(k.center[0]+b,k.center[1]+Z,k.width,k.height)}}}}catch(S){_.e(S)}finally{_.f()}}},{key:"_writeGlyphs",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this._minZoom;if(!(r.x<0||r.x>=512||r.y<0||r.y>=512)){var a,s=r.x+this._refOffsetX,o=r.y-this._refOffsetY,u=(0,l.Z)(n.glyphs);try{for(u.s();!(a=u.n()).done;){var c=a.value;c.minZoom=i,c.maxZoom=this._maxZoom,this._writeGlyph(e,t,s,o,c)}}catch(p){u.e(p)}finally{u.f()}var h=this._refPlacementDirX,f=this._refPlacementDirY,v=n.boundsT;e.metricStart(t,i,s,o,h,f,this._referenceSize,this._materialKey),e.metricBoxWrite(v.center[0],v.center[1],v.width,v.height),e.metricEnd()}}},{key:"_writeVertexCommon",value:function(e,t,r,n){var i=this._color,a=this._haloColor,s=(0,L.x)(0,0,this._size,this._haloSize),o=Math.max(n.minZoom,this._minZoom),u=Math.min(n.maxZoom,this._maxZoom),l=(0,L.x)(be(o),be(u),this._outLineLabelAngle,0);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(i),e.vertexWrite(a),e.vertexWrite(s),e.vertexWrite(this._refSymbolAndPlacementOffset),e.vertexWrite(l)}}],[{key:"fromLabelClass",value:function(e,t){if("esriServerLinePlacementCenterAlong"===e.labelPlacement){var n=e.symbol;n.xoffset=0,n.yoffset=0,n.angle=0,n.font.decoration="none"}return new r(e.materialKey,e,e.symbol,t)}}]),r}(ge),Le=3.14159265359/180,Pe=function(e){return function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(){var e;(0,p.Z)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).angle=0,e.xOffset=0,e.yOffset=0,e.width=0,e.height=0,e.boundsType="square",e._anchorX=0,e._anchorY=0,e._computedWidth=0,e._computedHeight=0,e._vertexBoundsScaleX=1,e._vertexBoundsScaleY=1,e._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0},e.geometryType=x.c.MARKER,e}return(0,d.Z)(r,[{key:"_write",value:function(e,t,r,n){var i=t.getDisplayId();e.recordStart(i,this._materialKey,this.geometryType,!0),this._writeGeometry(e,t,i,r,n),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,n,i){var a=this;if((0,w.r)(this._markerPlacement))return this._writePlacedMarkers(e,t,n,i);if(!i&&"esriGeometryPoint"===t.geometryType){var s=t.getX(),o=t.getY();if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(s<0||s>=513||o<0||o>=513))return;return this._writeVertices(e,r,this._getPos(s,o),s,o)}var u=i?(0,z.w)((0,z.t)(i),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readGeometryForDisplay();if(!(0,w.t)(u)){if(u.isPoint){var l=(0,f.Z)(u.coords,2),c=l[0],h=l[1];if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(c<0||c>=512||h<0||h>=512))return;return this._writeVertices(e,r,this._getPos(c,h),c,h)}u.forEachVertex((function(t,n){var i=2*_.o;t<-i||t>=i||n<-i||n>=i||a._writeVertices(e,r,a._getPos(t,n),t,n)}))}}},{key:"_writePlacedMarkers",value:function(e,t,r,n){var i=null!==n&&void 0!==n?n:t.readLegacyGeometryForDisplay(),a=_e.getPlacement(i,(0,w.e)(this._markerPlacement),(0,Z.u)(1),r.geometryEngine);if(a)for(var s=t.getDisplayId(),o=(0,C.n)(),u=(0,W.n)(),l=a.next();null!=l;){var c=l.tx,h=-l.ty;c>=-128&&c<=640&&h>=-128&&h<=640&&(this._applyTransformation(u,o,-l.getAngle()/Le),this._writeVertices(e,s,this._getPos(c,h),c,h)),l=a.next()}}},{key:"_writeVertices",value:function(e,t,r,n,i){var a=P.N.load(this._materialKey);return a.symbologyType===x.S.HEATMAP?this._writeHeatmapVertices(e,t,r,n,i):this._writeMarkerVertices(e,t,a,r,n,i)}},{key:"_writeMarkerVertices",value:function(e,t,r,n,i,a){var s=r.vvRotation,o=e.vertexCount(),u=this._computedWidth*this._vertexBoundsScaleX,l=this._computedHeight*this._vertexBoundsScaleY;if(this.angle){var c=Math.max(u,l);u=c,l=c}if(s){var h=Math.max(this.xOffset,this.yOffset);u+=h,l+=h}e.vertexBounds(i+this.xOffset,a-this.yOffset,u,l),e.vertexWrite(n),e.vertexWrite(this._offsetUpperLeft),e.vertexWrite(this._texUpperLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(n),e.vertexWrite(this._offsetUpperRight),e.vertexWrite(this._texUpperRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(n),e.vertexWrite(this._offsetBottomLeft),e.vertexWrite(this._texBottomLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(n),e.vertexWrite(this._offsetBottomRight),e.vertexWrite(this._texBottomRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),this._writeIndices(e,o)}},{key:"_writeHeatmapVertices",value:function(e,t,r,n,i){var a=e.vertexCount();e.vertexBounds(n+this.xOffset,i-this.yOffset,this.width,this.height),e.vertexWrite(r),e.vertexWrite(this._offsetUpperLeft),e.vertexWrite(t),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetUpperRight),e.vertexWrite(t),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomLeft),e.vertexWrite(t),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomRight),e.vertexWrite(t),e.vertexEnd(),this._writeIndices(e,a)}},{key:"_writeIndices",value:function(e,t){e.indexWrite(t+0),e.indexWrite(t+1),e.indexWrite(t+2),e.indexWrite(t+1),e.indexWrite(t+3),e.indexWrite(t+2)}},{key:"_applyTransformation",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,W.f)(e,(0,C.t)(this.xOffset,-this.yOffset)),this.angle+r!==0&&(0,W.e)(e,e,Le*(this.angle+r));var n=this._computedWidth,i=this._computedHeight,a=(this._anchorX-.5)*n,s=(this._anchorY-.5)*i;(0,E.r)(t,a,s),(0,E.z)(t,t,e),this._offsetUpperLeft=(0,L.w)(16*t[0],16*t[1]),this._offsets.xUpperLeft=t[0],this._offsets.yUpperLeft=t[1],(0,E.r)(t,a+n,s),(0,E.z)(t,t,e),this._offsetUpperRight=(0,L.w)(16*t[0],16*t[1]),this._offsets.xUpperRight=t[0],this._offsets.yUpperRight=t[1],(0,E.r)(t,a,s+i),(0,E.z)(t,t,e),this._offsetBottomLeft=(0,L.w)(16*t[0],16*t[1]),this._offsets.xBottomLeft=t[0],this._offsets.yBottomLeft=t[1],(0,E.r)(t,a+n,s+i),(0,E.z)(t,t,e),this._offsetBottomRight=(0,L.w)(16*t[0],16*t[1]),this._offsets.xBottomRight=t[0],this._offsets.yBottomRight=t[1]}},{key:"_getPos",value:function(e,t){return(0,L.w)(Math.round(8*e),Math.round(8*t))}}]),r}(e)},Te=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i,a,s,o,u,l,c,h,f,v,d,y,m,g,w,M,k,b,Z,S,T){var z;(0,p.Z)(this,r),(z=t.call(this)).angle=a,z.height=u,z.width=o,z.xOffset=n*k,z.yOffset=i*k,z._markerPlacement=b,z._effects=Z,z._anchorX=.5-(.5+g)*m.width/m.width,z._anchorY=.5-(.5+w)*m.height/m.height,z._minMaxZoom=(0,L.w)(Math.round(S*_.M),Math.round(T*_.M));var I=(y===_.L.MAP?_.W:_._)|(f?_.$:0)|(d?_.a0:0)|(v?_.a1:0),E=m&&m.sdf,A=P.N.load(e);A.sdf=E,A.pattern=!0,A.textureBinding=m.textureBinding,z._materialKey=A.data,z._fillColor=s,z._outlineColor=c,z._sizeOutlineWidth=(0,L.x)(Math.round(Math.min(Math.sqrt(128*o),255)),Math.round(Math.min(Math.sqrt(128*u),255)),Math.round(Math.min(Math.sqrt(128*h),255)),Math.round(Math.min(Math.sqrt(128*l),255)));var R=m.rect.x+_.a,F=m.rect.y+_.a,B=R+m.width,V=F+m.height;z._offsets.xUpperLeft=R,z._offsets.yUpperLeft=F,z._offsets.xUpperRight=B,z._offsets.yUpperRight=F,z._offsets.xBottomLeft=R,z._offsets.yBottomLeft=V,z._offsets.xBottomRight=B,z._offsets.yBottomRight=V,A.symbologyType===x.S.PIE_CHART?(z._texUpperLeft=(0,L.w)(0,1),z._texUpperRight=(0,L.w)(1,1),z._texBottomLeft=(0,L.w)(0,0),z._texBottomRight=(0,L.w)(1,0)):(z._texUpperLeft=(0,L.w)(R,F),z._texUpperRight=(0,L.w)(B,F),z._texBottomLeft=(0,L.w)(R,V),z._texBottomRight=(0,L.w)(B,V)),o*=M,u*=M,o*=k,u*=k;var O=Math.round(64*M);z._bitestAndDistRatio=(0,L.w)(I,O),z._computedWidth=o,z._computedHeight=u;var D=(0,C.n)(),G=(0,W.n)();return z._applyTransformation(G,D),z}return(0,d.Z)(r,null,[{key:"fromCIMMarker",value:function(e,t,n){var i=t&&t.width||1,a=t&&t.height||1,s=e.size,o=i/a*e.scaleX,u=e.scaleSymbolsProportionally&&e.frameHeight?s/e.frameHeight:1,l=(0,x.j)(e.color),c=(0,x.j)(e.outlineColor),h=(0,Z.u)(s),v=h*o,p=(0,Z.u)(e.offsetX||0),d=(0,Z.u)(e.offsetY||0),y=(0,Z.u)(e.outlineWidth||0)*u,m=e.alignment||_.L.SCREEN,g=(0,Z.u)(e.referenceSize),M=le(e.scaleInfo,n),k=(0,f.Z)(M,2),b=k[0],S=k[1];t.sdf||0!==l||(l=-1);var L=e.rotation||0;e.rotateClockwise||(L=-L);var P=0,T=0,z=e.anchorPoint;z&&(e.isAbsoluteAnchorPoint?s&&(P=-z.x/(s*o),T=z.y/s):(P=z.x,T=z.y));var I=new r(e.materialKey,p,d,L,l,v,h,g,c,y,e.colorLocked,e.scaleSymbolsProportionally,!1,m,t,P,T,e.sizeRatio,(0,w.n)(e.scaleFactor,1),e.markerPlacement,e.effects,b,S);return I._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/v:1,I._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/h:1,I}},{key:"fromPictureMarker",value:function(e,t){var n=Math.round((0,Z.u)(e.width)),i=Math.round((0,Z.u)(e.height)),a=_.a2,s=Math.round((0,Z.u)(e.xoffset||0)),o=Math.round((0,Z.u)(e.yoffset||0)),u=new r(e.materialKey,s,o,e.angle,a,n,i,i,0,0,!1,!1,!1,_.L.SCREEN,t,0,0,1,1,null,null,0,re);return u._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.width:1,u._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.height:1,u}},{key:"fromSimpleMarker",value:function(e,t){var n=(0,x.f)(e.color),i=Math.round((0,Z.u)(e.size)),a=i,s=Math.round((0,Z.u)(e.xoffset||0)),o=Math.round((0,Z.u)(e.yoffset||0)),u=e.style,l=e.outline,c=0|(l&&l.color&&(0,x.f)(l.color)),h=0|(l&&l.width&&Math.round((0,Z.u)(l.width))),f=new r(e.materialKey,s,o,e.angle,n,i,a,a,c,h,!1,!1,"esriSMSCross"===u||"esriSMSX"===u,_.L.SCREEN,t,0,0,126/64,1,null,null,0,re);return f.boundsType="esriSMSCircle"===u?"circle":"square",f._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.size:1,f._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.size:1,f}},{key:"fromLineSymbolMarker",value:function(e,t){var n,i=(0,x.f)(e.color),a=Math.round((0,Z.u)(6*e.lineWidth)),s=a,o="cross"===e.style||"x"===e.style;switch(e.placement){case"begin-end":n=_.i.Both;break;case"begin":n=_.i.JustBegin;break;case"end":n=_.i.JustEnd;break;default:n=_.i.None}var u={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:n,offsetAlongLine:0},l=new r(e.materialKey,0,0,0,i,a,s,s/6,i,o?Math.round((0,Z.u)(e.lineWidth)):0,!1,!1,o,_.L.MAP,t,0,0,126/64,1,u,null,0,re);return l.boundsType="circle"===e.style?"circle":"square",l}}]),r}(Pe(xe));function ze(e,t,r,n,i,a,s){et=0;var o,u,l,c,h,f=(n-r)*a,v=i&&i.length,p=v?(i[0]-r)*a:f,d=Ie(t,r,n,0,p,a,!0);if(d&&d.next!==d.prev){if(v&&(d=function(e,t,r,n,i,a){for(var s=new Array,o=0,u=n.length;o<u;o++){var l=Ie(e,t,r,n[o]*a,o<u-1?n[o+1]*a:r*a,a,!1);l===l.next&&(l.steiner=!0),s.push(Be(l))}s.sort(He);for(var c=0,h=s;c<h.length;c++){Ve(h[c],i),i=We(i,i.next)}return i}(t,r,n,i,d,a)),f>80*a){o=l=t[0+r*a],u=c=t[1+r*a];for(var y=a;y<p;y+=a){var _=t[y+r*a],m=t[y+1+r*a];o=Math.min(o,_),u=Math.min(u,m),l=Math.max(l,_),c=Math.max(c,m)}h=0!==(h=Math.max(l-o,c-u))?1/h:0}Ce(d,e,a,o,u,h,s,0)}}function Ie(e,t,r,n,i,a,s){var o;if(s===function(e,t,r,n,i,a){for(var s=0,o=n,u=i-a;o<i;o+=a)s+=(e[u+t*a]-e[o+t*a])*(e[o+1+t*a]+e[u+1+t*a]),u=o;return s}(e,t,0,n,i,a)>0)for(var u=n;u<i;u+=a)o=Re(u+t*a,e[u+t*a],e[u+1+t*a],o);else for(var l=i-a;l>=n;l-=a)o=Re(l+t*a,e[l+t*a],e[l+1+t*a],o);return o&&Xe(o,o.next)&&(Fe(o),o=o.next),o}function We(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e)return e;var r,n=e;do{if(r=!1,n.steiner||!Xe(n,n.next)&&0!==De(n.prev,n,n.next))n=n.next;else{if(Fe(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function Ce(e,t,r,n,i,a,s,o){if(e){!o&&a&&(e=Oe(e,n,i,a));for(var u=e;e.prev!==e.next;){var l=e.prev,c=e.next;if(a?Ae(e,n,i,a):Ee(e))t.push(l.index/r+s),t.push(e.index/r+s),t.push(c.index/r+s),Fe(e),e=c.next,u=c.next;else if((e=c)===u){o?1===o?Ce(e=je(e,t,r,s),t,r,n,i,a,s,2):2===o&&Ye(e,t,r,n,i,a,s):Ce(We(e),t,r,n,i,a,s,1);break}}}}function Ee(e){var t=e.prev,r=e,n=e.next;if(De(t,r,n)>=0)return!1;for(var i=e.next.next,a=i,s=0;i!==e.prev&&(0===s||i!==a);){if(s++,Ke(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&De(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Ae(e,t,r,n){var i=e.prev,a=e,s=e.next;if(De(i,a,s)>=0)return!1;for(var o=i.x<a.x?i.x<s.x?i.x:s.x:a.x<s.x?a.x:s.x,u=i.y<a.y?i.y<s.y?i.y:s.y:a.y<s.y?a.y:s.y,l=i.x>a.x?i.x>s.x?i.x:s.x:a.x>s.x?a.x:s.x,c=i.y>a.y?i.y>s.y?i.y:s.y:a.y>s.y?a.y:s.y,h=Ue(o,u,t,r,n),f=Ue(l,c,t,r,n),v=e.prevZ,p=e.nextZ;v&&v.z>=h&&p&&p.z<=f;){if(v!==e.prev&&v!==e.next&&Ke(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&De(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,p!==e.prev&&p!==e.next&&Ke(i.x,i.y,a.x,a.y,s.x,s.y,p.x,p.y)&&De(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;v&&v.z>=h;){if(v!==e.prev&&v!==e.next&&Ke(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&De(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;p&&p.z<=f;){if(p!==e.prev&&p!==e.next&&Ke(i.x,i.y,a.x,a.y,s.x,s.y,p.x,p.y)&&De(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Re(e,t,r,n){var i=Qe.create(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Fe(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Be(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Ve(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,s=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var o=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=i&&o>s){if(s=o,o===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===s)return r.prev;var u,l=r,c=r.x,h=r.y,f=1/0;for(n=r.next;n!==l;)i>=n.x&&n.x>=c&&i!==n.x&&Ke(a<h?i:s,a,c,h,a<h?s:i,a,n.x,n.y)&&(((u=Math.abs(a-n.y)/(i-n.x))<f||u===f&&n.x>r.x)&&Ne(n,e)&&(r=n,f=u)),n=n.next;return r}(e,t)){var r=$e(t,e);We(r,r.next)}}function Oe(e,t,r,n){for(var i;i!==e;i=i.next){if(null===(i=i||e).z&&(i.z=Ue(i.x,i.y,t,r,n)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,Oe(e,t,r,n);i.prevZ=i.prev,i.nextZ=i.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var n=void 0,i=e;e=null,t=null;for(var a=0;i;){a++,n=i;for(var s=0;s<r&&n;s++)n=n.nextZ;for(var o=r;s>0||o>0&&n;){var u=void 0;0===s?(u=n,n=n.nextZ,o--):0!==o&&n?i.z<=n.z?(u=i,i=i.nextZ,s--):(u=n,n=n.nextZ,o--):(u=i,i=i.nextZ,s--),t?t.nextZ=u:e=u,u.prevZ=t,t=u}i=n}if(t.nextZ=null,r*=2,a<2)return e}}(e)}function De(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Ge(e,t,r,n){return!!(Xe(e,t)&&Xe(r,n)||Xe(e,n)&&Xe(r,t))||De(e,t,r)>0!=De(e,t,n)>0&&De(r,n,e)>0!=De(r,n,t)>0}function Ke(e,t,r,n,i,a,s,o){return(i-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(n-o)-(r-s)*(t-o)>=0&&(r-s)*(a-o)-(i-s)*(n-o)>=0}function Ne(e,t){return De(e.prev,e,e.next)<0?De(e,t,e.next)>=0&&De(e,e.prev,t)>=0:De(e,t,e.prev)<0||De(e,e.next,t)<0}function Ue(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Xe(e,t){return e.x===t.x&&e.y===t.y}function He(e,t){return e.x-t.x}function je(e,t,r,n){var i=e;do{var a=i.prev,s=i.next.next;!Xe(a,s)&&Ge(a,i,i.next,s)&&Ne(a,s)&&Ne(s,a)&&(t.push(a.index/r+n),t.push(i.index/r+n),t.push(s.index/r+n),Fe(i),Fe(i.next),i=e=s),i=i.next}while(i!==e);return i}function Ye(e,t,r,n,i,a,s){var o=e;do{for(var u=o.next.next;u!==o.prev;){if(o.index!==u.index&&qe(o,u)){var l=$e(o,u);return o=We(o,o.next),l=We(l,l.next),Ce(o,t,r,n,i,a,s,0),void Ce(l,t,r,n,i,a,s,0)}u=u.next}o=o.next}while(o!==e)}function qe(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&Ge(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&Ne(e,t)&&Ne(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function $e(e,t){var r=Qe.create(e.index,e.x,e.y),n=Qe.create(t.index,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}for(var Qe=function(){function e(){(0,p.Z)(this,e),this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return(0,d.Z)(e,null,[{key:"create",value:function(t,r,n){var i=et<Je.length?Je[et++]:new e;return i.index=t,i.x=r,i.y=n,i.prev=null,i.next=null,i.z=null,i.prevZ=null,i.nextZ=null,i.steiner=!1,i}}]),e}(),Je=new Array,et=0,tt=0;tt<8096;tt++)Je.push(new Qe);var rt=new k.n(0,0,0,1,0),nt=new k.n(0,0,0,1,0);function it(e,t,r){for(var n=0,i=1;i<r;i++){var a=e[2*(t+i-1)],s=e[2*(t+i-1)+1];n+=(e[2*(t+i)]-a)*(e[2*(t+i)+1]+s)}return n}function at(e,t,r,n,i){for(var a=0,s=r;s<n;s+=3){var o=2*(e[s]-i),u=2*(e[s+1]-i),l=2*(e[s+2]-i);a+=Math.abs((t[o]-t[l])*(t[u+1]-t[o+1])-(t[o]-t[u])*(t[l+1]-t[o+1]))}return a}function st(e,t){var r=t.coords,n=t.lengths,i=e;if(t.hasIndeterminateRingOrder)return!1;for(var a=0,s=0;s<n.length;){for(var o=s,u=n[s],l=it(r,a,u),c=[];++o<n.length;){var h=n[o],f=it(r,a+u,h);if(!(f>0))break;l+=f,c.push(a+u),u+=h}var v=i.length;ze(i,r,a,a+u,c,2,0);var p=at(i,r,v,i.length,0),d=Math.abs(l);if(Math.abs((p-d)/Math.max(1e-7,d))>1e-5)return i.length=0,!1;s=o,a+=u}return!0}rt.setExtent(_.o),nt.setExtent(_.o);var ot=16,ut=function(e){return function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(){var e;(0,p.Z)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).tessellationProperties={},e._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0},e.geometryType=x.c.LINE,e}return(0,d.Z)(r,[{key:"writeGeometry",value:function(e,t,r,n){this._writeGeometry(e,t,r,n)}},{key:"_initializeTessellator",value:function(e){var t=P.C.load(this._materialKey),r=P.w.load(this._materialKey),n=this._tessellationOptions,i=t.vvSizeFieldStops||t.vvSizeMinMaxValue||t.vvSizeScaleStops||t.vvSizeUnitValue,a=this.tessellationProperties._halfWidth<_.X&&!e&&!i;this.tessellationProperties.minMaxZoom=this._minMaxZoom,n.wrapDistance=65535,n.textured=this._isDashed||this._hasPattern,n.offset=this.tessellationProperties.offset,n.halfWidth=this.tessellationProperties._halfWidth;var s=a?0:1,o=(0,P.O)(r)?ct:lt;this._lineTessellator=new k.d(o(this.tessellationProperties,s,s),ht(this.tessellationProperties),a)}},{key:"_write",value:function(e,t,r,n){var i="esriGeometryPoint"===t.geometryType;e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,i),this._writeGeometry(e,t,n,i),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,n){var i=null!==r&&void 0!==r?r:t.readLegacyGeometryForDisplay(),a=this._getLines(i,n);(0,w.t)(a)||this._writeVertices(e,t,a)}},{key:"_getLines",value:function(e,t){if((0,w.t)(e))return null;var r=e.paths||e.rings;return(0,w.t)(r)?null:function(e,t){nt.setPixelMargin(t);for(var r=nt,n=-t,i=_.o+t,a=[],s=!1,o=0;o<e.length;){var u=[],c=e[o];if(!c)return null;r.reset(B.s.LineString);var h=(0,f.Z)(c[0],2),v=h[0],p=h[1];if(s)r.moveTo(v,p);else{if(v<n||v>i||p<n||p>i){s=!0;continue}u.push({x:v,y:p})}for(var d=!1,y=c.length,m=1;m<y;++m)if(v+=c[m][0],p+=c[m][1],s)r.lineTo(v,p);else{if(v<n||v>i||p<n||p>i){d=!0;break}u.push({x:v,y:p})}if(d)s=!0;else{if(s){var x=r.resultWithStarts();if(x){var g,w=(0,l.Z)(x);try{for(w.s();!(g=w.n()).done;){var M=g.value;a.push(M)}}catch(k){w.e(k)}finally{w.f()}}}else a.push({line:u,start:0});o++,s=!1}}return a=a.filter((function(e){return e.line.length>1})),0===a.length?null:a}(r,t?256:16)}},{key:"_writeVertices",value:function(e,t,r){var n=t.getDisplayId(),i=e.vertexCount(),a=this.tessellationProperties,s=this._tessellationOptions;a.out=e,a.id=n,a.indexCount=0,a.vertexCount=0,a.offset=i,s.capType=this._capType,s.joinType=this._joinType;var o=P.w.load(this._materialKey);this.tessellationProperties.key=(0,P.O)(o)?o:P.C.load(this._materialKey);var u,c=(0,l.Z)(r);try{for(c.s();!(u=c.n()).done;){var h=u.value,f=h.line,v=h.start;s.initialDistance=v%65535,this._lineTessellator.tessellate(f,s)}}catch(p){c.e(p)}finally{c.f()}}}]),r}(e)},lt=function(e,t,r){return function(n,i,a,s,o,u,l,c,h,f,v){var p=(0,L.w)(v,Math.ceil(ot*e._halfWidth)),d=(0,L.x)(Math.round(ot*l),Math.round(ot*c),Math.round(ot*h),Math.round(ot*f)),y=(0,L.x)(ot*o,ot*u,0,e._bitset),_=e.out;return _.vertexBounds(n,i,t,r),_.vertexWrite((0,L.w)(8*n,8*i)),_.vertexWrite(e.id),_.vertexWrite(e._fillColor),_.vertexWrite(d),_.vertexWrite(p),_.vertexWrite(e._tl),_.vertexWrite(e._br),_.vertexWrite(y),_.vertexWrite((0,L.w)(Math.ceil(ot*e._halfReferenceWidth),0)),_.vertexWrite(e.minMaxZoom),_.vertexEnd(),e.offset+e.vertexCount++}},ct=function(e,t,r){return function(n,i,a,s,o,u,l,c,h,f,v){var p=(0,L.w)(ot*e._halfWidth,ot*e._halfReferenceWidth),d=(0,L.x)(ot*l+128,ot*c+128,ot*h+128,ot*f+128),y=e.out,_=e._bitset<<24|e.id;y.vertexBounds(n,i,t,r),y.vertexWrite((0,L.w)(8*n,8*i)),y.vertexWrite(_),y.vertexWrite(e._fillColor);var m=(0,P.b)(e.key);return m||(y.vertexWrite(0),y.vertexWrite(0)),y.vertexWrite(0),y.vertexWrite(p),y.vertexWrite(d),m||y.vertexWrite(e.minMaxZoom),y.vertexEnd(),e.offset+e.vertexCount++}},ht=function(e){return function(t,r,n){var i=e.out;i.indexWrite(t),i.indexWrite(r),i.indexWrite(n),e.indexCount+=3}},ft=M.s.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate"),vt=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i,a,s,o,u,l,c,h,f,v,d,y,m,x,g,w,M,k){var b;(0,p.Z)(this,r),b=t.call(this);var Z=P.C.load(e);n&&(Z.sdf=n.sdf,Z.pattern=!0,Z.textureBinding=n.textureBinding),b._capType=a,b._joinType=s,b._miterLimitCosine=ue(o),b.tessellationProperties._fillColor=u,b.tessellationProperties._tl=l,b.tessellationProperties._br=c,b._hasPattern=h,b._isDashed=f,b._zOrder=g,b._effects=w,b._minMaxZoom=(0,L.w)(Math.round(M*_.M),Math.round(k*_.M)),b._materialKey=Z.data;var S=(d?_.$:0)|(y?_.a3:0)|(v?_.a4:0)|(m?_.a5:0);return b.tessellationProperties._bitset=S,b.tessellationProperties._halfWidth=.5*i,b.tessellationProperties._halfReferenceWidth=.5*x,b.tessellationProperties.offset=0,b._initializeTessellator(!1),b}return(0,d.Z)(r,null,[{key:"fromCIMLine",value:function(e,t,n){var i=e.color,a=e.scaleFactor||1,s=!!e.dashTemplate,o=e.cap;s&&o===_.e.ROUND&&(o=_.e.SQUARE);var u=e.join,l=(0,Z.u)(e.width)*a,c=(0,Z.u)(e.referenceWidth),h=(0,Z.u)(e.miterLimit),v=i&&(0,x.j)(i)||0,p=le(e.scaleInfo,n),d=(0,f.Z)(p,2),y=d[0],m=d[1];if(!t)return new r(e.materialKey,t,l,o,u,h,v,0,0,!1,s,e.scaleDash,e.colorLocked,!1,e.sampleAlphaOnly,c,e.zOrder,e.effects,y,m);var g=t.rect,w=t.width,M=t.height,k=g.x+_.a,b=g.y+_.a,S=k+w,P=b+M,T=(0,L.w)(k,b),z=(0,L.w)(S,P);return new r(e.materialKey,t,l,o,u,h,v,T,z,!0,s,e.scaleDash,e.colorLocked,!1,e.sampleAlphaOnly,c,e.zOrder,e.effects,y,m)}},{key:"fromFillOutline",value:function(e){var t,n=P.w.load(e.materialKey);return(0,P.O)(n)&&e.outline&&"esriSLSSolid"===(null===(t=e.outline)||void 0===t?void 0:t.style)?r.fromSimpleLine((0,u.Z)({hash:"",materialKey:e.materialKey},e.outline),null,!0):null}},{key:"fromSimpleLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.color,a="esriSLSSolid"!==e.style&&"esriSLSNull"!==e.style,s=(0,x.k)(e.cap||"round"),o=(0,x.t)(e.join||"round"),u=i&&"esriSLSNull"!==e.style&&(0,x.f)(i)||0;"esriSLSNull"===e.style&&(u=0);var l=(0,Z.u)(e.width),c=e.miterLimit;if(!t)return new r(e.materialKey,t,l,s,o,c,u,0,0,!1,a,!0,!1,n,!1,l,0,null,0,re);var h=t.rect,f=t.width,v=t.height,p=h.x+_.a,d=h.y+_.a,y=p+f,m=d+v,g=(0,L.w)(p,d),w=(0,L.w)(y,m);return new r(e.materialKey,t,l,s,o,c,u,g,w,!0,a,!0,!1,n,!1,l,0,null,0,re)}},{key:"fromPictureLineSymbol",value:function(e,t,r,n){return ft.error("PictureLineSymbol support does not exist!"),null}}]),r}(ut(xe)),pt=function(e){return function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(){var e;(0,p.Z)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).forceLibtess=!1,e._bitset=0,e._lineTemplate=null,e.geometryType=x.c.FILL,e}return(0,d.Z)(r,[{key:"_maybeAddLineTemplate",value:function(e){this._lineTemplate=vt.fromFillOutline(e)}},{key:"_write",value:function(e,t,r,n){var i="esriGeometryPoint"===t.geometryType,a=P.w.load(this._materialKey);e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,i),this._writeGeometry(e,t,a,n,i),(0,P.O)(a)&&(0,w.r)(this._lineTemplate)&&this._lineTemplate.writeGeometry(e,t,n,i),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,n,i){var a=this._getGeometry(t,n,i);if(!(0,w.t)(a)){var s=[];if(a.maxLength>100||this.forceLibtess||!st(s,a)){var o=function(e){var t=e.coords,r=e.lengths;return(0,k.a)(t,r).buffer}(a);this._writeVertices(e,t,o,[o.length/2],r)}else s.length&&this._writeVertices(e,t,a.coords,a.lengths,r,s)}}},{key:"_writeVertex",value:function(e,t,r,n,i,a){var s=(0,L.w)(1*n,1*i);if(e.vertexBounds(n,i,0,0),e.vertexWrite(s),e.vertexWrite(t),r.symbologyType===x.S.DOT_DENSITY)e.vertexWriteF32(1/Math.abs(a.readGeometryArea()));else{e.vertexWrite(this.fillColor);var o=(0,P.b)(r);o||(e.vertexWrite(this.tl),e.vertexWrite(this.br)),e.vertexWrite(this.aux2_1),e.vertexWrite(this.aux2_2),e.vertexWrite(this.aux3),o||e.vertexWrite(this._minMaxZoom)}}},{key:"_writeVertices",value:function(e,t,r,n,i,a){var s=t.getDisplayId(),o=this._bitset<<24|s,u=n.reduce((function(e,t){return e+t})),c=(0,x.G)(i.geometryType,i.symbologyType).geometry/4,h=e.vertexCount();e.vertexEnsureSize(c*u);var f=0;if(a){var v,p=(0,l.Z)(a);try{for(p.s();!(v=p.n()).done;){var d=v.value,y=r[2*d],_=r[2*d+1];this._writeVertex(e,o,i,y,_,t),f++}}catch(k){p.e(k)}finally{p.f()}}else for(var m=0;m<r.length;m+=2){var g=Math.round(r[m]),w=Math.round(r[m+1]);this._writeVertex(e,o,i,g,w,t),f++}e.indexEnsureSize(f);for(var M=0;M<f;M++)e.indexWrite(M+h)}},{key:"_getGeometry",value:function(e,t,r){var n=t?(0,z.w)((0,z.t)(t),2):e.readGeometryForDisplay();return n?function(e,t){if((0,w.t)(e))return null;if(!function(e,t,r){for(var n=0,i=0;i<e.lengths.length;i++){for(var a=e.lengths[i],s=0;s<a;s++){var o=e.coords[2*(s+n)],u=e.coords[2*(s+n)+1];if(o<t||o>r||u<t||u>r)return!0}n+=a}return!1}(e,-128,_.o+128))return e;rt.setPixelMargin(t),rt.reset(B.s.Polygon);for(var r=0,n=0;n<e.lengths.length;n++){var i=e.lengths[n],a=e.coords[2*(0+r)],s=e.coords[2*(0+r)+1];rt.moveTo(a,s);for(var o=1;o<i;o++)a=e.coords[2*(o+r)],s=e.coords[2*(o+r)+1],rt.lineTo(a,s);rt.close(),r+=i}var u=rt.result(!1);if(!u)return null;var c,h=[],f=[],v=(0,l.Z)(u);try{for(v.s();!(c=v.n()).done;){var p,d=c.value,y=0,m=(0,l.Z)(d);try{for(m.s();!(p=m.n()).done;){var x=p.value;f.push(x.x),f.push(x.y),y++}}catch(g){m.e(g)}finally{m.f()}h.push(y)}}catch(g){v.e(g)}finally{v.f()}return new F.t(h,f)}(n,r?256:8):null}}]),r}(e)},dt=M.s.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate"),yt=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,p.Z)(this,r),(n=t.call(this))._ongoingMaterialRequestMap=new Map,n._materialCache=new Map,n._dynamicPropertyMap=new Map,n._cimLayer=e,n}return(0,d.Z)(r,[{key:"analyze",value:function(e,t,r,n,i){var a=this;if(i&&0===i.length)return null;var s=i&&i.length>0,o=t.readLegacyFeature(),u=t.getObjectId(),l=this._materialCache,c=this._cimLayer.materialHash;if(!c)return dt.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);var h="function"==typeof c?c(o,r,n,u):c;if(l.has(h)){var f=l.get(h);return Promise.resolve(f)}var v=this._ongoingMaterialRequestMap.get(h);if(v)return v;var p=this._cimLayer,d=(0,I.s)(p.cim,this._cimLayer.materialOverrides);d.mosaicHash=h;var y=p.type,_=p.url,m={cim:d,type:y,mosaicHash:h,url:_,size:null,dashTemplate:null,text:null,fontName:null,objectId:u,animatedSymbolProperties:null};switch(y){case"marker":m.size=(0,V.e)(p.size,o,r,n),m.animatedSymbolProperties=(0,V.e)(p.animatedSymbolProperties,o,r,n);break;case"line":m.dashTemplate=p.dashTemplate;break;case"text":m.text=(0,V.e)(p.text,o,r,n),m.fontName=(0,V.e)(p.fontName,o,r,n)}var x=e.getMosaicItem(m,i).then((function(e){return s||(a._ongoingMaterialRequestMap.delete(h),l.set(h,e)),e})).catch((function(e){return a._ongoingMaterialRequestMap.delete(h),dt.error(".analyze()",e.message),null}));return s||this._ongoingMaterialRequestMap.set(h,x),x}}]),r}(xe),_t=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i){var a,s;if((0,p.Z)(this,r),(s=t.call(this,e))._minMaxZoom=(0,L.w)(Math.round(n*_.M),Math.round(i*_.M)),oe(e.color)){s._dynamicPropertyMap.set("fillColor",(function(t,r,n){var i=e.color(t,r,n);return i&&(0,x.j)(i)||0}))}else{var u=e.color;s.fillColor=u&&(0,x.j)(u)||0}var l="CIMMarkerPlacementInsidePolygon"===(null===(a=e.cim.placement)||void 0===a?void 0:a.type)&&e.cim.placement.shiftOddRows?2:1,c=e.height;if(oe(c)){s._dynamicPropertyMap.set("_height",(function(e,t,r){return c(e,t,r)*l}))}else s._height=(c||0)*l;var h=e.offsetX;if(oe(h)){s._dynamicPropertyMap.set("_offsetX",(function(e,t,r){return(0,Z.u)(h(e,t,r))}))}else s._offsetX=(0,Z.u)(h||0);var f=e.offsetY;if(oe(f)){s._dynamicPropertyMap.set("_offsetY",(function(e,t,r){return(0,Z.u)(-f(e,t,r))}))}else s._offsetY=(0,Z.u)(-f||0);var v=e.scaleX;oe(v)?s._dynamicPropertyMap.set("_scaleX",v):s._scaleX=v||1;var d=e.angle;if(oe(d)){s._dynamicPropertyMap.set("_angle",(function(e,t,r){return(0,R.h)(d(e,t,r))}))}else s._angle=(0,R.h)(d)||0;if((0,w.r)(e.effects)){var y=e.effects;oe(y)?s._dynamicPropertyMap.set("_effects",y):s._effects=y}return s._cimFillLayer=e,s._bitset=(e.colorLocked?_.$:0)|(e.applyRandomOffset?_.a6:0)|(e.sampleAlphaOnly?_.a5:0),s._fillMaterialKey=P.w.load(e.materialKey),(0,o.Z)(s)}return(0,d.Z)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)}));var a=this._fillMaterialKey,s=this._materialCache,o=(0,this._cimFillLayer.materialHash)(i,t,r),u=s.get(o),l=null;if(u&&j(u.spriteMosaicItem)&&(l=u.spriteMosaicItem),l){var c=l,h=c.rect,f=c.width,v=c.height,p=h.x+_.a,d=h.y+_.a,y=p+f,m=d+v,x=Math.round((0,Z.u)(this._height));x<=0&&(x=m-d);var g=Math.round((0,Z.u)(this._height/v*f||0));g<=0&&(g=y-p);var w=this._scaleX;this.tl=(0,L.w)(p,d),this.br=(0,L.w)(y,m),this.aux2_1=(0,L.w)(g,x),this.aux2_2=(0,L.w)(this._offsetX,this._offsetY),this.aux3=(0,L.x)(w,1,this._angle,0),a.sdf=l.sdf,a.pattern=!0,a.textureBinding=l.textureBinding}else this.tl=0,this.br=0,this.aux2_1=0,this.aux2_2=0,this.aux3=0,a.sdf=!1,a.pattern=!1,a.textureBinding=0;this._materialKey=a.data}}],[{key:"fromCIMFill",value:function(e,t){var n=le(e.scaleInfo,t),i=(0,f.Z)(n,2);return new r(e,i[0],i[1])}}]),r}(pt(yt)),mt=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i){var a;(0,p.Z)(this,r),(a=t.call(this,e))._minMaxZoom=(0,L.w)(Math.round(n*_.M),Math.round(i*_.M)),a._cimLineLayer=e;var s=0;oe(e.width)||(s=.5*(0,Z.u)(e.width));a._dynamicPropertyMap.set("_halfWidth",(function(t,r,n){return oe(e.width)?.5*(0,Z.u)(e.width(t,r,n)):s})),oe(e.cap)?a._dynamicPropertyMap.set("_capType",e.cap):a._capType=e.cap,oe(e.join)?a._dynamicPropertyMap.set("_joinType",e.join):a._joinType=e.join;var o=e.color;if(oe(o)){a._dynamicPropertyMap.set("_fillColor",(function(e,t,r){return(0,x.j)(o(e,t,r))}))}else a._fillColor=o&&(0,x.j)(o)||0;var u=e.miterLimit;if(oe(u)){a._dynamicPropertyMap.set("_miterLimitCosine",(function(e,t,r){return ue(u(e,t,r))}))}else a._miterLimitCosine=ue(u);if((0,w.r)(e.effects)){var l=e.effects;oe(l)?a._dynamicPropertyMap.set("_effects",l):a._effects=l}a._scaleFactor=e.scaleFactor||1,a._isDashed=null!=e.dashTemplate;var c=e.colorLocked?_.$:0,h=e.scaleDash?_.a4:0,f=e.sampleAlphaOnly?_.a5:0;return a.tessellationProperties._bitset=c|h|f,a._materialKey=e.materialKey,a._initializeTessellator(!0),a}return(0,d.Z)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)})),this._halfWidth*=this._scaleFactor;var a=this._materialCache,s=(0,this._cimLineLayer.materialHash)(i,t,r),o=a.get(s),u=null;if(o&&j(o.spriteMosaicItem)&&(u=o.spriteMosaicItem),u){this._hasPattern=!0;var l=u,c=l.rect,h=l.width,f=l.height,v=c.x+_.a,p=c.y+_.a,d=v+h,y=p+f;this.tessellationProperties._tl=(0,L.w)(v,p),this.tessellationProperties._br=(0,L.w)(d,y)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties.offset=0,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;var m=P.C.load(this._materialKey);u&&(m.sdf=u.sdf,m.pattern=!0,m.textureBinding=u.textureBinding),this._materialKey=m.data}}],[{key:"fromCIMLine",value:function(e,t){var n=le(e.scaleInfo,t),i=(0,f.Z)(n,2);return new r(e,i[0],i[1])}}]),r}(ut(yt)),xt=(0,C.n)(),gt=(0,W.n)(),wt=M.s.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate"),Mt=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i){var a;(0,p.Z)(this,r),(a=t.call(this,e))._cimMarkerLayer=e,a._minMaxZoom=(0,L.w)(Math.round(n*_.M),Math.round(i*_.M));var s=e.color;if(oe(s)){a._dynamicPropertyMap.set("_fillColor",(function(e,t,r){return(0,x.j)(s(e,t,r))}))}else a._fillColor=(0,x.j)(s);var o=e.outlineColor;if(oe(o)){a._dynamicPropertyMap.set("_outlineColor",(function(e,t,r){return(0,x.j)(o(e,t,r))}))}else a._outlineColor=(0,x.j)(o);var u=e.size;if(oe(u)){a._dynamicPropertyMap.set("_size",(function(e,t,r){return(0,Z.u)(u(e,t,r))}))}else a._size=(0,Z.u)(u)||0;var l=e.scaleX;oe(l)?a._dynamicPropertyMap.set("_scaleX",l):a._scaleX=l||1;var c=e.offsetX;if(oe(c)){a._dynamicPropertyMap.set("xOffset",(function(e,t,r){return(0,Z.u)(c(e,t,r))}))}else a.xOffset=(0,Z.u)(c)||0;var h=e.offsetY;if(oe(h)){a._dynamicPropertyMap.set("yOffset",(function(e,t,r){return(0,Z.u)(h(e,t,r))}))}else a.yOffset=(0,Z.u)(h)||0;var f=e.outlineWidth;if(oe(f)){a._dynamicPropertyMap.set("_outlineWidth",(function(e,t,r){return(0,Z.u)(f(e,t,r))}))}else a._outlineWidth=(0,Z.u)(f)||0;var v=e.rotation;if(oe(v)?a._dynamicPropertyMap.set("_angle",v):a._angle=v||0,(0,w.r)(e.effects)){var d=e.effects;oe(d)?a._dynamicPropertyMap.set("_effects",d):a._effects=d}if((0,w.r)(e.markerPlacement)){var y=e.markerPlacement;oe(y)?a._dynamicPropertyMap.set("_markerPlacement",y):a._markerPlacement=y}return a._scaleFactor=(0,w.n)(e.scaleFactor,1),a._bitSet=(e.alignment===_.L.MAP?1:0)|(e.colorLocked?1:0)<<1|(e.scaleSymbolsProportionally?1:0)<<3,a._materialKey=e.materialKey,a}return(0,d.Z)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature(),a=e.getObjectId();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)}));var s=this._cimMarkerLayer.materialHash,o="function"==typeof s?s(i,t,r,a):s,u=this._materialCache.get(o);if(u&&j(u.spriteMosaicItem)&&u.spriteMosaicItem){var l=u.spriteMosaicItem,c=this._cimMarkerLayer.sizeRatio,h=l.width/l.height*this._scaleX,f=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,v=this._size,p=v*h,d=this.xOffset,y=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;var m=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/(0,Z.u)(this._cimMarkerLayer.frameHeight):1,x=this._outlineWidth*m,g=(0,Z.u)(this._cimMarkerLayer.referenceSize),w=0,k=0,b=this._cimMarkerLayer.anchorPoint;b&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(w=-b.x/(this._size*h),k=b.y/this._size):(w=b.x,k=b.y)),this._sizeOutlineWidth=(0,L.x)(Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*x),255)),Math.round(Math.min(Math.sqrt(128*g),255))),this.angle=f;var S=Math.round(64*c);this._bitestAndDistRatio=(0,L.w)(this._bitSet,S);var T=l.rect.x+_.a,z=l.rect.y+_.a,I=T+l.width,W=z+l.height;this._texUpperLeft=(0,L.w)(T,z),this._texUpperRight=(0,L.w)(I,z),this._texBottomLeft=(0,L.w)(T,W),this._texBottomRight=(0,L.w)(I,W);var C=P.N.load(this._materialKey);C.sdf=l.sdf,C.pattern=!0,C.textureBinding=l.textureBinding,this._materialKey=C.data,this._anchorX=.5-(.5+w)*l.width/l.width,this._anchorY=.5-(.5+k)*l.height/l.height,p*=c,v*=c,p*=this._scaleFactor,v*=this._scaleFactor,p*=l.rect.width/l.width,v*=l.rect.height/l.height,this._computedWidth=p,this._computedHeight=v,this._applyTransformation(gt,xt),this.xOffset=d,this.yOffset=y}else wt.error(new M.a("mapview-cim","Encountered an error when binding feature"))}}],[{key:"fromCIMMarker",value:function(e,t){var n=le(e.scaleInfo,t),i=(0,f.Z)(n,2);return new r(e,i[0],i[1])}}]),r}(Pe(yt));function kt(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function bt(e,t,r,n){return"string"==typeof e.text?e.text:"function"==typeof e.text?e.text(t,r,n):""}var Zt=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i){var a;(0,p.Z)(this,r),(a=t.call(this,e))._horizontalAlignment="center",a._verticalAlignment="middle",a._textToGlyphs=new Map,a._minMaxZoom=(0,L.w)(Math.round(n*_.M),Math.round(i*_.M));var s=e.scaleFactor||1;a._cimTextLayer=e;var o=e.color;if(oe(o)){a._dynamicPropertyMap.set("_color",(function(e,t,r){return(0,x.j)(o(e,t,r))}))}else a._color=(0,x.j)(o);var u,l=e.outlineColor;if(oe(l)){a._dynamicPropertyMap.set("_haloColor",(function(e,t,r){return(0,x.j)(l(e,t,r))}))}else a._haloColor=(0,x.j)(l);oe(e.size)||(u=Math.min(Math.round((0,Z.u)(e.size*e.sizeRatio)),127));var c;if(a._dynamicPropertyMap.set("_size",(function(t,r,n){return oe(e.size)?Math.min(Math.round((0,Z.u)(e.size(t,r,n)*e.sizeRatio)),127):u})),oe(e.outlineSize)){a._dynamicPropertyMap.set("_haloSize",(function(t,r,n){return Math.min(Math.floor(5*(0,Z.u)(e.outlineSize(t,r,n)*e.sizeRatio)),127)}))}else a._haloSize=Math.min(Math.floor(5*(0,Z.u)(e.outlineSize*e.sizeRatio)),127);oe(e.offsetX)||(c=Math.round((0,Z.u)(e.offsetX*e.sizeRatio)));var h;a._dynamicPropertyMap.set("_xOffset",(function(t,r,n){return oe(e.offsetX)?Math.round((0,Z.u)(e.offsetX(t,r,n)*e.sizeRatio)):c})),oe(e.offsetY)||(h=Math.round((0,Z.u)(e.offsetY*e.sizeRatio)));if(a._dynamicPropertyMap.set("_yOffset",(function(t,r,n){return oe(e.offsetY)?Math.round((0,Z.u)(e.offsetY(t,r,n)*e.sizeRatio)):h})),oe(e.angle)?a._dynamicPropertyMap.set("_angle",e.angle):a._angle=e.angle,oe(e.horizontalAlignment)?a._dynamicPropertyMap.set("_horizontalAlignment",e.horizontalAlignment):a._horizontalAlignment=e.horizontalAlignment,oe(e.verticalAlignment)?a._dynamicPropertyMap.set("_verticalAlignment",e.verticalAlignment):a._verticalAlignment=e.verticalAlignment,(0,w.r)(e.effects)){var f=e.effects;oe(f)?a._dynamicPropertyMap.set("_effects",f):a._effects=f}if((0,w.r)(e.markerPlacement)){var v=e.markerPlacement;oe(v)?a._dynamicPropertyMap.set("_markerPlacement",v):a._textPlacement=v}oe(e.text)?a._dynamicPropertyMap.set("_text",e.text):a._text=e.text,a._scaleFactor=s;var d=Math.min(Math.round((0,Z.u)(e.referenceSize*e.sizeRatio)),127);a._referenceSize=Math.round(Math.sqrt(256*d)),a._materialKey=e.materialKey;var y=P.P.load(a._materialKey);return y.sdf=!0,a._bitset=(e.alignment===_.L.MAP?1:0)|(e.colorLocked?1:0)<<1,a._materialKey=y.data,a._decoration="none",a._lineHeight=1,a._lineWidth=512,a._isCIM=!0,a}return(0,d.Z)(r,[{key:"analyze",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,i,o,u){var l,c,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=i.readLegacyFeature(),c=bt(this._cimTextLayer,l,o,u),e.next=4,(0,a.Z)((0,s.Z)(r.prototype),"analyze",this).call(this,t,i,o,u,kt(c));case 4:return h=e.sent,e.abrupt("return",(h&&h.glyphMosaicItems&&this._textToGlyphs.set(c,h.glyphMosaicItems),h));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();if(this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)})),this._text&&0!==this._text.length){this._size*=this._scaleFactor,this._scale=this._size/_.l,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=(0,S.r)((0,w.n)(this._horizontalAlignment,"center")),this._yAlignD=(0,S.n)((0,w.n)(this._verticalAlignment,"baseline"));var a=this._textToGlyphs.get(this._text);this.bindTextInfo(a,!1)}else this._shapingInfo=null}}],[{key:"fromCIMText",value:function(e,t){var n=le(e.scaleInfo,t),i=(0,f.Z)(n,2);return new r(e,i[0],i[1])}}]),r}(me(yt)),St=128,Lt=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i,a,s,o,u,l,c,h,f,v,d,y,m,x){var g;(0,p.Z)(this,r),(g=t.call(this))._effects=y;var w=P.w.load(e);return n&&(w.sdf=n.sdf,w.pattern=!0,w.textureBinding=n.textureBinding),g.fillColor=i,g.tl=a,g.br=s,g.aux2_1=(0,L.w)(o,u),g.aux2_2=(0,L.w)(l,c),g.aux3=(0,L.x)(h,f,v,0),g._bitset=d,g._minMaxZoom=(0,L.w)(Math.round(m*_.M),Math.round(x*_.M)),g._materialKey=w.data,g}return(0,d.Z)(r,null,[{key:"fromCIMFill",value:function(e,t,n){var i=e.color,a=i&&(0,x.j)(i)||0,s=e.materialKey,o=le(e.scaleInfo,n),u=(0,f.Z)(o,2),l=u[0],c=u[1],h=(e.colorLocked?_.$:0)|(e.applyRandomOffset?_.a6:0)|(e.sampleAlphaOnly?_.a5:0);if(!t)return new r(s,null,a,0,0,0,0,0,0,0,0,0,h,e.effects,l,c);var v=t.rect,p=t.width,d=t.height,y=e.scaleX||1,m=v.x+_.a,g=v.y+_.a,w=m+p,M=g+d,k=e.height,b=y*k,S=Math.round(k);S<=0&&(S=M-g);var P=Math.round(b);P<=0&&(P=w-m);var T=(0,Z.u)(e.offsetX||0),z=(0,Z.u)(-e.offsetY||0);return new r(s,t,a,(0,L.w)(m,g),(0,L.w)(w,M),P,S,T,z,St,St,(0,R.M)(e.angle),h,e.effects,l,c)}},{key:"fromSimpleFill",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.color,s=a&&"esriSFSNull"!==e.style&&(0,x.f)(a)||0,o=i?_.$:0,u=e.materialKey;if(t){var l=t.rect,c=t.width,h=t.height,f=l.x+_.a,v=l.y+_.a,p=f+c,d=v+h,y=(0,L.w)(f,v),m=(0,L.w)(p,d);n=new r(u,t,s,y,m,c,h,0,0,St,St,0,o,null,0,re)}else n=new r(u,null,s,0,0,0,0,0,0,0,0,0,o,null,0,re);return n._maybeAddLineTemplate(e),n}},{key:"fromPictureFill",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=_.a2,a=t.rect,s=t.width,o=t.height,u=a.x+_.a,l=a.y+_.a,c=u+s,h=l+o,f=(0,L.w)(u,l),v=(0,L.w)(c,h),p=Math.round((0,Z.u)(e.width)),d=Math.round((0,Z.u)(e.height)),y=(0,Z.u)(e.xoffset),m=(0,Z.u)(-e.yoffset),x=e.materialKey,g=n?_.$:0,w=new r(x,t,i,f,v,p,d,y,m,St*e.xscale,St*e.yscale,0,g,null,0,re);return w._maybeAddLineTemplate(e),w}}]),r}(pt(xe)),Pt=function(){function e(){(0,p.Z)(this,e),this._resolver=null}return(0,d.Z)(e,[{key:"isHeld",value:function(){return!!this._resolver}},{key:"acquire",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._resolver){e.next=7;break}return e.next=3,this._resolver.promise;case 3:return e.next=5,this.acquire();case 5:e.next=8;break;case 7:this._resolver=(0,M.ap)();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"release",value:function(){var e=this._resolver;this._resolver=null,e.resolve()}}]),e}();function Tt(){return Tt=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.acquire();case 3:return e.next=5,r(i);case 5:t.release(),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),t.release(),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),Tt.apply(this,arguments)}var zt={marker:x.c.MARKER,fill:x.c.FILL,line:x.c.LINE,text:x.c.TEXT},It=function(){function e(t,r,n,i){(0,p.Z)(this,e);var a={minScale:null===r||void 0===r?void 0:r.minScale,maxScale:null===r||void 0===r?void 0:r.maxScale},s=function(e){return e.minScale||e.maxScale?e.minScale+"-"+e.maxScale:""}(a);this.layers=t,this.data=r,this.hash=this._createHash()+s,this.rendererKey=n;var o,u={isOutline:!1,placement:null,symbologyType:x.S.DEFAULT,vvFlags:n},c=(0,l.Z)(t);try{for(c.s();!(o=c.n()).done;){var h=o.value,f=zt[h.type];u.isOutline="line"===h.type&&h.isOutline,h.materialKey=(0,P.f)(f,u),h.maxVVSize=i,h.scaleInfo=a,h.templateHash+=s}}catch(v){c.e(v)}finally{c.f()}}return(0,d.Z)(e,[{key:"type",get:function(){return"expanded-cim"}},{key:"_createHash",value:function(){var e,t="",r=(0,l.Z)(this.layers);try{for(r.s();!(e=r.n()).done;){t+=e.value.templateHash}}catch(n){r.e(n)}finally{r.f()}return t}}]),e}();function Wt(e,t,r){return Ct.apply(this,arguments)}function Ct(){return Ct=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.name){e.next=2;break}throw new M.a("style-symbol-reference-name-missing","Missing name in style symbol reference");case 2:if(!t.styleName||"Esri2DPointSymbolsStyle"!==t.styleName){e.next=4;break}return e.abrupt("return",Et(t,i));case 4:return e.prev=4,e.t0=Rt,e.next=8,(0,H.c)(t,r,i);case 8:return e.t1=e.sent,e.t2=t.name,e.t3=r,e.t4=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 15:return e.prev=15,e.t5=e.catch(4),e.abrupt("return",((0,M.H)(e.t5),null));case 18:case"end":return e.stop()}}),e,null,[[4,15]])}))),Ct.apply(this,arguments)}function Et(e,t){return At.apply(this,arguments)}function At(){return At=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=H.U.replace(/\{SymbolName\}/gi,t.name),e.prev=1,e.next=4,(0,H.j)(i,r);case 4:return a=e.sent,e.abrupt("return",(0,H.p)(a.data));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",((0,M.H)(e.t0),null));case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),At.apply(this,arguments)}function Rt(e,t,r,n){return Ft.apply(this,arguments)}function Ft(){return Ft=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a){var s,o,u,l,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.data,o={portal:i&&(0,w.r)(i.portal)?i.portal:U.B.getDefault(),url:(0,N.j)(t.baseUrl),origin:"portal-item"},u=s.items.find((function(e){return e.name===r})),u){e.next=3;break}throw new M.a("symbolstyleutils:symbol-name-not-found","The symbol name '".concat(r,"' could not be found"),{symbolName:r});case 3:return l=(0,X.i)((0,H.d)(u,"cimRef"),o),(0,K.c)()&&(l=(0,K.a)(l)),e.prev=5,e.next=8,(0,H.j)(l,a);case 8:return c=e.sent,e.abrupt("return",(0,H.p)(c.data));case 12:return e.prev=12,e.t0=e.catch(5),e.abrupt("return",((0,M.H)(e.t0),null));case 15:case"end":return e.stop()}}),e,null,[[5,12]])}))),Ft.apply(this,arguments)}var Bt=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=It,e.next=3,(0,I.Y)(t.data,r,i);case 3:return e.t1=e.sent,e.t2=t.data,e.t3=t.rendererKey,e.t4=t.maxVVSize,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3,e.t4));case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Vt=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if("cim"!==t.type){e.next=4;break}return e.abrupt("return",Bt(t,r,i));case 4:if("web-style"!==t.type){e.next=12;break}return e.next=7,Wt(t,null,a);case 7:return e.t0=e.sent,e.t1=t.rendererKey,e.t2=t.maxVVSize,s={type:"cim",data:e.t0,rendererKey:e.t1,maxVVSize:e.t2},e.abrupt("return",Bt(s,r,i));case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}();function Ot(e){if(!e)return null;var t=e.type,r=e.cim,n=e.url,i={cim:r,type:t,mosaicHash:e.materialHash,url:n,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null};switch(t){case"marker":i.size=e.size,i.path=e.path,i.animatedSymbolProperties=e.animatedSymbolProperties;break;case"line":i.dashTemplate=e.dashTemplate;break;case"text":i.text=e.text,i.fontName=e.fontName}return i}var Dt=M.s.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),Gt=new Array,Kt={isOutline:!1,placement:null,symbologyType:x.S.DEFAULT,vvFlags:0},Nt=(0,u.Z)((0,u.Z)({},A.r),{},{hash:JSON.stringify(A.r),materialKey:(0,P.f)(x.c.MARKER,Kt)}),Ut=(0,u.Z)((0,u.Z)({},A.s),{},{hash:JSON.stringify(A.s),materialKey:(0,P.f)(x.c.LINE,Kt)}),Xt=(0,u.Z)((0,u.Z)({},A.y),{},{hash:JSON.stringify(A.y),materialKey:(0,P.f)(x.c.FILL,Kt)});function Ht(e,t){var r=e.length;return e.push(null),t.then((function(t){return e[r]=t})),e}function jt(e){return!!(1&e)}var Yt=function(){function e(t,r){(0,p.Z)(this,e),this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new Pt,this._fetchResource=t,this._tileInfo=r}return(0,d.Z)(e,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}},{key:"createTemplateGroup",value:function(e,t){this._initErrorTemplates();var r=e.hash;if(this._symbolToTemplate.has(r))return this._symbolToTemplate.get(r);var n=new Array;t&&this._createMeshTemplates(n,t,!0),this._createMeshTemplates(n,e,!1);var i=this._createGroupId("expanded-cim"===e.type&&qt(e));return this._idToTemplateGroup.set(i,n),this._symbolToTemplate.set(r,i),i}},{key:"getTemplateGroup",value:function(e){return this._idToTemplateGroup.has(e)?this._idToTemplateGroup.get(e):Gt}},{key:"getDynamicTemplateGroup",value:function(e){return this._idToTemplateGroup.has(e)?(jt(e)||Dt.error("mapview-template-store","Id ".concat(e," does not refer to a dynamic template")),this._idToTemplateGroup.get(e)):Gt}},{key:"getMosaicItem",value:function(e,t){var r=this,n=this._createTemplateId(),i=new Promise((function(e){return r._idToResolver.set(n,e)}));return this._fetchQueue.push({symbol:e,id:n,glyphIds:t}),i}},{key:"finalize",value:function(e){return this._fetchQueue.length||this._lock.isHeld()?function(e,t,r){return Tt.apply(this,arguments)}(this._lock,this._fetchAllQueuedResources.bind(this),e):Promise.resolve()}},{key:"_initErrorTemplates",value:function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],Xt,!1),marker:this._createMeshTemplates([],Nt,!1),line:this._createMeshTemplates([],Ut,!1)})}},{key:"_fetchAllQueuedResources",value:function(e){var t=this;if(!this._fetchQueue.length)return Promise.resolve();var r=this._fetchQueue,n=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Promise.all(n).then((function(){return t._fetchResource(r,e).then((function(e){var r,n=(0,l.Z)(e);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=i.id,s=i.mosaicItem;t._idToResolver.get(a)(s),t._idToResolver.delete(a)}}catch(o){n.e(o)}finally{n.f()}}))})).catch((function(e){(0,M.u)(e)?t._fetchQueue=t._fetchQueue.concat(r):function(e){return"worker:port-closed"===e.name}(e)||Dt.error(new M.a("mapview-template-store","Unable to fetch requested texture resources",e))}))}},{key:"_createGroupId",value:function(e){return this._idCounter++<<1|(e?1:0)}},{key:"_createTemplateId",value:function(){return this._templateIdCounter++}},{key:"_createSMS",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,i=r.spriteMosaicItem,e.abrupt("return",j(i,Dt)?Te.fromSimpleMarker(t,i):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createPMS",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,i=r.spriteMosaicItem,e.abrupt("return",j(i,Dt)?Te.fromPictureMarker(t,i):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createSFS",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return i=e.sent,a=i.spriteMosaicItem,e.abrupt("return",j(a,Dt)?Lt.fromSimpleFill(t,a,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createPFS",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return i=e.sent,a=i.spriteMosaicItem,e.abrupt("return",j(a,Dt)?Lt.fromPictureFill(t,a,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createSLS",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return i=e.sent,a=i.spriteMosaicItem,e.abrupt("return",j(a,Dt)?vt.fromSimpleLine(t,a):this._lineError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createLMS",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,i=r.spriteMosaicItem,e.abrupt("return",j(i,Dt)?Te.fromLineSymbolMarker(t,i):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createTS",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,i=r.glyphMosaicItems,e.abrupt("return",ge.fromText(t,i));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMText",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(Ot(t),kt(t.text));case 2:return r=e.sent,i=r.glyphMosaicItems,e.abrupt("return",j(i,Dt)?ge.fromCIMText(t,i,this._tileInfo):this._textError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMFill",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(Ot(t));case 2:return r=e.sent,i=r.spriteMosaicItem,e.abrupt("return",j(i,Dt)?Lt.fromCIMFill(t,i,this._tileInfo):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMLine",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(Ot(t));case 2:return r=e.sent,i=r.spriteMosaicItem,e.abrupt("return",j(i,Dt)?vt.fromCIMLine(t,i,this._tileInfo):this._lineError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMMarker",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(Ot(t));case 2:return r=e.sent,i=r.spriteMosaicItem,e.abrupt("return",j(i,Dt)?Te.fromCIMMarker(t,i,this._tileInfo):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIM",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.templateHash,!this._cimTemplateCache.has(r)){e.next=3;break}return e.abrupt("return",this._cimTemplateCache.get(r));case 3:e.t0=t.type,e.next="marker"===e.t0?6:"line"===e.t0?10:"fill"===e.t0?14:"text"===e.t0?18:21;break;case 6:return e.next=8,this._createCIMMarker(t);case 8:return i=e.sent,e.abrupt("break",21);case 10:return e.next=12,this._createCIMLine(t);case 12:return i=e.sent,e.abrupt("break",21);case 14:return e.next=16,this._createCIMFill(t);case 16:return i=e.sent,e.abrupt("break",21);case 18:return e.next=20,this._createCIMText(t);case 20:i=e.sent;case 21:return e.abrupt("return",(this._cimTemplateCache.set(r,i),i));case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createDynamicCIM",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.templateHash,!this._cimTemplateCache.has(r)){e.next=3;break}return e.abrupt("return",this._cimTemplateCache.get(r));case 3:e.t0=t.type,e.next="marker"===e.t0?6:"line"===e.t0?8:"fill"===e.t0?10:"text"===e.t0?12:13;break;case 6:return i=Mt.fromCIMMarker(t,this._tileInfo),e.abrupt("break",13);case 8:return i=mt.fromCIMLine(t,this._tileInfo),e.abrupt("break",13);case 10:return i=_t.fromCIMFill(t,this._tileInfo),e.abrupt("break",13);case 12:i=Zt.fromCIMText(t,this._tileInfo);case 13:return e.abrupt("return",(this._cimTemplateCache.set(r,i),i));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createPrimitiveMeshTemplates",value:function(e,t,r){switch(t.type){case"esriSMS":return Ht(e,this._createSMS(t));case"esriPMS":return Ht(e,this._createPMS(t));case"esriSFS":return Ht(e,this._createSFS(t,r));case"line-marker":return Ht(e,this._createLMS(t));case"esriPFS":return Ht(e,this._createPFS(t,r));case"esriSLS":return Ht(e,this._createSLS(t,!1));case"esriTS":return Ht(e,this._createTS(t));default:return Dt.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),e}}},{key:"_createMeshTemplates",value:function(e,t,r){if(t.type.includes("3d"))return Dt.error("3D symbols are not supported with MapView"),e;if("expanded-cim"===t.type){var n,i=(0,l.Z)(t.layers);try{for(i.s();!(n=i.n()).done;){var a=n.value;"function"==typeof a.materialHash?Ht(e,this._createDynamicCIM(a)):Ht(e,this._createCIM(a))}}catch(c){i.e(c)}finally{i.f()}return e}if("composite-symbol"===t.type){var s,o=(0,l.Z)(t.layers);try{for(o.s();!(s=o.n()).done;){var u=s.value;this._createPrimitiveMeshTemplates(e,u,r)}}catch(c){o.e(c)}finally{o.f()}return e}return"cim"===t.type||"label"===t.type||"web-style"===t.type?e:this._createPrimitiveMeshTemplates(e,t,r)}}]),e}(),qt=function(e){if(!e.layers)return!1;var t,r=(0,l.Z)(e.layers);try{for(r.s();!(t=r.n()).done;){if("function"==typeof t.value.materialHash)return!0}}catch(n){r.e(n)}finally{r.f()}return!1},$t=function(){function e(t,r,n){(0,p.Z)(this,e),this._loadPromise=(0,k.o)(),this._geometryType=t,this._idField=r,this._templateStore=n}return(0,d.Z)(e,[{key:"update",value:function(e,t){(0,w.r)(e.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(e.mesh.labels,t)),this._schema=e}},{key:"_createLabelTemplates",value:function(e,t){var r=new Map;if("simple"===e.type){var n,i=(0,l.Z)(e.classes);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=Se.fromLabelClass(a,t);r.set(a.index,s)}}catch(p){i.e(p)}finally{i.f()}return r}for(var o in e.classes){var u,c=e.classes[o],h=(0,l.Z)(c);try{for(h.s();!(u=h.n()).done;){var f=u.value,v=Se.fromLabelClass(f,t);r.set(f.index,v)}}catch(p){h.e(p)}finally{h.f()}}return r}},{key:"templates",get:function(){return this._templateStore}},{key:"analyze",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a,s,o,u){var c,h,f,v,p,d,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,M.p)(u)){e.next=2;break}return e.abrupt("return");case 2:if(e.t0="dictionary"===i.type,!e.t0){e.next=7;break}return e.next=6,i.analyze(this._idField,t.copy(),r,s,o,u);case 6:c=e.sent;case 7:for(h=0;t.next();)if(void 0,f=c?c[h++]:(0,w.r)(a)&&(0,m.p)(t.getDisplayId())&&1!==t.readAttribute("cluster_count")?a.match(this._idField,t,this._geometryType,s,o):i.match(this._idField,t,this._geometryType,s,o),t.setGroupId(f),jt(f)){v=this._templateStore.getDynamicTemplateGroup(f),p=(0,l.Z)(v);try{for(p.s();!(d=p.n()).done;)(y=d.value)&&y.analyze&&y.analyze(this._templateStore,t,s,o)}catch(n){p.e(n)}finally{p.f()}}return e.next=11,this._loadPromise;case 11:return e.abrupt("return",this._templateStore.finalize(u));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a,s,o){return e.apply(this,arguments)}}()},{key:"analyzeGraphics",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a,s,o){var u,c,h,f,v,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,M.p)(o)){e.next=2;break}return e.abrupt("return");case 2:if(u=t.getCursor(),e.t0=i,!e.t0){e.next=7;break}return e.next=7,i.analyze(this._idField,u.copy(),r,a,s,o);case 7:if(!u.next()){e.next=13;break}if(null!=(c=u.getGroupId())&&-1!==c||(c=i.match(this._idField,u,u.geometryType,a,s),u.setGroupId(c)),jt(c)){h=this._templateStore.getDynamicTemplateGroup(c),f=(0,l.Z)(h);try{for(f.s();!(v=f.n()).done;)(p=v.value)&&p.analyze&&p.analyze(this._templateStore,u,a,s)}catch(n){f.e(n)}finally{f.f()}}u.setGroupId(c);case 11:e.next=7;break;case 13:return e.next=15,this._loadPromise;case 15:return e.abrupt("return",this._templateStore.finalize(o));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a,s){return e.apply(this,arguments)}}()},{key:"writeGraphic",value:function(e,t,r,n){var i=t.getGroupId(),a=t.getDisplayId(),s=this._templateStore.getTemplateGroup(i);if(e.featureStart(t.insertAfter,0),null!=a){if(jt(i)){var o,u=(0,l.Z)(s);try{for(u.s();!(o=u.n()).done;){var c=o.value;c&&c.bindFeature(t,null,null)}}catch(p){u.e(p)}finally{u.f()}}if(s){var h,f=(0,l.Z)(s);try{for(f.s();!(h=f.n()).done;){var v=h.value;v&&v.write(e,t,r,n)}}catch(p){f.e(p)}finally{f.f()}e.featureEnd()}}}},{key:"writeCursor",value:function(e,t,r,n,i,a,s){var o=t.getGroupId(),u=t.getDisplayId(),c=this._templateStore.getTemplateGroup(o),h=this._schema.mesh.sortKey,f=0;if((0,w.r)(h)&&(f=null!=h.fieldIndex?t.getComputedNumericAtIndex(h.fieldIndex):null!=h.field?t.readAttribute(h.field):t.readAttribute(this._idField),f*="asc"===h.order?1:-1),e.featureStart(0,null==f||isNaN(f)?0:f),null!=u&&c){if(jt(o)){var v,p=(0,l.Z)(c);try{for(p.s();!(v=p.n()).done;){v.value.bindFeature(t,r,n)}}catch(m){p.e(m)}finally{p.f()}}var d,y=(0,l.Z)(c);try{for(y.s();!(d=y.n()).done;){d.value.write(e,t,i,s)}}catch(m){y.e(m)}finally{y.f()}if((0,w.r)(a)&&e.hasRecords){var _=a&&this._findLabelRef(c);this._writeLabels(e,t,a,_,i,s)}e.featureEnd()}}},{key:"_findLabelRef",value:function(e){var t,r=(0,l.Z)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n instanceof Te)return n}}catch(i){r.e(i)}finally{r.f()}return null}},{key:"_writeLabels",value:function(e,t,r,n,i,a){var s,o=(0,l.Z)(r);try{for(o.s();!(s=o.n()).done;){var u=s.value;if((0,w.r)(u)&&u){var c=u.glyphs,h=u.rtl,f=u.index,v=this._labelTemplates.get(f);v.setZoomLevel(i),v.bindReferenceTemplate(n),v.bindTextInfo(c,h),v.write(e,t,null,a)}}}catch(p){o.e(p)}finally{o.f()}}}]),e}(),Qt=M.s.getLogger("esri/views/2d/engine/webgl/util/Matcher");function Jt(e,t,r,n){return er.apply(this,arguments)}function er(){return er=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="simple"===e.t0||"heatmap"===e.t0?3:"map"===e.t0?4:"interval"===e.t0?5:"dictionary"===e.t0?6:"pie-chart"===e.t0?7:"subtype"===e.t0?8:9;break;case 3:return e.abrupt("return",rr.fromBasicRenderer(t,r,i,a));case 4:return e.abrupt("return",ar.fromUVRenderer(t,r,i,a));case 5:return e.abrupt("return",ir.fromCBRenderer(t,r,i,a));case 6:return e.abrupt("return",cr.fromDictionaryRenderer(t,r,i,a));case 7:return e.abrupt("return",nr.fromPieChartRenderer(t,r,i,a));case 8:return e.abrupt("return",nr.fromSubtypes(t,r,i,a));case 9:case"end":return e.stop()}}),e)}))),er.apply(this,arguments)}var tr,rr=function(){function e(){(0,p.Z)(this,e),this.type="feature",this._defaultResult=null}return(0,d.Z)(e,[{key:"size",value:function(){return 1}},{key:"getDefault",value:function(){return this._defaultResult}},{key:"setDefault",value:function(e){this._defaultResult=e}},{key:"match",value:function(e,t,r,n,i){return this.getDefault()}},{key:"analyze",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a,s,o){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,i,a,s){return e.apply(this,arguments)}}()}],[{key:"fromBasicRenderer",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s){var o,u,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=new e,!r.symbol){t.next=7;break}return t.next=4,Vt(r.symbol,a,s);case 4:u=t.sent,l=i.createTemplateGroup(u,null),o.setDefault(l);case 7:return t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})));return function(e,r,n,i){return t.apply(this,arguments)}}()},{key:"fromPieChartRenderer",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s){var o,u,l,c;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=new e,!r.markerSymbol){t.next=12;break}return t.next=4,Vt(r.markerSymbol,a,s);case 4:if(u=t.sent,t.t0=r.fillSymbol,!t.t0){t.next=10;break}return t.next=9,Vt(r.fillSymbol,a,s);case 9:l=t.sent;case 10:c=i.createTemplateGroup(u,l),o.setDefault(c);case 12:return t.abrupt("return",o);case 13:case"end":return t.stop()}}),t)})));return function(e,r,n,i){return t.apply(this,arguments)}}()}]),e}(),nr=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n){var i;return(0,p.Z)(this,r),(i=t.call(this))._subMatchers=e,i._subtypeField=n,i}return(0,d.Z)(r,[{key:"match",value:function(e,t,r,n,i){var a=t.readAttribute(this._subtypeField),s=this._subMatchers.get(a);return s?s.match(e,t,r,n,i):null}}],[{key:"fromSubtypes",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,i,a,s){var o,u,l,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c in o=new Map,u=[],l=function(e){var r=parseInt(e,10),n=Jt(t.renderers[e],i,a,s).then((function(e){return o.set(r,e)}));u.push(n)},t.renderers)l(c);return e.next=5,Promise.all(u);case 5:return e.abrupt("return",new r(o,t.subtypeField));case 6:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}()}]),r}(rr),ir=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i,a){var s;return(0,p.Z)(this,r),(s=t.call(this)).type="interval",s._intervals=[],s._isMaxInclusive=n,s._fieldIndex=a,s._field=e,s._normalizationInfo=i,s}return(0,d.Z)(r,[{key:"add",value:function(e,t){this._intervals.push({interval:e,result:t}),this._intervals.sort((function(e,t){return e.interval.min-t.interval.min}))}},{key:"size",value:function(){return(0,a.Z)((0,s.Z)(r.prototype),"size",this).call(this)+this._intervals.length}},{key:"match",value:function(e,t,r,n,i){if(null==this._fieldIndex&&!this._field)return this.getDefault();var a=null!=this._fieldIndex?t.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(t);if(!a&&(null==a||isNaN(a)))return this.getDefault();for(var s=0;s<this._intervals.length;s++){var o=this._intervals[s],u=o.interval,l=o.result,c=a>=u.min,h=this._isMaxInclusive?a<=u.max:a<u.max;if(c&&h)return l}return this.getDefault()}},{key:"_needsNormalization",value:function(){var e=this._normalizationInfo;return e&&(e.normalizationField||e.normalizationTotal||e.normalizationType)}},{key:"_getValueFromField",value:function(e){var t=e.readAttribute(this._field);if(!this._needsNormalization()||null==t)return t;var r=this._normalizationInfo,n=r.normalizationField,i=r.normalizationTotal,a=r.normalizationType,s=!!n&&e.readAttribute(n);if(a)switch(a){case"esriNormalizeByField":return s?t/s:void 0;case"esriNormalizeByLog":return Math.log(t)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return t/i*100;default:return void Qt.error("Found unknown normalization type: ".concat(a))}else Qt.error("Normalization is required, but no type was set!")}}],[{key:"fromCBRenderer",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,a,s,o){var u,l,c,h,f,v,p,d,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.isMaxInclusive,l=t.normalizationField,c=t.normalizationTotal,h=t.normalizationType,f=t.field,v=new r(f,u,{normalizationField:l,normalizationTotal:c,normalizationType:h},t.fieldIndex),e.next=8,Vt(t.backgroundFillSymbol,s,o);case 8:return p=e.sent,e.next=11,Promise.all(t.intervals.map(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vt(t.symbol,s,o);case 2:return r=e.sent,e.next=5,a.createTemplateGroup(r,p);case 5:i=e.sent,u={min:t.min,max:t.max},v.add(u,i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return e.next=13,Vt(t.defaultSymbol,s,o);case 13:if(!(d=e.sent)){e.next=19;break}return e.next=17,a.createTemplateGroup(d,p);case 17:y=e.sent,v.setDefault(y);case 19:return e.abrupt("return",v);case 20:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}()}]),r}(rr),ar=function(e){(0,c.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,i){var a;return(0,p.Z)(this,r),(a=t.call(this)).type="map",a._nullResult=null,a._resultsMap=new Map,a._fieldsIndex=i,a._fields=e,a._seperator=n||"",a}return(0,d.Z)(r,[{key:"setNullResult",value:function(e){this._nullResult=e}},{key:"add",value:function(e,t){this._resultsMap.set(e.toString(),t)}},{key:"size",value:function(){return(0,a.Z)((0,s.Z)(r.prototype),"size",this).call(this)+this._resultsMap.size}},{key:"match",value:function(e,t,r,n,i){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();var a=null!=this._fieldsIndex?t.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(t);if(null!==this._nullResult&&(null==a||""===a||"<Null>"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();var s=a.toString();return this._resultsMap.has(s)?this._resultsMap.get(s):this.getDefault()}},{key:"_getValueFromFields",value:function(e){var t,r=[],n=(0,l.Z)(this._fields);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=e.readAttribute(i);null==a||""===a?r.push("<Null>"):r.push(a)}}catch(s){n.e(s)}finally{n.f()}return r.join(this._seperator)}}],[{key:"fromUVRenderer",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,a,s,o){var u,l,c,h,f,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.fieldDelimiter,l=[t.field],t.field2&&l.push(t.field2),t.field3&&l.push(t.field3),e.next=4,Vt(t.backgroundFillSymbol,s,o);case 4:return c=e.sent,h=new r(l,u,t.fieldIndex),e.next=8,Promise.all(t.map.map(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vt(t.symbol,s,o);case 2:return r=e.sent,e.next=5,a.createTemplateGroup(r,c);case 5:i=e.sent,"<Null>"===t.value?h.setNullResult(i):h.add(t.value,i);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:return e.next=10,Vt(t.defaultSymbol,s,o);case 10:if(!(f=e.sent)){e.next=16;break}return e.next=14,a.createTemplateGroup(f,c);case 14:v=e.sent,h.setDefault(v);case 16:return e.abrupt("return",h);case 17:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}()}]),r}(rr);function sr(e,t){return or.apply(this,arguments)}function or(){return or=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("number"!=typeof(i=t||1)){e.next=3;break}return e.abrupt("return",(function(e,t,r){return i}));case 3:return e.next=5,(0,D.i)(i,r.spatialReference,r.fields);case 5:return a=e.sent,e.abrupt("return",(function(e,t,n){return(0,G.s)(a,e,{$view:n},r.geometryType,t)||1}));case 7:case"end":return e.stop()}}),e)}))),or.apply(this,arguments)}function ur(){return lr.apply(this,arguments)}function lr(){return(lr=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(tr||(tr=r.e(5428).then(r.bind(r,25428))),tr));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var cr=function(e){(0,c.Z)(a,e);var t=(0,h.Z)(a);function a(e,r,n,i,s,o){var u;return(0,p.Z)(this,a),(u=t.call(this)).type="dictionary",u._groupIdCache=new O.e(100),u._loader=e,u._fieldMap=e.fieldMap,u._symbolFields=e.getSymbolFields(),u._templates=r,u._info=n,u._scaleFn=i,u._schemaUtilsModule=s,u._symbolOptions=o,u}return(0,d.Z)(a,[{key:"_analyzeFeature",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a,s){var o,c,h,f,v,p,d,y,_=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.readLegacyFeature(),c=this._scaleFn(o,i,a),h=this._attributeHash(o)+"-"+c,!(f=this._groupIdCache.get(h))){e.next=3;break}return e.abrupt("return",f);case 3:return v=(0,u.Z)((0,u.Z)({},a),{},{spatialReference:this._info.spatialReference,abortOptions:s,fields:this._info.fields}),e.next=6,this._loader.getSymbolAsync(o,v);case 6:return p=e.sent,d=this._schemaUtilsModule.createSymbolSchema(p,this._symbolOptions),y=Vt(d,this._info,r,s).then((function(e){if("expanded-cim"!==e.type)return Qt.error(new M.a("mapview-bad-type","Found unexpected type ".concat(e.type," in dictionary response"))),null;e.hash+="-"+c;var t,r=(0,l.Z)(e.layers);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.scaleFactor=c,n.templateHash+="-"+c}}catch(i){r.e(i)}finally{r.f()}return _._templates.createTemplateGroup(e,null)})),e.abrupt("return",(this._groupIdCache.put(h,y,1),y));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"analyze",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a,s,o){var u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(u=r.getCursor(),l=[];u.next();)l.push(this._analyzeFeature(u,i,a,s,o));return e.abrupt("return",Promise.all(l));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a,s){return e.apply(this,arguments)}}()},{key:"match",value:function(e,t,r,n,i){return null}},{key:"_attributeHash",value:function(e){var t,r="",n=(0,l.Z)(this._symbolFields);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this._fieldMap[i];a&&(r+=e.attributes[a]+"-")}}catch(s){n.e(s)}finally{n.f()}return r}}],[{key:"fromDictionaryRenderer",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,i,s,o){var u,l,c,h,v,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(8210).then(r.bind(r,28210)),ur()]);case 2:return u=e.sent,l=(0,f.Z)(u,2),c=l[0].DictionaryLoader,h=l[1],v=new c(t.url,t.config,t.fieldMap),e.next=9,v.fetchResources({spatialReference:s.spatialReference,fields:s.fields});case 9:return e.next=11,sr(t.scaleExpression,s);case 11:return p=e.sent,e.abrupt("return",new a(v,i,s,p,h,t.symbolOptions));case 13:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}()}]),a}(rr)},25715:function(e,t,r){function n(e){return e=e||globalThis.location.hostname,l.some((function(t){var r;return null!=(null===(r=e)||void 0===r?void 0:r.match(t))}))}function i(e,t){return e&&(t=t||globalThis.location.hostname)?null!=t.match(a)||null!=t.match(o)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(s)||null!=t.match(u)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}r.d(t,{a:function(){return i},c:function(){return n}});var a=/^devext.arcgis.com$/,s=/^qaext.arcgis.com$/,o=/^[\w-]*\.mapsdevext.arcgis.com$/,u=/^[\w-]*\.mapsqa.arcgis.com$/,l=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,a,s,/^jsapps.esri.com$/,o,u]},10200:function(e,t,r){r.d(t,{l:function(){return n}});r(23132),r(80262),r(75610),r(2760),r(34860),r(59819);function n(e,t,r,n){var i=e.clone(),a=1<<i.level,s=i.col+t,o=i.row+r;return n&&s<0?(i.col=s+a,i.world-=1):s>=a?(i.col=s-a,i.world+=1):i.col=s,i.row=o,i}}}]);
//# sourceMappingURL=6267.774f5a6c.chunk.js.map