"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[4544],{69768:function(e,t,r){r.d(t,{c:function(){return h}});var n=r(43144),i=r(15671),o=r(60136),s=r(29388),u=r(48848),a=r(62610),l=r(40114),c=r(93661),d=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).onFields=null,n.operator=null,n.searchTerm=null,n.searchType=null,n}return(0,n.Z)(r)}((0,a.i)(l.l));(0,u.e)([(0,u.y)({type:[String],json:{write:{enabled:!0,overridePolicy:function(){return{enabled:(0,c.r)(this.onFields)&&this.onFields.length>0}}}}})],d.prototype,"onFields",void 0),(0,u.e)([(0,u.y)({type:String,json:{write:!0}})],d.prototype,"operator",void 0),(0,u.e)([(0,u.y)({type:String,json:{write:!0}})],d.prototype,"searchTerm",void 0),(0,u.e)([(0,u.y)({type:String,json:{write:!0}})],d.prototype,"searchType",void 0);var h=d=(0,u.e)([(0,u.n)("esri.rest.support.FullTextSearch")],d)},85700:function(e,t,r){r.d(t,{a:function(){return l},c:function(){return d},e:function(){return p},o:function(){return h},r:function(){return v},t:function(){return c}});var n=r(15671),i=r(43144),o=r(60136),s=r(29388),u=r(93661),a=r(48848);function l(e){return e&&"function"==typeof e.highlight}function c(e){return e&&"function"==typeof e.maskOccludee}function d(e,t,r){return(0,u.t)(e)||e>r&&(0===t||e<t)}function h(e,t){return e>0||t>0}function v(e){var t,r,n=e.effectiveScaleRange;return{minScale:null!==(t=null===n||void 0===n?void 0:n.minScale)&&void 0!==t?t:0,maxScale:null!==(r=null===n||void 0===n?void 0:n.maxScale)&&void 0!==r?r:0}}var p=function(e){var t=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,n.Z)(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).goToOverride=null,e.view=null,e}return(0,i.Z)(r,[{key:"callGoTo",value:function(e){var t=this.view;return this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}}]),r}(e);return(0,a.e)([(0,a.y)()],t.prototype,"goToOverride",void 0),(0,a.e)([(0,a.y)()],t.prototype,"view",void 0),t=(0,a.e)([(0,a.n)("esri.widgets.support.GoTo")],t)}},44544:function(e,t,r){r.r(t);var n,i=r(4942),o=r(93433),s=r(74165),u=r(1413),a=r(15671),l=r(43144),c=r(97326),d=r(60136),h=r(29388),v=r(15861),p=r(48848),f=r(46737),g=r(50690),y=r(93661),m=r(42467),_=r(75255),w=r(64998),S=r(25577),b=r(37944),k=r(93314),M=r(37856),x=r(82474),I=r(65094),R=r(52113),T=r(93116),F=r(85700),L=r(34350),C=r(47855),E=r(74384),Z=r(69768),N=r(53586),O=r(40558),A=(r(46817),r(40114)),P=r(56162),G=r(2473),j=r(3719),D=r(60530),B=(r(42667),r(61118),r(62610),r(59984),r(20302),r(60369),r(92072),r(86086),r(21385),r(89794),r(48200),r(71802),r(85253),r(93209),r(25456),r(46337),r(81556),r(15751),r(74098),r(39994),r(92355),r(6189),r(69717),/https?:\/\/services.*\.arcgis\.com/i),U=/(?:\{([^}]+)\})/g,J=p.a.getLogger("esri.widgets.Search.support.layerSearchUtils");function H(e,t){var r=e.exactMatch,n=void 0!==r&&r,i=e.location,o=e.maxResults,s=e.spatialReference,u=e.source,a=e.sourceIndex,l=e.suggestResult,c=e.view,d=u.layer,h=u.filter,v=u.zoomScale,f=c&&c.scale,g=V(u,c),y=t&&t.signal;return K(d).then((function(){var e=d.popupTemplate;return e?e.getRequiredFields(d.fieldsIndex):null})).then((function(e){var t,r,m,_=d.objectIdField,w=d.returnZ,S=te(u);if(!ne(d,S))throw J.error("invalid-field: displayField is invalid."),new p.s("getResults():invalid-field","displayField is invalid.");var b=e&&e.length?e:[S],k=u.outFields||b,M=q(k);if(k.includes(_)||M||k.push(_),(null===(t=d.floorInfo)||void 0===t?void 0:t.floorField)&&k.push(d.floorInfo.floorField),!M&&!re(d,k))throw J.error("invalid-field: outField is invalid."),new p.s("getResults():invalid-field","outField is invalid.");var x=d.createQuery(),I=u.orderByFields;if(I&&(x.orderByFields=I),s){x.outSpatialReference=s;var R=1/(0,C.$)(s);R&&(x.maxAllowableOffset=R)}var T="mesh"===d.geometryType||"multipatch"===d.geometryType,F=(null===(r=d.capabilities)||void 0===r||null===(m=r.data)||void 0===m?void 0:m.supportsZ)&&!T;if(x.returnZ=F&&!1!==w,x.returnGeometry=!0,x.multipatchOption=T?"xyFootprint":null,k&&(x.outFields=k),i)x.geometry=i;else if(l.key)x.objectIds=[l.key];else{var L=u.searchFields||[S];if(!re(d,L))throw J.error("invalid-field: search field is invalid."),new p.s("getResults():invalid-field","search field is invalid.");if(ee(d)&&(x.num=o),g&&(x.geometry=g),!l.text.trim())return[];var E=l.text,Z=u.prefix,N=void 0===Z?"":Z,O=u.suffix,A=void 0===O?"":O,P=ie("".concat(N).concat(E).concat(A));Y(d)&&Q(d,L)&&!n&&E&&(x.fullText=$({text:E,searchFields:L}));var G=se({searchTerm:P,layer:d,searchFields:L,filter:h,exactMatch:n,query:x,type:"search"});if(x.where=G,!X(x))return[]}return d.queryFeatures(x,{signal:y}).then((function(e){return function(e,t,r,n,i,o,s){return e.features.map((function(e){return ae(e,t,r,n,i,o,s)}))}(e,c,u,a,S,f,v)}))}))}function W(e,t){var r=e.source,n=e.spatialReference,i=e.view,o=e.suggestTerm,s=e.maxSuggestions,u=e.sourceIndex,a=e.exactMatch,l=r.layer,c=r.filter,d=t&&t.signal,h=V(r,i);return K(l).then((function(){if(!ee(l))return[];var e=te(r),t=r.searchFields||[e],i=[];r.suggestionTemplate?r.suggestionTemplate.replace(U,(function(e,t){return i.push(t),e})):i.push(e);var v=q(i);i.includes(l.objectIdField)||v||i.push(l.objectIdField);var f=ne(l,e),g=v||re(l,i),y=re(l,t);if(!f)throw J.error("invalid-field: displayField is invalid."),new p.s("getSuggestions():invalid-field","displayField is invalid.");if(!g)throw J.error("invalid-field: outField is invalid."),new p.s("getSuggestions():invalid-field","outField is invalid.");if(!y)throw J.error("invalid-field: search field is invalid."),new p.s("getSuggestions():invalid-field","search field is invalid.");var m=l.createQuery(),_=r.orderByFields;if(_&&(m.orderByFields=_),m.outSpatialReference=n,m.returnGeometry=!1,m.num=s,m.outFields=i,h&&(m.geometry=h),!o.trim())return[];var w=r.prefix,S=void 0===w?"":w,b=r.suffix,k=void 0===b?"":b,M=ie("".concat(S).concat(o).concat(k));Y(l)&&Q(l,t)&&!a&&o&&(m.fullText=$({text:o,searchFields:t}));var x=se({searchTerm:M,layer:l,searchFields:t,filter:c,exactMatch:a,query:m,type:"suggest"});return m.where=x,X(m)?l.queryFeatures(m,{signal:d}).then((function(t){return function(e,t,r,n){return e.features.map((function(e){return function(e,t,r,n){var i=e.sourceLayer,o=e.attributes,s=i.objectIdField,u=o[s];return{text:ue(e,t.suggestionTemplate,n),key:u,sourceIndex:r}}(e,t,r,n)}))}(t,r,u,e)})):[]}))}function V(e,t){var r=e.filter,n=e.withinViewEnabled,i=t&&t.extent;return r&&r.geometry||(n&&i?i:void 0)}function q(e){return e&&e.includes("*")}function K(e){return z.apply(this,arguments)}function z(){return(z=(0,v.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=4;break}return e.next=4,t.load();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e){return!(!e.fullText&&!e.where)}function Q(e,t){var r=null===e||void 0===e?void 0:e.indexes;return!(!r||null===t||void 0===t||!t.length)&&r.filter((function(e){return"FullText"===e.indexType})).some((function(e){var r,n=(null===(r=e.fields)||void 0===r?void 0:r.split(",").map((function(e){return e.trim().toLowerCase()})))||[];return t.every((function(e){return n.includes(e.toLowerCase())}))}))}function $(e){var t=e.text,r=e.searchFields;return t.trim().split(" ").filter((function(e){return!!e.trim()})).map((function(e){return new Z.c({onFields:r,searchTerm:e,searchType:"prefix"})}))}function Y(e){var t,r,n;return null!==(t=null===e||void 0===e||null===(r=e.capabilities)||void 0===r||null===(n=r.query)||void 0===n?void 0:n.supportsFullTextSearch)&&void 0!==t&&t}function ee(e){var t,r,n;return null!==(t=null===e||void 0===e||null===(r=e.capabilities)||void 0===r||null===(n=r.query)||void 0===n?void 0:n.supportsPagination)&&void 0!==t&&t}function te(e){return e.displayField||e.layer.displayField||function(e){var t,r,n,i;return null!==(t=null===e||void 0===e||null===(r=e.fieldsIndex)||void 0===r||null===(n=r.fields)||void 0===n||null===(i=n.find((function(e){return"string"===e.type})))||void 0===i?void 0:i.name)&&void 0!==t?t:""}(e.layer)}function re(e,t){return!(!e||null===t||void 0===t||!t.length)&&t.every((function(t){return ne(e,t)}))}function ne(e,t){return!!e.getField(t)}function ie(e){return e.replace(/\'/g,"''")}function oe(e,t){var r=t&&t.where;return r?"(".concat(e,") AND (").concat(r,")"):e}function se(e){var t=e.searchTerm,r=e.layer,n=e.searchFields,i=e.filter,o=e.exactMatch,s=e.query,u=e.type,a=r.definitionExpression,l=r.url,c="";return!s.fullText&&t&&n&&n.forEach((function(e){var n=r.getField(e),s="function"==typeof r.getFieldDomain&&r.getFieldDomain(e),a=(s&&"coded-value"===s.type?function(e,t,r){var n=null,i=e.codedValues;return i&&i.some((function(e){var i=e.name,o=r?i:i.toLowerCase();return(r?t:t.toLowerCase())===o&&(n=e.code.toString(),!0)})),n}(s,t,o):null)||t||null;if(null!==a){var d=function(e){var t=e.currentTerm,r=e.field,n=e.filter,i=e.exactMatch,o=e.url,s=e.type,u=r.type,a=r.name;if("string"===u||"date"===u||"global-id"===u){var l=B.test(o),c=l&&function(e){for(var t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!0;return!1}(t)?"N":"";return oe(i&&"search"===s?"".concat(a," = ").concat(c,"'").concat(t,"'"):l?"".concat(a," LIKE ").concat(c,"'".concat(t,"%'")):"".concat("LOWER(".concat(a,")")," LIKE ",c,"'".concat(t.toLowerCase(),"%'")),n)}if("oid"===u||"small-integer"===u||"integer"===u||"single"===u||"double"===u){var d=Number(t);return isNaN(d)?null:oe("".concat(a," = ").concat(d),n)}return oe("".concat(a," = ").concat(t),n)}({currentTerm:a,field:n,filter:i,exactMatch:o,url:l,type:u});d&&(c+=function(e,t){return e?" OR (".concat(t,")"):"(".concat(t,")")}(c,d))}})),a&&c?"(".concat(a,") AND (").concat(c,")"):a||c}function ue(e,t,r){var n=e.sourceLayer,i=e.attributes,o="function"==typeof n.getFieldDomain&&n.getFieldDomain(r);if(t)return(0,f.s)(t,i);if(r&&i){var s=n.getField(r),u=function(e,t){return e[Object.keys(e).find((function(e){return e.toLowerCase()===t.toLowerCase()}))]}(i,r);return null==u?"":o&&"coded-value"===o.type?function(e,t){var r=null,n=e.codedValues;return n&&n.length&&n.some((function(e){return e.code===t&&(r=e.name,!0)})),r}(o,u):"date"===(null===s||void 0===s?void 0:s.type)?(0,N.L)(new Date(u)):"number"==typeof u?u.toString():"string"!=typeof u?"":u.trim()}return""}function ae(e,t,r,n,i,o,s){var u=e.clone(),a=e.sourceLayer,l=a&&a.objectIdField,c=l&&e.attributes[l],d=ue(e,r.searchTemplate,i),h=(0,L.a)(u.geometry,t,o),v="number"==typeof s?(0,L.p)((0,y.y)(h),t,s):h,p=e.clone();return(0,y.r)(v)&&(p.geometry=E.v.fromExtent(v)),{extent:v,target:p,feature:u,key:c,name:d,sourceIndex:n}}var le=n=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).displayField=null,n.exactMatch=null,n.orderByFields=null,n.searchFields=null,n.searchTemplate=null,n.suggestionTemplate=null,n.getResults=function(e,t){return H((0,u.Z)({source:(0,c.Z)(n)},e),t)},n.getSuggestions=function(e,t){return W((0,u.Z)({source:(0,c.Z)(n)},e),t)},n}return(0,l.Z)(r,[{key:"layer",set:function(e){this._set("layer",e),e&&e.load().catch((function(){}))}},{key:"name",get:function(){var e;return null!==(e=this._getLayerTitle())&&void 0!==e?e:""},set:function(e){this._overrideIfSome("name",e)}},{key:"clone",value:function(){return new n({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?(0,y.y)(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?(0,y.y)(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}},{key:"_getFirstStringField",value:function(){var e,t;return null!==(e=null===(t=this.layer.fieldsIndex.fields.find((function(e){return"string"===e.type})))||void 0===t?void 0:t.name)&&void 0!==e?e:""}},{key:"_getDisplayField",value:function(){return this.displayField||this.layer.displayField||this._getFirstStringField()}},{key:"_getSearchFieldsString",value:function(){var e=this.layer,t=this.searchFields;return e.loaded?": ".concat((t||[this._getDisplayField()]).map((function(t){var r=e.getField(t);return r&&r.alias||t})).join(", ")):""}},{key:"_getLayerTitle",value:function(){var e=this.layer;if(e){var t=e.title;return t?"".concat(t).concat(this._getSearchFieldsString()):void 0}}}]),r}(L.i);(0,p.e)([(0,p.y)({json:{read:{source:"field.name"},write:{target:"field.name"}}})],le.prototype,"displayField",void 0),(0,p.e)([(0,p.y)({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],le.prototype,"exactMatch",void 0),(0,p.e)([(0,p.y)({value:null})],le.prototype,"layer",null),(0,p.e)([(0,p.y)()],le.prototype,"name",null),(0,p.e)([(0,p.y)({type:[String],json:{write:!0}})],le.prototype,"orderByFields",void 0),(0,p.e)([(0,p.y)()],le.prototype,"searchFields",void 0),(0,p.e)([(0,p.y)()],le.prototype,"searchTemplate",void 0),(0,p.e)([(0,p.y)()],le.prototype,"suggestionTemplate",void 0);var ce=le=n=(0,p.e)([(0,p.n)("esri.widgets.Search.LayerSearchSource")],le);new O.s({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"}),new O.s({109006:"centimeters",9102:"decimal-degrees",109005:"decimeters",9002:"feet",109009:"inches",9036:"kilometers",9001:"meters",9035:"miles",109007:"millimeters",109012:"nautical-miles",9096:"yards"});var de=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).deviationUnit=null,n.geometries=null,n.maxDeviation=null,n}return(0,l.Z)(r)}(A.l);(0,p.e)([(0,p.y)({type:String,json:{write:!0}})],de.prototype,"deviationUnit",void 0),(0,p.e)([(0,p.y)({json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.v)(e)})).filter(y.r):null}},write:{writer:function(e,t){var r;t.geometries=null!==(r=null===e||void 0===e?void 0:e.map((function(e){return e.toJSON()})))&&void 0!==r?r:null}}}})],de.prototype,"geometries",void 0),(0,p.e)([(0,p.y)({type:Number,json:{write:!0}})],de.prototype,"maxDeviation",void 0),(de=(0,p.e)([(0,p.n)("esri.rest.support.GeneralizeParameters")],de)).from=(0,p.b)(de),new O.s({preserveShape:"preserve-shape"});var he=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).calculationType=null,n.geodesic=null,n.lengthUnit=null,n.polylines=null,n}return(0,l.Z)(r)}(A.l);(0,p.e)([(0,p.y)({type:String,json:{write:!0}})],he.prototype,"calculationType",void 0),(0,p.e)([(0,p.y)({type:Boolean,json:{write:!0}})],he.prototype,"geodesic",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],he.prototype,"lengthUnit",void 0),(0,p.e)([(0,p.y)({type:[E.m],json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.v)(e)})):null}},write:{writer:function(e,t){t.polylines=e.map((function(e){return e.toJSON()}))}}}})],he.prototype,"polylines",void 0),(he=(0,p.e)([(0,p.n)("esri.rest.support.LengthsParameters")],he)).from=(0,p.b)(he),new O.s({esriGeometryOffsetBevelled:"bevelled",esriGeometryOffsetMitered:"mitered",esriGeometryOffsetRounded:"rounded"}),new O.s({9001:"meters",9002:"feet",9036:"kilometers",9093:"miles",109012:"nautical-miles",109001:"yards"});var ve=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).bevelRatio=null,n.geometries=null,n.offsetDistance=null,n.offsetHow=null,n.offsetUnit=null,n}return(0,l.Z)(r)}(A.l);(0,p.e)([(0,p.y)({type:Number,json:{write:!0}})],ve.prototype,"bevelRatio",void 0),(0,p.e)([(0,p.y)({json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.v)(e)})).filter(y.r):null}},write:{writer:function(e,t){var r;t.geometries=null!==(r=null===e||void 0===e?void 0:e.map((function(e){return e.toJSON()})))&&void 0!==r?r:null}}}})],ve.prototype,"geometries",void 0),(0,p.e)([(0,p.y)({type:Number,json:{write:!0}})],ve.prototype,"offsetDistance",void 0),(0,p.e)([(0,p.y)({type:String,json:{write:!0}})],ve.prototype,"offsetHow",void 0),(0,p.e)([(0,p.y)({type:String,json:{write:!0}})],ve.prototype,"offsetUnit",void 0),(ve=(0,p.e)([(0,p.n)("esri.rest.support.OffsetParameters")],ve)).from=(0,p.b)(ve),new O.s({esriGeometryRelationCross:"cross",esriGeometryRelationDisjoint:"disjoint",esriGeometryRelationIn:"in",esriGeometryRelationInteriorIntersection:"interior-intersection",esriGeometryRelationIntersection:"intersection",esriGeometryRelationLineCoincidence:"line-coincidence",esriGeometryRelationLineTouch:"line-touch",esriGeometryRelationOverlap:"overlap",esriGeometryRelationPointTouch:"point-touch",esriGeometryRelationTouch:"touch",esriGeometryRelationWithin:"within",esriGeometryRelationRelation:"relation"});var pe=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).geometries1=null,n.geometries2=null,n.relation=null,n.relationParameter=null,n}return(0,l.Z)(r)}(A.l);(0,p.e)([(0,p.y)({json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.v)(e)})).filter(y.r):null}},write:{writer:function(e,t){var r;t.geometries1=null!==(r=null===e||void 0===e?void 0:e.map((function(e){return e.toJSON()})))&&void 0!==r?r:null}}}})],pe.prototype,"geometries1",void 0),(0,p.e)([(0,p.y)({json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.v)(e)})).filter(y.r):null}},write:{writer:function(e,t){var r;t.geometries2=null!==(r=null===e||void 0===e?void 0:e.map((function(e){return e.toJSON()})))&&void 0!==r?r:null}}}})],pe.prototype,"geometries2",void 0),(0,p.e)([(0,p.y)({type:String,json:{write:!0}})],pe.prototype,"relation",void 0),(0,p.e)([(0,p.y)({type:String,json:{write:!0}})],pe.prototype,"relationParameter",void 0),(pe=(0,p.e)([(0,p.n)("esri.rest.support.RelationParameters")],pe)).from=(0,p.b)(pe),new O.s({0:"default-curve-extension",1:"relocate-ends",2:"keep-end-attributes",4:"no-end-attributes",8:"no-extend-at-from",16:"no-extend-at-to"});var fe=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).extendHow="default-curve-extension",n.polylines=null,n.trimExtendTo=null,n}return(0,l.Z)(r)}(A.l);(0,p.e)([(0,p.y)({type:String,json:{write:!0}})],fe.prototype,"extendHow",void 0),(0,p.e)([(0,p.y)({type:[E.m],json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.v)(e)})):null}},write:{writer:function(e,t){t.polylines=e.map((function(e){return e.toJSON()}))}}}})],fe.prototype,"polylines",void 0),(0,p.e)([(0,p.y)({json:{read:{reader:function(e){return e?(0,P.v)(e):null}},write:{writer:function(e,t){t.trimExtendTo=e.toJSON()}}}})],fe.prototype,"trimExtendTo",void 0),(fe=(0,p.e)([(0,p.n)("esri.rest.support.TrimExtendParameters")],fe)).from=(0,p.b)(fe);var ge=p.a.getLogger("esri.widgets.support.geolocationUtils"),ye={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function me(){return function(){var e=(0,y.h)("esri-geolocation");return e||ge.warn("geolocation-unsupported","Geolocation unsupported."),e}()&&function(){var e=window.isSecureContext;return e||ge.warn("insecure-context","Geolocation requires a secure origin."),e}()}function _e(e,t){var r=e.position,n=e.view;return function(e,t,r){if(!t)return Promise.resolve(e);var n=t.spatialReference;return n.isWGS84?Promise.resolve(e):n.isWebMercator?Promise.resolve((0,x.R)(e)):function(e){if(y.s.geometryServiceUrl)return Promise.resolve(y.s.geometryServiceUrl);var t=T.j.getDefault();return t.load(e).catch((function(){})).then((function(){return t.get("helperServices.geometry.url")}))}(r).then((function(t){if(!t)throw new p.s("geometry-service:missing-url","Geometry service URL is missing");var i=new G.a({geometries:[e],outSpatialReference:n});return(0,G.n)(t,i,r).then((function(e){return e[0]}))}))}(function(e){var t=e&&e.coords;return t?new x.w({longitude:t.longitude,latitude:t.latitude,z:t.altitude||null,spatialReference:{wkid:4326}}):null}(function(e){var t=e&&e.coords||{},r={accuracy:t.accuracy,altitude:t.altitude,altitudeAccuracy:t.altitudeAccuracy,heading:t.heading,latitude:t.latitude,longitude:t.longitude,speed:t.speed};return e?{coords:r,timestamp:e.timestamp}:e}(r)),n,t)}function we(e,t){return e.hasOwnProperty(t)&&null!=e[t]&&""!==e[t]}var Se="esri.widgets.Search.SearchViewModel",be=p.a.getLogger(Se),ke="highlight",Me=k.j.ofType({key:function(e){return e.layer?"layer":"locator"},base:L.i,typeMap:{layer:ce,locator:L.c}}),xe=x.k.WGS84,Ie=/<(?:.|\s)*?>/g,Re=-1,Te=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e))._handles=new p.X,n._gotoController=null,n._searching=null,n._createdFeatureLayers=[],n.autoNavigate=!0,n.autoSelect=!0,n.defaultPopupTemplate=null,n.defaultSources=new Me,n.defaultSymbols={point:new b.n({url:(0,_.a)("esri/images/search/search-symbol-32.png"),size:24,width:24,height:24}),polyline:new b.m({color:[130,130,130,1],width:2}),polygon:new b.a({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},n.includeDefaultSources=!0,n.maxInputLength=128,n.maxResults=6,n.maxSuggestions=6,n.messages=null,n.minSuggestCharacters=3,n.popupEnabled=!0,n.popupTemplate=null,n.portal=T.j.getDefault(),n.resultCount=null,n.resultGraphicEnabled=!0,n.resultGraphic=null,n.results=null,n.selectedSuggestion=null,n.searchAllEnabled=!0,n.selectedResult=null,n.sources=new Me,n.suggestionDelay=350,n.suggestionCount=null,n.suggestions=null,n.suggestionsEnabled=!0,n.view=null,n}return(0,l.Z)(r,[{key:"initialize",value:function(){var e=this,t=function(){var t=(0,v.Z)((0,s.Z)().mark((function t(){var r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,R.u)("esri/widgets/Search/t9n/Search");case 2:r=t.sent,e.messages=r,e.defaultPopupTemplate=new S.k({title:r.searchResult,content:"{Match_addr}"});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t(),this._handles.add([(0,g.l)((function(){return[e.includeDefaultSources,e.view,e.portal]}),(function(){return e._update()}),g.h),(0,I.s)(t)])}},{key:"destroy",value:function(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics(),this._handles.destroy(),this._handles=null}},{key:"activeSource",get:function(){var e;return null!==(e=this.allSources.at(this.activeSourceIndex))&&void 0!==e?e:null}},{key:"activeSourceIndex",get:function(){return 1!==this.allSources.length&&this.searchAllEnabled?Re:0},set:function(e){this._overrideIfSome("activeSourceIndex",e)}},{key:"allPlaceholder",get:function(){var e;return null===(e=this.messages)||void 0===e?void 0:e.allPlaceholder},set:function(e){this._overrideIfSome("allPlaceholder",e)}},{key:"allSources",get:function(){var e=this.sources,t=this.defaultSources,r=this.includeDefaultSources,n="function"==typeof r?r.call(null,{sources:e,defaultSources:t}):r?t.concat(e):e,i=this._get("allSources")||new Me;return i.removeAll(),i.addMany(n.filter(Boolean)),i}},{key:"locationEnabled",get:function(){return this._get("locationEnabled")||me()},set:function(e){if(void 0!==e){var t=me();if(e&&!t){var r=new p.s("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});be.error(r)}this._override("locationEnabled",!!e&&t)}else this._clearOverride("locationEnabled")}},{key:"placeholder",get:function(){var e=this.allSources,t=this.activeSourceIndex,r=this.allPlaceholder;if(t===Re)return r;var n=e.at(t);return n?n.placeholder:""}},{key:"searchTerm",get:function(){return this._get("searchTerm")||""},set:function(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),""===e&&this._clear()}},{key:"state",get:function(){return this._searching?"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}},{key:"updating",get:function(){return null!=this._updatingPromise}},{key:"clear",value:function(){this.searchTerm=""}},{key:"clearGraphics",value:function(){this._removeHighlight(),this._closePopup(),this.view&&this.view.graphics.remove(this.resultGraphic),this._set("resultGraphic",null)}},{key:"search",value:function(e,t){var r=this;this.emit("search-start"),this.clearGraphics();var n=this._createSuggestionForSearch(e),i=this.when().then((function(){return r._getResultsFromSources(n,t).then((function(e){var i;if(null!==(i=(0,y.e)(null===t||void 0===t?void 0:t.signal))&&void 0!==i&&i.aborted)return null;var o={activeSourceIndex:r.activeSourceIndex,searchTerm:n.text,numResults:0,numErrors:0,errors:[],results:[]};r._formatResponse(o,e,n);var s=r._getFirstResult(o.results),u=(n.location&&s?s.name:n.text).replace(Ie,"");return r._set("searchTerm",u),(n.key&&"number"==typeof n.sourceIndex||n.location)&&r._set("selectedSuggestion",n),r._set("results",o.results),r._set("resultCount",o.results.reduce((function(e,t){return e+t.results.length}),0)),r.emit("search-complete",o),r._selectFirstResult(s).then((function(){return o}))}))})).then((function(e){return r._clearSearching(),e}),(function(e){throw r._clearSearching(),e}));return this._searching=i,i}},{key:"searchNearby",value:function(e){var t=this;if(!this.locationEnabled){var r=new p.s("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});return be.error(r),Promise.reject(r)}var n=function(e){return e||(e=ye),new Promise((function(t,r){setTimeout((function(){return r(new p.s("geolocation:timeout","getting the current geolocation position timed out"))}),15e3),navigator.geolocation.getCurrentPosition(t,r,e)}))}().then((function(r){return _e({position:r,view:t.view},e)})).then((function(r){return t.search(r,e)}));return this._searching=n,n.catch((function(){})).then((function(){return t._clearSearching()})),n}},{key:"select",value:function(e){var t=this;if(this.clearGraphics(),!e){var r=new p.s("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});return be.error(r),Promise.reject(r)}var n=this.view,i=we(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),o=this.allSources.at(i);if(!o){var s=new p.s("select:missing-source","Cannot select without a source.",{source:o});return be.error(s),Promise.reject(s)}var u=o instanceof ce?this._getLayerSourcePopupTemplate(o):o.popupTemplate,a=o.resultSymbol||this._getDefaultSymbol(e),l=we(o,"resultGraphicEnabled")?o.resultGraphicEnabled:this.resultGraphicEnabled,c=we(o,"autoNavigate")?o.autoNavigate:this.autoNavigate,d=we(o,"popupEnabled")?o.popupEnabled:this.popupEnabled,h=d?u||this.popupTemplate||this.defaultPopupTemplate:null,v=e.feature;if(!v){var f=new p.s("select:missing-feature","Cannot select without a feature.",{feature:v});return be.error(f),Promise.reject(f)}var g=v.attributes,m=v.geometry,_=v.layer,S=v.sourceLayer,k=(0,L.m)(m),M={layerViewQuery:this._getLayerView(v),elevationQuery:n&&(0,y.r)(k)?(0,L.s)(k,n).catch((function(){return k})):Promise.resolve(k)};return(0,p.E)(M).then((function(r){var s=r.layerViewQuery.value,u=r.elevationQuery.value;a instanceof b.b&&(a.text=e.name);var p=n&&c?e.target||e.extent:null;return((0,y.r)(p)?t._goToSearchResult(p):Promise.resolve()).then((function(){var r,c=s?v:new w.g({geometry:m,symbol:a,attributes:g,layer:_,sourceLayer:S,popupTemplate:h}),p=d&&(null===(r=t.view)||void 0===r?void 0:r.popup),f=p&&c.getEffectivePopupTemplate(p.defaultPopupTemplateEnabled);return f&&n.popup.open({features:[c],location:u}),s&&(0,F.a)(s)&&!f&&t._highlightFeature({graphic:c,layerView:s}),!s&&l&&n&&n.graphics.push(c),t._setResultFloor(e),t._set("selectedResult",e),t._set("resultGraphic",c),t.emit("select-result",{result:e,source:o,sourceIndex:i}),e}))}))}},{key:"suggest",value:function(e,t,r){var n=this,i=e||this.searchTerm;return this.emit("suggest-start",{searchTerm:i}),this._suggestTimer(t,r).then((function(){return n._suggestImmediate(i,r).then((function(e){return n._set("suggestions",e.results),n._set("suggestionCount",e.results.reduce((function(e,t){return e+t.results.length}),0)),n.emit("suggest-complete",e),e}))}))}},{key:"when",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(){var t=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.j)((function(){return!t.updating}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_update",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(){var t,r,n,i=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.portal,r=this.view,!this.includeDefaultSources){e.next=9;break}if(n=this._updatingPromise=(0,p.E)([null===t||void 0===t?void 0:t.load(),null===r||void 0===r?void 0:r.when()]),!this.destroyed){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,n;case 7:if(n===this._updatingPromise){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,(0,g.j)((function(){return i.messages}));case 11:this.destroyed||this._updateDefaultSources(),this._updatingPromise=null;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_clearSearching",value:function(){this._searching=null}},{key:"_convertHelperServices",value:function(){var e,t,r=this,n=null===(e=this.portal)||void 0===e||null===(t=e.helperServices)||void 0===t?void 0:t.geocode;return n?n.map((function(e){if(!1!==e.placefinding){var t=y.s.apiKey&&(0,L.S)(e.url)?{url:L.w}:null,n=L.c.fromJSON((0,u.Z)((0,u.Z)({},e),t)),i=n.url;if((0,L.S)(i)||(0,L.v)(i)||(0,L.x)(i)){var o=n.outFields||["Addr_type","Match_addr","StAddr","City"],s=n.placeholder||r.messages.placeholder,a="number"==typeof n.defaultZoomScale?n.defaultZoomScale:2500;n.set({singleLineFieldName:"SingleLine",outFields:o,placeholder:s,defaultZoomScale:a})}return n.singleLineFieldName?n:void 0}})).filter(Boolean):[]}},{key:"_destroyFeatureLayers",value:function(){this._createdFeatureLayers.forEach((function(e){return null===e||void 0===e?void 0:e.destroy()})),this._createdFeatureLayers=[]}},{key:"_getLayerSources",value:function(e,t){var r,n=this,i=null===(r=this.view)||void 0===r?void 0:r.map;return e.map((function(e){var r=i.findLayerById(e.id);if(r){var o=n._getLayerJSON(e),s=ce.fromJSON(o);return s.placeholder=t,n._getLayer(r,o).then((function(e){s.layer=e})),s}})).filter(Boolean).toArray()}},{key:"_getTableSources",value:function(e,t){var r,n=this,i=null===(r=this.view)||void 0===r?void 0:r.map;return e.map((function(e){var r=i.findTableById(e.id);if(r){var o=n._getLayerJSON(e),s=ce.fromJSON(o);return s.placeholder=t,n._getLayer(r,o).then((function(e){s.layer=e})),s}})).filter(Boolean).toArray()}},{key:"_convertApplicationProperties",value:function(){var e,t,r,n=null===(e=this.view)||void 0===e?void 0:e.map,i=null===n||void 0===n||null===(t=n.applicationProperties)||void 0===t||null===(r=t.viewing)||void 0===r?void 0:r.search;if(!i)return[];var s=i.enabled,u=i.hintText,a=i.layers,l=i.tables;return s?[].concat((0,o.Z)(this._getLayerSources(a,u)),(0,o.Z)(this._getTableSources(l,u))):[]}},{key:"_getSubLayer",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(t,r){var n,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:if(t.allSublayers){e.next=4;break}throw new Error;case 4:if(n=t.allSublayers.find((function(e){return e.id===r.subLayer}))){e.next=7;break}throw new Error;case 7:return e.next=9,n.createFeatureLayer();case 9:return i=e.sent,e.abrupt("return",(this._createdFeatureLayers.push(i),i));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getBuildingSubLayer",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(t,r){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:if("building-component"===(null===(n=t.allSublayers.find((function(e){return e.id===r.subLayer})))||void 0===n?void 0:n.type)){e.next=5;break}throw new Error;case 5:return e.next=7,n.load();case 7:if(null!=n.associatedLayer){e.next=9;break}throw new Error;case 9:return e.next=11,n.associatedLayer.load();case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getLayer",value:function(e,t){return"feature"===e.type||"scene"===e.type||"csv"===e.type||"geojson"===e.type||"ogc-feature"===e.type?Promise.resolve(e):"map-image"===e.type?this._getSubLayer(e,t).catch((function(){var t=new p.s("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return be.error(t),null})):"building-scene"===e.type?this._getBuildingSubLayer(e,t):Promise.resolve(null)}},{key:"_getLayerJSON",value:function(e){return"function"==typeof e.toJSON?e.toJSON():e}},{key:"_updateDefaultSources",value:function(){var e=this.defaultSources,t=this.includeDefaultSources;this._destroyFeatureLayers(),e.removeAll(),t&&e.addMany([].concat((0,o.Z)(this._convertApplicationProperties()),(0,o.Z)(this._convertHelperServices())))}},{key:"_abortGoTo",value:function(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}},{key:"_clear",value:function(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}},{key:"_closePopup",value:function(){var e,t=null===(e=this.view)||void 0===e?void 0:e.popup,r=this.resultGraphic;if(t&&r){var n=t.selectedFeature;n&&n===r&&t.close()}}},{key:"_suggestTimer",value:function(e,t){var r=null!=e?e:this.suggestionDelay;return(0,p.ab)(r,null,t&&t.signal)}},{key:"_createLocationForSearch",value:function(e){return e instanceof w.g?(0,L.m)(e.geometry):e instanceof x.w?e:Array.isArray(e)&&2===e.length?new x.w({longitude:e[0],latitude:e[1]}):null}},{key:"_createSuggestionForSearch",value:function(e){if(e&&we(e,"key")&&we(e,"text")&&we(e,"sourceIndex"))return e;var t=this._createLocationForSearch(e),r="string"==typeof e?e:this.searchTerm,n=this.selectedSuggestion,i=this.selectedResult,o=!e&&n&&i,s=o&&n.key===i.key&&n.sourceIndex===i.sourceIndex,u=o&&n.location;return s||u?n:{location:(0,y.e)(t),text:t?"":r,sourceIndex:null,key:null}}},{key:"_getFirstResult",value:function(e){var t=null;return e&&e.some((function(e){var r=e.results[0],n=!!r;return n&&(t=r),n})),t}},{key:"_selectFirstResult",value:function(e){return this.autoSelect&&e?this.select(e):Promise.resolve(null)}},{key:"_suggestImmediate",value:function(e,t){var r=this;return this.when().then((function(){return r._getSuggestionsFromSources(e,t)})).then((function(n){var i;if(null!==(i=(0,y.e)(null===t||void 0===t?void 0:t.signal))&&void 0!==i&&i.aborted)return null;var o={activeSourceIndex:r.activeSourceIndex,searchTerm:e,numResults:0,numErrors:0,errors:[],results:[]};return r._formatResponse(o,n),o}))}},{key:"_formatSourceResponse",value:function(e,t,r){var n=t&&t.value||[],i=t&&t.error,o=this.allSources.at(r);if(i){var s={sourceIndex:r,source:o,error:i};e.errors.push(s),be.error(i),e.numErrors++}else{var u={sourceIndex:r,source:o,results:n};e.results.push(u),e.numResults+=n.length}}},{key:"_formatResponse",value:function(e,t,r){var n=this;if(t)if(e.activeSourceIndex===Re){var i=r&&we(r,"sourceIndex")&&-1!==r.sourceIndex?r.sourceIndex:void 0;t.forEach((function(t,r){var o=void 0!==i?i:r;n._formatSourceResponse(e,t,o)}))}else this._formatSourceResponse(e,t[0],e.activeSourceIndex)}},{key:"_getResultsFromSources",value:function(e,t){var r=this,n=this.allSources,i=!e.location&&we(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,o=[];if(!n.length){var s=new p.s("search:no-sources-defined","At least one source is required.",{allSources:n});return be.error(s),Promise.reject(s)}return i===Re?n.forEach((function(n,i){o.push(r._getResultsFromSource(e,i,t))})):o.push(this._getResultsFromSource(e,i,t)),(0,p.E)(o)}},{key:"_getSuggestionsFromSources",value:function(e,t){var r=this,n=this.allSources,i=this.activeSourceIndex,o=[];if(!n.length){var s=new p.s("suggest:no-sources-defined","At least one source is required.",{allSources:n});return be.error(s),Promise.reject(s)}return i===Re?n.forEach((function(n,i){o.push(r._getSuggestionsFromSource(e,i,t))})):o.push(this._getSuggestionsFromSource(e,i,t)),(0,p.E)(o)}},{key:"_getResultsFromSource",value:function(e,t,r){var n,i=this.allSources.at(t),o=e.location,s=void 0===o?null:o,u=(null===(n=this.view)||void 0===n?void 0:n.spatialReference)||xe,a=we(i,"maxResults")?i.maxResults:this.maxResults,l=!!(i instanceof ce&&we(i,"exactMatch"))&&i.exactMatch,c=this.view;return i.getResults({view:c,sourceIndex:t,location:s,suggestResult:e,spatialReference:u,exactMatch:l,maxResults:a},r)}},{key:"_getSuggestionsFromSource",value:function(e,t,r){var n=this.allSources.at(t),i=we(n,"suggestionsEnabled")?n.suggestionsEnabled:this.suggestionsEnabled,o=e.length,s=we(n,"minSuggestCharacters")?n.minSuggestCharacters:this.minSuggestCharacters;if(i&&e.trim()&&o>=s){var u,a=(null===(u=this.view)||void 0===u?void 0:u.spatialReference)||xe,l=we(n,"maxSuggestions")?n.maxSuggestions:this.maxSuggestions,c=this.view,d=!!(n instanceof ce&&we(n,"exactMatch"))&&n.exactMatch;return n.getSuggestions({view:c,sourceIndex:t,suggestTerm:e,spatialReference:a,maxSuggestions:l,exactMatch:d},r)}return Promise.resolve(null)}},{key:"_getLayerSourcePopupTemplate",value:function(e){var t=e.layer;if(t)return we(e,"popupTemplate")?e.popupTemplate:t.popupTemplate}},{key:"_getSourceIndexOfResult",value:function(e){var t=this.results,r=null;return t.some((function(t){return t.results.some((function(n){return n===e&&(r=t.sourceIndex,!0)}))})),r}},{key:"_goToSearchResult",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(t){var r,n,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!!t,this._abortGoTo(),n=new AbortController,this._gotoController=n,i={target:{target:t},options:{animate:r,signal:n.signal}},e.next=7,this.callGoTo(i);case 7:this._gotoController=null;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getDefaultSymbol",value:function(e){var t,r=this.defaultSymbols,n=null===(t=e.feature)||void 0===t?void 0:t.geometry;if((0,y.t)(n))return null;switch(n.type){case"point":case"multipoint":return r.point;case"polyline":return r.polyline;case"extent":case"polygon":return r.polygon;default:return null}}},{key:"_removeHighlight",value:function(){this._handles.remove(ke)}},{key:"_getLayerView",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(t){var r,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.view,t&&r&&"building-component"!==t.layer.type&&"subtype-sublayer"!==t.layer.type){e.next=3;break}return e.abrupt("return",null);case 3:return n=t.layer,e.next=6,r.when();case 6:return e.abrupt("return",r.whenLayerView(n));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_highlightFeature",value:function(e){var t=e.graphic,r=e.layerView,n=t.attributes,i=t.layer.objectIdField,o=n&&n[i],s=r.highlight(o||t);this._handles.add(s,ke)}},{key:"_setResultFloor",value:function(e){var t,r,n,i=this.view,o=null===(t=e.feature)||void 0===t?void 0:t.attributes,s=null===(r=e.feature)||void 0===r?void 0:r.sourceLayer;if(s&&"floorInfo"in s&&null!==s&&void 0!==s&&null!==(n=s.floorInfo)&&void 0!==n&&n.floorField&&o){var u=o[s.floorInfo.floorField];null===i||void 0===i||i.emit("select-result-floor",u)}}}]),r}((0,F.e)(M.n.EventedMixin(p.m)));Te.ALL_INDEX=Re,(0,p.e)([(0,p.y)()],Te.prototype,"_searching",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"_updatingPromise",void 0),(0,p.e)([(0,p.y)({readOnly:!0,value:null})],Te.prototype,"activeSource",null),(0,p.e)([(0,p.y)()],Te.prototype,"activeSourceIndex",null),(0,p.e)([(0,p.y)()],Te.prototype,"allPlaceholder",null),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"allSources",null),(0,p.e)([(0,p.y)()],Te.prototype,"autoNavigate",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"autoSelect",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"defaultPopupTemplate",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"defaultSources",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"defaultSymbols",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"includeDefaultSources",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"locationEnabled",null),(0,p.e)([(0,p.y)()],Te.prototype,"maxInputLength",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"maxResults",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"maxSuggestions",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"messages",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"minSuggestCharacters",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"placeholder",null),(0,p.e)([(0,p.y)()],Te.prototype,"popupEnabled",void 0),(0,p.e)([(0,p.y)({type:S.k})],Te.prototype,"popupTemplate",void 0),(0,p.e)([(0,p.y)({type:T.j})],Te.prototype,"portal",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"resultCount",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"resultGraphicEnabled",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"resultGraphic",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"results",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"selectedSuggestion",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"searchAllEnabled",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"selectedResult",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"searchTerm",null),(0,p.e)([(0,p.y)({type:Me})],Te.prototype,"sources",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"state",null),(0,p.e)([(0,p.y)()],Te.prototype,"suggestionDelay",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"suggestionCount",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"suggestions",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"suggestionsEnabled",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Te.prototype,"updating",null),(0,p.e)([(0,p.y)()],Te.prototype,"view",void 0),(0,p.e)([(0,p.y)()],Te.prototype,"clear",null);var Fe=Te=(0,p.e)([(0,p.n)(Se)],Te),Le="esri-search-result-renderer esri-widget",Ce="esri-widget__anchor",Ee="esri-search-result-renderer__more-results--show-more-results",Ze="esri-search-result-renderer__more-results",Ne="esri-search-result-renderer__more-results-list",Oe="esri-search-result-renderer__more-results-item",Ae="esri-search-result-renderer__more-results-list-header",Pe=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e,n){var i;return(0,a.Z)(this,r),(i=t.call(this,e,n)).messages=null,i.showMoreResultsOpen=!1,i.viewModel=null,i}return(0,l.Z)(r,[{key:"render",value:function(){var e=(0,i.Z)({},Ee,this.showMoreResultsOpen);return(0,m.n)("div",{class:Le},(0,m.n)("div",{key:"esri-search-renderer__container",class:this.classes(Ze,e)},this.renderSearchResultName(),this.renderMoreResults()))}},{key:"renderMoreResults",value:function(){return(0,m.n)("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())}},{key:"renderSearchResultName",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.selectedResult,r=t&&t.name||"";return(0,m.n)("div",{key:"esri-search-renderer__result-name",class:Oe},r)}},{key:"renderMoreResultsLists",value:function(){var e,t=this,r=null===(e=this.viewModel)||void 0===e?void 0:e.results;if(this.viewModel.resultCount<2)return null;var n=r.map((function(e){return t.renderMoreResultsList(e)}));return(0,m.n)("div",{key:"esri-search-renderer__more-results-container",class:Ne},n)}},{key:"renderMoreResultsButton",value:function(){var e=this.messages;return this.viewModel.resultCount<2?null:(0,m.n)("div",{key:"esri-search-renderer__more-results-button",class:Oe},(0,m.n)("a",{class:Ce,href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults))}},{key:"renderMoreResultsHeader",value:function(e,t){return(0,m.n)("div",{key:"esri-search-result-renderer__header-".concat(t),class:Ae},e)}},{key:"renderMoreResultsList",value:function(e){var t,r,n=this,i=e.results,o=i.length,s=!!o,u=null===(t=this.viewModel)||void 0===t?void 0:t.selectedResult,a=1===o&&i[0]===u,l=this._getSourceName(e.source,e.sourceIndex),c=(null===(r=this.viewModel)||void 0===r?void 0:r.results.length)>1&&!a?this.renderMoreResultsHeader(l,e.sourceIndex):null,d=s&&i.map((function(e,t){return n.renderMoreResultsListItem(e,t)})),h=s&&!a?(0,m.n)("ul",{key:"esri-search-result-renderer__list-".concat(e.sourceIndex)},d):null;return s?(0,m.n)("div",{key:"esri-search-result-renderer__results-".concat(e.sourceIndex)},c,h):null}},{key:"renderMoreResultsListItem",value:function(e,t){return e!==this.get("viewModel.selectedResult")?(0,m.n)("li",{key:"esri-search-result-renderer__list-item-".concat(t)},(0,m.n)("a",{class:Ce,href:"#",tabindex:"0",bind:this,"data-result":e,onclick:this._selectResultClick,onkeydown:this._selectResultClick},e.name)):null}},{key:"_showMoreResultsClick",value:function(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;var t=this.get("viewModel.view.popup");t&&t.reposition()}},{key:"_selectResultClick",value:function(e){e.preventDefault();var t=e.currentTarget["data-result"];this.viewModel&&this.viewModel.select(t)}},{key:"_getSourceName",value:function(e,t){return t===Fe.ALL_INDEX?this.messages.all:e.name}}]),r}(m.M);(0,p.e)([(0,p.y)(),(0,m.e)("esri/widgets/Search/t9n/Search")],Pe.prototype,"messages",void 0),(0,p.e)([(0,p.y)()],Pe.prototype,"showMoreResultsOpen",void 0),(0,p.e)([(0,p.y)()],Pe.prototype,"viewModel",void 0),(0,p.e)([(0,j.t)()],Pe.prototype,"_showMoreResultsClick",null),(0,p.e)([(0,j.t)()],Pe.prototype,"_selectResultClick",null);var Ge=Pe=(0,p.e)([(0,p.n)("esri.widgets.Search.SearchResultRenderer")],Pe),je="esri-search esri-widget",De="esri-widget__loader",Be="esri-widget__loader-text",Ue="esri-widget__loader-animation",Je="esri-input",He="esri-search--multiple-sources",We="esri-search--loading",Ve="esri-search--searching",qe="esri-search--show-suggestions",Ke="esri-search--sources",ze="esri-search--warning",Xe="esri-search__container",Qe="esri-search__input",$e="esri-search__input-container",Ye="esri-search__form",et="esri-search__submit-button",tt="esri-search__sources-button",rt="esri-search__clear-button",nt="esri-search__source-name",it="esri-search__suggestions-menu",ot="esri-search__suggestions-list",st="esri-search__suggestions-list--current-location",ut="esri-search__sources-menu",at="esri-search__source",lt="esri-search__warning-menu",ct="esri-search__warning-body",dt="esri-search__warning-header",ht="esri-search__warning-text",vt="esri-search__no-value-text",pt="esri-widget--disabled",ft="esri-widget--button",gt="esri-icon-font-fallback-text",yt="esri-icon-locate-circled",mt="esri-menu",_t="esri-menu__list",wt="esri-menu__list-item",St="esri-menu__list-item--active",bt="esri-menu__list-item--focus",kt="esri-menu__header",Mt="esri-icon-search",xt="esri-icon-down-arrow esri-search__sources-button--down",It="esri-icon-up-arrow esri-search__sources-button--up",Rt="esri-icon-close",Tt="esri-icon-notice-triangle",Ft="esri-icon-search",Lt="esri-disabled",Ct=/<[a-z/][\s\S]*>/i,Et=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e,n){var i;return(0,a.Z)(this,r),(i=t.call(this,e,n))._activeMenuItemIndex=-1,i._handles=new p.X,i._inputNode=null,i._menuItemCount=0,i._sourceMenuButtonNode=null,i._sourceListNode=null,i._suggestionListNode=null,i._searchResultRenderer=new Ge,i._locateFailed=null,i._container=null,i.activeMenu="none",i.disabled=!1,i.iconClass=Ft,i.messages=null,i.messagesCommon=null,i.viewModel=new Fe,i._clearActiveMenu=function(){i.activeMenu="none"},i._removeActiveMenu=function(e){var t,r=e.relatedTarget;r&&(null===(t=i._container)||void 0===t?void 0:t.contains(r))||i._clearActiveMenu()},i.addHandles([(0,g.l)((function(){return i.searchTerm}),(function(e){(e&&"warning"===i.activeMenu||!e&&!i.get("viewModel.selectedSuggestion.location"))&&i._clearActiveMenu()})),(0,g.a)((function(){var e;return null===(e=i.viewModel)||void 0===e?void 0:e.allSources}),"change",(function(){return i._watchSourceChanges()})),(0,g.l)((function(){return i.activeMenu}),(function(){return i._resetActiveMenuItemIndex()}),g.h),(0,g.l)((function(){var e;return null===(e=i.viewModel)||void 0===e?void 0:e.defaultPopupTemplate}),(function(e){e&&(e.content=i._renderSearchResultsContent.bind((0,c.Z)(i)))}),g.h)]),i}return(0,l.Z)(r,[{key:"destroy",value:function(){this._handles.destroy(),this._handles=null,this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)}},{key:"displayedSearchTerm",get:function(){return"".concat(this.viewModel.searchTerm).trim()}},{key:"inputId",get:function(){return this._buildId("input")}},{key:"suggestionsMenuId",get:function(){return this._buildId("suggest-menu")}},{key:"sourceMenuId",get:function(){return this._buildId("source-menu")}},{key:"sourceMenuButtonId",get:function(){return this._buildId("source-menu-button")}},{key:"activeSource",get:function(){return this.viewModel.activeSource}},{key:"activeSourceIndex",get:function(){return this.viewModel.activeSourceIndex},set:function(e){this.viewModel.activeSourceIndex=e}},{key:"allPlaceholder",get:function(){return this.viewModel.allPlaceholder},set:function(e){this.viewModel.allPlaceholder=e}},{key:"allSources",get:function(){return this.viewModel.allSources}},{key:"autoNavigate",get:function(){return this.viewModel.autoNavigate},set:function(e){this.viewModel.autoNavigate=e}},{key:"autoSelect",get:function(){return this.viewModel.autoSelect},set:function(e){this.viewModel.autoSelect=e}},{key:"defaultSources",get:function(){return this.viewModel.defaultSources}},{key:"goToOverride",get:function(){return this.viewModel.goToOverride},set:function(e){this.viewModel.goToOverride=e}},{key:"includeDefaultSources",get:function(){return this.viewModel.includeDefaultSources},set:function(e){this.viewModel.includeDefaultSources=e}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"locationEnabled",get:function(){return this.viewModel.locationEnabled},set:function(e){this.viewModel.locationEnabled=e}},{key:"maxResults",get:function(){return this.viewModel.maxResults},set:function(e){this.viewModel.maxResults=e}},{key:"maxSuggestions",get:function(){return this.viewModel.maxSuggestions},set:function(e){this.viewModel.maxSuggestions=e}},{key:"minSuggestCharacters",get:function(){return this.viewModel.minSuggestCharacters},set:function(e){this.viewModel.minSuggestCharacters=e}},{key:"popupEnabled",get:function(){return this.viewModel.popupEnabled},set:function(e){this.viewModel.popupEnabled=e}},{key:"popupTemplate",get:function(){return this.viewModel.popupTemplate},set:function(e){this.viewModel.popupTemplate=e}},{key:"portal",get:function(){return this.viewModel.portal},set:function(e){this.viewModel.portal=e}},{key:"resultGraphic",get:function(){return this.viewModel.resultGraphic},set:function(e){this.viewModel.resultGraphic=e}},{key:"resultGraphicEnabled",get:function(){return this.viewModel.resultGraphicEnabled},set:function(e){this.viewModel.resultGraphicEnabled=e}},{key:"results",get:function(){return this.viewModel.results}},{key:"searchAllEnabled",get:function(){return this.viewModel.searchAllEnabled},set:function(e){this.viewModel.searchAllEnabled=e}},{key:"searchTerm",get:function(){return this.viewModel.searchTerm},set:function(e){this.viewModel.searchTerm=e}},{key:"selectedResult",get:function(){return this.viewModel.selectedResult}},{key:"sources",get:function(){return this.viewModel.sources},set:function(e){this.viewModel.sources=e}},{key:"suggestions",get:function(){return this.viewModel.suggestions}},{key:"suggestionsEnabled",get:function(){return this.viewModel.suggestionsEnabled},set:function(e){this.viewModel.suggestionsEnabled=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"clear",value:function(){this.viewModel.clear()}},{key:"focus",value:function(){var e;null!==(e=this._inputNode)&&void 0!==e&&e.focus(),this.emit("search-focus")}},{key:"blur",value:function(){var e;null!==(e=this._inputNode)&&void 0!==e&&e.blur(),this.emit("search-blur")}},{key:"search",value:function(e){var t=this;this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();var r=new AbortController,n=r.signal;return this._searchController=r,this.viewModel.search(e,{signal:n}).catch((function(e){if(t._searchController===r)return t._clearActiveMenu(),t._searchController=null,e})).then((function(e){if(t._searchController===r)return t.activeMenu=e.numResults?"none":"warning",t._searchController=null,e}))}},{key:"suggest",value:function(e){var t=this;this._cancelSuggest();var r=new AbortController,n=r.signal;return this._suggestController=r,this.viewModel.suggest(e,null,{signal:n}).then((function(e){if(t._suggestController===r)return t._suggestController=null,e.numResults&&t._openSuggestionMenu(),t._scrollToTopSuggestion(),e})).catch((function(){if(t._suggestController===r)return t._suggestController=null,null}))}},{key:"render",value:function(){var e,t=this.viewModel.state,r=(e={},(0,i.Z)(e,Lt,"disabled"===t),(0,i.Z)(e,pt,this.disabled),e);return(0,m.n)("div",{class:this.classes(je,r)},"loading"===t?this.renderLoader():this.renderContainer())}},{key:"renderSubmitButton",value:function(){var e=this.messages,t=this.disabled;return(0,m.n)("button",{"aria-label":e.searchButtonTitle,bind:this,disabled:t,class:this.classes(et,ft),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle,type:"button"},(0,m.n)("span",{"aria-hidden":"true",class:Mt}))}},{key:"renderWarningMenu",value:function(){return(0,m.n)("div",{key:"esri-search__error-menu",class:this.classes(mt,lt)},(0,m.n)("div",{class:ct},this.renderWarning()))}},{key:"renderSourceMenuButton",value:function(){var e=this.messages,t=this.activeMenu,r=this.sourceMenuId,n=this.sourceMenuButtonId,i=this.disabled,o=this.viewModel,s=o.activeSourceIndex;return o.allSources.length>1?(0,m.n)("button",{id:n,key:"esri-search__source-menu-button",bind:this,disabled:i,"aria-label":e.searchIn,title:e.searchIn,"aria-haspopup":"true","aria-expanded":("source"===t).toString(),"aria-controls":r,class:this.classes(tt,ft),onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,afterCreate:m.v,"data-node-ref":"_sourceMenuButtonNode",type:"button"},(0,m.n)("span",{"aria-hidden":"true",class:xt}),(0,m.n)("span",{"aria-hidden":"true",class:It}),(0,m.n)("span",{class:nt},this._getSourceName(s))):null}},{key:"renderSourcesList",value:function(){var e=this,t=this.viewModel,r=t.allSources,n=t.searchAllEnabled,i=this._activeMenuItemIndex,o=this.activeMenu,s=this.sourceMenuId,u=this.sourceMenuButtonId,a="source"===o&&i>-1?this._buildId("source-item",i):null;return r.length>1?(0,m.n)("ul",{"aria-activedescendant":a,"aria-labelledby":u,id:s,role:"menu",bind:this,afterCreate:m.v,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:_t,tabIndex:-1},n?this.renderSource(Fe.ALL_INDEX):null,r.map((function(t,r){return e.renderSource(r)})).toArray()):null}},{key:"renderSourcesMenu",value:function(){return this.viewModel.allSources.length>1?(0,m.n)("div",{key:"esri-search__source-menu",class:this.classes(mt,ut)},this.renderSourcesList()):null}},{key:"renderLoader",value:function(){var e=this.messages,t=this.messagesCommon,r=this.disabled;return(0,m.n)("div",{class:De,key:"base-loader",tabIndex:r?-1:null},(0,m.n)("span",{"aria-hidden":"true",class:Ue}),(0,m.n)("span",{class:gt},e.searchButtonTitle),(0,m.n)("span",{class:Be},t.loading))}},{key:"renderContainer",value:function(){var e,t=this,r=this.viewModel,n=r.allSources,o=r.state,s=this.activeMenu,u=(e={},(0,i.Z)(e,He,n.length>1),(0,i.Z)(e,We,"loading"===o),(0,i.Z)(e,Ve,"searching"===o),(0,i.Z)(e,ze,"warning"===s),(0,i.Z)(e,Ke,"source"===s),(0,i.Z)(e,qe,"suggestion"===s),e);return(0,m.n)("div",{tabIndex:-1,afterCreate:function(e){t._container=e,e.addEventListener("focusout",t._removeActiveMenu)},afterRemoved:function(e){e.removeEventListener("focusout",t._removeActiveMenu)},class:this.classes(u,Xe),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}},{key:"renderClearButton",value:function(){return this.searchTerm?(0,m.n)("button",{bind:this,disabled:this.disabled,class:this.classes(rt,ft),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},(0,m.n)("span",{"aria-hidden":"true",class:Rt})):null}},{key:"renderLocationGroup",value:function(){var e=this.messages,t=this.locationEnabled,r=this.displayedSearchTerm,n=t&&!r,i="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return n?(0,m.n)("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes(_t,ot,st)},(0,m.n)("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),role:"option",class:this.classes(wt,i?bt:null)},(0,m.n)("span",{"aria-hidden":"true",class:yt})," ",e.useCurrentLocation)):null}},{key:"renderInput",value:function(){var e=this.activeMenu,t=this.locationEnabled,r=this.displayedSearchTerm,n=this.messages,i=this.suggestionsMenuId,o=this.inputId,s=this._activeMenuItemIndex,u=this.disabled,a=this.viewModel,l=a.maxInputLength,c=a.placeholder,d=a.searchTerm,h=a.suggestionCount,v=!((!t||r)&&!h),p="suggestion"===e&&s>-1?this._buildId("suggestion-item",s):null;return(0,m.n)("input",{"aria-activedescendant":p,"aria-autocomplete":"list","aria-expanded":(v&&"suggestion"===e).toString(),"aria-controls":v?i:null,"aria-haspopup":"listbox","aria-label":n.searchButtonTitle,bind:this,disabled:u,placeholder:c,maxlength:l,autocomplete:"off",type:"text",class:this.classes(Je,Qe),value:d,id:o,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:m.v,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:d?"":c})}},{key:"renderForm",value:function(){return(0,m.n)("form",{key:"esri-search__form",bind:this,disabled:this.disabled,class:Ye,onsubmit:this._formSubmit,role:"search"},this.renderInput())}},{key:"renderSuggestList",value:function(e){var t=this,r=e.sourceIndex,n=e.results.length,i=e.results;return n?(0,m.n)("ul",{role:"group",key:"esri-search__suggestion-list-".concat(r),class:this.classes(_t,ot)},i.map((function(e){return t.renderSuggestion(e,t._menuItemCount++)}))):null}},{key:"renderSuggestionsGroup",value:function(){var e=this,t=this.viewModel.suggestions;return t?t.map((function(t){return[e.renderSuggestionHeader(t),e.renderSuggestList(t)]})):null}},{key:"renderSuggestionsMenu",value:function(){var e=this.displayedSearchTerm,t=this.locationEnabled,r=this.suggestionsMenuId,n=this.inputId,i=this.viewModel.suggestionCount,o=t&&!e||i;return this._menuItemCount=0,o?(0,m.n)("div",{id:r,key:"esri-search__suggestions-menu",class:this.classes(mt,it),role:"listbox","aria-labelledby":n,bind:this,afterCreate:m.v,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}},{key:"renderInputContainer",value:function(){return(0,m.n)("div",{key:"esri-search__input-container",class:$e},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}},{key:"renderSuggestionHeader",value:function(e){var t=this.viewModel,r=t.allSources,n=t.activeSourceIndex,i=e.sourceIndex,o=e.results.length,s=r.length>1&&n===Fe.ALL_INDEX;return o&&s?(0,m.n)("div",{key:"esri-search__suggestion-header-".concat(i),class:kt},this._getSourceName(i)):null}},{key:"renderSuggestion",value:function(e,t){var r=this._activeMenuItemIndex,n=this.messages,i=this.viewModel.searchTerm;if(i){var o=e.text||n.untitledResult,s=Ct.test(o),u=[];if(s)u.push((0,m.n)("div",{innerHTML:o}));else{var a=this._splitResult(o,i),l=i.toLowerCase();a.forEach((function(e,t){e&&e.length&&(e.toLowerCase()===l?u.push((0,m.n)("strong",{key:t},e)):u.push(e))}))}var c="suggestion"===this.activeMenu&&r===t;return(0,m.n)("li",{bind:this,id:this._buildId("suggestion-item",t),"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===t).toString(),onclick:this._handleSuggestionClick,key:"esri-search__suggestion_".concat(t),"data-suggestion":e,role:"option",class:this.classes(wt,c?bt:null)},u)}}},{key:"renderSource",value:function(e){var t,r=this.viewModel,n=r.activeSourceIndex,o=r.searchAllEnabled,s=(t={},(0,i.Z)(t,St,e===n),(0,i.Z)(t,bt,"source"===this.activeMenu&&e===(o?this._activeMenuItemIndex-1:this._activeMenuItemIndex)),t),u=o?e+1:e;return(0,m.n)("li",{bind:this,key:"esri-search__source-".concat(e),id:this._buildId("source-item",u),"aria-checked":(e===n).toString(),onclick:this._handleSourceClick,"data-source-index":e,role:"menuitemradio",class:this.classes(at,wt,s)},this._getSourceName(e))}},{key:"renderNoResultsWarning",value:function(e){var t=this.messages,r=e?(0,f.s)(t.noResultsFoundForValue,{value:'"'.concat(e,'"')}):t.noResultsFound;return(0,m.n)("div",{key:"esri-search__no_results"},(0,m.n)("div",{class:dt},t.noResults),(0,m.n)("div",{class:ht},r))}},{key:"renderEmptySearchWarning",value:function(){var e=this.messages;return(0,m.n)("div",{key:"esri-search__empty-search"},(0,m.n)("span",{"aria-hidden":"true",class:Tt}),(0,m.n)("span",{class:vt},e.emptyValue))}},{key:"renderLocateWarning",value:function(){var e=this.messages;return(0,m.n)("div",{key:"esri-search__locate-error"},(0,m.n)("span",{"aria-hidden":"true",class:Tt}),(0,m.n)("span",{class:vt},e.locateError))}},{key:"renderWarning",value:function(){var e,t=this.displayedSearchTerm,r=this._locateFailed,n=this.viewModel;return r?this.renderLocateWarning():null!==(e=n.selectedSuggestion)&&void 0!==e&&e.location||t?this.renderNoResultsWarning(t):this.renderEmptySearchWarning()}},{key:"_resetActiveMenuItemIndex",value:function(){this._activeMenuItemIndex=-1}},{key:"_buildId",value:function(e,t){return"".concat(this.id,"-").concat(e).concat(void 0===t?"":"-".concat(t))}},{key:"_watchSourceChanges",value:function(){var e=this,t=this._handles,r=this.viewModel.allSources,n="sources";t.remove(n),r.forEach((function(r){return t.add((0,g.l)((function(){return r.name}),(function(){return e.scheduleRender()})),n)}))}},{key:"_handleSourcesMenuToggleFocus",value:function(){"source"!==this.activeMenu&&this._clearActiveMenu()}},{key:"_handleSourcesMenuToggleClick",value:function(){var e,t="source"===this.activeMenu;this.activeMenu=t?"none":"source",this.renderNow(),"source"===this.activeMenu&&(null===(e=this._sourceListNode)||void 0===e||e.focus())}},{key:"_handleClearButtonClick",value:function(){this.viewModel.clear(),this._focus()}},{key:"_handleSearchButtonClick",value:function(){this.search()}},{key:"_handleSuggestionClick",value:function(e){var t=e.currentTarget["data-suggestion"];t&&(this._focus(),this.search(t))}},{key:"_handleUseCurrentLocationClick",value:function(){this._useCurrentLocation()}},{key:"_useCurrentLocation",value:function(){var e=this;this._focus("none"),this._cancelSuggest(),this._cancelSearch();var t=new AbortController,r=t.signal;this._searchController=t,this.viewModel.searchNearby({signal:r}).then((function(t){e.activeMenu=t.numResults?"none":"warning"})).catch((function(){e._locateFailed=!0,e.activeMenu="warning"})).then((function(){e._searchController=null}))}},{key:"_handleSourceClick",value:function(e){this._setSourceFromMenuItem(e.currentTarget)}},{key:"_setSourceFromMenuItem",value:function(e){var t;if(e){var r=e["data-source-index"];this.viewModel.activeSourceIndex=r,this._clearActiveMenu(),null===(t=this._sourceMenuButtonNode)||void 0===t||t.focus()}}},{key:"_cancelSuggest",value:function(){this._suggestController&&(this._suggestController.abort(),this._suggestController=null)}},{key:"_cancelSearch",value:function(){this._searchController&&(this._searchController.abort(),this._searchController=null),this._locateFailed=!1}},{key:"_handleInputKeyup",value:function(e){var t,r=(0,p.af)(e);if(!e.ctrlKey&&!e.metaKey&&"Copy"!==r&&"ArrowLeft"!==r&&"ArrowRight"!==r&&"Shift"!==r){if("Tab"===r||"Escape"===r||e.shiftKey&&"Tab"===r)return this._cancelSuggest(),void("Escape"===r&&this._clearActiveMenu());var n="Home"===r||"End"===r||"ArrowUp"===r||"ArrowDown"===r;if("Enter"===r&&this._activeMenuItemIndex<0)this._cancelSuggest();else{var i=null===(t=this._suggestionListNode)||void 0===t?void 0:t.getElementsByTagName("li");if(null!==i&&void 0!==i&&i.length){if("suggestion"!==this.activeMenu&&this._openSuggestionMenu(),n)return e.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(r,i,this._suggestionListNode);var o=i[this._activeMenuItemIndex];if("Enter"===r&&o){var s=o["data-suggestion"];return void(s?(this._focus(),this.search(s)):o["data-current-location-item"]&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}}}},{key:"_handleItemNavigation",value:function(e,t,r){var n=this._activeMenuItemIndex;"Home"===e&&(this._activeMenuItemIndex=0),"End"===e&&(this._activeMenuItemIndex=t.length-1),"ArrowUp"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?t.length-1:this._activeMenuItemIndex-1),"ArrowDown"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex===t.length-1?0:this._activeMenuItemIndex+1),n!==this._activeMenuItemIndex&&(0,m.A)(t[this._activeMenuItemIndex],r)}},{key:"_scrollToTopSuggestion",value:function(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}},{key:"_openSuggestionMenu",value:function(){this.activeMenu="suggestion"}},{key:"_handleInputPaste",value:function(e){var t=e.target;this.viewModel.searchTerm!==t.value&&(this.viewModel.searchTerm=t.value),this.viewModel.searchTerm&&this.suggest()}},{key:"_handleSourceMenuKeydown",value:function(e){var t=(0,p.af)(e);if((0,m.k)(t)){e.preventDefault();var r=this._sourceListNode.getElementsByTagName("li")[this._activeMenuItemIndex];this._setSourceFromMenuItem(r)}else"ArrowUp"!==t&&"ArrowDown"!==t&&"End"!==t&&"Home"!==t||e.preventDefault()}},{key:"_handleSourceMenuKeyup",value:function(e){var t,r,n=(0,p.af)(e),i="ArrowUp"===n||"ArrowDown"===n||"End"===n||"Home"===n;if(i&&e.preventDefault(),"Escape"===n)return this._clearActiveMenu(),void(null===(t=this._sourceMenuButtonNode)||void 0===t||t.focus());var o=null===(r=this._sourceListNode)||void 0===r?void 0:r.getElementsByTagName("li");return o&&0!==o.length&&i?("source"!==this.activeMenu&&(this.activeMenu="source"),void this._handleItemNavigation(n,o,this._sourceListNode.parentElement)):void 0}},{key:"_focus",value:function(e){this.focus(),e&&(this.activeMenu=e)}},{key:"_formSubmit",value:function(e){e.preventDefault(),-1===this._activeMenuItemIndex&&this.search()}},{key:"_getSourceName",value:function(e){var t=this.messages,r=this.viewModel.allSources.getItemAt(e);return e===Fe.ALL_INDEX?t.all:r&&r.name||t.untitledSource}},{key:"_splitResult",value:function(e,t){var r=(0,p.ax)(t);return e.replace(new RegExp("(^|)(".concat(r,")(|$)"),"ig"),"$1|$2|$3").split("|")}},{key:"_renderSearchResultsContent",value:function(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}}]),r}(m.M);(0,p.e)([(0,p.y)()],Et.prototype,"_activeMenuItemIndex",void 0),(0,p.e)([(0,p.y)()],Et.prototype,"displayedSearchTerm",null),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"inputId",null),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"suggestionsMenuId",null),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"sourceMenuId",null),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"sourceMenuButtonId",null),(0,p.e)([(0,p.y)()],Et.prototype,"activeMenu",void 0),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"activeSource",null),(0,p.e)([(0,p.y)()],Et.prototype,"activeSourceIndex",null),(0,p.e)([(0,p.y)()],Et.prototype,"allPlaceholder",null),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"allSources",null),(0,p.e)([(0,p.y)()],Et.prototype,"autoNavigate",null),(0,p.e)([(0,p.y)()],Et.prototype,"autoSelect",null),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"defaultSources",null),(0,p.e)([(0,p.y)()],Et.prototype,"disabled",void 0),(0,p.e)([(0,p.y)()],Et.prototype,"goToOverride",null),(0,p.e)([(0,p.y)()],Et.prototype,"iconClass",void 0),(0,p.e)([(0,p.y)()],Et.prototype,"includeDefaultSources",null),(0,p.e)([(0,p.y)()],Et.prototype,"label",null),(0,p.e)([(0,p.y)()],Et.prototype,"locationEnabled",null),(0,p.e)([(0,p.y)()],Et.prototype,"maxResults",null),(0,p.e)([(0,p.y)()],Et.prototype,"maxSuggestions",null),(0,p.e)([(0,p.y)(),(0,m.e)("esri/widgets/Search/t9n/Search")],Et.prototype,"messages",void 0),(0,p.e)([(0,p.y)(),(0,m.e)("esri/t9n/common")],Et.prototype,"messagesCommon",void 0),(0,p.e)([(0,p.y)()],Et.prototype,"minSuggestCharacters",null),(0,p.e)([(0,p.y)()],Et.prototype,"popupEnabled",null),(0,p.e)([(0,p.y)()],Et.prototype,"popupTemplate",null),(0,p.e)([(0,p.y)()],Et.prototype,"portal",null),(0,p.e)([(0,p.y)()],Et.prototype,"resultGraphic",null),(0,p.e)([(0,p.y)()],Et.prototype,"resultGraphicEnabled",null),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"results",null),(0,p.e)([(0,p.y)()],Et.prototype,"searchAllEnabled",null),(0,p.e)([(0,p.y)()],Et.prototype,"searchTerm",null),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"selectedResult",null),(0,p.e)([(0,p.y)()],Et.prototype,"sources",null),(0,p.e)([(0,p.y)({readOnly:!0})],Et.prototype,"suggestions",null),(0,p.e)([(0,p.y)()],Et.prototype,"suggestionsEnabled",null),(0,p.e)([(0,p.y)()],Et.prototype,"view",null),(0,p.e)([(0,D.e)(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),(0,p.y)({type:Fe})],Et.prototype,"viewModel",void 0);var Zt=Et=(0,p.e)([(0,p.n)("esri.widgets.Search")],Et);t.default=Zt},3719:function(e,t,r){r.d(t,{t:function(){return i}});var n=r(42467);function i(){return function(e,t){if(!e[t])throw new TypeError("Cannot auto bind undefined function '".concat(t,"'"));return{value:s(e[t])}}}function o(e){var t=e.type;return e instanceof KeyboardEvent||"keyup"===t||"keydown"===t||"keypress"===t}function s(e){return function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];o(t)?(0,n.k)(t.key)&&(t.preventDefault(),t.stopPropagation(),t.target.click()):e.call.apply(e,[this,t].concat(i))}}},46737:function(e,t,r){r.d(t,{s:function(){return p}});var n=r(74165),i=r(15671),o=r(43144),s=r(15861),u=r(53586),a=r(48848),l=r(93661),c=(r(65094),r(52113)),d=r(40558),h=r(75255),v=a.a.getLogger("esri.intl.substitute");function p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.format,i=void 0===n?{}:n;return(0,a.H)(e,(function(e){return f(e,t,i)}))}function f(e,t,r){var n,i,o,s=e.indexOf(":");if(-1===s?i=e.trim():(i=e.slice(0,s).trim(),o=e.slice(s+1).trim()),!i)return"";var a=(0,l.a)(i,t);if(null==a)return"";var c=null!==(n=o?null===r||void 0===r?void 0:r[o]:null)&&void 0!==n?n:null===r||void 0===r?void 0:r[i];return c?function(e,t){switch(t.type){case"date":return(0,u.L)(e,t.intlOptions);case"number":return(0,u.m)(e,t.intlOptions);default:return v.warn("missing format descriptor for key {key}"),g(e)}}(a,c):o?function(e,t){switch(t.toLowerCase()){case"dateformat":return(0,u.L)(e);case"numberformat":return(0,u.m)(e);default:return v.warn("inline format is unsupported since 4.12: ".concat(t)),/^(dateformat|datestring)/i.test(t)?(0,u.L)(e):/^numberformat/i.test(t)?(0,u.m)(e):g(e)}}(a,o):g(a)}function g(e){switch(typeof e){case"string":return e;case"number":return(0,u.m)(e);case"boolean":return""+e;default:return e instanceof Date?(0,u.L)(e):""}}function y(){return y=(0,s.Z)((0,n.Z)().mark((function e(t,r,i,o){var s,u,l,d,h,v,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r.exec(i)){e.next=3;break}throw new a.s("esri-intl:invalid-bundle",'Bundle id "'.concat(i,'" is not compatible with the pattern "').concat(r,'"'));case 3:return u=s[1]?"".concat(s[1],"/"):"",l=s[2],d=(0,c.h)(o),h="".concat(u).concat(l,".json"),v=d?"".concat(u).concat(l,"_").concat(d,".json"):h,e.prev=4,e.next=7,m(t(v));case 7:case 17:p=e.sent,e.next=23;break;case 10:if(e.prev=10,e.t0=e.catch(4),v!==h){e.next=14;break}throw new a.s("intl:unknown-bundle",'Bundle "'.concat(i,'" cannot be loaded'),{error:e.t0});case 14:return e.prev=14,e.next=17,m(t(h));case 20:throw e.prev=20,e.t1=e.catch(14),new a.s("intl:unknown-bundle",'Bundle "'.concat(i,'" cannot be loaded'),{error:e.t1});case 23:return e.abrupt("return",p);case 24:case"end":return e.stop()}}),e,null,[[4,10],[14,20]])}))),y.apply(this,arguments)}function m(e){return _.apply(this,arguments)}function _(){return(_=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,l.r)(b.fetchBundleAsset)){e.next=2;break}return e.abrupt("return",b.fetchBundleAsset(t));case 2:return e.next=4,(0,d.U)(t,{responseType:"text"});case 4:return r=e.sent,e.abrupt("return",JSON.parse(r.data));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=function(){function e(t){var r,n=t.base,o=void 0===n?"":n,s=t.pattern,u=t.location,a=void 0===u?new URL(window.location.href):u;(0,i.Z)(this,e),r="string"==typeof a?function(e){return new URL(e,new URL(a,window.location.href)).href}:a instanceof URL?function(e){return new URL(e,a).href}:a,this.pattern="string"==typeof s?new RegExp("^".concat(s)):s,this.getAssetUrl=r,o=o?o.endsWith("/")?o:o+"/":"",this.matcher=new RegExp("^".concat(o,"(?:(.*)/)?(.*)$"))}return(0,o.Z)(e,[{key:"fetchMessageBundle",value:function(e,t){return function(e,t,r,n){return y.apply(this,arguments)}(this.getAssetUrl,this.matcher,e,t)}}]),e}();var S,b={};(0,c.l)((S={pattern:"esri/",location:h.a},new w(S)))},2473:function(e,t,r){r.d(t,{a:function(){return y},n:function(){return _}});var n=r(74165),i=r(1413),o=r(15861),s=r(15671),u=r(43144),a=r(60136),l=r(29388),c=r(40558),d=r(48848),h=r(56162),v=r(39994),p=r(69717),f=r(40114),g=(r(93661),function(e){(0,a.Z)(r,e);var t=(0,l.Z)(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e)).geometries=null,n.outSpatialReference=null,n.transformation=null,n.transformForward=null,n}return(0,u.Z)(r,[{key:"toJSON",value:function(){var e=this.geometries.map((function(e){return e.toJSON()})),t=this.geometries[0],r={};return r.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),r.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),r.geometries=JSON.stringify({geometryType:(0,h.c)(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(r.transformForward=this.transformForward),r}}]),r}(f.l));(0,d.e)([(0,d.y)()],g.prototype,"geometries",void 0),(0,d.e)([(0,d.y)({json:{read:{source:"outSR"}}})],g.prototype,"outSpatialReference",void 0),(0,d.e)([(0,d.y)()],g.prototype,"transformation",void 0),(0,d.e)([(0,d.y)()],g.prototype,"transformForward",void 0);var y=g=(0,d.e)([(0,d.n)("esri.rest.support.ProjectParameters")],g),m=(0,d.b)(y);function _(e,t,r){return w.apply(this,arguments)}function w(){return w=(0,o.Z)((0,n.Z)().mark((function e(t,r,o){var s,u,a,l,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=m(r),s=(0,v.f)(t),u=(0,i.Z)((0,i.Z)({},s.query),{},{f:"json"},r.toJSON()),a=r.outSpatialReference,l=(0,h.c)(r.geometries[0]),d=(0,v.i)(u,o),e.abrupt("return",(0,c.U)(s.path+"/project",d).then((function(e){var t=e.data.geometries;return(0,p.o)(t,l,a)})));case 3:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}},50690:function(e,t,r){r.d(t,{P:function(){return h},U:function(){return v},a:function(){return a},f:function(){return s},h:function(){return p},j:function(){return l},l:function(){return o},w:function(){return f}});var n=r(48848),i=r(93661);function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u(e,t,r,c)}function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u(e,t,r,d)}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,s=null,u=r.once?function(e,r){o(e)&&((0,i.f)(s),t(e,r))}:function(e,r){o(e)&&t(e,r)};if(s=(0,n.P)(e,u,r.sync,r.equals),r.initial){var a=e();u(a,a)}return s}function a(e,t,r){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=null,a=null,l=null;function c(){var e;u&&a&&(a.remove(),null!==(e=s.onListenerRemove)&&void 0!==e&&e.call(s,u),u=null,a=null)}function d(e){s.once&&s.once&&(0,i.f)(l),r(e)}var h=o(e,(function(e,r){var i;c(),(0,n.B)(e)&&(u=e,a=(0,n.C)(e,t,d),null===(i=s.onListenerAdd)||void 0===i||i.call(s,e))}),{sync:s.sync,initial:!0});return l=(0,n.D)((function(){h.remove(),c()}))}function l(e,t){return function(e,t,r){if((0,n.p)(r))return Promise.reject((0,n.d)());var o=e();if(null!==t&&void 0!==t&&t(o))return Promise.resolve(o);var s=null;function a(){s=(0,i.f)(s)}return new Promise((function(i,o){s=(0,n.F)([(0,n.v)(r,(function(){a(),o((0,n.d)())})),u(e,(function(e){a(),i(e)}),{sync:!1,once:!0},null!==t&&void 0!==t?t:c)])}))}(e,d,t)}function c(e){return!0}function d(e){return!!e}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!1,i=o(e,(function(e,r){n||t(e,r)}),r);return{remove:function(){i.remove()},pause:function(){n=!0},resume:function(){n=!1}}}var v={sync:!0},p={initial:!0},f={sync:!0,initial:!0}},69717:function(e,t,r){r.d(t,{o:function(){return o},r:function(){return i}});var n=r(56162);function i(e){return{geometryType:(0,n.c)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function o(e,t,r){var i=(0,n.d)(t);return e.map((function(e){var t=i.fromJSON(e);return t.spatialReference=r,t}))}},60530:function(e,t,r){r.d(t,{e:function(){return i}});var n=r(93433);function i(e){return function(t){t.hasOwnProperty("_delegatedEventNames")||(t._delegatedEventNames=t._delegatedEventNames?t._delegatedEventNames.slice():[]);var r=t._delegatedEventNames,i=Array.isArray(e)?e:function(e){return e.split(",").map((function(e){return e.trim()}))}(e);r.push.apply(r,(0,n.Z)(i))}}}}]);
//# sourceMappingURL=4544.d649fc81.chunk.js.map