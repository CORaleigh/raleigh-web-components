"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[4853,2235,8999],{28681:function(e,t,r){r.d(t,{i:function(){return s}});var n=r(15671),i=r(43144),o=r(60136),a=r(29388),u=r(23132);r(75610);var s=function(e){var t=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"apiKey",get:function(){var e;return this._isOverridden("apiKey")?this._get("apiKey"):"portalItem"in this?null===(e=this.portalItem)||void 0===e?void 0:e.apiKey:null},set:function(e){null!=e?this._override("apiKey",e):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}}]),r}(e);return(0,u.e)([(0,u.d)({type:String})],t.prototype,"apiKey",null),t=(0,u.e)([(0,u.n)("esri.layers.mixins.APIKeyMixin")],t)}},77129:function(e,t,r){r.d(t,{m:function(){return f}});var n,i=r(15671),o=r(43144),a=r(60136),u=r(29388),s=r(23132),l=r(78674),p=r(70441),c=r(75610),d=n=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).color=new l.l([0,0,0,1]),n}return(0,o.Z)(r,[{key:"clone",value:function(){return new n((0,c.m)({color:this.color}))}}]),r}(p.l);(0,s.e)([(0,s.d)({type:l.l,json:{write:!0}})],d.prototype,"color",void 0);var f=d=n=(0,s.e)([(0,s.n)("esri.webmap.background.ColorBackground")],d)},50905:function(e,t,r){r.d(t,{n:function(){return m},p:function(){return y}});var n=r(43144),i=r(15671),o=r(60136),a=r(29388),u=r(23132),s=r(2157),l=r(70441),p=(r(75610),r(30709)),c=r(43124),d=new(r(57714).s)({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"}),f=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.description=null,n.drawingTool=null,n.prototype=null,n.thumbnail=null,n}return(0,n.Z)(r)}((0,s.l)(l.l));(0,u.e)([(0,u.d)({json:{write:!0}})],f.prototype,"name",void 0),(0,u.e)([(0,u.d)({json:{write:!0}})],f.prototype,"description",void 0),(0,u.e)([(0,u.d)({json:{read:d.read,write:d.write}})],f.prototype,"drawingTool",void 0),(0,u.e)([(0,u.d)({json:{write:!0}})],f.prototype,"prototype",void 0),(0,u.e)([(0,u.d)({json:{write:!0}})],f.prototype,"thumbnail",void 0);var y=f=(0,u.e)([(0,u.n)("esri.layers.support.FeatureTemplate")],f),v=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).id=null,n.name=null,n.domains=null,n.templates=null,n}return(0,n.Z)(r,[{key:"readDomains",value:function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];t[i]=(0,c.t)(e[i])}return t}},{key:"writeDomains",value:function(e,t){for(var r={},n=0,i=Object.keys(e);n<i.length;n++){var o,a=i[n];e[a]&&(r[a]=null===(o=e[a])||void 0===o?void 0:o.toJSON())}t.domains=r}}]),r}((0,s.l)(l.l));(0,u.e)([(0,u.d)({json:{write:!0}})],v.prototype,"id",void 0),(0,u.e)([(0,u.d)({json:{write:!0}})],v.prototype,"name",void 0),(0,u.e)([(0,u.d)({json:{write:!0}})],v.prototype,"domains",void 0),(0,u.e)([(0,p.o)("domains")],v.prototype,"readDomains",null),(0,u.e)([(0,p.r)("domains")],v.prototype,"writeDomains",null),(0,u.e)([(0,u.d)({type:[y],json:{write:!0}})],v.prototype,"templates",void 0);var m=v=(0,u.e)([(0,u.n)("esri.layers.support.FeatureType")],v)},43124:function(e,t,r){r.d(t,{n:function(){return N},p:function(){return v},t:function(){return O},u:function(){return k},y:function(){return E}});var n,i=r(15671),o=r(43144),a=r(60136),u=r(29388),s=r(23132),l=r(57714),p=r(70441),c=r(75610),d=r(50448),f=r(30709),y=r(69797),v=n=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.code=null,n}return(0,o.Z)(r,[{key:"clone",value:function(){return new n({name:this.name,code:this.code})}}]),r}(p.l);(0,s.e)([(0,s.d)({type:String,json:{write:!0}})],v.prototype,"name",void 0),(0,s.e)([(0,s.d)({type:[String,Number],json:{write:!0}})],v.prototype,"code",void 0),v=n=(0,s.e)([(0,s.n)("esri.layers.support.CodedValue")],v);var m=new l.s({inherited:"inherited",codedValue:"coded-value",range:"range"}),h=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.type=null,n}return(0,o.Z)(r)}(p.l);(0,s.e)([(0,s.d)({type:String,json:{write:!0}})],h.prototype,"name",void 0),(0,s.e)([(0,d.r)(m)],h.prototype,"type",void 0);var g,w=h=(0,s.e)([(0,s.n)("esri.layers.support.Domain")],h),b=g=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).codedValues=null,n.type="coded-value",n}return(0,o.Z)(r,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some((function(e){return String(e.code)===r&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new g({codedValues:(0,c.m)(this.codedValues),name:this.name})}}]),r}(w);(0,s.e)([(0,s.d)({type:[v],json:{write:!0}})],b.prototype,"codedValues",void 0),(0,s.e)([(0,d.r)({codedValue:"coded-value"})],b.prototype,"type",void 0);var S,k=b=g=(0,s.e)([(0,s.n)("esri.layers.support.CodedValueDomain")],b),Z=S=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).type="inherited",n}return(0,o.Z)(r,[{key:"clone",value:function(){return new S}}]),r}(w);(0,s.e)([(0,d.r)({inherited:"inherited"})],Z.prototype,"type",void 0);var I,T=Z=S=(0,s.e)([(0,s.n)("esri.layers.support.InheritedDomain")],Z),x=I=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).maxValue=null,n.minValue=null,n.type="range",n}return(0,o.Z)(r,[{key:"clone",value:function(){return new I({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),r}(w);(0,s.e)([(0,s.d)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,r){t[r]=[this.minValue||0,e]}}}})],x.prototype,"maxValue",void 0),(0,s.e)([(0,s.d)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue||0]}}}})],x.prototype,"minValue",void 0),(0,s.e)([(0,d.r)({range:"range"})],x.prototype,"type",void 0);var j,_=x=I=(0,s.e)([(0,s.n)("esri.layers.support.RangeDomain")],x),N={key:"type",base:w,typeMap:{range:_,"coded-value":k,inherited:T}};function O(e){if(!e||!e.type)return null;switch(e.type){case"range":return _.fromJSON(e);case"codedValue":return k.fromJSON(e);case"inherited":return T.fromJSON(e)}return null}var R=new l.s({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),A=j=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).alias=null,n.defaultValue=void 0,n.description=null,n.domain=null,n.editable=!0,n.length=-1,n.name=null,n.nullable=!0,n.type=null,n.valueType=null,n}return(0,o.Z)(r,[{key:"readDescription",value:function(e,t){var r,n=t.description;try{r=JSON.parse(n)}catch(i){}return r?r.value:null}},{key:"readValueType",value:function(e,t){var r,n=t.description;try{r=JSON.parse(n)}catch(i){}return r?R.fromJSON(r.fieldValueType):null}},{key:"clone",value:function(){return new j({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}}]),r}(p.l);(0,s.e)([(0,s.d)({type:String,json:{write:!0}})],A.prototype,"alias",void 0),(0,s.e)([(0,s.d)({type:[String,Number],json:{write:{allowNull:!0}}})],A.prototype,"defaultValue",void 0),(0,s.e)([(0,s.d)()],A.prototype,"description",void 0),(0,s.e)([(0,f.o)("description")],A.prototype,"readDescription",null),(0,s.e)([(0,s.d)({types:N,json:{read:{reader:O},write:!0}})],A.prototype,"domain",void 0),(0,s.e)([(0,s.d)({type:Boolean,json:{write:!0}})],A.prototype,"editable",void 0),(0,s.e)([(0,s.d)({type:s.S,json:{write:!0}})],A.prototype,"length",void 0),(0,s.e)([(0,s.d)({type:String,json:{write:!0}})],A.prototype,"name",void 0),(0,s.e)([(0,s.d)({type:Boolean,json:{write:!0}})],A.prototype,"nullable",void 0),(0,s.e)([(0,d.r)(y.i)],A.prototype,"type",void 0),(0,s.e)([(0,s.d)()],A.prototype,"valueType",void 0),(0,s.e)([(0,f.o)("valueType",["description"])],A.prototype,"readValueType",null);var E=A=j=(0,s.e)([(0,s.n)("esri.layers.support.Field")],A)},77196:function(e,t,r){r.d(t,{o:function(){return c},s:function(){return p}});var n=r(43144),i=r(15671),o=r(97326),a=r(60136),u=r(29388),s=r(23132),l=0,p=function(e){var t=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;(0,i.Z)(this,r);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return e=t.call.apply(t,[this].concat(a)),Object.defineProperty((0,o.Z)(e),"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+l++}),e}return(0,n.Z)(r)}(e);return t=(0,s.e)([(0,s.n)("esri.core.Identifiable")],t)},c=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r)}(p(function(){return(0,n.Z)((function e(){(0,i.Z)(this,e)}))}()));c=(0,s.e)([(0,s.n)("esri.core.Identifiable")],c)},70516:function(e,t,r){r.d(t,{p:function(){return d}});var n,i=r(15671),o=r(43144),a=r(60136),u=r(29388),s=r(23132),l=r(80175),p=r(70441),c=(r(75610),n=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).floorField=null,n.viewAllMode=!1,n.viewAllLevelIds=new l.j,n}return(0,o.Z)(r,[{key:"clone",value:function(){return new n({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}}]),r}(p.l));(0,s.e)([(0,s.d)({type:String,json:{write:!0}})],c.prototype,"floorField",void 0),(0,s.e)([(0,s.d)({json:{read:!1,write:!1}})],c.prototype,"viewAllMode",void 0),(0,s.e)([(0,s.d)({json:{read:!1,write:!1}})],c.prototype,"viewAllLevelIds",void 0);var d=c=n=(0,s.e)([(0,s.n)("esri.layers.support.LayerFloorInfo")],c)},34853:function(e,t,r){r.r(t);var n=r(29439),i=r(93433),o=r(11752),a=r(61120),u=r(1413),s=r(37762),l=r(74165),p=r(15861),c=r(15671),d=r(43144),f=r(60136),y=r(29388),v=r(23132),m=r(57714),h=r(78470),g=r(10815),w=r(75610),b=r(80175),S=r(79611),k=r(38843),Z=r(9575),I=r(43920),T=r(36551),x=r(30709),j=r(81905),_=r(70441),N=r(97866),O=r(10242),R=r(74575),A=r(20005),E=r(80262),C=r(34860),P=r(61099),F=r(56384),L=r(22051),V=r(6073),U=r(2157),G=r(50448),J=r(91204),M=r(30604),D=r(36638),B=r(27264),W=r(24892),q=r(77196),K=r(77129),z=r(52376),H=(r(1665),r(9055),r(53373),r(33703),r(54841),r(78674),r(66307),r(2760),r(48889),r(88370),r(30150),r(97033),r(77470),r(53647),r(72763),r(55269),r(21583),r(38304),r(96349),r(51451),r(50526),r(41742),r(1773),r(67154),r(24980),r(3114),r(22144),r(72820),r(78311),r(96636),r(79054),r(29709),r(47642),r(83822),r(18411),r(44455),r(43782),r(33976),r(407),r(28210),r(17436),r(25316),r(77389),r(94872),r(3969),r(53249),r(43124),r(69797),r(83996),r(6794),r(49580),r(28999),r(69953),r(15612),r(36460),r(28681),r(38929),r(68890),r(83024),r(61340),r(31513),r(25838),r(54539),r(19967),r(50338),r(28623),r(10312),r(95254),r(12158),r(93874),r(62446),r(50905),r(78945),r(55827),r(70516),r(25279),r(22268),r(10590),r(40452),r(63022),r(69202),v.s.getLogger("esri.networks.Network")),Y=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).id=null,n.title=null,n.layerUrl=null,n.dataElement=null,n.fullExtent=null,n.spatialReference=null,n.type=null,n.sourceJSON=null,n}return(0,d.Z)(r,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){var r,n;(0,v.u)(t)||H.error("#load()","Failed to load layer (title: '".concat(null!==(r=e.title)&&void 0!==r?r:"no title","', id: '").concat(null!==(n=e.id)&&void 0!==n?n:"no id","')"),{error:t})}))}},{key:"datasetName",get:function(){var e;return null===(e=this.dataElement)||void 0===e?void 0:e.name}},{key:"owner",get:function(){var e;return null===(e=this.dataElement)||void 0===e?void 0:e.userIdentity}},{key:"schemaGeneration",get:function(){var e;return null===(e=this.dataElement)||void 0===e?void 0:e.schemaGeneration}},{key:"parsedUrl",get:function(){var e=this.layerUrl;return e?(0,m.j)(e):null}},{key:"featureServiceUrl",get:function(){var e=this.parsedUrl&&(0,N.m)(this.parsedUrl.path);return(0,w.r)(e)?e.url.path:null}},{key:"networkServiceUrl",get:function(){return this.featureServiceUrl?this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer"):null}},{key:"layerId",get:function(){var e=this.parsedUrl&&(0,N.m)(this.parsedUrl.path);return(0,w.r)(e)?e.sublayer:null}},{key:"load",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),t)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,t)),this));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLayerIdBySourceId",value:function(e){if(this.dataElement){var t,r=this.dataElement.domainNetworks,n=(0,s.Z)(r);try{for(n.s();!(t=n.n()).done;){var i,o=t.value,a=(0,s.Z)(o.edgeSources?o.edgeSources:[]);try{for(a.s();!(i=a.n()).done;){var u=i.value;if(u.sourceId===e)return u.layerId}}catch(d){a.e(d)}finally{a.f()}var l,p=(0,s.Z)(o.junctionSources?o.junctionSources:[]);try{for(p.s();!(l=p.n()).done;){var c=l.value;if(c.sourceId===e)return c.layerId}}catch(d){p.e(d)}finally{p.f()}}}catch(d){n.e(d)}finally{n.f()}return null}return null}},{key:"_fetchLayerMetaData",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t,r){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.U)(t,(0,u.Z)({responseType:"json",query:{f:"json"}},r));case 2:n=e.sent,this.sourceJSON=n.data,this.read(n.data,{origin:"service"});case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_fetchDataElement",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t,r,n){var i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dataElement){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,m.U)("".concat(t,"/queryDataElements"),(0,u.Z)({responseType:"json",query:{layers:JSON.stringify([r]),f:"json"}},n)).then((function(e){var t;return null===(t=e.data.layerDataElements)||void 0===t?void 0:t[0]}));case 4:(i=e.sent)&&this.read(i,{origin:"service"});case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}((0,Z.O)(S.m));(0,v.e)([(0,v.d)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}}},read:!1}})],Y.prototype,"id",void 0),(0,v.e)([(0,v.d)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}}},read:!1}})],Y.prototype,"title",void 0),(0,v.e)([(0,v.d)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],Y.prototype,"layerUrl",void 0),(0,v.e)([(0,v.d)({type:Object,json:{origins:{service:{read:!0}},read:!1}})],Y.prototype,"dataElement",void 0),(0,v.e)([(0,v.d)({type:E.M,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],Y.prototype,"fullExtent",void 0),(0,v.e)([(0,v.d)({type:x.k,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],Y.prototype,"spatialReference",void 0),(0,v.e)([(0,v.d)({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],Y.prototype,"type",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Y.prototype,"datasetName",null),(0,v.e)([(0,v.d)({readOnly:!0})],Y.prototype,"owner",null),(0,v.e)([(0,v.d)({readOnly:!0})],Y.prototype,"schemaGeneration",null),(0,v.e)([(0,v.d)({readOnly:!0})],Y.prototype,"parsedUrl",null),(0,v.e)([(0,v.d)({readOnly:!0})],Y.prototype,"featureServiceUrl",null),(0,v.e)([(0,v.d)({readOnly:!0})],Y.prototype,"networkServiceUrl",null),(0,v.e)([(0,v.d)({readOnly:!0})],Y.prototype,"layerId",null),(0,v.e)([(0,v.d)()],Y.prototype,"sourceJSON",void 0);var Q,X=Y=(0,v.e)([(0,v.n)("esri.networks.Network")],Y);!function(e){e[e.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",e[e.RTContainment=2]="RTContainment",e[e.RTAttachment=3]="RTAttachment",e[e.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",e[e.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"}(Q||(Q={}));var $=new m.s({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"});new m.s({connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"});var ee=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).request=m.U,n}return(0,d.Z)(r,[{key:"initialize",value:function(){}},{key:"load",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){var r,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.layer.load(t).then((function(){return n._initializeRulesTable()})),e.abrupt("return",(this.addResolvingPromise(r),this));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeatureSQL",value:function(e,t){var r=e.layerId.toString(),n=e.fieldsIndex.normalizeFieldName("assetGroup"),i=e.fieldsIndex.normalizeFieldName("assetType"),o=t.attributes[n],a=t.attributes[i],u=this.rulesHash[r];if(u){var s=u.assetGroupHash[o];if(s)return s.assetTypeHash[a]||null}return null}},{key:"_initializeRulesTable",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(){var t,r,n,i,o,a,u,p,c,d,f,y,v,m,h,g,w,b,S,k,Z,I,T,x,j,_,N,O,R,A,E,C,P,F,L,V,U;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},function(e){e[e.from=0]="from",e[e.to=1]="to",e[e.via=2]="via"}(r||(r={})),n=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}],i=(0,s.Z)(this.rules),e.prev=4,i.s();case 6:if((o=i.n()).done){e.next=35;break}if((a=o.value).ruleType===Q.RTJunctionJunctionConnectivity||a.ruleType===Q.RTJunctionEdgeConnectivity||a.ruleType===Q.RTEdgeJunctionEdgeConnectivity){e.next=10;break}return e.abrupt("continue",33);case 10:u=[[r.from,r.to],[r.to,r.from]],a.ruleType===Q.RTEdgeJunctionEdgeConnectivity&&(u=[[r.from,r.via],[r.via,r.from],[r.to,r.via],[r.via,r.to]]),p=0,c=u;case 13:if(!(p<c.length)){e.next=33;break}S=c[p],k=S.shift(),Z=S.shift(),I=!1,e.t0=a.ruleType,e.next=e.t0===Q.RTEdgeJunctionEdgeConnectivity?20:e.t0===Q.RTJunctionEdgeConnectivity?22:23;break;case 20:return I=k===r.from||k===r.to,e.abrupt("break",23);case 22:I=k===r.to;case 23:if(T=n[k],x=a[T.networkSourceId].layerId.toString(),j=null===(d=a[T.assetGroupId])||void 0===d||null===(f=d.assetGroupCode)||void 0===f?void 0:f.toString(),_=null===(y=a[T.assetTypeId])||void 0===y||null===(v=y.assetTypeCode)||void 0===v?void 0:v.toString(),N=n[Z],O=a[N.networkSourceId].layerId.toString(),R=null===(m=a[N.assetGroupId])||void 0===m||null===(h=m.assetGroupCode)||void 0===h?void 0:h.toString(),A=a[N.assetTypeId],E=null===A||void 0===A||null===(g=A.assetTypeCode)||void 0===g?void 0:g.toString(),C=t[x]?t[x]:{assetGroupHash:{}},j&&_&&R&&E){e.next=26;break}return e.abrupt("continue",30);case 26:P=C.assetGroupHash[j]?C.assetGroupHash[j]:{assetTypeHash:{}},(F=P.assetTypeHash[_]?P.assetTypeHash[_]:{})[O]=F[O]?F[O]:{},I&&(F[x]=F[x]?F[x]:{},V="(assetgroup = ".concat(j," AND assettype = ").concat(_,")"),F[x].anyVertex=F[x].anyVertex?"".concat(F[x].anyVertex):"".concat(V),"esriNECPEndVertex"===A.connectivityPolicy&&(F[x].endVertex=null!==(L=F[x])&&void 0!==L&&L.endVertex?"".concat(F[x].endVertex):"".concat(V))),U="(assetgroup = ".concat(R," AND assettype = ").concat(E,")"),F[O].anyVertex=null!==(w=F[O])&&void 0!==w&&w.anyVertex?"".concat(F[O].anyVertex," OR ").concat(U):"".concat(U),"esriNECPEndVertex"===A.connectivityPolicy&&(F[O].endVertex=null!==(b=F[O])&&void 0!==b&&b.endVertex?"".concat(F[O].endVertex," OR ").concat(U):"".concat(U)),P.assetTypeHash[_]=F,C.assetGroupHash[j]=P,t[x]=C;case 30:p++,e.next=13;break;case 33:e.next=6;break;case 35:e.next=40;break;case 37:e.prev=37,e.t1=e.catch(4),i.e(e.t1);case 40:return e.prev=40,i.f(),e.finish(40);case 43:this.rulesHash=t;case 44:case"end":return e.stop()}}),e,this,[[4,37,40,43]])})));return function(){return e.apply(this,arguments)}}()}]),r}((0,_.u)(S.m));(0,v.e)([(0,v.d)({constructOnly:!0})],ee.prototype,"layer",void 0),(0,v.e)([(0,v.d)({constructOnly:!0})],ee.prototype,"rules",void 0),(0,v.e)([(0,v.d)()],ee.prototype,"rulesHash",void 0),(0,v.e)([(0,v.d)({constructOnly:!0})],ee.prototype,"request",void 0);var te=ee=(0,v.e)([(0,v.n)("esri.networks.RulesTable")],ee),re=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).conditionBarriers=[],n.outputConditions=[],n.functions=[],n.functionBarriers=[],n.traversabilityScope=null,n.shortestPathNetworkAttributeName=null,n.includeBarriers=null,n.validateConsistency=null,n.ignoreBarriersAtStartingPoints=null,n}return(0,d.Z)(r)}(_.l);(0,v.e)([(0,v.d)({type:[Object],json:{write:!0}})],re.prototype,"conditionBarriers",void 0),(0,v.e)([(0,v.d)({type:[Object],json:{write:!0}})],re.prototype,"outputConditions",void 0),(0,v.e)([(0,v.d)({type:[Object],json:{write:!0}})],re.prototype,"functions",void 0),(0,v.e)([(0,v.d)({type:[Object],json:{write:!0}})],re.prototype,"functionBarriers",void 0),(0,v.e)([(0,v.d)({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],re.prototype,"traversabilityScope",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],re.prototype,"shortestPathNetworkAttributeName",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],re.prototype,"includeBarriers",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],re.prototype,"validateConsistency",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],re.prototype,"ignoreBarriersAtStartingPoints",void 0);var ne=re=(0,v.e)([(0,v.n)("esri.networks.support.TraceConfiguration")],re),ie=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).filterBarriers=[],n.domainNetworkName=null,n.filterBitsetNetworkAttributeName=null,n.filterFunctionBarriers=[],n.filterScope=null,n.includeContainers=null,n.includeContent=null,n.includeIsolated=null,n.includeStructures=null,n.includeUpToFirstSpatialContainer=null,n.nearestNeighbor=null,n.outputFilterCategories=[],n.outputFilters=[],n.propagators=[],n.subnetworkName=null,n.targetTierName=null,n.tierName=null,n.validateLocatability=null,n}return(0,d.Z)(r)}(ne);(0,v.e)([(0,v.d)({type:[Object],json:{write:!0}})],ie.prototype,"filterBarriers",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],ie.prototype,"domainNetworkName",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],ie.prototype,"filterBitsetNetworkAttributeName",void 0),(0,v.e)([(0,v.d)({type:[Object],json:{write:!0}})],ie.prototype,"filterFunctionBarriers",void 0),(0,v.e)([(0,v.d)({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],ie.prototype,"filterScope",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],ie.prototype,"includeContainers",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],ie.prototype,"includeContent",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],ie.prototype,"includeIsolated",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],ie.prototype,"includeStructures",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],ie.prototype,"includeUpToFirstSpatialContainer",void 0),(0,v.e)([(0,v.d)({type:Object,json:{write:!0}})],ie.prototype,"nearestNeighbor",void 0),(0,v.e)([(0,v.d)({type:[Object],json:{write:!0}})],ie.prototype,"outputFilterCategories",void 0),(0,v.e)([(0,v.d)({type:[Object],json:{write:!0}})],ie.prototype,"outputFilters",void 0),(0,v.e)([(0,v.d)({type:[Object],json:{write:!0}})],ie.prototype,"propagators",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],ie.prototype,"subnetworkName",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],ie.prototype,"targetTierName",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],ie.prototype,"tierName",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],ie.prototype,"validateLocatability",void 0);var oe=ie=(0,v.e)([(0,v.n)("esri.networks.support.UNTraceConfiguration")],ie),ae=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).globalId=null,n.title=null,n.traceConfiguration=null,n.creationDate=null,n.creator=null,n.description=null,n.minStartingPoints=null,n.resultTypes=[],n.tags=[],n.traceType=null,n}return(0,d.Z)(r,[{key:"readTraceConfiguration",value:function(e,t){return void 0!==e.tierName?oe.fromJSON(e):ne.fromJSON(e)}}]),r}(Z.S);(0,v.e)([(0,v.d)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"}}},read:!1}})],ae.prototype,"globalId",void 0),(0,v.e)([(0,v.d)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],ae.prototype,"title",void 0),(0,v.e)([(0,v.d)({type:ne,json:{origins:{service:{read:!0}},read:!1}})],ae.prototype,"traceConfiguration",void 0),(0,v.e)([(0,x.o)("service","traceConfiguration")],ae.prototype,"readTraceConfiguration",null),(0,v.e)([(0,v.d)({type:Date,json:{origins:{service:{read:!0}},read:!1}})],ae.prototype,"creationDate",void 0),(0,v.e)([(0,v.d)({type:String,json:{origins:{service:{read:!0}},read:!1}})],ae.prototype,"creator",void 0),(0,v.e)([(0,v.d)({type:String,json:{origins:{service:{read:!0}},read:!1}})],ae.prototype,"description",void 0),(0,v.e)([(0,v.d)({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"}}},read:!1}})],ae.prototype,"minStartingPoints",void 0),(0,v.e)([(0,v.d)({type:[Object],json:{origins:{service:{read:!0}},read:!1}})],ae.prototype,"resultTypes",void 0),(0,v.e)([(0,v.d)({type:[String],json:{origins:{service:{read:!0}},read:!1}})],ae.prototype,"tags",void 0),(0,v.e)([(0,v.d)({type:$.apiValues,json:{type:$.jsonValues,origins:{service:{read:$.read}},read:!1}})],ae.prototype,"traceType",void 0);var ue=ae=(0,v.e)([(0,v.n)("esri.networks.support.NamedTraceConfiguration")],ae),se=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).id=null,n.name=null,n}return(0,d.Z)(r)}(_.l);(0,v.e)([(0,v.d)({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],se.prototype,"id",void 0),(0,v.e)([(0,v.d)({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],se.prototype,"name",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{write:!0}})],se.prototype,"isUpstreamTerminal",void 0);var le=se=(0,v.e)([(0,v.n)("esri.networks.support.Terminal")],se),pe=new m.s({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"}),ce=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).defaultConfiguration=null,n.id=null,n.name=null,n.terminals=[],n.traversabilityModel=null,n}return(0,d.Z)(r)}(_.l);(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],ce.prototype,"defaultConfiguration",void 0),(0,v.e)([(0,v.d)({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],ce.prototype,"id",void 0),(0,v.e)([(0,v.d)({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],ce.prototype,"name",void 0),(0,v.e)([(0,v.d)({type:[le],json:{write:!0}})],ce.prototype,"terminals",void 0),(0,v.e)([(0,v.d)({type:pe.apiValues,json:{type:pe.jsonValues,read:pe.read,write:pe.write}})],ce.prototype,"traversabilityModel",void 0);var de=ce=(0,v.e)([(0,v.n)("esri.networks.support.TerminalConfiguration")],ce),fe=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).sharedNamedTraceConfigurations=[],n.type="utility",n}return(0,d.Z)(r,[{key:"serviceTerritoryFeatureLayerId",get:function(){var e;return null===(e=this.dataElement)||void 0===e?void 0:e.serviceTerritoryFeatureLayerId}},{key:"systemLayers",get:function(){var e,t;return{rulesTableId:null===(e=this.sourceJSON)||void 0===e?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(this.rulesTableId):null,subnetworksTableId:null===(t=this.sourceJSON)||void 0===t?void 0:t.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(this.subnetworksTableId):null}}},{key:"rulesTableId",get:function(){var e;return null===(e=this.sourceJSON)||void 0===e?void 0:e.systemLayers.rulesTableId}},{key:"rulesTableUrl",get:function(){return this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(this.rulesTableId):null}},{key:"subnetworksTableId",get:function(){var e;return null===(e=this.sourceJSON)||void 0===e?void 0:e.systemLayers.subnetworksTableId}},{key:"subnetworksTableUrl",get:function(){return this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(this.subnetworksTableId):null}},{key:"terminalConfigurations",get:function(){var e;return(null===(e=this.dataElement)||void 0===e?void 0:e.terminalConfigurations.map((function(e){return de.fromJSON(e)})))||[]}},{key:"domainNetworkNames",get:function(){var e;return(null===(e=this.dataElement)||void 0===e?void 0:e.domainNetworks.map((function(e){return e.domainNetworkName})))||[]}},{key:"_utilityLayerList",get:function(){var e=new Set;return this.dataElement.domainNetworks.map((function(t){t.edgeSources.map((function(t){e.add(t.layerId)})),t.junctionSources.map((function(t){e.add(t.layerId)}))})),e}},{key:"load",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.addResolvingPromise((0,o.Z)((0,a.Z)(r.prototype),"load",this).call(this,t)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(t)),this));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTerminalConfiguration",value:function(e){var t,r=null,n=null,i=e.layer;if("feature"!==(null===i||void 0===i?void 0:i.type))return null;if(null===(t=i.layerId))return null;var o=e.attributes;if(null==o)return null;for(var a=0,u=Object.keys(o);a<u.length;a++){var l=u[a];"ASSETGROUP"===l.toUpperCase()&&(r=e.getAttribute(l)),"ASSETTYPE"===l.toUpperCase()&&(n=e.getAttribute(l))}if(!this.dataElement)return null;var p,c=null,d=this.dataElement.domainNetworks,f=(0,s.Z)(d);try{for(f.s();!(p=f.n()).done;){var y,v=null===(y=p.value.junctionSources)||void 0===y?void 0:y.find((function(e){return e.layerId===t}));if(v){var m,h=null===(m=v.assetGroups)||void 0===m?void 0:m.find((function(e){return e.assetGroupCode===r}));if(h){var g,w=null===(g=h.assetTypes)||void 0===g?void 0:g.find((function(e){return e.assetTypeCode===n}));if(w){c=w.terminalConfigurationId;break}}}}}catch(k){f.e(k)}finally{f.f()}if(null!=c){var b,S=null===(b=this.dataElement.terminalConfigurations)||void 0===b?void 0:b.find((function(e){return e.terminalConfigurationId===c}));return S?de.fromJSON(S):null}return null}},{key:"getTierNames",value:function(e){var t,r=null===(t=this.dataElement)||void 0===t?void 0:t.domainNetworks.find((function(t){return t.domainNetworkName===e}));return(null===r||void 0===r?void 0:r.tiers.map((function(e){return e.name})))||[]}},{key:"getRulesTable",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createRulesTable());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUtilityLayer",value:function(e){return this._utilityLayerList.has(e.layerId)}},{key:"_loadNamedTraceConfigurationsFromNetwork",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){var r,n,i,o,a,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(null===(r=this.sharedNamedTraceConfigurations)||void 0===r?void 0:r.length)){e.next=2;break}return e.abrupt("return");case 2:return n=this.sharedNamedTraceConfigurations.map((function(e){return e.globalId})),e.next=5,this._fetchTraceConfigData(this.networkServiceUrl,n,t);case 5:i=e.sent,o=(0,s.Z)(this.sharedNamedTraceConfigurations);try{for(u=function(){var e=a.value,t=null===i||void 0===i?void 0:i.find((function(t){return t.globalId===e.globalId}));t&&e.read(t,{origin:"service"})},o.s();!(a=o.n()).done;)u()}catch(l){o.e(l)}finally{o.f()}case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createRulesTable",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(){var t,r,n,o,a,u=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new R.K({url:this.rulesTableUrl}),e.next=3,r.load();case 3:if(n=null===(t=this.dataElement)||void 0===t?void 0:t.domainNetworks){e.next=6;break}return e.abrupt("return",null);case 6:return o=n.flatMap((function(e){return[].concat((0,i.Z)(e.edgeSources),(0,i.Z)(e.junctionSources))})),e.next=9,this._queryRulesTable(r);case 9:return a=e.sent.map((function(e){return u._hydrateRuleInfo(r,o,e)})),e.abrupt("return",new te({layer:r,rules:a}));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryRulesTable",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new C.b({where:"1=1",outFields:["*"]}),e.next=3,(0,A.t)(t,r);case 3:return e.abrupt("return",e.sent.features);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_hydrateRuleInfo",value:function(e,t,r){var n,i=this,o=e.fieldsIndex.get("RULETYPE"),a=e.fieldsIndex.get("CREATIONDATE"),u=e.fieldsIndex.get("FROMNETWORKSOURCEID"),s=e.fieldsIndex.get("FROMASSETGROUP"),l=e.fieldsIndex.get("FROMASSETTYPE"),p=e.fieldsIndex.get("FROMTERMINALID"),c=e.fieldsIndex.get("TONETWORKSOURCEID"),d=e.fieldsIndex.get("TOASSETGROUP"),f=e.fieldsIndex.get("TOASSETTYPE"),y=e.fieldsIndex.get("TOTERMINALID"),v=e.fieldsIndex.get("VIANETWORKSOURCEID"),m=e.fieldsIndex.get("VIAASSETGROUP"),h=e.fieldsIndex.get("VIAASSETTYPE"),g=e.fieldsIndex.get("VIATERMINALID"),w=r.attributes[o.name],b=new Date(r.attributes[a.name]),S=[{networkSourceId:r.attributes[u.name],assetGroupId:r.attributes[s.name],assetTypeId:r.attributes[l.name],terminalId:r.attributes[p.name]},{networkSourceId:r.attributes[c.name],assetGroupId:r.attributes[d.name],assetTypeId:r.attributes[f.name],terminalId:r.attributes[y.name]},{networkSourceId:r.attributes[v.name],assetGroupId:r.attributes[m.name],assetTypeId:r.attributes[h.name],terminalId:r.attributes[g.name]}];!function(e){e[e.from=0]="from",e[e.to=1]="to",e[e.via=2]="via"}(n||(n={}));for(var k={ruleType:w,creationDate:b},Z=function(){var e=T[I];if(w!==Q.RTEdgeJunctionEdgeConnectivity&&e===n.via)return"continue";var r=S[e],o=t.find((function(e){return e.sourceId===r.networkSourceId})),a=null===o||void 0===o?void 0:o.assetGroups.find((function(e){return e.assetGroupCode===r.assetGroupId})),u=null===a||void 0===a?void 0:a.assetTypes.find((function(e){return e.assetTypeCode===r.assetTypeId})),s=i._getTerminal(w,u,r);w!==Q.RTContainment&&w!==Q.RTAttachment||(s=null);var l="";switch(e){case n.from:l="from";break;case n.to:l="to";break;case n.via:l="via"}k["".concat(l,"NetworkSource")]=o,k["".concat(l,"AssetGroup")]=a,k["".concat(l,"AssetType")]=u,k["".concat(l,"Terminal")]=s},I=0,T=[n.from,n.to,n.via];I<T.length;I++)Z();return k}},{key:"_getTerminal",value:function(e,t,r){var n,i;if(e===Q.RTAttachment||e===Q.RTContainment)return null;var o=null===t||void 0===t?void 0:t.terminalConfigurationId,a=null===(n=this.terminalConfigurations)||void 0===n?void 0:n.find((function(e){return e.id===o}));return null===a||void 0===a||null===(i=a.terminals)||void 0===i?void 0:i.find((function(e){return e.id===r.terminalId}))}},{key:"_fetchTraceConfigData",value:function(e,t,r){return(0,m.U)("".concat(e,"/traceConfigurations/query"),(0,u.Z)({responseType:"json",query:{globalIds:JSON.stringify(t),f:"json"}},r)).then((function(e){return e.data.traceConfigurations}))}}]),r}(X);(0,v.e)([(0,v.d)({type:[ue],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],fe.prototype,"sharedNamedTraceConfigurations",void 0),(0,v.e)([(0,v.d)({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],fe.prototype,"type",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],fe.prototype,"serviceTerritoryFeatureLayerId",null),(0,v.e)([(0,v.d)({readOnly:!0})],fe.prototype,"systemLayers",null),(0,v.e)([(0,v.d)({readOnly:!0})],fe.prototype,"rulesTableId",null),(0,v.e)([(0,v.d)({readOnly:!0})],fe.prototype,"rulesTableUrl",null),(0,v.e)([(0,v.d)({readOnly:!0})],fe.prototype,"subnetworksTableId",null),(0,v.e)([(0,v.d)({readOnly:!0})],fe.prototype,"subnetworksTableUrl",null),(0,v.e)([(0,v.d)({readOnly:!0})],fe.prototype,"terminalConfigurations",null),(0,v.e)([(0,v.d)({readOnly:!0})],fe.prototype,"domainNetworkNames",null);var ye=fe=(0,v.e)([(0,v.n)("esri.networks.UtilityNetwork")],fe),ve=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).expression=null,n.returnType="string",n.title=null,n}return(0,d.Z)(r)}((0,U.l)(_.l));(0,v.e)([(0,v.d)({type:String,json:{write:{isRequired:!0}}})],ve.prototype,"expression",void 0),(0,v.e)([(0,v.d)({type:["number","string"],json:{write:!0}})],ve.prototype,"returnType",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],ve.prototype,"title",void 0);var me=ve=(0,v.e)([(0,v.n)("esri.webdoc.geotriggersInfo.ExpressionInfo")],ve),he=new m.s({deviceLocation:"device-location"}),ge=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).filterExpression=null,n.type="device-location",n}return(0,d.Z)(r)}((0,U.l)(_.l));(0,v.e)([(0,v.d)({type:me,json:{write:!0}})],ge.prototype,"filterExpression",void 0),(0,v.e)([(0,v.d)({type:he.apiValues,readOnly:!0,json:{type:he.jsonValues,read:he.read,write:he.write}})],ge.prototype,"type",void 0);var we=ge=(0,v.e)([(0,v.n)("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],ge),be=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).geometry=null,n.where=null,n}return(0,d.Z)(r)}((0,U.l)(_.l));(0,v.e)([(0,v.d)({types:J.i,json:{read:M.d,write:!0}})],be.prototype,"geometry",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],be.prototype,"where",void 0);var Se=be=(0,v.e)([(0,v.n)("esri.webdoc.geotriggersInfo.FeatureFilter")],be),ke=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).layerId=null,n.layerUrl=null,n.type="feature-layer",n}return(0,d.Z)(r)}((0,U.l)(_.l));(0,v.e)([(0,v.d)({type:String,json:{write:{overridePolicy:function(){return{isRequired:null===this.layerUrl}}}}})],ke.prototype,"layerId",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:{overridePolicy:function(){return{isRequired:null===this.layerId}}}}})],ke.prototype,"layerUrl",void 0),(0,v.e)([(0,G.r)({featureLayer:"feature-layer"},{readOnly:!0})],ke.prototype,"type",void 0);var Ze=ke=(0,v.e)([(0,v.n)("esri.webdoc.geotriggersInfo.FeatureLayerSource")],ke),Ie=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).fenceSource=null,n.filter=null,n.bufferDistance=null,n.type="features",n}return(0,d.Z)(r)}((0,U.l)(_.l));(0,v.e)([(0,v.d)({type:Ze,json:{write:{isRequired:!0}}})],Ie.prototype,"fenceSource",void 0),(0,v.e)([(0,v.d)({type:Se,json:{write:!0}})],Ie.prototype,"filter",void 0),(0,v.e)([(0,v.d)({type:Number,json:{write:!0}})],Ie.prototype,"bufferDistance",void 0),(0,v.e)([(0,G.r)({features:"features"},{readOnly:!0})],Ie.prototype,"type",void 0);var Te=Ie=(0,v.e)([(0,v.n)("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],Ie),xe=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).type="fence",n}return(0,d.Z)(r)}((0,U.l)(_.l));(0,v.e)([(0,G.r)({fence:"fence"},{readOnly:!0})],xe.prototype,"type",void 0);var je=xe=(0,v.e)([(0,v.n)("esri.webdoc.geotriggersInfo.Geotrigger")],xe),_e=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).expressionInfo=null,n.requestedActions=null,n}return(0,d.Z)(r)}((0,U.l)(_.l));(0,v.e)([(0,v.d)({type:me,json:{write:!0}})],_e.prototype,"expressionInfo",void 0),(0,v.e)([(0,v.d)({type:[String],json:{write:!0}})],_e.prototype,"requestedActions",void 0);var Ne=_e=(0,v.e)([(0,v.n)("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],_e),Oe=new m.s({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),Re=new m.s({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),Ae=new m.s({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"}),Ee=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).enterExitRule="enter-contains-and-exit-does-not-intersect",n.feed=null,n.feedAccuracyMode="use-geometry",n.fenceNotificationRule=null,n.fenceParameters=null,n.name=null,n.notificationOptions=null,n.type="fence",n}return(0,d.Z)(r)}(je);(0,v.e)([(0,G.r)(Oe)],Ee.prototype,"enterExitRule",void 0),(0,v.e)([(0,v.d)({type:we,json:{write:{isRequired:!0}}})],Ee.prototype,"feed",void 0),(0,v.e)([(0,G.r)(Re)],Ee.prototype,"feedAccuracyMode",void 0),(0,v.e)([(0,v.d)({type:Ae.apiValues,json:{type:Ae.jsonValues,read:Ae.read,write:{writer:Ae.write,isRequired:!0}}})],Ee.prototype,"fenceNotificationRule",void 0),(0,v.e)([(0,v.d)({type:Te,json:{write:{isRequired:!0}}})],Ee.prototype,"fenceParameters",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:!0}})],Ee.prototype,"name",void 0),(0,v.e)([(0,v.d)({type:Ne,json:{write:!0}})],Ee.prototype,"notificationOptions",void 0),(0,v.e)([(0,G.r)({fence:"fence"},{readOnly:!0})],Ee.prototype,"type",void 0);var Ce={base:je,key:"type",typeMap:{fence:Ee=(0,v.e)([(0,v.n)("esri.webdoc.geotriggersInfo.FenceGeotrigger")],Ee)}},Pe=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).geotriggers=null,n}return(0,d.Z)(r)}((0,U.l)(_.l));(0,v.e)([(0,v.d)({types:[Ce],json:{write:{isRequired:!0}}})],Pe.prototype,"geotriggers",void 0);var Fe,Le=Pe=(0,v.e)([(0,v.n)("esri.webdoc.GeotriggersInfo")],Pe),Ve=Fe=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).activeRange=null,n.currentRangeExtent=null,n.fullRangeExtent=null,n}return(0,d.Z)(r,[{key:"clone",value:function(){return new Fe((0,w.m)({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}}]),r}(_.l);(0,v.e)([(0,v.d)({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],Ve.prototype,"activeRange",void 0),(0,v.e)([(0,v.d)({type:[Number],json:{write:!0}})],Ve.prototype,"currentRangeExtent",void 0),(0,v.e)([(0,v.d)({type:[Number],json:{write:!0}})],Ve.prototype,"fullRangeExtent",void 0);var Ue,Ge=Ve=Fe=(0,v.e)([(0,v.n)("esri.webdoc.RangeInfo")],Ve),Je=Ue=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).enabled=!1,n.longNames=!1,n.minimized=!1,n.pinnedLevels=!1,n.site=null,n.facility=null,n.level=null,n}return(0,d.Z)(r,[{key:"clone",value:function(){return new Ue((0,w.m)({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}}]),r}(_.l);(0,v.e)([(0,v.d)({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],Je.prototype,"enabled",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],Je.prototype,"longNames",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],Je.prototype,"minimized",void 0),(0,v.e)([(0,v.d)({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],Je.prototype,"pinnedLevels",void 0),(0,v.e)([(0,v.d)({type:String,json:{read:{source:"site"},write:{target:"site"}}})],Je.prototype,"site",void 0),(0,v.e)([(0,v.d)({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],Je.prototype,"facility",void 0),(0,v.e)([(0,v.d)({type:String,json:{read:{source:"level"},write:{target:"level"}}})],Je.prototype,"level",void 0);var Me,De=Je=Ue=(0,v.e)([(0,v.n)("esri.webdoc.widgets.FloorFilter")],Je),Be=new m.s({slider:"slider",picker:"picker"}),We=Me=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).interactionMode=null,n.numStops=null,n.stopInterval=null,n}return(0,d.Z)(r,[{key:"clone",value:function(){return new Me({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}}]),r}(_.l);(0,v.e)([(0,v.d)({type:Be.apiValues,nonNullable:!0,json:{type:Be.jsonValues,default:null,read:{reader:Be.read},write:{isRequired:!0,writer:Be.write}}})],We.prototype,"interactionMode",void 0),(0,v.e)([(0,v.d)({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy:function(){var e=null!=this.stopInterval;return{enabled:!e,isRequired:!e}}}}})],We.prototype,"numStops",void 0),(0,v.e)([(0,v.d)({type:Number,json:{write:{overridePolicy:function(){return{isRequired:null==this.numStops}}}}})],We.prototype,"stopInterval",void 0);var qe,Ke=We=Me=(0,v.e)([(0,v.n)("esri.webdoc.widgets.Range")],We),ze=qe=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).currentTimeExtent=null,n.fullTimeExtent=null,n.loop=!1,n.numStops=null,n.numThumbs=null,n.stopDelay=null,n.stopInterval=null,n.stops=null,n}return(0,d.Z)(r,[{key:"readCurrentTimeExtent",value:function(e){if(e){var t=null!=e[0]?new Date(e[0]):null,r=null!=e[1]?new Date(e[1]):null;return new D.y({start:t,end:r})}}},{key:"writeCurrentTimeExtent",value:function(e,t,r){e&&(0,w.o)(r,[(0,w.r)(e.start)?e.start.getTime():null,(0,w.r)(e.end)?e.end.getTime():null],t)}},{key:"readFullTimeExtent",value:function(e,t){var r=t.properties;if(r){var n=null!=r.endTime?new Date(r.endTime):null,i=null!=r.startTime?new Date(r.startTime):null;return new D.y({start:i,end:n})}}},{key:"writeFullTimeExtent",value:function(e,t){if(e){var r=t.properties=t.properties||{},n=e.end,i=e.start;n&&(r.endTime=(0,w.r)(n)?n.getTime():null),i&&(r.startTime=(0,w.r)(i)?i.getTime():null)}}},{key:"readStopInterval",value:function(e,t,r){return e?B.l.fromJSON({value:e.interval,unit:e.units},r):null}},{key:"writeStopInterval",value:function(e,t,r,n){if(e){var i=e.toJSON(n);(0,w.o)(r,{interval:i.value,units:i.unit},t)}}},{key:"readStops",value:function(e){return e&&e.length?e.map((function(e){return new Date(e)})):null}},{key:"writeStops",value:function(e,t,r){e&&e.length&&(0,w.o)(r,e.map((function(e){return e.getTime()})),t)}},{key:"clone",value:function(){return new qe((0,w.m)({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}}]),r}(_.l);(0,v.e)([(0,v.d)({type:D.y,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],ze.prototype,"currentTimeExtent",void 0),(0,v.e)([(0,x.o)("currentTimeExtent")],ze.prototype,"readCurrentTimeExtent",null),(0,v.e)([(0,x.r)("currentTimeExtent")],ze.prototype,"writeCurrentTimeExtent",null),(0,v.e)([(0,v.d)({type:D.y,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],ze.prototype,"fullTimeExtent",void 0),(0,v.e)([(0,x.o)("fullTimeExtent")],ze.prototype,"readFullTimeExtent",null),(0,v.e)([(0,x.r)("fullTimeExtent")],ze.prototype,"writeFullTimeExtent",null),(0,v.e)([(0,v.d)({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],ze.prototype,"loop",void 0),(0,v.e)([(0,v.d)({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy:function(){var e,t=!!this.stopInterval,r=!(null===(e=this.stops)||void 0===e||!e.length),n=!(t||r);return{enabled:n,isRequired:n}}}}})],ze.prototype,"numStops",void 0),(0,v.e)([(0,v.d)({type:[1,2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],ze.prototype,"numThumbs",void 0),(0,v.e)([(0,v.d)({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],ze.prototype,"stopDelay",void 0),(0,v.e)([(0,v.d)({type:B.l,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy:function(){var e,t=null!=this.numStops,r=!(null===(e=this.stops)||void 0===e||!e.length);return{enabled:!r,isRequired:!(t||r)}}}}})],ze.prototype,"stopInterval",void 0),(0,v.e)([(0,x.o)("stopInterval")],ze.prototype,"readStopInterval",null),(0,v.e)([(0,x.r)("stopInterval")],ze.prototype,"writeStopInterval",null),(0,v.e)([(0,v.d)({type:[Date],json:{read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy:function(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],ze.prototype,"stops",void 0),(0,v.e)([(0,x.o)("stops")],ze.prototype,"readStops",null),(0,v.e)([(0,x.r)("stops")],ze.prototype,"writeStops",null);var He,Ye=ze=qe=(0,v.e)([(0,v.n)("esri.webdoc.widgets.TimeSlider")],ze),Qe=He=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).range=null,n.timeSlider=null,n.floorFilter=null,n}return(0,d.Z)(r,[{key:"clone",value:function(){return new He((0,w.m)({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}}]),r}(_.l);(0,v.e)([(0,v.d)({type:Ke,json:{write:!0}})],Qe.prototype,"range",void 0),(0,v.e)([(0,v.d)({type:Ye,json:{write:!0}})],Qe.prototype,"timeSlider",void 0),(0,v.e)([(0,v.d)({type:De,json:{write:!0}})],Qe.prototype,"floorFilter",void 0);var Xe,$e=Qe=He=(0,v.e)([(0,v.n)("esri.webdoc.Widgets")],Qe),et=Xe=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).editing=null,n.offline=null,n.viewing=null,n}return(0,d.Z)(r,[{key:"clone",value:function(){return new Xe((0,w.m)({editing:this.editing,offline:this.offline,viewing:this.viewing}))}}]),r}(_.l);(0,v.e)([(0,v.d)({json:{write:!0}})],et.prototype,"editing",void 0),(0,v.e)([(0,v.d)({json:{write:!0}})],et.prototype,"offline",void 0),(0,v.e)([(0,v.d)({type:V.i,json:{write:!0}})],et.prototype,"viewing",void 0);var tt,rt=et=Xe=(0,v.e)([(0,v.n)("esri.webmap.ApplicationProperties")],et),nt="esri.webmap.Bookmark",it=v.s.getLogger(nt),ot=tt=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).name=null,n.thumbnail=new V.p,n.timeExtent=null,n}return(0,d.Z)(r,[{key:"castThumbnail",value:function(e){return"string"==typeof e?new V.p({url:e}):(0,v.b)(V.p,e)}},{key:"viewpoint",set:function(e){var t=e.targetGeometry,r=e.scale;(0,w.r)(t)&&"point"===t.type&&(0,w.t)(r)&&it.warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",e),this._set("viewpoint",e)}},{key:"readViewpoint",value:function(e,t){var r=t.extent,n=t.viewpoint;return g.u.fromJSON(n||{targetGeometry:r})}},{key:"writeViewpoint",value:function(e,t,r,n){if(e){var i=e.targetGeometry;if((0,w.r)(i)&&"extent"!==i.type){var o="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";null!==n&&void 0!==n&&n.messages?n.messages.push(new v.a("property:unsupported",o)):it.error(o)}else(0,w.r)(i)&&(t.extent=i.toJSON()),t[r]=e.toJSON()}}},{key:"clone",value:function(){return new tt((0,w.m)({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}}]),r}((0,q.s)(_.l));(0,v.e)([(0,v.d)({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],ot.prototype,"name",void 0),(0,v.e)([(0,v.d)({type:V.p,json:{write:{overridePolicy:function(e){return{enabled:!(!e||!e.url)}}}}})],ot.prototype,"thumbnail",void 0),(0,v.e)([(0,v.q)("thumbnail")],ot.prototype,"castThumbnail",null),(0,v.e)([(0,v.d)({type:D.y,json:{write:!0}})],ot.prototype,"timeExtent",void 0),(0,v.e)([(0,v.d)({type:g.u,nonNullable:!0,json:{write:!0}})],ot.prototype,"viewpoint",null),(0,v.e)([(0,x.o)("viewpoint",["extent","viewpoint"])],ot.prototype,"readViewpoint",null),(0,v.e)([(0,x.r)("viewpoint")],ot.prototype,"writeViewpoint",null);var at,ut=ot=tt=(0,v.e)([(0,v.n)(nt)],ot),st=at=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e){var n;return(0,c.Z)(this,r),(n=t.call(this,e)).background=null,n.rangeInfo=null,n.spatialReference=null,n.viewpoint=null,n}return(0,d.Z)(r,[{key:"clone",value:function(){return new at((0,w.m)({background:this.background,rangeInfo:this.rangeInfo,spatialReference:this.spatialReference,viewpoint:this.viewpoint}))}}]),r}(v.y);(0,v.e)([(0,v.d)({type:K.m})],st.prototype,"background",void 0),(0,v.e)([(0,v.d)({type:Ge})],st.prototype,"rangeInfo",void 0),(0,v.e)([(0,v.d)({type:x.k})],st.prototype,"spatialReference",void 0),(0,v.e)([(0,v.d)({type:g.u})],st.prototype,"viewpoint",void 0);var lt=st=at=(0,v.e)([(0,v.n)("esri.webmap.InitialViewProperties")],st),pt=function(e){(0,f.Z)(r,e);var t=(0,y.Z)(r);function r(e,n){return(0,c.Z)(this,r),t.call(this,e,n,"webmap")}return(0,d.Z)(r)}(z.r),ct=new pt(2,25),dt="Web Map",ft=b.j.ofType(ut),yt=b.j.ofType(ye),vt=v.s.getLogger("esri.WebMap"),mt=new Map;mt.set("image/jpeg","jpeg"),mt.set("image/jpg","jpg"),mt.set("image/png","png"),mt.set("image/gif","gif");var ht=F.f.JSAPI,gt="CollectorDisabled",wt="Collector",bt="Data Editing",St="OfflineDisabled",kt="Offline",Zt="Workforce Project",It="Workforce Worker",Tt="Workforce Dispatcher",xt=F.f.DEVELOPER_BASEMAP,jt=["NatGeo_World_Map","Ocean_Basemap","USA_Topo_Maps","World_Imagery","World_Street_Map","World_Terrain_Base","World_Topo_Map","World_Hillshade","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Reference/World_Boundaries_and_Places","Reference/World_Reference_Overlay","Reference/World_Transportation"].map((function(e){return e.toLowerCase()})),_t=function(e){(0,f.Z)(i,e);var t=(0,y.Z)(i);function i(e){var r;return(0,c.Z)(this,i),(r=t.call(this,e)).applicationProperties=null,r.bookmarks=new ft,r.floorInfo=null,r.geotriggersInfo=null,r.initialViewProperties=new lt,r.portalItem=null,r.presentation=null,r.sourceVersion=null,r.widgets=null,r.utilityNetworks=null,r.authoringApp=r.authoringAppVersion=null,r._isAuthoringAppSetByUser=r._isAuthoringAppVersionSetByUser=!1,r}return(0,d.Z)(i,[{key:"destroy",value:function(){var e=this.portalItem;this.portalItem=null,null===e||void 0===e||e.destroy()}},{key:"initialize",value:function(){if(this.when().catch((function(e){vt.error("#load()","Failed to load web map",e)})),this.resourceInfo){var e;try{e=this._validateJSON(this.resourceInfo)}catch(t){return void this.addResolvingPromise(Promise.reject(t))}this.read(e)}}},{key:"authoringApp",set:function(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}},{key:"writeAuthoringApp",value:function(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp=ht}},{key:"authoringAppVersion",set:function(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}},{key:"writeAuthoringAppVersion",value:function(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=m.c}},{key:"readInitialViewProperties",value:function(e,t){var r,n=new lt;t.background&&(n.background=K.m.fromJSON(t.background));var i=null===(r=t.initialState)||void 0===r?void 0:r.viewpoint;return i&&(i.rotation&&pt.parse(t.version||"","webmap").lessThan(2,20)&&"ArcGIS Pro"===t.authoringApp&&(i.rotation*=-1),n.viewpoint=g.u.fromJSON(i)),t.mapRangeInfo&&(n.rangeInfo=Ge.fromJSON(t.mapRangeInfo)),t.spatialReference&&(n.spatialReference=x.k.fromJSON(t.spatialReference)),n}},{key:"writeInitialViewProperties",value:function(e,t,r,n){if(e){var i=e.background;i&&i.color&&(t.background=i.write({},n)),e.viewpoint&&(t.initialState={viewpoint:e.viewpoint.write({},n)}),e.rangeInfo&&(t.mapRangeInfo=e.rangeInfo.toJSON(n)),e.spatialReference&&(t.spatialReference=e.spatialReference.write({},n))}}},{key:"writeLayers",value:function(e,t,r,n){t[r]=this._writeLayers(e,n,"operational-layers")}},{key:"readSourceVersion",value:function(e,t){var r=t.version.split("."),i=(0,n.Z)(r,2),o=i[0],a=i[1];return new pt(parseInt(o,10),parseInt(a,10))}},{key:"writeSourceVersion",value:function(e,t,r){t[r]="".concat(ct.major,".").concat(ct.minor)}},{key:"writeTables",value:function(e,t,r,n){var i=this._writeLayers(e,n,"tables");i.length&&(t[r]=i)}},{key:"thumbnailUrl",get:function(){return this.portalItem&&this.portalItem.thumbnailUrl||null},set:function(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride()}},{key:"load",value:function(e){return this.addResolvingPromise(this._loadFromSource()),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return(0,k.n)(this,(function(t){t(e.ground,e.basemap,e.layers,e.tables)}))}},{key:"read",value:function(e,t){var r=this;t=(0,u.Z)((0,u.Z)({},t),{},{origin:"web-map"});var n=this._getAuthoringPropsState();(0,_.d)(this,e,(function(t){return(0,o.Z)((0,a.Z)(i.prototype),"read",r).call(r,e,t)}),t),this._restoreAuthoringPropsFromState(n)}},{key:"write",value:function(e,t){if("loaded"!==this.loadStatus){var r=new v.a("webmap:not-loaded","Web map must be loaded before it can be serialized");throw vt.error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),r}return this._removeDanglingLayerRefs(),t=(0,u.Z)((0,u.Z)({},t),{},{origin:"web-map",restrictedWebMapWriting:!0,webmap:this}),(0,o.Z)((0,a.Z)(i.prototype),"write",this).call(this,e,t)}},{key:"save",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){var r,n,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},this._validateItem(),e.next=4,this._updateFromPromise;case 4:return e.next=6,this.load();case 6:return e.next=8,this._loadLayerContainers();case 8:return e.next=10,this._beforeSave();case 10:return e.next=12,this._validateMap();case 12:return r=this.portalItem,n={origin:"web-map",messages:[],writtenProperties:[],url:r.itemUrl&&(0,m.j)(r.itemUrl),portal:r.portal||S.B.getDefault()},i=this.write({},n),this._validateJSONForWriting(n,t),e.next=16,this._updateItemProperties(r);case 16:return e.next=18,this._updateItem(r,i,n);case 18:return e.next=20,this._updateItemThumbnail();case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveAs",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t,r){var n,i,o,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||{},n=this._getPortalItem(t),e.next=4,this._updateFromPromise;case 4:return e.next=6,this.load();case 6:return e.next=8,this._loadLayerContainers();case 8:return e.next=10,this._beforeSave();case 10:return e.next=12,this._validateMap();case 12:return i={origin:"web-map",messages:[],writtenProperties:[],url:null,portal:n.portal},o=this.write({},i),this._validateJSONForWriting(i,r),e.next=16,this._updateItemPropertiesForSaveAs(n);case 16:return a=this._getThumbnailState(),e.next=19,this._createItem(n,o,i,r);case 19:return this._restoreThumbnailFromState(a),e.next=22,this._updateItemThumbnail();case 22:return e.abrupt("return",n);case 23:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateFrom",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t,r){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._updateFromInternal(t,r),this._updateFromPromise=n,e.next=4,n;case 4:n===this._updateFromPromise&&(this._updateFromPromise=null);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getLayerJSONFromResourceInfo",value:function(e){var t,r,n,i,o=this.resourceInfo;return this._collectAllLayersJSON((0,w.x)([null===o||void 0===o||null===(t=o.baseMap)||void 0===t?void 0:t.baseMapLayers,null===o||void 0===o?void 0:o.operationalLayers,null===(r=this.basemap)||void 0===r||null===(n=r.resourceInfo)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.baseMapLayers])).find((function(t){return t.id===e.id}))}},{key:"_collectAllLayersJSON",value:function(e){var t=this;return e.reduce((function(e,r){return e.push(r),"GroupLayer"===r.layerType&&(e=e.concat(t._collectAllLayersJSON(r.layers||[]))),e}),[])}},{key:"_writeLayers",value:function(e,t,r){var n=this;return t=(0,u.Z)((0,u.Z)({},t),{},{layerContainerType:r}),e.map((function(e){return(0,w.e)((0,W.y)(e,"tables"===r?null:n.getLayerJSONFromResourceInfo(e),t))})).filter(Boolean).toArray()}},{key:"_loadFromSource",value:function(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):Promise.resolve(null)}},{key:"_loadFromItem",value:function(e){var t=this;return e.load().catch((function(e){throw new v.a("webmap:load-portal-item","Failed to load portal item",{error:e})})).then((function(){if("Web Map"!==e.type)throw new v.a("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:e.type})})).then((function(){return e.fetchData()})).then((function(r){return t.resourceInfo=r,t._readAndLoadFromJSON(r,{origin:"web-map",portal:e.portal||S.B.getDefault()})})).then((function(){return t._computeInitialViewpoint()}))}},{key:"_readAndLoadFromJSON",value:function(e,t){var r=this._validateJSON(e);return this.read(r,t),this._loadFromJSON(r,t)}},{key:"_validateJSON",value:function(e){var t=pt.parse(e.version||"","webmap");return ct.validate(t),e.version="".concat(t.major,".").concat(t.minor),e}},{key:"_loadFromJSON",value:function(e,t){var n=this,i={context:(0,u.Z)((0,u.Z)({},t),{},{layerContainerType:"operational-layers"})};return this.portalItem&&(i.context.portal=this.portalItem.portal||S.B.getDefault()),Promise.all([r.e(8854),r.e(6498),r.e(5907)]).then(r.bind(r,71883)).then((function(t){var r=t.populateOperationalLayers,o=[],a=e.operationalLayers;a&&a.length&&o.push(r(n.layers,a,i));var s=(0,u.Z)((0,u.Z)({},i),{},{context:(0,u.Z)((0,u.Z)({},i.context),{},{layerContainerType:"tables"}),defaultLayerType:"ArcGISFeatureLayer"}),l=e.tables;return l&&l.length&&o.push(r(n.tables,l,s)),(0,v.E)(o).then((function(){}))}))}},{key:"_computeInitialViewpoint",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(){var t,r,n,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.initialViewProperties,!(null===(t=n)||void 0===t||null===(r=t.viewpoint)||void 0===r?void 0:r.targetGeometry)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this._getExtentFromItem();case 6:(i=e.sent)&&((n=n?n.clone():new lt).viewpoint=new g.u,n.viewpoint.targetGeometry=i,this.initialViewProperties=n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getExtentFromItem",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(){var t,n,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null===(t=this.initialViewProperties)||void 0===t?void 0:t.spatialReference,o=null===(n=this.portalItem)||void 0===n?void 0:n.extent,!i||!o){e.next=9;break}if(!i.isWGS84){e.next=4;break}return e.abrupt("return",o.clone());case 4:if(!i.isWebMercator){e.next=6;break}return e.abrupt("return",(0,x.R)(o));case 6:return e.next=8,r.e(6982).then(r.bind(r,87603));case 8:return e.abrupt("return",e.sent.getGeometryServiceURL(this.portalItem).then((function(e){var t=new L.a;return t.geometries=[o],t.outSpatialReference=i,(0,L.n)(e,t)})).then((function(e){return e[0]})).catch((function(e){return vt.error("Error projecting item's extent:",e),null})));case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_removeDanglingLayerRefs",value:function(){var e=this,t=this.applicationProperties,r=t&&t.viewing&&t.viewing.search,n=function(t){return e.allLayers.some((function(e){return e.id===t}))};r&&r.layers&&(r.layers=r.layers.filter((function(e){return n(e.id)}))),r&&r.tables&&(r.tables=r.tables.filter((function(t){return e.tables.some((function(e){return e.id===t.id}))})));var i=t&&t.editing&&t.editing.locationTracking;i&&i.info&&!n(i.info.layerId)&&(t.editing=null);var o=this.presentation&&this.presentation.slides;o&&o.forEach((function(e){e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((function(e){return n(e.id)})))}))}},{key:"_validateMap",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(){var t,r,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=this.basemap)&&void 0!==t&&t.baseLayers.length){e.next=2;break}throw new v.a("webmap:save","Map does not have a valid basemap with a base layer.");case 2:return r=null,e.next=5,(0,T.j)((function(){var e=(0,h.h)(n.initialViewProperties,n.basemap);return r=e.spatialReference,!e.updating}));case 5:if((0,x.E)(r,this.initialViewProperties.spatialReference)){e.next=7;break}throw new v.a("webmap:save","The spatial reference of the basemap is not compatible with the one from the map.",{expected:this.initialViewProperties.spatialReference,actual:r});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_validateItem",value:function(){if(!this.portalItem)throw vt.error("save: requires the portalItem property to be set"),new v.a("webmap:portal-item-not-set","Portal item to save to has not been set on the WebMap");this._validateItemType(this.portalItem)}},{key:"_validateItemType",value:function(e){if(e.type!==dt)throw new v.a("webmap:portal-item-wrong-type",'Portal item needs to have type "'.concat(dt,'"'))}},{key:"_loadLayerContainers",value:function(){var e=[];return this.basemap&&e.push(this.basemap.load()),this.ground&&e.push(this.ground.load()),(0,v.E)(e).then((function(){}))}},{key:"_beforeSave",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(){var t,r,n,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],r=(0,s.Z)(this.allLayers);try{for(r.s();!(n=r.n()).done;)"beforeSave"in(i=n.value)&&"function"==typeof i.beforeSave&&(o=i.beforeSave())&&t.push(o)}catch(a){r.e(a)}finally{r.f()}return e.next=5,(0,v.E)(t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_loadAllLayers",value:function(){var e=this._getAllLayersAndTables().map((function(e){return e.load()}));return(0,v.E)(e).then((function(){}))}},{key:"_getAllLayersAndTables",value:function(){return this.allLayers.concat(this.allTables)}},{key:"_validateJSONForWriting",value:function(e,t){var r=e.messages.filter((function(e){return"error"===e.type})).map((function(e){return new v.a(e.name,e.message,e.details)}));if(t.ignoreUnsupported&&(r=r.filter((function(e){return"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name}))),r.length>0)throw new v.a("webmap:save","Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:r})}},{key:"_updateItemProperties",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry);case 2:return t.extent=e.sent,e.next=5,this._updateTypeKeywords(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateItemPropertiesForSaveAs",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,F.c)(t,gt),(0,F.c)(t,"FieldMapsDisabled"),(0,F.c)(t,F.f.METADATA),(0,F.c)(t,St),(0,F.c)(t,"Offline Map Areas"),(0,F.c)(t,Tt),(0,F.c)(t,Zt),(0,F.c)(t,It),e.next=10,this._updateItemProperties(t);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getWGS84Extent",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){var r,n,i,o,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.clone().normalize()).length>1){i=(0,s.Z)(r);try{for(i.s();!(o=i.n()).done;)a=o.value,n?a.width>n.width&&(n=a):n=a}catch(u){i.e(u)}finally{i.f()}}else n=r[0];return e.abrupt("return",this._projectToWGS84(n));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_projectToWGS84",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){var n,i,o,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.spatialReference).isWGS84){e.next=3;break}return e.abrupt("return",t.clone());case 3:if(!n.isWebMercator){e.next=5;break}return e.abrupt("return",(0,x.a)(t));case 5:return e.next=7,r.e(6982).then(r.bind(r,87603));case 7:return i=e.sent,e.next=10,i.getGeometryServiceURL(this.portalItem);case 10:return o=e.sent,(a=new L.a).geometries=[t],a.outSpatialReference=x.k.WGS84,e.next=15,(0,L.n)(o,a);case 15:return e.abrupt("return",e.sent[0]);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateTypeKeywords",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,F.i)(t,ht),e.next=3,this._loadAllLayers();case 3:this._evalCollectorKeyword(t),this._evalDataEditingKeyword(t),this._evalOfflineKeyword(t),this._evalDeveloperBasemapKeyword(t),t.typeKeywords&&(t.typeKeywords=t.typeKeywords.filter((function(e,t,r){return r.indexOf(e)===t})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_evalCollectorKeyword",value:function(e){(0,F.s)(e,gt)||(0,F.s)(e,Zt)||(0,F.s)(e,It)||(0,F.s)(e,Tt)||!this._hasEditableFeatureLayer()?(0,F.c)(e,wt):(0,F.i)(e,wt)}},{key:"_evalDataEditingKeyword",value:function(e){this._hasEditableFeatureLayer()?(0,F.i)(e,bt):(0,F.c)(e,bt)}},{key:"_evalOfflineKeyword",value:function(e){!(0,F.s)(e,St)&&this._isOfflineCapableMap()?(0,F.i)(e,kt):(0,F.c)(e,kt)}},{key:"_evalDeveloperBasemapKeyword",value:function(e){(0,h.v)(this.basemap)?(0,F.i)(e,xt):(0,F.c)(e,xt)}},{key:"_hasEditableFeatureLayer",value:function(){return this._getAllLayersAndTables().some((function(e){return e.loaded&&(0,O.l)(e)&&e.capabilities.operations.supportsEditing&&e.editingEnabled}))}},{key:"_isOfflineCapableMap",value:function(){var e=this;return this._getAllLayersAndTables().filter((function(e){return"group"!==e.type})).every((function(t){return t.loaded&&e._isOfflineCapableLayer(t)}))}},{key:"_isFeatureCollectionLike",value:function(e){return(0,O.a)(e)||"map-notes"===e.type||"route"===e.type}},{key:"_isOfflineCapableLayer",value:function(e){return(0,O.l)(e)&&e.capabilities.operations.supportsSync||this._isFeatureCollectionLike(e)&&!e.portalItem||("tile"===e.type||"vector-tile"===e.type)&&(e.capabilities.operations.supportsExportTiles||this._isExportableAGOLTileLayer(e)||(0,h.S)(e))&&e.spatialReference.equals(this.initialViewProperties.spatialReference)}},{key:"_isExportableAGOLTileLayer",value:function(e){return"tile"===e.type&&(0,N.j)(e.url)&&jt.some((function(t){return e.url.toLowerCase().includes("/"+t+"/")}))}},{key:"_updateItem",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t,r,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update({data:r});case 2:this._syncUpInstanceWithItem(t,r,n);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_createItem",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t,r,n,i){var o,a,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.portalItem,a=!!(o&&o.id&&o.portal.user),u=t.portal,e.next=3,u._signIn();case 3:return e.next=5,this._canCopyItem(o,a,u);case 5:if(e.sent){e.next=7;break}throw new v.a("webmap:save-as-copy-not-allowed","Owner of this map does not allow others to save a copy");case 7:return e.next=9,u.user.addItem({item:t,folder:i.folder,data:r});case 9:this.portalItem=t,this._syncUpInstanceWithItem(t,r,n);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"_canCopyItem",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t,r,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!((0,w.r)(t)&&t.id&&t.typeKeywords&&t.typeKeywords.includes("useOnly")),e.t0){e.next=10;break}if(e.t1=t.portal.portalHostname===n.portalHostname,!e.t1){e.next=9;break}if(e.t2=r,e.t2){e.next=8;break}return e.next=8,t.reload();case 8:e.t1="admin"===t.itemControl||"update"===t.itemControl;case 9:e.t0=e.t1;case 10:return e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_syncUpInstanceWithItem",value:function(e,t,r){Z.S.prototype.read.call(this,{version:t.version,authoringApp:t.authoringApp,authoringAppVersion:t.authoringAppVersion},{origin:"web-map",ignoreDefaults:!0,url:e.itemUrl&&(0,m.j)(e.itemUrl)}),(0,j.i)(r),this.resourceInfo=t}},{key:"_updateItemThumbnail",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.thumbnailUrl&&this._isOverridden("thumbnailUrl"),!e.t0){e.next=5;break}return e.next=4,this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename});case 4:this._clearThumbnailOverride();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getPortalItem",value:function(e){var t=P.default.from(e);return t.id&&((t=t.clone()).id=null),t.type||(t.type=dt),t.portal||(t.portal=S.B.getDefault()),this._validateItemType(t),t}},{key:"_updateFromInternal",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t,r){var n,i,o,a,u,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||{},e.next=3,(0,T.j)((function(){return t.ready}));case 3:if(this._updateInitialViewProperties(t,r),t.map!==this){e.next=7;break}n=(0,s.Z)(t.allLayerViews);try{for(n.s();!(i=n.n()).done;)for(o=i.value,a=0,u=["visible","featureEffect"];a<u.length;a++)(p=u[a])in o&&p in o.layer&&o._isOverridden(p)&&(o.layer[p]=o[p])}catch(l){n.e(l)}finally{n.f()}case 7:return e.next=9,this._updateThumbnailUrl(t,r);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_updateInitialViewProperties",value:function(e,t){var r;if(t.backgroundExcluded||(this.initialViewProperties.background=null===(r=e.background)||void 0===r?void 0:r.clone()),this.initialViewProperties.spatialReference=e.spatialReference.clone(),t.viewpointExcluded||(this.initialViewProperties.viewpoint=new g.u({rotation:e.rotation,scale:t.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)})),!t.widgetsExcluded){var n,i=(0,s.Z)(e.persistableViewModels);try{for(i.s();!(n=i.n()).done;){n.value.updateWebDocument(this)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"_getViewExtent",value:function(e){var t=e.center.clone().normalize(),r=e.extent.clone(),n=r.width/2;return r.xmin=t.x-n,r.xmax=t.x+n,r}},{key:"_updateThumbnailUrl",value:function(){var e=(0,p.Z)((0,l.Z)().mark((function e(t,r){var n,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.thumbnailExcluded){e.next=2;break}return e.abrupt("return");case 2:return n=(0,V.a)(t,r.thumbnailSize),e.next=5,t.takeScreenshot({format:"png",width:n.width,height:n.height});case 5:i=e.sent,this._setAutoGeneratedThumbnail(i.dataUrl);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_setAutoGeneratedThumbnail",value:function(e){this.thumbnailUrl=e,this._thumbnailFilename=null}},{key:"_clearThumbnailOverride",value:function(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}},{key:"_generateCustomThumbnailFilename",value:function(e){if((0,m.X)(e)){var t=(0,m.n)(e),r=t&&t.mediaType,n=r&&mt.get(r.toLowerCase())||null,i="thumbnail".concat(Date.now());return n?"".concat(i,".").concat(n):i}return null}},{key:"_getThumbnailState",value:function(){var e=this.thumbnailUrl;return e&&(e=this._isOverridden("thumbnailUrl")?e:(0,m.S)(e,"w","8192")),{thumbnailUrl:e,filename:this._thumbnailFilename}}},{key:"_restoreThumbnailFromState",value:function(e){this.thumbnailUrl=e.thumbnailUrl,this._thumbnailFilename=e.filename}},{key:"_getAuthoringPropsState",value:function(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}},{key:"_restoreAuthoringPropsFromState",value:function(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1,e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}}],[{key:"fromJSON",value:function(e){var t=e;if(!t)throw new v.a("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:t})}}]),i}((0,Z.O)(S.m.LoadableMixin((0,I.m)(h.L))));_t.VERSION=ct,(0,v.e)([(0,v.d)({type:rt,json:{write:!0}})],_t.prototype,"applicationProperties",void 0),(0,v.e)([(0,v.d)({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],_t.prototype,"authoringApp",null),(0,v.e)([(0,x.r)("authoringApp")],_t.prototype,"writeAuthoringApp",null),(0,v.e)([(0,v.d)({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],_t.prototype,"authoringAppVersion",null),(0,v.e)([(0,x.r)("authoringAppVersion")],_t.prototype,"writeAuthoringAppVersion",null),(0,v.e)([(0,v.d)({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],_t.prototype,"basemap",void 0),(0,v.e)([(0,v.d)({type:ft,json:{write:{overridePolicy:function(e){return{enabled:!!(e&&e.length>0),ignoreOrigin:!0}}}}})],_t.prototype,"bookmarks",void 0),(0,v.e)([(0,v.d)({type:V.l,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],_t.prototype,"floorInfo",void 0),(0,v.e)([(0,v.d)({type:Le,json:{write:!0}})],_t.prototype,"geotriggersInfo",void 0),(0,v.e)([(0,v.d)({type:lt,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference"]},write:{ignoreOrigin:!0,target:{background:{type:K.m},"initialState.viewpoint":{type:g.u},mapRangeInfo:{type:Ge},spatialReference:{type:x.k}}}}})],_t.prototype,"initialViewProperties",void 0),(0,v.e)([(0,x.o)("initialViewProperties")],_t.prototype,"readInitialViewProperties",null),(0,v.e)([(0,x.r)("initialViewProperties")],_t.prototype,"writeInitialViewProperties",null),(0,v.e)([(0,v.d)({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],_t.prototype,"layers",void 0),(0,v.e)([(0,x.r)("layers")],_t.prototype,"writeLayers",null),(0,v.e)([(0,v.d)({type:P.default})],_t.prototype,"portalItem",void 0),(0,v.e)([(0,v.d)({json:{write:!0}})],_t.prototype,"presentation",void 0),(0,v.e)([(0,v.d)()],_t.prototype,"resourceInfo",void 0),(0,v.e)([(0,v.d)({readOnly:!0,type:pt,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],_t.prototype,"sourceVersion",void 0),(0,v.e)([(0,x.o)("sourceVersion")],_t.prototype,"readSourceVersion",null),(0,v.e)([(0,x.r)("sourceVersion")],_t.prototype,"writeSourceVersion",null),(0,v.e)([(0,v.d)({json:{read:!1,write:{ignoreOrigin:!0}}})],_t.prototype,"tables",void 0),(0,v.e)([(0,x.r)("tables")],_t.prototype,"writeTables",null),(0,v.e)([(0,v.d)()],_t.prototype,"thumbnailUrl",null),(0,v.e)([(0,v.d)({type:$e,json:{write:!0}})],_t.prototype,"widgets",void 0),(0,v.e)([(0,v.d)({type:yt,json:{read:!0,write:!0}})],_t.prototype,"utilityNetworks",void 0);var Nt=_t=(0,v.e)([(0,v.n)("esri.WebMap")],_t);t.default=Nt},97866:function(e,t,r){r.d(t,{I:function(){return S},L:function(){return w},S:function(){return g},b:function(){return b},d:function(){return d},g:function(){return h},h:function(){return v},j:function(){return k},m:function(){return f},w:function(){return y},y:function(){return m}});var n=r(29439),i=r(75610),o=r(57714),a=r(96349),u={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},s=Object.values(u),l=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(s.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),p=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(s.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),c=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function d(e){return!!l.test(e)}function f(e){if((0,i.t)(e))return null;var t=(0,o.j)(e),r=t.path.match(l)||t.path.match(p);if(!r)return null;var a=(0,n.Z)(r,5),s=a[1],c=a[2],d=a[3],f=a[4],y=c.indexOf("/");return{title:v(-1!==y?c.slice(y+1):c),serverType:u[d.toLowerCase()],sublayer:null!=f&&""!==f?parseInt(f,10):null,url:{path:s}}}function y(e){var t=(0,o.j)(e).path.match(c);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function v(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function m(e,t){var r=[];if(e){var n=f(e);(0,i.r)(n)&&n.title&&r.push(n.title)}if(t){var o=v(t);r.push(o)}if(2===r.length){if(r[0].toLowerCase().includes(r[1].toLowerCase()))return r[0];if(r[1].toLowerCase().includes(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function h(e){if(!e)return!1;var t=(e=e.toLowerCase()).includes(".arcgis.com/"),r=e.includes("//services")||e.includes("//tiles")||e.includes("//features");return t&&r}function g(e,t){return e?(0,o.C)((0,o.A)(e,t)):e}function w(e){var t=e.url;if(!t)return{url:t};t=(0,o.A)(t,e.logger);var r,n=(0,o.j)(t),a=f(n.path);if((0,i.r)(a))null!=a.sublayer&&null==e.layer.layerId&&(r=a.sublayer),t=a.url.path;else if(e.nonStandardUrlAllowed){var u=y(n.path);(0,i.r)(u)&&(t=u.serviceUrl,r=u.sublayerId)}return{url:(0,o.C)(t),layerId:r}}function b(e,t,r,n,i){(0,a.p)(t,n,"url",i),n.url&&null!=e.layerId&&(n.url=(0,o.G)(n.url,r,e.layerId.toString()))}function S(e){if(!e)return!1;var t=e.toLowerCase(),r=t.includes("/services/"),n=t.includes("/mapserver/wmsserver"),i=t.includes("/imageserver/wmsserver"),o=t.includes("/wmsserver");return r&&(n||i||o)}function k(e){if(!e)return!1;var t=new o.y((0,o.Q)(e)).authority.toLowerCase();return"server.arcgisonline.com"===t||"services.arcgisonline.com"===t}},50338:function(e,t,r){r.d(t,{S:function(){return u},e:function(){return n},i:function(){return i},l:function(){return o},o:function(){return a},r:function(){return l},s:function(){return p},t:function(){return s},y:function(){return c}});var n=[252,146,31,255],i=[153,153,153,255],o={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},a={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},u={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},s={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},l={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},p={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},c={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},50448:function(e,t,r){r.d(t,{r:function(){return o}});var n=r(57714),i=r(23132);function o(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e instanceof n.s?e:new n.s(e,r),a={type:null===(t=null===r||void 0===r?void 0:r.ignoreUnknown)||void 0===t||t?o.apiValues:String,json:{type:o.jsonValues,read:!(null!==r&&void 0!==r&&r.readOnly)&&{reader:o.read},write:{writer:o.write}}};return void 0!==(null===r||void 0===r?void 0:r.readOnly)&&(a.readOnly=!!r.readOnly),void 0!==(null===r||void 0===r?void 0:r.default)&&(a.json.default=r.default),void 0!==(null===r||void 0===r?void 0:r.name)&&(a.json.name=r.name),(0,i.d)(a)}},20005:function(e,t,r){r.d(t,{a:function(){return l},t:function(){return u}});var n=r(74165),i=r(15861),o=r(75610),a=r(34860);function u(e,t,r){return s.apply(this,arguments)}function s(){return s=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){var a,u,s,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=r.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(r.maxRecordCountFactor=p(t)),a=l(t),u=t.capabilities.query.supportsPagination,r.start=0,r.num=a,s=null;case 4:return e.next=6,t.source.queryFeaturesJSON(r,i);case 6:if(c=e.sent,(0,o.t)(s)?s=c:s.features=s.features.concat(c.features),s.exceededTransferLimit=c.exceededTransferLimit,u&&c.exceededTransferLimit){e.next=9;break}return e.abrupt("break",12);case 9:r.start+=a;case 10:e.next=4;break;case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function l(e){return p(e)*function(e){return e.capabilities.query.maxRecordCount||2e3}(e)}function p(e){return e.capabilities.query.supportsMaxRecordCountFactor?a.b.MAX_MAX_RECORD_COUNT_FACTOR:1}},91204:function(e,t,r){r.d(t,{a:function(){return s},i:function(){return p},t:function(){return l}});var n=r(23132),i=r(80262),o=r(30709),a=r(36460),u=r(57714),s=(0,u.o)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),l=(0,u.o)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),p={base:o.p,key:"type",typeMap:{extent:i.M,multipoint:a.a,point:o.j,polyline:a.m,polygon:a.v}};(0,n.N)(p)},30604:function(e,t,r){r.d(t,{a:function(){return v},c:function(){return c},d:function(){return d},f:function(){return s},l:function(){return l},s:function(){return u},v:function(){return f},y:function(){return p}});var n=r(75610),i=r(80262),o=r(30709),a=r(36460);function u(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}function s(e){return void 0!==e.points}function l(e){return void 0!==e.x&&void 0!==e.y}function p(e){return void 0!==e.paths}function c(e){return void 0!==e.rings}function d(e){return(0,n.t)(e)?null:e instanceof o.p?e:l(e)?o.j.fromJSON(e):p(e)?a.m.fromJSON(e):c(e)?a.v.fromJSON(e):s(e)?a.a.fromJSON(e):u(e)?i.M.fromJSON(e):null}function f(e){return e?l(e)?"esriGeometryPoint":p(e)?"esriGeometryPolyline":c(e)?"esriGeometryPolygon":u(e)?"esriGeometryEnvelope":s(e)?"esriGeometryMultipoint":null:null}var y={esriGeometryPoint:o.j,esriGeometryPolyline:a.m,esriGeometryPolygon:a.v,esriGeometryEnvelope:i.M,esriGeometryMultipoint:a.a};function v(e){return e&&y[e]||null}},98805:function(e,t,r){function n(e){return e&&"getAtOrigin"in e&&"originOf"in e}r.d(t,{i:function(){return n}})},81905:function(e,t,r){r.d(t,{i:function(){return i}});var n=r(98805);function i(e){e&&e.writtenProperties&&e.writtenProperties.forEach((function(e){var t=e.target,r=e.propName,i=e.newOrigin;(0,n.i)(t)&&i&&t.originOf(r)!==i&&t.updateOrigin(r,i)}))}},96349:function(e,t,r){r.d(t,{I:function(){return l},R:function(){return m},U:function(){return y},c:function(){return a},h:function(){return f},i:function(){return o},m:function(){return u},p:function(){return s}});var n=r(75610),i=r(57714);function o(e,t){var r=t&&t.url&&t.url.path;if(e&&r&&(e=(0,i.Q)(e,r,{preserveProtocolRelative:!0}),t.portalItem&&t.readResourcePaths)){var n=(0,i._)(e,t.portalItem.itemUrl);d.test(n)&&t.readResourcePaths.push(t.portalItem.resourceFromPath(n).path)}return v(e,t&&t.portal)}function a(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.YES;if(!e)return e;!(0,i.K)(e)&&t&&t.blockedRelativeUrls&&t.blockedRelativeUrls.push(e);var n=(0,i.Q)(e);if(t){var o=t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.rootPath||t.url&&t.url.path;if(o){var a=v(o,t.portal);(n=(0,i._)(v(n,t.portal),a,a))!==e&&t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.writtenUrls.push(n)}}return n=y(n,t&&t.portal),(0,i.K)(n)&&(n=(0,i.F)(n)),null!==t&&void 0!==t&&t.resources&&null!==t&&void 0!==t&&t.portalItem&&!(0,i.K)(n)&&!(0,i.X)(n)&&r===l.YES&&t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(n)}),n}function u(e,t,r){return o(e,r)}function s(e,t,r,n){var i=a(e,n);void 0!==i&&(t[r]=i)}var l,p,c=/\/items\/([^\/]+)\/resources\//,d=/^\.\/resources\//;function f(e){var t=(0,n.r)(e)?e.match(c):null;return(0,n.r)(t)?t[1]:null}function y(e,t){return t&&!t.isPortal&&t.urlKey&&t.customBaseUrl?(0,i.v)(e,"".concat(t.urlKey,".").concat(t.customBaseUrl),t.portalHostname):e}function v(e,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return e;var r="".concat(t.urlKey,".").concat(t.customBaseUrl),n=(0,i.b)();return(0,i.z)(n,"".concat(n.scheme,"://").concat(r))?(0,i.v)(e,t.portalHostname,r):(0,i.v)(e,r,t.portalHostname)}(p=l||(l={}))[p.YES=0]="YES",p[p.NO=1]="NO";var m=Object.freeze(Object.defineProperty({__proto__:null,fromJSON:o,toJSON:a,read:u,write:s,itemIdFromResourceUrl:f,ensureMainOnlineDomain:y,get MarkKeep(){return l}},Symbol.toStringTag,{value:"Module"}))},56384:function(e,t,r){r.d(t,{a:function(){return f},c:function(){return d},f:function(){return v},i:function(){return p},s:function(){return c}});var n=r(37762),i=r(74165),o=r(15861),a=r(63022),u=r(30709);function s(e){return l.apply(this,arguments)}function l(){return l=(0,o.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.spatialReference).isWGS84){e.next=3;break}return e.abrupt("return",t.clone());case 3:if(!r.isWebMercator){e.next=5;break}return e.abrupt("return",(0,u.a)(t));case 5:return n=u.k.WGS84,e.next=8,(0,a.f)(r,n);case 8:return e.abrupt("return",(0,a.r)(t,n));case 9:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function p(e,t){if(!c(e,t)){var r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function c(e,t){var r;return!(null===(r=e.typeKeywords)||void 0===r||!r.includes(t))}function d(e,t){var r=e.typeKeywords;if(r){var n=r.indexOf(t);n>-1&&r.splice(n,1)}}function f(e){return y.apply(this,arguments)}function y(){return(y=(0,o.Z)((0,i.Z)().mark((function e(t){var r,o,a,u,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.clone().normalize()).length>1){a=(0,n.Z)(r);try{for(a.s();!(u=a.n()).done;)l=u.value,o?l.width>o.width&&(o=l):o=l}catch(i){a.e(i)}finally{a.f()}}else o=r[0];return e.abrupt("return",s(o));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table"}},22051:function(e,t,r){r.d(t,{a:function(){return h},n:function(){return w}});var n=r(74165),i=r(1413),o=r(15861),a=r(15671),u=r(43144),s=r(60136),l=r(29388),p=r(57714),c=r(23132),d=r(30604),f=r(69202),y=r(70441);r(75610);function v(e,t,r){var n=(0,d.a)(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))}var m=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).geometries=null,n.outSpatialReference=null,n.transformation=null,n.transformForward=null,n}return(0,u.Z)(r,[{key:"toJSON",value:function(){var e=this.geometries.map((function(e){return e.toJSON()})),t=this.geometries[0],r={};return r.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),r.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),r.geometries=JSON.stringify({geometryType:(0,d.v)(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(r.transformForward=this.transformForward),r}}]),r}(y.l);(0,c.e)([(0,c.d)()],m.prototype,"geometries",void 0),(0,c.e)([(0,c.d)({json:{read:{source:"outSR"}}})],m.prototype,"outSpatialReference",void 0),(0,c.e)([(0,c.d)()],m.prototype,"transformation",void 0),(0,c.e)([(0,c.d)()],m.prototype,"transformForward",void 0);var h=m=(0,c.e)([(0,c.n)("esri.rest.support.ProjectParameters")],m),g=(0,c.b)(h);function w(e,t,r){return b.apply(this,arguments)}function b(){return b=(0,o.Z)((0,n.Z)().mark((function e(t,r,o){var a,u,s,l,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=g(r),a=(0,f.n)(t),u=(0,i.Z)((0,i.Z)({},a.query),{},{f:"json"},r.toJSON()),s=r.outSpatialReference,l=(0,d.v)(r.geometries[0]),c=(0,f.e)(u,o),e.abrupt("return",(0,p.U)(a.path+"/project",c).then((function(e){return v(e.data.geometries,l,s)})));case 3:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}},28999:function(e,t,r){r.d(t,{r:function(){return a}});var n=r(37762),i=r(75610),o=r(69953);function a(e,t,r){if(r&&r.features&&r.hasZ){var a=(0,o.o)(r.geometryType,t,e.outSpatialReference);if(!(0,i.t)(a)){var u,s=(0,n.Z)(r.features);try{for(s.s();!(u=s.n()).done;){a(u.value.geometry)}}catch(l){s.e(l)}finally{s.f()}}}}},47642:function(e,t,r){var n,i;function o(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function a(e){return null!=e&&!isNaN(e)&&isFinite(e)}function u(e){return e.valueExpression?n.Expression:e.field&&"string"==typeof e.field?n.Field:n.Unknown}function s(e,t){var r=t||u(e),o=e.valueUnit||"unknown";return r===n.Unknown?i.Constant:e.stops?i.Stops:null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?i.ClampedLinear:"unknown"===o?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?i.Proportional:i.Additive:i.Identity:i.RealWorldSize}r.d(t,{a:function(){return s},e:function(){return o},i:function(){return i},l:function(){return a},n:function(){return n},t:function(){return u}}),function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"}(n||(n={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(i||(i={}))},53249:function(e,t,r){r.d(t,{r:function(){return a},t:function(){return s}});var n=r(74165),i=r(15861),o=r(75610);function a(e,t){return u.apply(this,arguments)}function u(){return u=(0,i.Z)((0,n.Z)().mark((function e(t,i){var o,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(1019).then(r.bind(r,81019));case 2:return o=e.sent,a=o.WhereClause,e.abrupt("return",a.create(t,i));case 5:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function s(e,t){return(0,o.r)(e)?(0,o.r)(t)?"(".concat(e,") AND (").concat(t,")"):e:t}},69202:function(e,t,r){r.d(t,{e:function(){return a},n:function(){return u},o:function(){return s}});var n=r(1413),i=r(75610),o=r(57714);function a(e,t){return t?(0,n.Z)((0,n.Z)({},t),{},{query:(0,n.Z)((0,n.Z)({},e),t.query)}):{query:e}}function u(e){return"string"==typeof e?(0,o.j)(e):(0,i.m)(e)}function s(e,t,r){var n={};for(var i in e)if("declaredClass"!==i){var o=e[i];if(null!=o&&"function"!=typeof o)if(Array.isArray(o)){n[i]=[];for(var a=0;a<o.length;a++)n[i][a]=s(o[a])}else if("object"==typeof o)if(o.toJSON){var u=o.toJSON(r&&r[i]);n[i]=t?u:JSON.stringify(u)}else n[i]=t?o:JSON.stringify(o);else n[i]=o}return n}},69953:function(e,t,r){r.d(t,{o:function(){return u}});var n=r(37762),i=r(75610),o=r(44455),a=r(30709);function u(e,t,r){if((0,i.t)(t)||(0,i.t)(r)||r.vcsWkid||(0,a.E)(t,r))return null;var u=(0,o.W)(t)/(0,o.W)(r);if(1===u)return null;switch(e){case"point":case"esriGeometryPoint":return function(e){return function(e,t){e&&null!=e.z&&(e.z*=t)}(e,u)};case"polyline":case"esriGeometryPolyline":return function(e){return function(e,t){if(e){var r,i=(0,n.Z)(e.paths);try{for(i.s();!(r=i.n()).done;){var o,a=r.value,u=(0,n.Z)(a);try{for(u.s();!(o=u.n()).done;){var s=o.value;s.length>2&&(s[2]*=t)}}catch(l){u.e(l)}finally{u.f()}}}catch(l){i.e(l)}finally{i.f()}}}(e,u)};case"polygon":case"esriGeometryPolygon":return function(e){return function(e,t){if(e){var r,i=(0,n.Z)(e.rings);try{for(i.s();!(r=i.n()).done;){var o,a=r.value,u=(0,n.Z)(a);try{for(u.s();!(o=u.n()).done;){var s=o.value;s.length>2&&(s[2]*=t)}}catch(l){u.e(l)}finally{u.f()}}}catch(l){i.e(l)}finally{i.f()}}}(e,u)};case"multipoint":case"esriGeometryMultipoint":return function(e){return function(e,t){if(e){var r,i=(0,n.Z)(e.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.length>2&&(o[2]*=t)}}catch(a){i.e(a)}finally{i.f()}}}(e,u)};case"extent":case"esriGeometryExtent":return function(e){return function(e,t){e&&null!=e.zmin&&null!=e.zmax&&(e.zmin*=t,e.zmax*=t)}(e,u)};default:return null}}}}]);
//# sourceMappingURL=4853.60cf55b1.chunk.js.map