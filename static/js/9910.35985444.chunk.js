"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[9910],{75618:function(e,t,r){r.d(t,{v:function(){return C}});var n=r(74165),a=r(37762),i=r(15861),o=r(15671),s=r(43144),u=r(60136),l=r(29388),p=r(29439),c=r(48848),h=(r(93661),r(25456)),y=r(82474),d=r(3356),f=r(37677),m=r(65703),v=r(51732),g=Math.PI/180;function x(e){return e*g}function b(e,t){var r=x(t.rotation),n=Math.abs(Math.cos(r)),a=Math.abs(Math.sin(r)),i=(0,p.Z)(t.size,2),o=i[0],s=i[1];return e[0]=Math.round(s*a+o*n),e[1]=Math.round(s*n+o*a),e}function w(e,t,r,n){var a=(0,p.Z)(t,2),i=a[0],o=a[1],s=(0,p.Z)(n,2),u=s[0],l=s[1],c=.5*r;return e[0]=i-c*u,e[1]=o-c*l,e[2]=i+c*u,e[3]=o+c*l,e}var k=(0,h.u)(),Z=[0,0],S=new v.e(0,0,0,0),P=2048,M=2048,_=!1,R=!1,E=!1,I=function(e){(0,u.Z)(r,e);var t=(0,l.Z)(r);function r(e){var s;return(0,o.Z)(this,r),(s=t.call(this,e))._imagePromise=null,s.bitmaps=[],s.hidpi=E,s.imageMaxWidth=P,s.imageMaxHeight=M,s.imageRotationSupported=_,s.imageNormalizationSupported=R,s.update=(0,c.a1)(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,o,u,l,p,h,d,f,m,v,g,x,w,k,S,P,M,_,R,E;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,c.f)(r),t.stationary&&!s.destroyed){e.next=2;break}return e.abrupt("return");case 2:return i=t.state,o=(0,y.a)(i.spatialReference),u=s.hidpi?t.pixelRatio:1,(l=s.imageNormalizationSupported&&i.worldScreenWidth&&i.worldScreenWidth<i.size[0])?(Z[0]=i.worldScreenWidth,Z[1]=i.size[1]):s.imageRotationSupported?(Z[0]=i.size[0],Z[1]=i.size[1]):b(Z,i),p=Math.floor(Z[0]*u)>s.imageMaxWidth||Math.floor(Z[1]*u)>s.imageMaxHeight,h=o&&(i.extent.xmin<o.valid[0]||i.extent.xmax>o.valid[1]),d=!s.imageNormalizationSupported&&h,f=!p&&!d,m=s.imageRotationSupported?i.rotation:0,v=s.container.children.slice(),f?(g=l?i.paddedViewState.center:i.center,s._imagePromise&&console.error("Image promise was not defined!"),s._imagePromise=s._singleExport(i,Z,g,i.resolution,m,u,r)):(x=Math.min(s.imageMaxWidth,s.imageMaxHeight),d&&(x=Math.min(i.worldScreenWidth,x)),s._imagePromise=s._tiledExport(i,x,u,r)),e.prev=6,e.next=9,s._imagePromise;case 9:if(w=e.sent,(0,c.f)(r),k=[],s._imagePromise=null,!s.destroyed){e.next=14;break}return e.abrupt("return");case 14:s.bitmaps=null!==w&&void 0!==w?w:[],S=(0,a.Z)(v);try{for(M=function(){var e=P.value;w.includes(e)||k.push(e.fadeOut().then((function(){e.remove(),e.destroy()})))},S.s();!(P=S.n()).done;)M()}catch(n){S.e(n)}finally{S.f()}_=(0,a.Z)(w);try{for(_.s();!(R=_.n()).done;)E=R.value,k.push(E.fadeIn())}catch(n){_.e(n)}finally{_.f()}return e.next=21,Promise.all(k);case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(6),s._imagePromise=null,(0,c.w)(e.t0);case 26:case"end":return e.stop()}}),e,null,[[6,23]])})));return function(t,r){return e.apply(this,arguments)}}(),5e3),s.updateExports=(0,c.a1)(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,o,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],i=(0,a.Z)(s.container.children),e.prev=2,u=function(){var e=o.value;if(!e.visible||!e.stage)return{v:void 0};r.push(t(e).then((function(){e.invalidateTexture(),e.requestRender()})))},i.s();case 5:if((o=i.n()).done){e.next=11;break}if("object"!==typeof(l=u())){e.next=9;break}return e.abrupt("return",l.v);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),i.e(e.t0);case 16:return e.prev=16,i.f(),e.finish(16);case 19:return s._imagePromise=(0,c.E)(r).then((function(){return s._imagePromise=null})),e.next=22,s._imagePromise;case 22:case"end":return e.stop()}}),e,null,[[2,13,16,19]])})));return function(t){return e.apply(this,arguments)}}()),s}return(0,s.Z)(r,[{key:"destroy",value:function(){this.bitmaps.forEach((function(e){return e.destroy()})),this.bitmaps=[]}},{key:"updating",get:function(){return!this.destroyed&&null!==this._imagePromise}},{key:"_export",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,a,i,o,s){var u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchSource(t,Math.floor(r*o),Math.floor(a*o),{rotation:i,pixelRatio:o,signal:s});case 2:return u=e.sent,(0,c.f)(s),(l=new f.R(null,{immutable:!0,requestRenderOnSourceChangedEnabled:!0})).x=t.xmin,l.y=t.ymax,l.resolution=t.width/r,l.rotation=i,l.pixelRatio=o,l.opacity=0,this.container.addChild(l),e.next=14,l.setSourceAsync(u,s);case 14:return(0,c.f)(s),e.abrupt("return",l);case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,o){return e.apply(this,arguments)}}()},{key:"_singleExport",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,a,i,o,s,u){var l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(k,a,i,r),l=(0,h.f)(k,t.spatialReference),e.next=4,this._export(l,r[0],r[1],o,s,u);case 4:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,o,s){return e.apply(this,arguments)}}()},{key:"_tiledExport",value:function(e,t,r,n){var a=this,i=d.j.create({size:t,spatialReference:e.spatialReference,scales:[e.scale]}),o=new m.h(i),s=o.getTileCoverage(e);if(!s)return null;var u=[];return s.forEach((function(i,s,l,p){S.set(i,s,l,0),o.getTileBounds(k,S);var c=(0,h.f)(k,e.spatialReference);u.push(a._export(c,t,t,0,r,n).then((function(e){return 0!==p&&(S.set(i,s,l,p),o.getTileBounds(k,S),e.x=k[0],e.y=k[3]),e})))})),Promise.all(u)}}]),r}(c.m);(0,c.e)([(0,c.y)()],I.prototype,"_imagePromise",void 0),(0,c.e)([(0,c.y)()],I.prototype,"bitmaps",void 0),(0,c.e)([(0,c.y)()],I.prototype,"container",void 0),(0,c.e)([(0,c.y)()],I.prototype,"fetchSource",void 0),(0,c.e)([(0,c.y)()],I.prototype,"hidpi",void 0),(0,c.e)([(0,c.y)()],I.prototype,"imageMaxWidth",void 0),(0,c.e)([(0,c.y)()],I.prototype,"imageMaxHeight",void 0),(0,c.e)([(0,c.y)()],I.prototype,"imageRotationSupported",void 0),(0,c.e)([(0,c.y)()],I.prototype,"imageNormalizationSupported",void 0),(0,c.e)([(0,c.y)()],I.prototype,"requestUpdate",void 0),(0,c.e)([(0,c.y)()],I.prototype,"updating",null);var C=I=(0,c.e)([(0,c.n)("esri.views.2d.layers.support.ExportStrategy")],I)},91483:function(e,t,r){r.d(t,{l:function(){return p}});var n=r(15671),a=r(43144),i=r(60136),o=r(29388),s=r(48848),u=r(630),l=(r(93661),{visible:"visibleSublayers"}),p=function(e){(0,i.Z)(r,e);var t=(0,o.Z)(r);function r(e){var a;return(0,n.Z)(this,r),(a=t.call(this,e)).scale=0,a}return(0,a.Z)(r,[{key:"layer",set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.sublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("wms-sublayer-update",(function(e){return t.notifyChange(l[e.propertyName])}))],"layer"))}},{key:"layers",get:function(){return this.visibleSublayers.filter((function(e){return e.name})).map((function(e){return e.name})).join()}},{key:"version",get:function(){this.commitProperty("layers");var e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){var e=this.layer,t=this.scale,r=null===e||void 0===e?void 0:e.sublayers,n=[];return null!==r&&void 0!==r&&r.forEach((function e(r){var a=r.minScale,i=r.maxScale,o=r.sublayers;r.visible&&(0===t||(0===a||t<=a)&&(0===i||t>=i))&&(o?o.forEach(e):n.push(r))})),n}},{key:"toJSON",value:function(){var e=this.layer,t=this.layers;return{format:e.imageFormat,request:"GetMap",service:"WMS",styles:"",transparent:e.imageTransparency?"TRUE":"FALSE",version:e.version,layers:t}}}]),r}((0,u.a)(s.m));(0,s.e)([(0,s.y)()],p.prototype,"layer",null),(0,s.e)([(0,s.y)({readOnly:!0})],p.prototype,"layers",null),(0,s.e)([(0,s.y)({type:Number})],p.prototype,"scale",void 0),(0,s.e)([(0,s.y)({readOnly:!0})],p.prototype,"version",null),(0,s.e)([(0,s.y)({readOnly:!0})],p.prototype,"visibleSublayers",null),p=(0,s.e)([(0,s.n)("esri.layers.support.ExportWMSImageParameters")],p)},35264:function(e,t,r){r.d(t,{i:function(){return l}});var n=r(15671),a=r(43144),i=r(60136),o=r(29388),s=r(48848),u=r(50690),l=(r(93661),function(e){var t=function(e){(0,i.Z)(r,e);var t=(0,o.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,a.Z)(r,[{key:"initialize",value:function(){var e=this;this.handles.add((0,u.a)((function(){return e.layer}),"refresh",(function(t){e.doRefresh(t.dataChanged).catch((function(t){(0,s.j)(t)||s.a.getLogger(e.declaredClass).error(t)}))})),"RefreshableLayerView")}}]),r}(e);return(0,s.e)([(0,s.y)()],t.prototype,"layer",void 0),t=(0,s.e)([(0,s.n)("esri.layers.mixins.RefreshableLayerView")],t)})},84643:function(e,t,r){r.d(t,{a:function(){return p}});var n=r(15671),a=r(43144),i=r(60136),o=r(29388),s=r(48848),u=(r(93661),r(12953)),l=r(91483),p=function(e){var t=function(e){(0,i.Z)(r,e);var t=(0,o.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,a.Z)(r,[{key:"initialize",value:function(){this.exportImageParameters=new l.l({layer:this.layer})}},{key:"destroy",value:function(){this.exportImageParameters.destroy(),this.exportImageParameters=null}},{key:"exportImageVersion",get:function(){var e;return null!==(e=this.exportImageParameters)&&void 0!==e&&e.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}},{key:"fetchPopupFeatures",value:function(e){var t=this.layer;if(!e)return Promise.reject(new s.s("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t}));var r=t.popupEnabled;if(!r)return Promise.reject(new s.s("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:r}));var n=this.createFetchPopupFeaturesQuery(e);if(!n)return Promise.resolve([]);var a=n.extent,i=n.width,o=n.height,u=n.x,l=n.y;if(!(a&&i&&o))throw new s.s("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:a,width:i,height:o});return t.fetchFeatureInfo(a,i,o,u,l)}}]),r}(e);return(0,s.e)([(0,s.y)()],t.prototype,"exportImageParameters",void 0),(0,s.e)([(0,s.y)({readOnly:!0})],t.prototype,"exportImageVersion",null),(0,s.e)([(0,s.y)()],t.prototype,"layer",void 0),(0,s.e)([(0,s.y)(u.g)],t.prototype,"timeExtent",void 0),t=(0,s.e)([(0,s.n)("esri.layers.mixins.WMSLayerView")],t)}},19910:function(e,t,r){r.r(t);var n=r(1413),a=r(74165),i=r(15861),o=r(15671),s=r(43144),u=r(60136),l=r(29388),p=r(48848),c=r(50690),h=(r(93661),r(46817)),y=r(68146),d=r(91502),f=r(75618),m=r(52195),v=r(35264),g=r(84643),x=(r(82474),r(40114),r(6994),r(43066),r(7131),r(71802),r(1797),r(13239),r(27205),r(93122),r(75833),r(18144),r(1206),r(31698),r(92739),r(68136),r(74337),r(26313),r(44954),r(64095),r(37856),r(54233),r(4679),r(62312),r(5650),r(35602),r(84234),r(18030),r(33795),r(48200),r(79557),r(26151),r(91681),r(89794),r(60491),r(87917),r(29048),r(52559),r(56162),r(74384),r(40558),r(62466),r(93314),r(15751),r(81556),r(25456),r(3356),r(47855),r(37677),r(65703),r(51732),r(630),r(92072),r(65094),r(12953),r(89181),r(46337),r(15529),r(59984),r(85253),r(91483),function(e){(0,u.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments)).bitmapContainer=new y.a,e}return(0,s.Z)(r,[{key:"supportsSpatialReference",value:function(e){return this.layer.serviceSupportsSpatialReference(e)}},{key:"update",value:function(e){var t=this;this.strategy.update(e).catch((function(e){(0,p.j)(e)||p.a.getLogger(t.declaredClass).error(e)}))}},{key:"attach",value:function(){var e=this,t=this.layer,r=t.imageMaxHeight,n=t.imageMaxWidth;this.bitmapContainer=new y.a,this.container.addChild(this.bitmapContainer),this.strategy=new f.v({container:this.bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:r,imageMaxWidth:n,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.handles.add((0,c.l)((function(){return e.exportImageVersion}),(function(){return e.requestUpdate()})),"exportImageVersion")}},{key:"detach",value:function(){this.handles.remove("exportImageVersion"),this.strategy.destroy(),this.strategy=null,this.container.removeAllChildren()}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"createFetchPopupFeaturesQuery",value:function(e){var t=this.view,r=this.bitmapContainer,n=e.x,a=e.y,i=t.spatialReference,o=null,s=0,u=0;if(r.children.some((function(e){var t=e.width,r=e.height,l=e.resolution,p=e.x,c=e.y,y=p+l*t,d=c-l*r;return n>=p&&n<=y&&a<=c&&a>=d&&(o=new h.w({xmin:p,ymin:d,xmax:y,ymax:c,spatialReference:i}),s=t,u=r,!0)})),!o)return null;var l=o.width/s,p=Math.round((n-o.xmin)/l),c=Math.round((o.ymax-a)/l);return{extent:o,width:s,height:u,x:p,y:c}}},{key:"doRefresh",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.requestUpdate();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return this.strategy.updating||this.updateRequested}},{key:"fetchImage",value:function(e,t,r,a){return this.layer.fetchImageBitmap(e,t,r,(0,n.Z)({timeExtent:this.timeExtent},a))}}]),r}((0,g.a)((0,v.i)((0,d.y)(m.u)))));(0,p.e)([(0,p.y)()],x.prototype,"strategy",void 0),(0,p.e)([(0,p.y)()],x.prototype,"updating",void 0);var b=x=(0,p.e)([(0,p.n)("esri.views.2d.layers.WMSLayerView2D")],x);t.default=b}}]);
//# sourceMappingURL=9910.35985444.chunk.js.map