"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[1529],{68741:function(e,t,r){r.d(t,{S:function(){return P}});var i=r(74165),n=r(37762),a=r(15861),o=r(15671),u=r(43144),s=r(60136),c=r(29388),h=r(29439),d=r(50165),p=r(96263),l=r(79146),f=r(77322),v=r(57405),g=r(73151),m=r(22494),y=r(49510),w=Math.PI/180;function x(e){return e*w}function Z(e,t){var r=x(t.rotation),i=Math.abs(Math.cos(r)),n=Math.abs(Math.sin(r)),a=(0,h.Z)(t.size,2),o=a[0],u=a[1];return e[0]=Math.round(u*n+o*i),e[1]=Math.round(u*i+o*n),e}function k(e,t,r,i){var n=(0,h.Z)(t,2),a=n[0],o=n[1],u=(0,h.Z)(i,2),s=u[0],c=u[1],d=.5*r;return e[0]=a-d*s,e[1]=o-d*c,e[2]=a+d*s,e[3]=o+d*c,e}var _=(0,l.u)(),b=[0,0],M=new y.e(0,0,0,0),R=2048,S=2048,C=!1,I=!1,z=!1,q=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e){var u;return(0,o.Z)(this,r),(u=t.call(this,e))._imagePromise=null,u.bitmaps=[],u.hidpi=z,u.imageMaxWidth=R,u.imageMaxHeight=S,u.imageRotationSupported=C,u.imageNormalizationSupported=I,u.update=(0,d.B)(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var o,s,c,h,d,p,l,v,g,m,y;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stationary&&!u.destroyed){e.next=2;break}return e.abrupt("return",null);case 2:return o=t.state,s=(0,f.b)(o.spatialReference),c=u.hidpi?t.pixelRatio:1,(h=u.imageNormalizationSupported&&o.worldScreenWidth&&o.worldScreenWidth<o.size[0])?(b[0]=o.worldScreenWidth,b[1]=o.size[1]):u.imageRotationSupported?(b[0]=o.size[0],b[1]=o.size[1]):Z(b,o),d=Math.floor(b[0]*c)>u.imageMaxWidth||Math.floor(b[1]*c)>u.imageMaxHeight,p=s&&(o.extent.xmin<s.valid[0]||o.extent.xmax>s.valid[1]),l=!u.imageNormalizationSupported&&p,v=!d&&!l,g=u.imageRotationSupported?o.rotation:0,v?(m=h?o.paddedViewState.center:o.center,u._imagePromise=u._singleExport(o,b,m,o.resolution,g,c,r)):(y=Math.min(u.imageMaxWidth,u.imageMaxHeight),l&&(y=Math.min(o.worldScreenWidth,y)),u._imagePromise=u._tiledExport(o,y,c,r)),e.abrupt("return",u._imagePromise.then(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,a,o,s,c,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u._imagePromise=null,!u.destroyed){u.bitmaps=null!==t&&void 0!==t?t:[],r=(0,n.Z)(u.container.children);try{for(o=function(){var e=a.value;t.includes(e)||e.fadeOut().then((function(){e.remove()}))},r.s();!(a=r.n()).done;)o()}catch(i){r.e(i)}finally{r.f()}s=(0,n.Z)(t);try{for(s.s();!(c=s.n()).done;)h=c.value,u.container.addChild(h),h.fadeIn()}catch(i){s.e(i)}finally{s.f()}}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw u._imagePromise=null,e})));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),5e3),u}return(0,u.Z)(r,[{key:"destroy",value:function(){this.bitmaps=[]}},{key:"updating",get:function(){return!this.destroyed&&null!==this._imagePromise}},{key:"updateExports",value:function(e){var t,r=(0,n.Z)(this.container.children);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!i.visible||!i.stage)return;e(i),i.invalidateTexture(),i.requestRender()}}catch(a){r.e(a)}finally{r.f()}}},{key:"_export",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,n,a,o,u){var s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchSource(t,Math.floor(r*o),Math.floor(n*o),{rotation:a,pixelRatio:o,signal:u});case 2:return s=e.sent,c=new g.v(s,"additive"),e.abrupt("return",(c.x=t.xmin,c.y=t.ymax,c.resolution=t.width/r,c.rotation=a,c.pixelRatio=o,c));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r,i,n,a,o){return e.apply(this,arguments)}}()},{key:"_singleExport",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,n,a,o,u,s){var c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(_,n,a,r),c=new p.M(_[0],_[1],_[2],_[3],t.spatialReference),e.next=4,this._export(c,r[0],r[1],o,u,s);case 4:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,i,n,a,o,u){return e.apply(this,arguments)}}()},{key:"_tiledExport",value:function(e,t,r,i){var n=this,a=v.S.create({size:t,spatialReference:e.spatialReference,scales:[e.scale]}),o=new m.h(a),u=o.getTileCoverage(e);if(!u)return null;var s=[];return u.forEach((function(a,u,c,h){M.set(a,u,c,h),o.getTileBounds(_,M);var d=new p.M(_[0],_[1],_[2],_[3],e.spatialReference);s.push(n._export(d,t,t,0,r,i))})),Promise.all(s)}}]),r}(d.y);(0,d.e)([(0,d.d)()],q.prototype,"_imagePromise",void 0),(0,d.e)([(0,d.d)()],q.prototype,"bitmaps",void 0),(0,d.e)([(0,d.d)()],q.prototype,"container",void 0),(0,d.e)([(0,d.d)()],q.prototype,"fetchSource",void 0),(0,d.e)([(0,d.d)()],q.prototype,"hidpi",void 0),(0,d.e)([(0,d.d)()],q.prototype,"imageMaxWidth",void 0),(0,d.e)([(0,d.d)()],q.prototype,"imageMaxHeight",void 0),(0,d.e)([(0,d.d)()],q.prototype,"imageRotationSupported",void 0),(0,d.e)([(0,d.d)()],q.prototype,"imageNormalizationSupported",void 0),(0,d.e)([(0,d.d)()],q.prototype,"requestUpdate",void 0),(0,d.e)([(0,d.d)()],q.prototype,"updating",null);var P=q=(0,d.e)([(0,d.n)("esri.views.2d.layers.support.ExportStrategy")],q)},73001:function(e,t,r){r.d(t,{n:function(){return f}});var i=r(15671),n=r(43144),a=r(11752),o=r(61120),u=r(60136),s=r(29388),c=r(50165),h=r(3441),d=r(28372),p=r(6819),l=function(e){(0,u.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r,[{key:"doRender",value:function(e){e.drawPhase===h.I.HIGHLIGHT&&(0,a.Z)((0,o.Z)(r.prototype),"doRender",this).call(this,e)}},{key:"renderChildren",value:function(e){if(this.attributeView.bindTextures(e.context),this.children.some((function(e){return e.hasData}))){(0,a.Z)((0,o.Z)(r.prototype),"renderChildren",this).call(this,e);var t=e.painter.effects.highlight;t.bind(e),e.context.setColorMask(!0,!0,!0,!0),e.context.clear(p._.COLOR_BUFFER_BIT),this._renderChildren(e,t.defines.concat(["highlightAll"])),t.draw(e),t.unbind()}}}]),r}(d.t),f=l=(0,c.e)([(0,c.n)("esri.views.2d.layers.support.HighlightGraphicContainer")],l)},31529:function(e,t,r){r.r(t);var i=r(1413),n=r(74165),a=r(15861),o=r(15671),u=r(43144),s=r(60136),c=r(29388),h=r(50165),d=r(73627),p=r(42094),l=r(34780),f=r(35744),v=r(28372),g=r(73001),m=r(68741),y=r(60470),w=r(66780),x=r(1894),Z=r(12736),k=(r(89031),r(33530),r(96263),r(77322),r(32335),r(31278),r(13994),r(98496),r(40133),r(4483),r(79747),r(42),r(52155),r(75662),r(17493),r(62980),r(16377),r(9887),r(88406),r(66307),r(2760),r(42488),r(9330),r(79146),r(3029),r(42687),r(78330),r(78697),r(78664),r(22984),r(69738),r(35341),r(68634),r(73393),r(87110),r(72577),r(61772),r(92870),r(26079),r(15508),r(17691),r(48561),r(55269),r(73428),r(86931),r(51613),r(80392),r(10489),r(62298),r(2815),r(2326),r(90339),r(76375),r(82046),r(49961),r(31412),r(53089),r(83172),r(66270),r(60418),r(84539),r(75366),r(5233),r(36235),r(61340),r(57439),r(59075),r(97823),r(49350),r(89354),r(16897),r(47642),r(63334),r(38419),r(84231),r(38665),r(32717),r(39853),r(94872),r(3969),r(43895),r(30594),r(73267),r(22628),r(24982),r(46584),r(7093),r(85966),r(28003),r(49796),r(58428),r(8049),r(80933),r(40858),r(95076),r(56389),r(86738),r(69205),r(50338),r(33074),r(31134),r(41524),r(68668),r(55916),r(66319),r(24781),r(2329),r(37243),r(97345),r(39001),r(84913),r(84823),r(9411),r(14826),r(64620),r(22225),r(75272),r(4197),r(86905),r(64997),r(26208),r(2816),r(46237),r(98428),r(5792),r(67871),r(75097),r(47672),r(98643),r(83745),r(96401),r(87833),r(21523),r(84192),r(99057),r(26995),r(6819),r(25346),r(99797),r(50463),r(48968),r(47692),r(45578),r(3441),r(94640),r(14023),r(27969),r(77372),r(66281),r(69754),r(38802),r(48308),r(14527),r(3096),r(66156),r(33265),r(20592),r(44365),r(77006),r(29648),r(35650),r(7513),r(48606),r(68792),r(49510),r(6927),r(82909),r(95734),r(25593),r(69379),r(22494),r(18392),r(89324),r(6283),r(98057),r(20422),r(38969),r(75105),r(25715),r(51386),r(81044),r(40100),r(88533),r(77639),r(13089),r(49862),r(37783),r(57405),r(73151),r(66339),r(34342),r(43634),r(33117),h.s.getLogger("esri.views.2d.layers.MapImageLayerView2D")),_=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments))._highlightGraphics=new p.c,e}return(0,u.Z)(r,[{key:"update",value:function(e){this.strategy.update(e).catch((function(e){(0,h.I)(e)||k.error(e)}))}},{key:"attach",value:function(){var e=this,t=this.layer,r=t.imageMaxWidth,i=t.imageMaxHeight,n=t.version,a=n>=10.3,o=n>=10;this._bitmapContainer=new l.t,this.container.addChild(this._bitmapContainer);var u=new v.a({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:function(){return e.requestUpdate()},container:new g.n(this.view.featuresTilingScheme)});this.container.addChild(u.container),this.strategy=new m.S({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:r,imageMaxHeight:i,imageRotationSupported:a,imageNormalizationSupported:o,hidpi:!0}),this.handles.add((0,d.l)((function(){return e.exportImageVersion}),(function(){return e.requestUpdate()})),"exportImageVersion"),this.handles.add((0,d.l)((function(){var t;return null===(t=e.view)||void 0===t?void 0:t.floors}),(function(){return e.requestUpdate()})),"view.floors"),this.requestUpdate()}},{key:"detach",value:function(){this.handles.remove("exportImageVersion"),this.handles.remove("view.floors"),this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren()}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"highlight",value:function(e,t){var r=this;return this._highlightGraphics.add(e),{remove:function(){r._highlightGraphics.remove(e)}}}},{key:"supportsSpatialReference",value:function(e){return this.layer.serviceSupportsSpatialReference(e)}},{key:"createFetchPopupFeaturesQueryGeometry",value:function(e,t){return(0,Z.a)(e,t,this.view)}},{key:"doRefresh",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.requestUpdate();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return this.strategy.updating||this.updateRequested}},{key:"fetchImage",value:function(e,t,r,n){return this.layer.fetchImage(e,t,r,(0,i.Z)({timeExtent:this.timeExtent,floors:this.view.floors},n))}}]),r}((0,w.x)((0,x.i)((0,f.f)(y.u))));(0,h.e)([(0,h.d)()],_.prototype,"strategy",void 0),(0,h.e)([(0,h.d)()],_.prototype,"updating",void 0);var b=_=(0,h.e)([(0,h.n)("esri.views.2d.layers.MapImageLayerView2D")],_);t.default=b},1894:function(e,t,r){r.d(t,{i:function(){return c}});var i=r(15671),n=r(43144),a=r(60136),o=r(29388),u=r(50165),s=r(73627),c=function(e){var t=function(e){(0,a.Z)(r,e);var t=(0,o.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r,[{key:"initialize",value:function(){var e=this;this.handles.add((0,s.a)((function(){return e.layer}),"refresh",(function(t){e.doRefresh(t.dataChanged).catch((function(t){(0,u.I)(t)||u.s.getLogger(e.declaredClass).error(t)}))})),"RefreshableLayerView")}}]),r}(e);return(0,u.e)([(0,u.d)()],t.prototype,"layer",void 0),t=(0,u.e)([(0,u.n)("esri.layers.mixins.RefreshableLayerView")],t)}},66339:function(e,t,r){r.d(t,{c:function(){return o},i:function(){return a},r:function(){return n}});var i=r(73428);function n(e,t){var r=t||e.extent,n=e.width,a=(0,i.z)(r&&r.spatialReference);return r&&n?r.width/n*a*i.d*96:0}function a(e,t){return e/((0,i.z)(t)*i.d*96)}function o(e,t){var r=e.extent,i=e.width,n=a(t,r.spatialReference);return r.clone().expand(n*i/r.width)}}}]);
//# sourceMappingURL=1529.7451b128.chunk.js.map