"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[249],{28930:function(e,t,r){r.d(t,{p:function(){return d}});var n=r(15671),i=r(43144),a=r(60136),s=r(29388),o=r(23132),u=(r(75610),r(81019)),l=r(58687),c=o.s.getLogger("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView"),d=function(e){var t=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments))._definitionExpressionErrors=0,e._maxDefinitionExpressionErrors=20,e.logError=function(t){e._definitionExpressionErrors<e._maxDefinitionExpressionErrors&&c.error("Error while evaluating definitionExpression: "+t),e._definitionExpressionErrors++,e._definitionExpressionErrors===e._maxDefinitionExpressionErrors&&c.error("Further errors are ignored")},e}return(0,i.Z)(r,[{key:"parsedDefinitionExpression",get:function(){if(!this.i3slayer||!this.i3slayer.definitionExpression)return null;try{var e=u.WhereClause.create(this.i3slayer.definitionExpression,this.i3slayer.fieldsIndex);if(!e.isStandardized)return c.error("definitionExpression is using non standard function"),null;var t=[],r=e.fieldNames;return(0,l.J)(r,this.i3slayer.fields,{missingFields:t}),t.length>0?(c.error("definitionExpression references unknown fields: ".concat(t.join(", "))),null):(this._definitionExpressionErrors=0,e)}catch(e){return c.error("Failed to parse definitionExpression: "+e),null}}},{key:"definitionExpressionFields",get:function(){return this.parsedDefinitionExpression?this.parsedDefinitionExpression.fieldNames:null}},{key:"_evaluateClause",value:function(e,t){try{return e.testFeature(t)}catch(r){return this.logError(r),!1}}},{key:"_addDefinitionExpressionToQuery",value:function(e){if(!this.parsedDefinitionExpression)return e;var t=this.i3slayer.definitionExpression,r=e.clone();return r.where?r.where="(".concat(t,") AND (").concat(r.where,")"):r.where=t,r}}]),r}(e);return(0,o.e)([(0,o.d)()],t.prototype,"i3slayer",void 0),(0,o.e)([(0,o.d)({readOnly:!0})],t.prototype,"parsedDefinitionExpression",null),(0,o.e)([(0,o.d)({readOnly:!0})],t.prototype,"definitionExpressionFields",null),t=(0,o.e)([(0,o.n)("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView")],t),t}},39149:function(e,t,r){r.d(t,{C:function(){return M},f:function(){return X},n:function(){return H},p:function(){return z}});var n=r(29439),i=r(74165),a=r(15861),s=r(37762),o=r(15671),u=r(43144),l=r(60136),c=r(29388),d=r(23132),f=(r(91204),r(75610)),p=r(2760),y=r(36551),h=r(44455),v=r(81019),g=r(63022),E=r(72820),m=r(78311),w=r(30709),x=r(25838),b=r(58687),k=r(77470),S=r(80262),F=r(20880),I=r(15612),_=r(34860),O=r(75370),R=r(33642),Z=r(80175),D=r(3969),j=r(40023),C=d.s.getLogger("esri.views.3d.layers.i3s.I3SMeshViewFilter"),M=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e))._projectionEngineLoaded=!1,r}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;(0,y.j)((function(){var t;return(null===(t=(0,f.e)(e.viewFilter))||void 0===t?void 0:t.geometry)||(0,f.r)(e.layerFilter)})).then((function(){return e.loadAsyncModule(Promise.all([r.e(6549),r.e(1624)]).then(r.bind(r,91624)).then((function(t){e.destroyed||(e._geometryEngine=t,e.applyFilters())})))}))}},{key:"sortedObjectIds",get:function(){if((0,f.t)(this.viewFilter)||(0,f.t)(this.viewFilter.objectIds))return null;var e=new Float64Array(this.viewFilter.objectIds);return e.sort(),e}},{key:"parsedWhereClause",get:function(){var e=(0,f.r)(this.viewFilter)?this.viewFilter.where:null;if((0,f.t)(e)||!e)return null;try{return v.WhereClause.create(e,this.layerFieldsIndex)}catch(t){C.error("Failed to parse filter where clause: ".concat(t))}return null}},{key:"addFilters",value:function(e,t,r,n){var i=this.sortedObjectIds;(0,f.r)(i)&&e.push((function(e){return(0,b.ad)(i,!0,e)})),this.addSqlFilter(e,this.parsedWhereClause);var a=this._layerMaskGeometries,s=this._geometryEngine;if((0,f.r)(a)&&(0,f.r)(this.layerFilter)&&(0,f.r)(s)){var o=this.layerFilter.spatialRelationship;e.push((function(e,i){return L(s,e,i,n,t,r,a,o)}))}var u=this._viewMaskGeometries;if((0,f.r)(u)&&(0,f.r)(this.viewFilter)&&(0,f.r)(s)){var l=this.viewFilter.spatialRelationship;e.push((function(e,i){return L(s,e,i,n,t,r,u,l)}))}}},{key:"isMBSGeometryVisible",value:function(e,t,r){var n=this._layerMaskGeometries,i=this._geometryEngine;if((0,f.r)(n)&&(0,f.r)(this.layerFilter)&&(0,f.r)(i)){var a=this.layerFilter.spatialRelationship,s=n[0].spatialReference||t;return(0,g.b)(e,r,J,s)?G(i,J,n,s,a):(C.warnOnce("SceneLayer.mask geometry is using unsupported SpatialReference, skipping geometry filter for MBS"),!0)}var o=this._viewMaskGeometries;if((0,f.r)(o)&&(0,f.r)(this.viewFilter)&&(0,f.r)(i)){var u=this.viewFilter.spatialRelationship,l=o[0].spatialReference||t;return(0,g.b)(e,r,J,l)?G(i,J,o,l,u):(C.warnOnce("SceneLayerView.filter.geometry is using unsupported SpatialReference, skipping geometry filter for MBS"),!0)}return!0}},{key:"parsedGeometry",get:function(){var e=this._viewMaskGeometries,t=this._layerMaskGeometries;return(0,f.t)(e)||(0,f.t)(t)?e||t:t.concat(e)}},{key:"_layerMaskGeometries",get:function(){var e=this.layerFilter;return(0,f.t)(e)||(0,f.t)(this._geometryEngine)?null:A(this._geometryEngine,e.geometry,e.spatialRelationship)}},{key:"_viewMaskGeometries",get:function(){var e=this;if((0,f.t)(this.viewFilter)||(0,f.t)(this._geometryEngine))return null;var t=this.viewFilter.geometry;if((0,f.t)(t))return null;var r=this.viewFilter,n=r.distance,i=r.units,a=this.viewFilter.spatialRelationship,s="mesh"===t.type?t.extent:t;if((0,f.t)(n)||0===n)return A(this._geometryEngine,s,a);var o=i||(0,h.Z)(s.spatialReference);if(s.spatialReference.isWGS84){var u=this._geometryEngine.geodesicBuffer(s,n,o);return A(this._geometryEngine,u,a)}var l=(0,w.M)(s,w.k.WGS84);if((0,f.r)(l)){var c=(0,w.M)(this._geometryEngine.geodesicBuffer(l,n,o),s.spatialReference);return A(this._geometryEngine,c,a)}if(!this._projectionEngineLoaded&&(this.loadAsyncModule((0,g.t)().then((function(){return e._projectionEngineLoaded=!0}))),!this._projectionEngineLoaded))return null;var d=null;try{d=(0,g.r)(s,w.k.WGS84)}catch(p){}if(d)try{d=(0,g.r)(this._geometryEngine.geodesicBuffer(d,n,o),s.spatialReference)}catch(p){d=null}return d||C.error("Filter by geodesic buffer (distance) unsupported, failed to project input geometry (".concat(s.spatialReference.wkid,") to WGS84.")),A(this._geometryEngine,d,a)}}],[{key:"checkSupport",value:function(e){return!(0,f.t)(e)&&(e.timeExtent?(C.warn("Filters with a timeExtent are not supported for mesh scene layers"),!1):!!function(e){return null!=e&&N.includes(e)}(e.spatialRelationship)||(C.warn("Filters with spatialRelationship other than ".concat(N.join(", ")," are not supported for mesh scene layers")),!1))}}]),n}(d.y);(0,d.e)([(0,d.d)()],M.prototype,"layerFilter",void 0),(0,d.e)([(0,d.d)({type:x.y})],M.prototype,"viewFilter",void 0),(0,d.e)([(0,d.d)()],M.prototype,"layerFieldsIndex",void 0),(0,d.e)([(0,d.d)()],M.prototype,"loadAsyncModule",void 0),(0,d.e)([(0,d.d)()],M.prototype,"applyFilters",void 0),(0,d.e)([(0,d.d)()],M.prototype,"addSqlFilter",void 0),(0,d.e)([(0,d.d)({readOnly:!0})],M.prototype,"sortedObjectIds",null),(0,d.e)([(0,d.d)({readOnly:!0})],M.prototype,"parsedWhereClause",null),(0,d.e)([(0,d.d)({readOnly:!0})],M.prototype,"parsedGeometry",null),(0,d.e)([(0,d.d)({readOnly:!0})],M.prototype,"_layerMaskGeometries",null),(0,d.e)([(0,d.d)({readOnly:!0})],M.prototype,"_viewMaskGeometries",null),(0,d.e)([(0,d.d)()],M.prototype,"_projectionEngineLoaded",void 0),(0,d.e)([(0,d.d)()],M.prototype,"_geometryEngine",void 0),M=(0,d.e)([(0,d.n)("esri.views.3d.layers.i3s.I3SMeshViewFilter")],M);var Q,T,N=["contains","intersects","disjoint"];function A(e,t,r){if((0,f.t)(t))return null;if("disjoint"===r&&"polygon"===t.type){var n=function(){for(var r=new Array(t.rings.length),n=0;n<t.rings.length;++n){var i=(0,m.o)(1/0,1/0,-1/0,-1/0);(0,m.x)(i,t.rings[n]),r[n]={type:"polygon",rings:[t.rings[n]],spatialReference:t.spatialReference,aabr:i}}r.sort((function(e,t){return e.aabr[0]-t.aabr[0]}));for(var a=new Set,s=new f.g,o=function(t){for(var n=r[t],i=t+1;i<r.length;++i){var o=r[i];if(o.aabr[0]>=n.aabr[2])break;a.add(o)}a.forEach((function(t){if(n!==t)if(t.aabr[2]<=n.aabr[0])a.delete(t);else if(e.intersects(n,t)){n.rings=n.rings.concat(t.rings),(0,m.h)(n.aabr,t.aabr,n.aabr),delete n._geVersion,a.delete(t);var i=(0,f.v)(r,t,r.length,s);r.splice(i,1)}})),a.add(n)},u=0;u<r.length;++u)o(u);for(var l=0,c=r;l<c.length;l++){delete c[l].aabr}return{v:r}}();if("object"===typeof n)return n.v}return[t]}function G(e,t,r,n,i){var a=P(e,t,n);return r.every((function(t){return V(e,t,a,i)!==Q.DISCARD}))}function L(e,t,r,n,i,a,o,u){var l=o[0].spatialReference||i.spatialReference;if((0,g.b)(r.node.mbs,a,J,l)){var c,d=P(e,J,l),f=function(e,t,r,n,i){var a=t.renderSpatialReference,s=new Map,o={rings:[[[0,0,0],[0,0,0],[0,0,0],[0,0,0]]],hasZ:!1,hasM:!1,type:"polygon",spatialReference:r};o.rings[0][3]=o.rings[0][0];var u,l,c={indices:null,data:null,stride:0,startIndex:0,endIndex:0};switch(e){case"intersects":u=function(e,t,r){return e.intersects(t,r)?Q.KEEP:Q.TEST},l=B;break;case"contains":u=function(e,t,r){return e.contains(t,r)?Q.TEST:Q.DISCARD},l=B;break;default:u=function(e,t,r){return e.disjoint(t,r)?Q.TEST:Q.DISCARD},l=W}return{collection:n,object:i,type:e,maskSR:r,renderSR:a,aabbCache:s,triangle:o,positions:c,triangleTest:u,geometryTest:l}}(u,i,l,n,r.objectHandle),y=(0,s.Z)(o);try{var h=function(){var n=c.value;if(0===t.length)return{v:void 0};switch(V(e,n,d,u)){case Q.DISCARD:return{v:void(t.length=0)};case Q.KEEP:return"continue"}(0,b.a3)(t,r.featureIds,(function(t){return function(e,t,r,n){var i=n.collection,a=n.object,s=n.renderSR,o=n.maskSR,u=n.geometryTest,l=n.aabbCache,c=l.get(r);if(!c){var d=i.getObjectTransform(a);i.getComponentAabb(a,r,q);for(var f=[[q[0],q[1],0],[q[0],q[4],0],[q[3],q[4],0],[q[3],q[1],0]],y=0;y<4;++y)(0,p.O)(f[y],f[y],d.rotationScale),(0,p.u)(f[y],f[y],d.position),(0,g.B)(f[y],s,f[y],o);(c={rings:[f],hasZ:!1,hasM:!1,type:"polygon",spatialReference:o}).rings[0][4]=c.rings[0][0],l.set(r,c)}switch(u(e,t,c)){case Q.DISCARD:return!1;case Q.KEEP:return!0}var h=n.triangle,v=n.triangleTest,E=n.positions,m=h.rings[0][0],w=h.rings[0][1],x=h.rings[0][2],b=i.getObjectTransform(a);i.getComponentPositions(a,r,E);for(var k=E.indices,S=E.data,F=E.stride,I=E.startIndex,_=E.endIndex,O=I;O<_;O+=3){var R=F*k[O+0],Z=F*k[O+1],D=F*k[O+2];(0,p.f)(m,S[R+0],S[R+1],S[R+2]),(0,p.f)(w,S[Z+0],S[Z+1],S[Z+2]),(0,p.f)(x,S[D+0],S[D+1],S[D+2]),(0,p.O)(m,m,b.rotationScale),(0,p.O)(w,w,b.rotationScale),(0,p.O)(x,x,b.rotationScale),(0,p.u)(m,m,b.position),(0,p.u)(w,w,b.position),(0,p.u)(x,x,b.position),(0,g.B)(m,s,m,o),(0,g.B)(w,s,w,o),(0,g.B)(x,s,x,o);var j=w[0]-m[0],C=w[1]-m[1],M=x[0]-m[0],T=x[1]-m[1];if(!(Math.abs(j*T-C*M)<K))switch(delete h._geVersion,v(e,t,h)){case Q.DISCARD:return!1;case Q.KEEP:return!0}}return"intersects"!==n.type}(e,n,t,f)}))};for(y.s();!(c=y.n()).done;){var v=h();if("continue"!==v&&"object"===typeof v)return v.v}}catch(E){y.e(E)}finally{y.f()}}else C.warnOnce("SceneLayerView.filter.geometry is using unsupported SpatialReference, skipping geometry filter")}(T=Q||(Q={}))[T.KEEP=0]="KEEP",T[T.DISCARD=1]="DISCARD",T[T.TEST=2]="TEST";var J=[0,0,0,0];function P(e,t,r){var n={x:t[0],y:t[1],hasZ:!1,hasM:!1,type:"point",spatialReference:r},i=!r.isWGS84&&!r.isWebMercator,a=Number.isNaN(t[3])?0:(0,p.o)(t[3],0,2*w.s.radius),s=i?e.buffer(n,a,1):e.geodesicBuffer(n,a,1);return s.type="polygon",s}function V(e,t,r,n){switch(n){case"intersects":case"contains":return B(e,t,r);case"disjoint":return W(e,t,r)}}function B(e,t,r){return e.intersects(t,r)?e.contains(t,r)?Q.KEEP:Q.TEST:Q.DISCARD}function W(e,t,r){return e.intersects(t,r)?e.contains(t,r)?Q.DISCARD:Q.TEST:Q.KEEP}var K=Math.pow(2,-32);var q=(0,E.a)(),U=F.Y,z=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e))._dataQueryEngineInstance=null,n._handles=new k.u,n}return(0,u.Z)(r,[{key:"defaultQueryJSON",get:function(){return new _.b({outSpatialReference:this.spatialReference}).toJSON()}},{key:"dataQueryEngine",get:function(){return this._ensureDataQueryEngine()}},{key:"initialize",value:function(){var e=this;this._handles.add(this.layerView.on("visible-geometry-changed",(function(){return e.spatialIndex.events.emit("changed")})))}},{key:"destroy",value:function(){this._dataQueryEngineInstance&&(this._dataQueryEngineInstance.destroy(),this._dataQueryEngineInstance=null),this._handles&&(this._handles.destroy(),this._handles=null),this._set("layerView",null)}},{key:"executeQueryForCount",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dataQueryEngine.executeQueryForCount(this._ensureQueryJSON(t),r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForExtent",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataQueryEngine.executeQueryForExtent(this._ensureQueryJSON(t),r);case 2:return n=e.sent,a=n.count,s=n.extent,e.abrupt("return",{count:a,extent:S.M.fromJSON(s)});case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForIds",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dataQueryEngine.executeQueryForIds(this._ensureQueryJSON(t),r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQuery",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._ensureQueryJSON(t)).returnGeometry){e.next=3;break}throw new d.a("feature-store:unsupported-query","returnGeometry is not yet supported for mesh scene layer queries");case 3:if(!n.returnCentroid){e.next=5;break}throw new d.a("feature-store:unsupported-query","returnCentroid is not yet supported for mesh scene layer queries");case 5:return e.next=7,this.dataQueryEngine.executeQuery(n,r);case 7:return a=e.sent,s=I.default.fromJSON(a),e.abrupt("return",(s.features.forEach((function(e){e.geometry=null})),s));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_ensureQueryJSON",value:function(e){return(0,f.t)(e)?this.defaultQueryJSON:e.toJSON()}},{key:"_ensureDataQueryEngine",value:function(){if(this._dataQueryEngineInstance)return this._dataQueryEngineInstance;var e=this.layer.objectIdField||"OBJECTID",t=this.layer.fields.map((function(e){return e.toJSON()})),r=this.layerView.view.resourceController.scheduler,n=this.spatialReference.toJSON(),i=this.priority,a=this.spatialIndex;return this._dataQueryEngineInstance=new U({hasZ:!0,hasM:!1,geometryType:"esriGeometryPolygon",fields:t,timeInfo:null,spatialReference:n,objectIdField:e,featureStore:a,scheduler:r,priority:i}),this._dataQueryEngineInstance}}]),r}(d.y);(0,d.e)([(0,d.d)({constructOnly:!0})],z.prototype,"layerView",void 0),(0,d.e)([(0,d.d)({constructOnly:!0})],z.prototype,"priority",void 0),(0,d.e)([(0,d.d)({constructOnly:!0})],z.prototype,"spatialIndex",void 0),(0,d.e)([(0,d.d)({readOnly:!0,aliasOf:"layerView.view.spatialReference"})],z.prototype,"spatialReference",void 0),(0,d.e)([(0,d.d)({readOnly:!0,aliasOf:"layerView.i3slayer"})],z.prototype,"layer",void 0),(0,d.e)([(0,d.d)({readOnly:!0})],z.prototype,"defaultQueryJSON",null),z=(0,d.e)([(0,d.n)("esri.views.3d.layers.i3s.I3SQueryEngine")],z);var H=function(){function e(t){(0,o.Z)(this,e),this.objectIdField=t.objectIdField,this.getFeatureExtent=t.getFeatureExtent}return(0,u.Z)(e,[{key:"getObjectId",value:function(e){return e.id}},{key:"getAttributes",value:function(e){var t=e.meta,r=e.index,n={};this.objectIdField&&(n[this.objectIdField]=e.id);var i=(0,f.r)(t.attributeInfo)&&t.attributeInfo.attributeData;if((0,f.r)(i))for(var a=0,s=Object.keys(i);a<s.length;a++){var o=s[a];n[o]=(0,b.a8)(i[o],r)}return n}},{key:"getAttribute",value:function(e,t){if(t===this.objectIdField)return e.id;var r=e.meta,n=e.index,i=(0,f.r)(r.attributeInfo)&&r.attributeInfo.attributeData;return(0,f.r)(i)?(0,b.a8)(i[t],n):null}},{key:"getGeometry",value:function(e){if(e.geometry)return e.geometry;var t=this.getFeatureExtent(e,Y),r=(0,n.Z)(t,5),i=r[0],a=r[1],s=r[2],o=r[3],u=r[4];return new R.t([5],[i,a,s,o,a,s,o,u,s,i,u,s,i,a,s])}},{key:"getCentroid",value:function(e,t){if(e.geometry)return(0,O.e)(new R.t,e.geometry,t.hasZ,t.hasM);var r=this.getFeatureExtent(e,Y),i=(0,n.Z)(r,6),a=i[0],s=i[1],o=i[2],u=i[3],l=i[4],c=i[5];return new R.t([0],[(a+u)/2,(s+l)/2,(o+c)/2])}},{key:"cloneWithGeometry",value:function(e,t){return{id:e.id,index:e.index,meta:e.meta,geometry:t}}}]),e}(),Y=(0,E.a)(),X=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).events=new Z.n,n}return(0,u.Z)(r,[{key:"forEach",value:function(e){this.forAllFeatures((function(t){return e(t),j.L.CONTINUE}))}},{key:"forEachBounds",value:function(e,t,r){var n,i=this.getFeatureExtent,a=(0,s.Z)(e);try{for(a.s();!(n=a.n()).done;){t(i(n.value,r))}}catch(o){a.e(o)}finally{a.f()}}},{key:"forEachInBounds",value:function(e,t){var r=this;this.forAllFeatures((function(n){var i=r.getFeatureExtent(n,ee);return(0,m.E)(e,(0,E.G)(i,te))&&t(n),j.L.CONTINUE}),(function(t){if((0,g.b)(t.node.mbs,r.sourceSpatialReference,$,r.viewSpatialReference),$[0]>=e[0]&&$[2]<=e[2]&&$[1]>=e[1]&&$[3]<=e[3])return j.L.CONTINUE;var n=Math.max(e[0],Math.min($[0],e[2])),i=Math.max(e[1],Math.min($[1],e[3])),a=$[0]-n,s=$[1]-i;return a*a+s*s<=$[3]*$[3]?j.L.CONTINUE:j.L.SKIP}))}}]),r}(d.y);(0,d.e)([(0,d.d)({constructOnly:!0})],X.prototype,"featureAdapter",void 0),(0,d.e)([(0,d.d)({constructOnly:!0})],X.prototype,"toArray",void 0),(0,d.e)([(0,d.d)({constructOnly:!0})],X.prototype,"forAllFeatures",void 0),(0,d.e)([(0,d.d)({constructOnly:!0})],X.prototype,"getFeatureExtent",void 0),(0,d.e)([(0,d.d)({constructOnly:!0})],X.prototype,"sourceSpatialReference",void 0),(0,d.e)([(0,d.d)({constructOnly:!0})],X.prototype,"viewSpatialReference",void 0),X=(0,d.e)([(0,d.n)("esri.views.3d.layers.i3s.I3SQueryFeatureStore")],X);var $=(0,D.n)(),ee=(0,E.a)(),te=(0,m.u)()},42152:function(e,t,r){r.d(t,{d:function(){return u},s:function(){return c}});var n=r(74165),i=r(93433),a=r(15861),s=r(75610),o=r(50526);function u(e){return l.apply(this,arguments)}function l(){return l=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,u,l,c,d,f,p,y,h=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=h.length>1&&void 0!==h[1]?h[1]:t.popupTemplate,!(0,s.t)(r)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,r.getRequiredFields(t.fieldsIndex);case 5:if(a=e.sent,u=r.lastEditInfoEnabled,l=t.objectIdField,c=t.typeIdField,d=t.globalIdField,f=t.relationships,!a.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:if(!u){e.next=19;break}return e.next=16,(0,o.L)(t);case 16:e.t0=e.sent,e.next=20;break;case 19:e.t0=[];case 20:return p=e.t0,y=(0,o.y)(t.fieldsIndex,[].concat((0,i.Z)(a),(0,i.Z)(p))),e.abrupt("return",(c&&y.push(c),y&&l&&t.fieldsIndex.has(l)&&!y.includes(l)&&y.push(l),y&&d&&t.fieldsIndex.has(d)&&!y.includes(d)&&y.push(d),f&&f.forEach((function(e){var r=e.keyField;y&&r&&t.fieldsIndex.has(r)&&!y.includes(r)&&y.push(r)})),y));case 23:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function c(e,t){return e.popupTemplate?e.popupTemplate:(0,s.r)(t)&&t.defaultPopupTemplateEnabled&&(0,s.r)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}}]);
//# sourceMappingURL=249.1756f7c9.chunk.js.map