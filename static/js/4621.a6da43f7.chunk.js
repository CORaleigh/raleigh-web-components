"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[4621,339],{58428:function(e,t,n){n.d(t,{i:function(){return l}});var r=n(15671),i=n(43144),a=n(60136),o=n(29388),s=n(50165);var l=function(e){var t=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"apiKey",get:function(){var e;return this._isOverridden("apiKey")?this._get("apiKey"):"portalItem"in this?null===(e=this.portalItem)||void 0===e?void 0:e.apiKey:null},set:function(e){null!=e?this._override("apiKey",e):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}}]),n}(e);return(0,s.e)([(0,s.d)({type:String})],t.prototype,"apiKey",null),t=(0,s.e)([(0,s.n)("esri.layers.mixins.APIKeyMixin")],t)}},55269:function(e,t,n){n.d(t,{i:function(){return o},o:function(){return l},r:function(){return u},s:function(){return c}});var r=n(15671),i=n(43144),a=n(2760),o=function(){function e(t,n){(0,r.Z)(this,e),this.min=t,this.max=n,this.range=n-t}return(0,i.Z)(e,[{key:"ndiff",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.ceil((e-t)/this.range)*this.range+t}},{key:"_normalize",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(n-=r)<e?n+=this.ndiff(e-n):n>t&&(n-=this.ndiff(n-t)),i&&n===t&&(n=e),n+r}},{key:"normalize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._normalize(this.min,this.max,e,t,n)}},{key:"clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,a.o)(e-t,this.min,this.max)+t}},{key:"monotonic",value:function(e,t,n){return e<t?t:t+this.ndiff(e-t,n)}},{key:"minimalMonotonic",value:function(e,t,n){return this._normalize(e,e+this.range,t,n)}},{key:"center",value:function(e,t,n){return t=this.monotonic(e,t,n),this.normalize((e+t)/2,n)}},{key:"diff",value:function(e,t,n){return this.monotonic(e,t,n)-e}},{key:"shortestSignedDiff",value:function(e,t){e=this.normalize(e);var n=(t=this.normalize(t))-e,r=t<e?this.minimalMonotonic(e,t)-e:t-this.minimalMonotonic(t,e);return Math.abs(n)<Math.abs(r)?n:r}},{key:"contains",value:function(e,t,n){return t=this.minimalMonotonic(e,t),(n=this.minimalMonotonic(e,n))>e&&n<t}}]),e}();function s(e){for(var t in e){var n=e[t];n instanceof Function&&(e[t]=n.bind(e))}return e}var l=s(new o(0,2*Math.PI)),u=s(new o(-Math.PI,Math.PI)),c=s(new o(0,360))},15508:function(e,t,n){n.r(t),n.d(t,{D:function(){return q},E:function(){return Gr},F:function(){return Hr},J:function(){return Sr},e:function(){return or},i:function(){return Rr},j:function(){return B},l:function(){return U},x:function(){return D},y:function(){return W}});var r=n(97326),i=n(37762),a=n(29439),o=n(4942),s=n(74165),l=n(15671),u=n(43144),c=n(60136),d=n(29388),f=n(93433),p=n(1413),h=n(15861),v=n(50165),m=n(87110),y=n(73627),g=n(17691),b=n(73393),_=n(48561),w=(n(55269),n(2760)),I=n(73428),k=n(42),M=n(89031),x=n(40133),A=n(86931),F=n(66270),Z=n(4483),C=n(98496),T=n(61772),E=n(60418),L=n(22984),S=n(43895),R=n(13994),N=n(53089),O=(n(77322),n(30594),n(96263),n(31278),n(10489),n(2815),n(82046),n(33530),n(52155)),P=n(73267),z=n(24982),j=n(69738);function V(e,t,n){return e.units[t][n]}function U(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,k.m)(t,{minimumFractionDigits:r,maximumFractionDigits:r})," ").concat(V(e,n,i))}function q(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,I.b)(t,n);return U(e,(0,I.N)(t,n,a),a,r,i)}function D(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,I.J)(t,n);return U(e,(0,I.N)(t,n,a),a,r,i)}function W(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,I.K)(t,n);return U(e,(0,I.N)(t,n,a),a,r,i)}function B(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,I.A)(t,n);return U(e,(0,I.N)(t,n,a),a,r,i)}var K=["B","kB","MB","GB","TB"];var $=v.s.getLogger("esri.widgets.Feature.support.featureUtils"),G=/href=(""|'')/gi,H=/(\{([^\{\r\n]+)\})/g,Y=/\'/g,Q=/^\s*expression\//i,X=/(\n)/gi,J=/[\u00A0-\u9999<>\&]/gim,ee=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,te=/^(?:mailto:|tel:)/,ne="relationships/",re=(0,k.S)("short-date-short-time");function ie(e){if(!(0,v.t)(e))return e.get("sourceLayer")||e.get("layer")}function ae(e,t){return oe.apply(this,arguments)}function oe(){return oe=(0,h.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","function"==typeof t?t.call(null,n):t);case 1:case"end":return e.stop()}}),e)}))),oe.apply(this,arguments)}function se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!te.test(e.trim().toLowerCase())}function le(e){return!!e&&Q.test(e)}function ue(e,t){var n=function(e,t){if(!le(t)||!e)return null;var n,r=t.replace(Q,"").toLowerCase();return e.some((function(e){return e.name.toLowerCase()===r&&(n=e,!0)})),n}(t,null===e||void 0===e?void 0:e.fieldName);return n?n.title||null:e?e.label||e.fieldName:null}function ce(e,t){var n=de(t,e);return n?n.name:e}function de(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function fe(e){return"".concat(e).trim()}function pe(e){var t=e.attributes,n=e.globalAttributes,r=e.layer,i=e.text,a=e.expressionAttributes,o=e.fieldInfoMap;return i?he({formattedAttributes:n,template:ge(i,(0,p.Z)((0,p.Z)((0,p.Z)({},n),a),t),r),fieldInfoMap:o}):""}function he(e){var t=e.formattedAttributes,n=e.template,r=e.fieldInfoMap;return fe(function(e){return e.replace(G,"")}((0,v.h)((0,v.h)(n,(function(e){return function(e,t){var n=t.get(e.toLowerCase());return"{".concat(n&&n.fieldName||e,"}")}(e,r)})),t)))}function ve(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t[e];if("string"==typeof r){var i="%27",a=(n?encodeURIComponent(r):r).replace(Y,i);t[e]=a}}function me(e,t,n){var r=(t=fe(t))&&"{"!==t[0];return(0,v.h)(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,p.Z)({},e);return Object.keys(n).forEach((function(e){return ve(e,n,t)})),n}(n,r))}function ye(e,t){return e.replace(H,(function(e,n,r){var i=de(t,r);return i?"{".concat(i.name,"}"):n}))}function ge(e,t,n){var r=ye(e,n);return r?r.replace(ee,(function(e,n,r){return me(e,n||r,t)})):r}function be(e){return!(null===e||void 0===e||!e.layer)}function _e(e,t){var n,r=t.fieldInfos,i=t.fieldName,a=null===(n=we(r,i))||void 0===n?void 0:n.clone(),o=t.preventPlacesFormatting,s=t.layer,l=de(s,i);if(a&&"date"===(null===l||void 0===l?void 0:l.type)){var u=a.format||new C.u;u.dateFormat=u.dateFormat||"short-date-short-time",u.dateTimeFormatOptions=!be(s)&&function(e){return"feature"===(null===e||void 0===e?void 0:e.type)}(s)&&s.datesInUnknownTimezone||be(s)&&function(e){return"map-image"===(null===e||void 0===e?void 0:e.type)}(s.layer)&&s.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,a.format=u}var c=a&&a.format;return"string"==typeof e&&(0,Z.d)(i)&&c?c.formatRasterPixelValue(e):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){var n=Number(e);if(!isNaN(n))return n}return e}(e,c))||null==e||null==c?Me(e):o?(0,k.m)(e,(0,p.Z)((0,p.Z)({},(0,k.u)(c)),{},{minimumFractionDigits:0,maximumFractionDigits:20})):c.format(e)}function we(e,t){if(e&&e.length&&t){var n,r=t.toLowerCase();return e.some((function(e){return!(!e.fieldName||e.fieldName.toLowerCase()!==r)&&(n=e,!0)})),n}}function Ie(e){var t=[];if(!e)return t;var n=e.fieldInfos,r=e.content;return n&&t.push.apply(t,(0,f.Z)(n)),r&&Array.isArray(r)?(r.forEach((function(e){if("fields"===e.type){var n=e&&e.fieldInfos;n&&t.push.apply(t,(0,f.Z)(n))}})),t):t}function ke(e){return e.replace(J,(function(e){return"&#".concat(e.charCodeAt(0),";")}))}function Me(e){return"string"==typeof e?e.replace(X,'<br class="esri-text-new-line" />'):e}function xe(e){var t=e.value,n=e.fieldName,r=e.fieldInfos,i=e.fieldInfoMap,a=e.layer,o=e.graphic;if(null==t)return"";var s=function(e){var t=e.fieldName,n=e.value,r=e.graphic,i=e.layer;if(Se(t))return null;if(!i||"function"!=typeof i.getFieldDomain)return null;var a=i.getFieldDomain(t,{feature:r});return a&&"coded-value"===a.type?a.getName(n):null}({fieldName:n,value:t,graphic:o,layer:a});if(s)return s;var l=function(e){var t=e.fieldName,n=e.graphic,r=e.layer;if(Se(t))return null;if(!r||"function"!=typeof r.getFeatureType)return null;var i=r.typeIdField;if(!i||t!==i)return null;var a=r.getFeatureType(n);return a?a.name:null}({fieldName:n,graphic:o,layer:a});if(l)return l;if(i.get(n.toLowerCase()))return _e(t,{fieldInfos:r||Array.from(i.values()),fieldName:n,layer:a});var u=a&&a.fieldsIndex;return u&&u.isDateField(n)?(0,k.L)(t,re):Me(t)}function Ae(e){var t=e.fieldInfos,n=e.attributes,r=e.layer,i=e.graphic,a=e.fieldInfoMap,o=e.relatedInfos,s={};return null!==o&&void 0!==o&&o.forEach((function(e){return function(e){var t=e.attributes,n=e.relatedInfo,r=e.fieldInfoMap,i=e.fieldInfos,a=e.layer;t&&n&&(n.relatedFeatures&&n.relatedFeatures&&n.relatedFeatures.forEach((function(e){return Re({attributes:t,graphic:e,relatedInfo:n,fieldInfoMap:r,fieldInfos:i,layer:a})})),n.relatedStatsFeatures&&n.relatedStatsFeatures&&n.relatedStatsFeatures.forEach((function(e){return Re({attributes:t,graphic:e,relatedInfo:n,fieldInfoMap:r,fieldInfos:i,layer:a})})))}({attributes:s,relatedInfo:e,fieldInfoMap:a,fieldInfos:t,layer:r})})),Object.keys(n).forEach((function(e){var o=n[e];s[e]=xe({fieldName:e,fieldInfos:t,fieldInfoMap:a,layer:r,value:o,graphic:i})})),s}function Fe(e,t){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,h.Z)((0,s.Z)().mark((function e(t,n){var r,i,a,o,l,u,c,d,f,p,h,v;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.layer,o=t.graphic,l=t.outFields,u=t.objectIds,c=t.returnGeometry,d=t.spatialReference,"number"==typeof(f=u[0])||"string"==typeof f){e.next=4;break}return"Could not query required fields for the specified feature. The feature's ID is invalid.",p={layer:a,graphic:o,objectId:f,requiredFields:l},e.abrupt("return",($.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",p),null));case 4:if(null!==(r=a.capabilities)&&void 0!==r&&null!==(i=r.operations)&&void 0!==i&&i.supportsQuery){e.next=7;break}return"The specified layer cannot be queried. The following fields will not be available.",h={layer:a,graphic:o,requiredFields:l,returnGeometry:c},e.abrupt("return",($.warn("The specified layer cannot be queried. The following fields will not be available.",h),null));case 7:return(v=a.createQuery()).objectIds=u,v.outFields=null!==l&&void 0!==l&&l.length?l:[a.objectIdField],v.returnGeometry=!!c,v.returnZ=!!c,v.returnM=!!c,v.outSpatialReference=d,e.next=11,a.queryFeatures(v,n);case 11:return e.abrupt("return",e.sent.features[0]);case 12:case"end":return e.stop()}}),e)}))),Ze.apply(this,arguments)}function Ce(e){return Te.apply(this,arguments)}function Te(){return Te=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.expressionInfos)&&void 0!==n&&n.length){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,(0,Z.a)();case 4:return r=e.sent,i=r.arcadeUtils.hasGeometryFunctions,e.abrupt("return",i(t));case 7:case"end":return e.stop()}}),e)}))),Te.apply(this,arguments)}function Ee(e,t){return Le.apply(this,arguments)}function Le(){return Le=(0,h.Z)((0,s.Z)().mark((function e(t,n){var r,i,a,o,l,u,c,d,f,h,v;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.graphic,i=t.popupTemplate,a=t.layer,o=t.spatialReference,a&&i){e.next=3;break}return e.abrupt("return");case 3:if(e.t0="function"==typeof a.load,!e.t0){e.next=7;break}return e.next=7,a.load(n);case 7:if(r.attributes){e.next=9;break}return e.abrupt("return");case 9:if(null!=(l=r.attributes[a.objectIdField])){e.next=12;break}return e.abrupt("return");case 12:return u=[l],e.next=15,i.getRequiredFields(a.fieldsIndex);case 15:if(c=e.sent,d=(0,Z.e)(c,r),f=d?[]:c,e.t1=i.returnGeometry,e.t1){e.next=23;break}return e.next=22,Ce(i);case 22:e.t1=e.sent;case 23:if(h=e.t1,!d||h){e.next=26;break}return e.abrupt("return");case 26:return e.next=28,Fe({layer:a,graphic:r,outFields:f,objectIds:u,returnGeometry:h,spatialReference:o},n);case 28:(v=e.sent)&&(v.geometry&&(r.geometry=v.geometry),v.attributes&&(r.attributes=(0,p.Z)((0,p.Z)({},r.attributes),v.attributes)));case 30:case"end":return e.stop()}}),e)}))),Le.apply(this,arguments)}function Se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(ne)}function Re(e){var t=e.attributes,n=e.graphic,r=e.relatedInfo,i=e.fieldInfos,a=e.fieldInfoMap,o=e.layer;t&&n&&r&&Object.keys(n.attributes).forEach((function(e){var s=function(e){return e?"".concat(ne).concat(e.layerId,"/").concat(e.fieldName):""}({layerId:r.relation.id.toString(),fieldName:e}),l=n.attributes[e];t[s]=xe({fieldName:s,fieldInfos:i,fieldInfoMap:a,layer:o,value:l,graphic:n})}))}var Ne=function(e){if(!e)return!1;var t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},Oe=function(e){var t,n,r=e.layer,i=e.method,a=e.query,o=e.definitionExpression;if(null!==(t=r.capabilities)&&void 0!==t&&null!==(n=t.query)&&void 0!==n&&n.supportsCacheHint&&"attachments"!==i){var s=(0,v.r)(a.where)&&a.where,l=(0,v.r)(a.geometry)&&a.geometry;Ne(o)||Ne(s)||"extent"===(null===l||void 0===l?void 0:l.type)||"tile"===a.resultType||(a.cacheHint=!0)}},Pe={editing:!1,operations:{add:!0,update:!0,delete:!0}},ze=x.j.ofType(A.l),je=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e))._getAttachmentsPromise=null,r._attachmentLayer=null,r.abilities=(0,p.Z)({},Pe),r.activeAttachmentInfo=null,r.attachmentInfos=new ze,r.graphic=null,r.mode="view",r.own((0,y.l)((function(){return r.graphic}),(function(){return r._graphicChanged()}),y.h)),r}return(0,u.Z)(n,[{key:"destroy",value:function(){this._attachmentLayer=null,this.graphic=null}},{key:"castAbilities",value:function(e){return(0,p.Z)((0,p.Z)({},Pe),e)}},{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}},{key:"getAttachments",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(){var t,n,r,i,a,o,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._attachmentLayer,n=this.attachmentInfos,t&&"function"==typeof t.queryAttachments){e.next=3;break}throw new v.a("invalid-layer","getAttachments(): A valid layer is required.");case 3:return r=this._getFeatureId(),i=new F.c({objectIds:[r],returnMetadata:!0}),a=[],o=t.queryAttachments(i).then((function(e){return e[r]||a})).catch((function(){return a})),this._getAttachmentsPromise=o,this.notifyChange("state"),e.next=7,o;case 7:return l=e.sent,e.abrupt("return",(n.removeAll(),l.length&&n.addMany(l),this._getAttachmentsPromise=null,this.notifyChange("state"),l));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addAttachment",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l,u=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._attachmentLayer,r=this.attachmentInfos,i=this.graphic,a=this.abilities,t){e.next=3;break}throw new v.a("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});case 3:if(a.operations.add){e.next=5;break}throw new v.a("invalid-abilities","addAttachment(): add abilities are required.");case 5:if(n&&"function"==typeof n.addAttachment){e.next=7;break}throw new v.a("invalid-layer","addAttachment(): A valid layer is required.");case 7:return o=n.addAttachment(i,t).then((function(e){return u._queryAttachment(e.objectId)})),e.next=10,o;case 10:return l=e.sent,e.abrupt("return",(r.add(l),l));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteAttachment",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._attachmentLayer,r=this.attachmentInfos,i=this.graphic,a=this.abilities,t){e.next=3;break}throw new v.a("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});case 3:if(a.operations.delete){e.next=5;break}throw new v.a("invalid-abilities","deleteAttachment(): delete abilities are required.");case 5:if(n&&"function"==typeof n.deleteAttachments){e.next=7;break}throw new v.a("invalid-layer","deleteAttachment(): A valid layer is required.");case 7:return o=n.deleteAttachments(i,[t.id]).then((function(){return t})),e.next=10,o;case 10:return l=e.sent,e.abrupt("return",(r.remove(l),l));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l,u,c,d=this,f=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:this.activeAttachmentInfo,r=this._attachmentLayer,i=this.attachmentInfos,a=this.graphic,o=this.abilities,t){e.next=4;break}throw new v.a("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});case 4:if(n){e.next=6;break}throw new v.a("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:n});case 6:if(o.operations.update){e.next=8;break}throw new v.a("invalid-abilities","updateAttachment(): Update abilities are required.");case 8:if(l=i.findIndex((function(e){return e===n})),r&&"function"==typeof r.updateAttachment){e.next=11;break}throw new v.a("invalid-layer","updateAttachment(): A valid layer is required.");case 11:return u=r.updateAttachment(a,n.id,t).then((function(e){return d._queryAttachment(e.objectId)})),e.next=14,u;case 14:return c=e.sent,e.abrupt("return",(i.splice(l,1,c),c));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_queryAttachment",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new v.a("invalid-attachment-id","Could not query attachment.");case 2:return n=this._attachmentLayer,r=this._getFeatureId(),i=new F.c({objectIds:[r],attachmentsWhere:"AttachmentId=".concat(t),returnMetadata:!0}),e.abrupt("return",n.queryAttachments(i).then((function(e){return e[r][0]})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getFeatureId",value:function(){var e=this._attachmentLayer,t=this.graphic;if(!e||!t)return null;var n=e.objectIdField,r=t.attributes;return r&&r[n]}},{key:"_graphicChanged",value:function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((function(){})))}},{key:"_setAttachmentLayer",value:function(){var e=ie(this.graphic);this._attachmentLayer=e?"scene"===e.type&&(0,v.r)(e.associatedLayer)?e.associatedLayer:e:null}}]),n}(v.y);(0,v.e)([(0,v.d)()],je.prototype,"abilities",void 0),(0,v.e)([(0,v.H)("abilities")],je.prototype,"castAbilities",null),(0,v.e)([(0,v.d)()],je.prototype,"activeAttachmentInfo",void 0),(0,v.e)([(0,v.d)({readOnly:!0,type:ze})],je.prototype,"attachmentInfos",void 0),(0,v.e)([(0,v.d)({type:M.g})],je.prototype,"graphic",void 0),(0,v.e)([(0,v.d)()],je.prototype,"mode",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],je.prototype,"state",null),(0,v.e)([(0,v.d)({readOnly:!0})],je.prototype,"supportsResizeAttachments",null);var Ve=je=(0,v.e)([(0,v.n)("esri.widgets.Attachments.AttachmentsViewModel")],je);var Ue={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},qe="esri-attachments",De="esri-attachments__loader-container",We="esri-attachments__loader",Be="esri-attachments__container",Ke="esri-attachments__container--list",$e="esri-attachments__container--preview",Ge="esri-attachments__actions",He="esri-attachments__delete-button",Ye="esri-attachments__add-attachment-button",Qe="esri-attachments__error-message",Xe="esri-attachments__items",Je="esri-attachments__item",et="esri-attachments__item-button",tt="esri-attachments__item-mask",nt="esri-attachments__item-mask--icon",rt="esri-attachments__image",it="esri-attachments__image--resizable",at="esri-attachments__label",ot="esri-attachments__filename",st="esri-attachments__item-chevron-icon",lt="esri-attachments__item-link",ut="esri-attachments__item-link-overlay",ct="esri-attachments__item-link-overlay-icon",dt="esri-attachments__item-add-icon",ft="esri-attachments__form-node",pt="esri-attachments__file-fieldset",ht="esri-attachments__file-label",vt="esri-attachments__file-name",mt="esri-attachments__file-input",yt="esri-attachments__metadata",gt="esri-attachments__metadata-fieldset",bt="esri-attachments__progress-bar",_t="esri-widget",wt="esri-button",It="esri-button--disabled",kt="esri-button--secondary",Mt="esri-button--tertiary",xt="esri-button--third",At="esri-button--small",Ft="esri-button--half",Zt="esri-widget__content--empty",Ct="esri-icon-right",Tt="esri-icon-left",Et="esri-icon-plus",Lt=window.CSS,St=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r)).abilities=null,i.displayType="auto",i.graphic=null,i.label=void 0,i.messages=null,i.messagesUnits=null,i.selectedFile=null,i.submitting=!1,i.viewModel=new Ve,i.visibleElements=(0,p.Z)({},Ue),i._supportsImageOrientation=Lt&&Lt.supports&&Lt.supports("image-orientation","from-image"),i._addAttachmentForm=null,i._updateAttachmentForm=null,i}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this.own([(0,y.a)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.attachmentInfos}),"change",(function(){return e.scheduleRender()})),(0,y.l)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.mode}),(function(){return e._modeChanged()}),y.h)])}},{key:"effectiveDisplayType",get:function(){var e=this.displayType;return e&&"auto"!==e?e:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"castVisibleElements",value:function(e){return(0,p.Z)((0,p.Z)({},Ue),e)}},{key:"addAttachment",value:function(){var e=this,t=this._addAttachmentForm,n=this.viewModel;return this._set("submitting",!0),this._set("error",null),n.addAttachment(t).then((function(t){return e._set("submitting",!1),e._set("error",null),n.mode="view",t})).catch((function(t){throw e._set("submitting",!1),e._set("error",new v.a("attachments:add-attachment",e.messages.addErrorMessage,t)),t}))}},{key:"deleteAttachment",value:function(e){var t=this,n=this.viewModel;return this._set("submitting",!0),this._set("error",null),n.deleteAttachment(e).then((function(e){return t._set("submitting",!1),t._set("error",null),n.mode="view",e})).catch((function(e){throw t._set("submitting",!1),t._set("error",new v.a("attachments:delete-attachment",t.messages.deleteErrorMessage,e)),e}))}},{key:"updateAttachment",value:function(){var e=this,t=this.viewModel,n=this._updateAttachmentForm;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(n).then((function(n){return e._set("submitting",!1),e._set("error",null),t.mode="view",n})).catch((function(t){throw e._set("submitting",!1),e._set("error",new v.a("attachments:update-attachment",e.messages.updateErrorMessage,t)),t}))}},{key:"render",value:function(){var e=this.submitting,t=this.viewModel.state;return(0,b.n)("div",{class:this.classes(qe,_t)},e?this.renderProgressBar():null,"loading"===t?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}},{key:"renderErrorMessage",value:function(){var e=this.error,t=this.visibleElements;return e&&t.errorMessage?(0,b.n)("div",{key:"error-message",class:Qe},e.message):null}},{key:"renderAttachments",value:function(){var e=this.viewModel,t=e.mode,n=e.activeAttachmentInfo;return"add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(n):this.renderAttachmentContainer()}},{key:"renderLoading",value:function(){return(0,b.n)("div",{class:De,key:"loader"},(0,b.n)("div",{class:We}))}},{key:"renderProgressBar",value:function(){return this.visibleElements.progressBar?(0,b.n)("div",{class:bt,key:"progress-bar"}):null}},{key:"renderAddForm",value:function(){var e=this.submitting,t=this.selectedFile,n=e||!t,r=this.visibleElements.cancelAddButton?(0,b.n)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(wt,Mt,At,Ft,e&&It)},this.messages.cancel):null,i=this.visibleElements.addSubmitButton?(0,b.n)("button",{type:"submit",disabled:n,class:this.classes(wt,kt,At,Ft,(0,o.Z)({},It,n))},this.messages.add):null,a=t?(0,b.n)("span",{key:"file-name",class:vt},t.name):null,s=(0,b.n)("form",{bind:this,afterCreate:b.v,afterRemoved:b.h,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},(0,b.n)("fieldset",{class:pt},a,(0,b.n)("label",{class:this.classes(ht,wt,kt)},t?this.messages.changeFile:this.messages.selectFile,(0,b.n)("input",{class:mt,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),i,r);return(0,b.n)("div",{key:"add-form-container",class:ft},s)}},{key:"renderDetailsForm",value:function(e){var t=this,n=this.visibleElements,r=this.viewModel,i=this.selectedFile,a=this.submitting,s=e.contentType,l=e.size,u=e.url,c=r.abilities,d=a||!i,f=c.editing&&c.operations.delete&&n.deleteButton?(0,b.n)("button",{key:"delete-button",type:"button",disabled:a,bind:this,onclick:function(n){return t._submitDeleteAttachment(n,e)},class:this.classes(wt,At,Mt,He,(0,o.Z)({},It,a))},this.messages.delete):null,p=c.editing&&c.operations.update&&n.updateButton?(0,b.n)("button",{disabled:d,key:"update-button",type:"submit",class:this.classes(wt,At,xt,(0,o.Z)({},It,d))},this.messages.update):null,h=this.visibleElements.cancelUpdateButton?(0,b.n)("button",{disabled:a,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(wt,At,Mt,xt,(0,o.Z)({},It,a))},this.messages.cancel):null,m=i?(0,b.n)("span",{key:"file-name",class:vt},i.name):null,y=c.editing&&c.operations.update?(0,b.n)("fieldset",{key:"file",class:pt},m,(0,b.n)("label",{class:this.classes(ht,wt,kt)},this.messages.changeFile,(0,b.n)("input",{class:mt,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,g=(0,b.n)("fieldset",{key:"size",class:gt},(0,b.n)("label",null,function(e,t){var n=0===t?0:Math.floor(Math.log(t)/Math.log(_.o.KILOBYTES));n=(0,w.o)(n,0,K.length-1);var r=(0,k.m)(t/Math.pow(_.o.KILOBYTES,n),{maximumFractionDigits:2});return(0,v.h)(e.units.bytes[K[n]],{fileSize:r})}(this.messagesUnits,l))),I=(0,b.n)("fieldset",{key:"content-type",class:gt},(0,b.n)("label",null,s)),M=(0,b.n)("form",{bind:this,afterCreate:b.v,afterRemoved:b.h,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},(0,b.n)("div",{class:yt},g,I),y,(0,b.n)("div",{class:Ge},f,h,p));return(0,b.n)("div",{key:"edit-form-container",class:ft},(0,b.n)("a",{class:lt,href:u,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:e,size:400}),(0,b.n)("div",{class:ut},(0,b.n)("span",{class:ct},(0,b.n)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},(0,b.n)("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),(0,b.n)("path",{fill:"none",d:"M0 0h32v32H0z"}))))),M)}},{key:"renderImageMask",value:function(e){var t=e.attachmentInfo,n=e.size,r=this.viewModel.supportsResizeAttachments,i=t.contentType,a=t.name,s=t.url,l=r&&function(e){var t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}(i),u=this._getCSSTransform(t,l),c=u?{transform:u,"image-orientation":"none"}:{},d=s.includes("?")?"&":"?",f=l?"".concat(s).concat(d,"w=").concat(n):function(e){var t=(0,T.a)("esri/themes/base/images/files/");return e?"text/plain"===e?"".concat(t,"text-32.svg"):"application/pdf"===e?"".concat(t,"pdf-32.svg"):"text/csv"===e?"".concat(t,"csv-32.svg"):"application/gpx+xml"===e?"".concat(t,"gpx-32.svg"):"application/x-dwf"===e?"".concat(t,"cad-32.svg"):"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?"".concat(t,"code-32.svg"):"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?"".concat(t,"zip-32.svg"):e.includes("image/")?"".concat(t,"image-32.svg"):e.includes("audio/")?"".concat(t,"sound-32.svg"):e.includes("video/")?"".concat(t,"video-32.svg"):e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?"".concat(t,"excel-32.svg"):e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?"".concat(t,"word-32.svg"):e.includes("powerpoint")||e.includes("presentationml")?"".concat(t,"report-32.svg"):"".concat(t,"generic-32.svg"):"".concat(t,"generic-32.svg")}(i),p=(0,o.Z)({},nt,!l),h=(0,o.Z)({},it,r);return(0,b.n)("div",{class:this.classes(p,tt)},(0,b.n)("img",{styles:c,alt:a,src:f,class:this.classes(h,rt)}))}},{key:"renderAttachmentInfo",value:function(e){var t=this,n=e.attachmentInfo,r=e.displayType,i=this.viewModel.abilities,a=n.name,o=n.url,s=this.renderImageMask({attachmentInfo:n,size:"list"===r?48:400}),l=i.editing?(0,b.n)("span",{"aria-hidden":"true",class:this.classes(st,(0,b.f)(this.container)?Tt:Ct)}):null,u=[s,(0,b.n)("label",{class:at},(0,b.n)("span",{class:ot},a||this.messages.noTitle),l)],c=i.editing?(0,b.n)("button",{key:"details-button",bind:this,class:et,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":n.id,onclick:function(){return t._startEditAttachment(n)},type:"button"},u):(0,b.n)("a",{key:"details-link",class:et,href:o,target:"_blank"},u);return(0,b.n)("li",{class:Je,key:n},c)}},{key:"renderAttachmentContainer",value:function(){var e,t=this,n=this.effectiveDisplayType,r=this.viewModel,i=this.visibleElements,a=r.attachmentInfos,s=r.abilities,l=a&&a.length,u=(e={},(0,o.Z)(e,Ke,"preview"!==n),(0,o.Z)(e,$e,"preview"===n),e),c=s.editing&&s.operations.add&&i.addButton?(0,b.n)("button",{bind:this,onclick:function(){return t._startAddAttachment()},class:this.classes(wt,Mt,Ye),type:"button"},(0,b.n)("span",{"aria-hidden":"true",class:this.classes(dt,Et)}),this.messages.add):null,d=l?(0,b.n)("ul",{class:Xe},a.toArray().map((function(e){return t.renderAttachmentInfo({attachmentInfo:e,displayType:n})}))):(0,b.n)("div",{class:Zt},this.messages.noAttachments);return(0,b.n)("div",{key:"attachments-container",class:this.classes(Be,u)},d,c)}},{key:"_modeChanged",value:function(){this._set("error",null),this._set("selectedFile",null)}},{key:"_handleFileInputChange",value:function(e){var t=e.target,n=t&&t.files&&t.files.item(0);this._set("selectedFile",n)}},{key:"_submitDeleteAttachment",value:function(e,t){e.preventDefault(),this.deleteAttachment(t)}},{key:"_submitAddAttachment",value:function(e){e.preventDefault(),this.addAttachment()}},{key:"_submitUpdateAttachment",value:function(e){e.preventDefault(),this.updateAttachment()}},{key:"_startEditAttachment",value:function(e){var t=this.viewModel;t.activeAttachmentInfo=e,t.mode="edit"}},{key:"_startAddAttachment",value:function(){this.viewModel.mode="add"}},{key:"_cancelForm",value:function(e){e.preventDefault(),this.viewModel.mode="view"}},{key:"_getCSSTransform",value:function(e,t){var n=e.orientationInfo;return!this._supportsImageOrientation&&t&&n?[n.rotation?"rotate(".concat(n.rotation,"deg)"):"",n.mirrored?"scaleX(-1)":""].join(" "):""}}]),n}(b.O);(0,v.e)([(0,g.o)("viewModel.abilities")],St.prototype,"abilities",void 0),(0,v.e)([(0,v.d)()],St.prototype,"displayType",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],St.prototype,"effectiveDisplayType",null),(0,v.e)([(0,g.o)("viewModel.graphic")],St.prototype,"graphic",void 0),(0,v.e)([(0,v.d)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],St.prototype,"label",void 0),(0,v.e)([(0,v.d)(),(0,b.e)("esri/widgets/Attachments/t9n/Attachments")],St.prototype,"messages",void 0),(0,v.e)([(0,v.d)(),(0,b.e)("esri/core/t9n/Units")],St.prototype,"messagesUnits",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],St.prototype,"selectedFile",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],St.prototype,"submitting",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],St.prototype,"error",void 0),(0,v.e)([(0,v.d)({type:Ve})],St.prototype,"viewModel",void 0),(0,v.e)([(0,v.d)()],St.prototype,"visibleElements",void 0),(0,v.e)([(0,v.H)("visibleElements")],St.prototype,"castVisibleElements",null);var Rt=St=(0,v.e)([(0,v.n)("esri.widgets.Attachments")],St),Nt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e)).description=null,r.title=null,r}return(0,u.Z)(n)}(Ve);(0,v.e)([(0,v.d)()],Nt.prototype,"description",void 0),(0,v.e)([(0,v.d)()],Nt.prototype,"title",void 0);var Ot=Nt=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],Nt),Pt="esri-feature-element-info",zt="esri-feature-element-info__title",jt="esri-feature-element-info__description",Vt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r)).description=null,i.headingLevel=2,i.title=null,i}return(0,u.Z)(n,[{key:"render",value:function(){return(0,b.n)("div",{class:Pt},this.renderTitle(),this.renderDescription())}},{key:"renderTitle",value:function(){var e=this.title;return e?(0,b.n)(E.n,{level:this.headingLevel,class:zt},e):null}},{key:"renderDescription",value:function(){var e=this.description;return e?(0,b.n)("div",{key:"description",class:jt},e):null}}]),n}(b.O);(0,v.e)([(0,v.d)()],Vt.prototype,"description",void 0),(0,v.e)([(0,v.d)()],Vt.prototype,"headingLevel",void 0),(0,v.e)([(0,v.d)()],Vt.prototype,"title",void 0);var Ut=Vt=(0,v.e)([(0,v.n)("esri.widgets.Feature.support.FeatureElementInfo")],Vt),qt="esri-feature-attachments",Dt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r))._featureElementInfo=null,i.attachmentsWidget=new Rt,i.description=null,i.displayType=null,i.graphic=null,i.headingLevel=2,i.title=null,i.viewModel=new Ot,i}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new Ut,this.own([(0,y.l)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(n=e.viewModel)||void 0===n?void 0:n.title,e.headingLevel]}),(function(){return e._setupFeatureElementInfo()}),y.h),(0,y.l)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.graphic}),(function(t){return e.attachmentsWidget.graphic=t}),y.h)])}},{key:"destroy",value:function(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}},{key:"render",value:function(){var e,t=this.attachmentsWidget;return(0,b.n)("div",{class:qt},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),null===t||void 0===t?void 0:t.render())}},{key:"_setupFeatureElementInfo",value:function(){var e=this.description,t=this.title,n=this.headingLevel;this._featureElementInfo.set({description:e,title:t,headingLevel:n})}}]),n}(b.O);(0,v.e)([(0,v.d)({readOnly:!0})],Dt.prototype,"attachmentsWidget",void 0),(0,v.e)([(0,g.o)("viewModel.description")],Dt.prototype,"description",void 0),(0,v.e)([(0,g.o)("attachmentsWidget.displayType")],Dt.prototype,"displayType",void 0),(0,v.e)([(0,g.o)("viewModel.graphic")],Dt.prototype,"graphic",void 0),(0,v.e)([(0,v.d)()],Dt.prototype,"headingLevel",void 0),(0,v.e)([(0,g.o)("viewModel.title")],Dt.prototype,"title",void 0),(0,v.e)([(0,v.d)({type:Ot})],Dt.prototype,"viewModel",void 0);var Wt=Dt=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureAttachments")],Dt),Bt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e))._loadingPromise=null,r.created=null,r.creator=null,r.destroyer=null,r.graphic=null,r.handles.add((0,y.l)((function(){return r.creator}),(function(e){r._destroyContent(),r._createContent(e)}),y.h)),r}return(0,u.Z)(n,[{key:"destroy",value:function(){this._destroyContent()}},{key:"state",get:function(){return this._loadingPromise?"loading":"ready"}},{key:"_destroyContent",value:function(){var e=this.created,t=this.graphic,n=this.destroyer;e&&(ae(n,{graphic:t}).catch((function(){return null})),this._set("created",null))}},{key:"_createContent",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.graphic,r=ae(t,{graphic:n}).catch((function(){return null})),this._loadingPromise=r,this.notifyChange("state"),e.next=4,r;case 4:i=e.sent,r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",i));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}((0,L.a)(v.y));(0,v.e)([(0,v.d)({readOnly:!0})],Bt.prototype,"created",void 0),(0,v.e)([(0,v.d)()],Bt.prototype,"creator",void 0),(0,v.e)([(0,v.d)()],Bt.prototype,"destroyer",void 0),(0,v.e)([(0,v.d)({type:M.g})],Bt.prototype,"graphic",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Bt.prototype,"state",null);var Kt=Bt=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],Bt),$t="esri-feature-content",Gt="esri-feature-content__loader-container",Ht="esri-feature-content__loader",Yt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r)).creator=null,i.graphic=null,i.viewModel=null,i._addTargetToAnchors=function(e){Array.from(e.querySelectorAll("a")).forEach((function(e){se(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))},i}return(0,u.Z)(n,[{key:"renderLoading",value:function(){return(0,b.n)("div",{class:Gt,key:"loader"},(0,b.n)("div",{class:Ht}))}},{key:"renderCreated",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.created;return t?t instanceof HTMLElement?(0,b.n)("div",{key:t,bind:t,afterCreate:this._attachToNode}):(0,S.e)(t)?(0,b.n)("div",{key:t},!t.destroyed&&t.render()):(0,b.n)("div",{key:t,innerHTML:t,afterCreate:this._addTargetToAnchors}):null}},{key:"render",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.state;return(0,b.n)("div",{class:$t},"loading"===t?this.renderLoading():this.renderCreated())}},{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),n}(b.O);(0,v.e)([(0,g.o)("viewModel.creator")],Yt.prototype,"creator",void 0),(0,v.e)([(0,g.o)("viewModel.graphic")],Yt.prototype,"graphic",void 0),(0,v.e)([(0,v.d)({type:Kt})],Yt.prototype,"viewModel",void 0);var Qt=Yt=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureContent")],Yt),Xt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e)).attributes=null,r.expressionInfos=null,r.description=null,r.fieldInfos=null,r.title=null,r}return(0,u.Z)(n,[{key:"formattedFieldInfos",get:function(){var e=this.expressionInfos,t=this.fieldInfos,n=[];return null!==t&&void 0!==t&&t.forEach((function(t){if(!t.hasOwnProperty("visible")||t.visible){var r=t.clone();r.label=ue(r,e),n.push(r)}})),n}}]),n}(v.y);(0,v.e)([(0,v.d)()],Xt.prototype,"attributes",void 0),(0,v.e)([(0,v.d)({type:[C.d]})],Xt.prototype,"expressionInfos",void 0),(0,v.e)([(0,v.d)()],Xt.prototype,"description",void 0),(0,v.e)([(0,v.d)({type:[C.a]})],Xt.prototype,"fieldInfos",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Xt.prototype,"formattedFieldInfos",null),(0,v.e)([(0,v.d)()],Xt.prototype,"title",void 0);var Jt=Xt=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],Xt),en=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function tn(e,t){if("string"!=typeof t||!t)return t;var n=function(e){var t=null;return en.some((function(n){return n.pattern.test(e)&&(t=n),!!t})),t}(t);if(!n)return t;var r=t.match(n.pattern),i=r&&r[2],a=(0,v.h)((0,v.h)(n.label,{messages:e,hierPart:i}),{appName:n.appName}),o=n.target?' target="'.concat(n.target,'"'):"",s="_blank"===n.target?' rel="noreferrer"':"";return t.replace(n.pattern,"<a".concat(o,' href="$1"').concat(s,">").concat(a,"</a>"))}var nn="esri-feature-fields",rn="esri-feature-fields__field-header",an="esri-feature-fields__field-data",on="esri-feature-fields__field-data--date",sn="esri-widget__table",ln=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r))._featureElementInfo=null,i.attributes=null,i.description=null,i.expressionInfos=null,i.fieldInfos=null,i.title=null,i.viewModel=new Jt,i.messages=null,i.messagesURIUtils=null,i}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new Ut,this.own((0,y.l)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(n=e.viewModel)||void 0===n?void 0:n.title]}),(function(){return e._setupFeatureElementInfo()}),y.h))}},{key:"destroy",value:function(){this._featureElementInfo.destroy()}},{key:"renderFieldInfo",value:function(e,t){var n=this.viewModel.attributes,r=e.fieldName,i=e.label||r,a=n?null==n[r]?"":n[r]:"",s=!(!e.format||!e.format.dateFormat),l="number"!=typeof a||s?tn(this.messagesURIUtils,a):this._forceLTR(a),u=(0,o.Z)({},on,s);return(0,b.n)("tr",{key:"fields-element-info-row-".concat(r,"-").concat(t)},(0,b.n)("th",{key:"fields-element-info-row-header-".concat(r,"-").concat(t),class:rn,innerHTML:i}),(0,b.n)("td",{key:"fields-element-info-row-data-".concat(r,"-").concat(t),class:this.classes(an,u),innerHTML:l}))}},{key:"renderFields",value:function(){var e=this,t=this.viewModel.formattedFieldInfos;return null!==t&&void 0!==t&&t.length?(0,b.n)("table",{class:sn,summary:this.messages.fieldsSummary},(0,b.n)("tbody",null,t.map((function(t,n){return e.renderFieldInfo(t,n)})))):null}},{key:"render",value:function(){var e;return(0,b.n)("div",{class:nn},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderFields())}},{key:"_setupFeatureElementInfo",value:function(){var e=this.description,t=this.title;this._featureElementInfo.set({description:e,title:t})}},{key:"_forceLTR",value:function(e){return"&lrm;".concat(e)}}]),n}(b.O);(0,v.e)([(0,g.o)("viewModel.attributes")],ln.prototype,"attributes",void 0),(0,v.e)([(0,g.o)("viewModel.description")],ln.prototype,"description",void 0),(0,v.e)([(0,g.o)("viewModel.expressionInfos")],ln.prototype,"expressionInfos",void 0),(0,v.e)([(0,g.o)("viewModel.fieldInfos")],ln.prototype,"fieldInfos",void 0),(0,v.e)([(0,g.o)("viewModel.title")],ln.prototype,"title",void 0),(0,v.e)([(0,v.d)({type:Jt})],ln.prototype,"viewModel",void 0),(0,v.e)([(0,v.d)(),(0,b.e)("esri/widgets/Feature/t9n/Feature")],ln.prototype,"messages",void 0),(0,v.e)([(0,v.d)(),(0,b.e)("esri/widgets/support/t9n/uriUtils")],ln.prototype,"messagesURIUtils",void 0);var un=ln=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureFields")],ln),cn=v.s.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),dn=new Map;function fn(e){if(!Se(e))return null;var t=e.split("/").slice(1),n=(0,a.Z)(t,2);return{layerId:n[0],fieldName:n[1]}}function pn(e){var t,n=e.originRelationship,r=e.relationships,i=e.layerId;return r&&r.some((function(e){return"".concat(e.relatedTableId)===i&&e.id===n.id&&(t=e),!!t})),t}function hn(e,t){var n=t.toLowerCase();for(var r in e)if(r.toLowerCase()===n)return e[r];return null}function vn(e,t){var n=function(e,t){if(!t.relationships)return null;var n=null;return t.relationships.some((function(t){return t.id===parseInt(e,10)&&(n=t,!0)})),n}(e,t);if(n)return{url:"".concat(t.url,"/").concat(n.relatedTableId),sourceSpatialReference:t.spatialReference,relation:n,relatedFields:[],outStatistics:[]}}function mn(e,t){if(t&&e){var n=e.features,r=e.statsFeatures,i=n&&n.value;t.relatedFeatures=i?i.features:[];var a=r&&r.value;t.relatedStatsFeatures=a?a.features:[]}}function yn(e,t,n,r){var i=new F.d;return i.outFields=["*"],i.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),i.objectIds=[e.attributes[n.objectIdField]],n.queryRelatedFeatures(i,r)}function gn(e,t,n){for(var r=0,i=[];r<t.length;)i.push("".concat(e," IN (").concat(t.slice(r,n+r),")")),r+=n;return i.join(" OR ")}function bn(){return bn=(0,h.Z)((0,s.Z)().mark((function e(t,n,r,i){var a,o,l,u,c,d,f,p,h,m,y,g,b,_,w,I,k,M,x;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.layerId.toString(),o=n.layerInfo,l=n.relation,u=n.relatedFields,c=n.outStatistics,d=n.url,f=n.sourceSpatialReference,!(p=pn({originRelationship:l,relationships:o.relationships,layerId:a})).relationshipTableId||!p.keyFieldInRelationshipTable){e.next=14;break}return e.next=4,yn(t,p,r,i);case 4:if(e.t0=t.attributes[r.objectIdField],h=e.sent[e.t0]){e.next=8;break}return e.abrupt("return",null);case 8:if(m=h.features.map((function(e){return e.attributes[o.objectIdField]})),!((null===c||void 0===c?void 0:c.length)>0&&o.supportsStatistics)){e.next=14;break}return(y=new N.b).where=gn(o.objectIdField,m,1e3),y.outFields=u,y.outStatistics=c,y.sourceSpatialReference=f,g={features:Promise.resolve(h),statsFeatures:(0,A.s)(d,y)},e.abrupt("return",(0,v.E)(g));case 14:if(!(b=null===p||void 0===p?void 0:p.keyField)){e.next=18;break}return _=(0,Z.B)(In(o.fields,b)),w=hn(t.attributes,l.keyField),I=_?"".concat(b,"=").concat(w):"".concat(b,"='").concat(w,"'"),k=(0,A.s)(d,new N.b({where:I,outFields:n.relatedFields,sourceSpatialReference:f}),i),M=n.outStatistics&&n.outStatistics.length>0&&o.supportsStatistics?(0,A.s)(d,new N.b({where:I,outFields:n.relatedFields,outStatistics:n.outStatistics,sourceSpatialReference:f}),i):null,x={features:k},e.abrupt("return",(M&&(x.statsFeatures=M),(0,v.E)(x)));case 18:return e.abrupt("return",null);case 19:case"end":return e.stop()}}),e)}))),bn.apply(this,arguments)}function _n(e,t){var n=e.relatedInfos,r=e.layer,i={};return n.forEach((function(e,n){var a=e.relation;if(!a){var o=new v.a("relation-required","A relation is required on a layer to retrieve related records.");throw cn.error(o),o}var s=a.relatedTableId;if("number"!=typeof s){var l=new v.a("A related table ID is required on a layer to retrieve related records.");throw cn.error(l),l}var u="".concat(r.url,"/").concat(s),c=dn.get(u),d=c||function(e,t){return(0,R.U)(e,{query:{f:"json"},signal:t&&t.signal})}(u,t);c||dn.set(u,d),i[n]=d})),(0,v.E)(i)}function wn(e,t){var n=e.graphic,r=e.relatedInfos,i=e.layer,a={};return r.forEach((function(e,r){e.layerInfo&&(a[r]=function(e,t,n,r){return bn.apply(this,arguments)}(n,e,i,t))})),(0,v.E)(a)}function In(e,t){if(null!=e){t=t.toLowerCase();var n,r=(0,i.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a&&a.name.toLowerCase()===t)return a}}catch(o){r.e(o)}finally{r.f()}}return null}var kn={chartAnimation:!0},Mn=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e)).abilities=(0,p.Z)({},kn),r.activeMediaInfoIndex=0,r.attributes=null,r.description=null,r.fieldInfoMap=null,r.formattedAttributes=null,r.expressionAttributes=null,r.layer=null,r.mediaInfos=null,r.popupTemplate=null,r.relatedInfos=null,r.title=null,r}return(0,u.Z)(n,[{key:"castAbilities",value:function(e){return(0,p.Z)((0,p.Z)({},kn),e)}},{key:"activeMediaInfo",get:function(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}},{key:"formattedMediaInfos",get:function(){return this._formatMediaInfos()||[]}},{key:"formattedMediaInfoCount",get:function(){return this.formattedMediaInfos.length}},{key:"setActiveMedia",value:function(e){this._setContentElementMedia(e)}},{key:"next",value:function(){this._pageContentElementMedia(1)}},{key:"previous",value:function(){this._pageContentElementMedia(-1)}},{key:"_setContentElementMedia",value:function(e){var t=this.formattedMediaInfoCount,n=(e+t)%t;this.activeMediaInfoIndex=n}},{key:"_pageContentElementMedia",value:function(e){var t=this.activeMediaInfoIndex+e;this._setContentElementMedia(t)}},{key:"_formatMediaInfos",value:function(){var e=this,t=this.attributes,n=this.mediaInfos,r=this.formattedAttributes,i=this.expressionAttributes,a=this.fieldInfoMap,o=this.layer;return null===n||void 0===n?void 0:n.map((function(n){var s=null===n||void 0===n?void 0:n.clone();if(!s)return null;if(s.title=pe({attributes:t,fieldInfoMap:a,globalAttributes:r,expressionAttributes:i,layer:o,text:s.title}),s.caption=pe({attributes:t,fieldInfoMap:a,globalAttributes:r,expressionAttributes:i,layer:o,text:s.caption}),s.altText=pe({attributes:t,fieldInfoMap:a,globalAttributes:r,expressionAttributes:i,layer:o,text:s.altText}),"image"===s.type){var l=s.value;return e._setImageValue({value:l,formattedAttributes:r,layer:o}),s.value.sourceURL?s:void 0}if("pie-chart"===s.type||"line-chart"===s.type||"column-chart"===s.type||"bar-chart"===s.type){var u=s.value;return e._setChartValue({value:u,chartType:s.type,attributes:t,formattedAttributes:r,layer:o}),s}return null})).filter(Boolean)}},{key:"_setImageValue",value:function(e){var t=this.fieldInfoMap,n=e.value,r=e.formattedAttributes,i=e.layer,a=n.linkURL,o=n.sourceURL;if(o){var s=ye(o,i);n.sourceURL=he({formattedAttributes:r,template:s,fieldInfoMap:t})}if(a){var l=ye(a,i);n.linkURL=he({formattedAttributes:r,template:l,fieldInfoMap:t})}}},{key:"_setChartValue",value:function(e){var t=this,n=e.value,r=e.attributes,i=e.formattedAttributes,a=e.chartType,o=e.layer,s=this.popupTemplate,l=this.relatedInfos,u=n.fields,c=n.normalizeField;if(n.fields=function(e,t){return e&&e.map((function(e){return ce(e,t)}))}(u,o),c&&(n.normalizeField=ce(c,o)),u.some((function(e){return!!(null!=i[e]||Se(e)&&l.size)}))){var d=null===s||void 0===s?void 0:s.fieldInfos;u.forEach((function(e){if(Se(e))n.series=[].concat((0,f.Z)(n.series),(0,f.Z)(t._getRelatedChartInfos({fieldInfos:d,fieldName:e,formattedAttributes:i,chartType:a,value:n})));else{var o=t._getChartOption({value:n,attributes:r,chartType:a,formattedAttributes:i,fieldName:e,fieldInfos:d});n.series.push(o)}}))}}},{key:"_getRelatedChartInfos",value:function(e){var t,n=this,r=e.fieldInfos,i=e.fieldName,a=e.formattedAttributes,o=e.chartType,s=e.value,l=[],u=fn(i),c=u.layerId,d=u.fieldName,f=null===(t=this.relatedInfos)||void 0===t?void 0:t.get(c.toString());if(!f)return l;var p=f.relatedFeatures,h=f.relation;if(!h||!p)return l;var v=h.cardinality;return p.forEach((function(e){var t=e.attributes;t&&Object.keys(t).forEach((function(e){e===d&&l.push(n._getChartOption({value:s,attributes:t,formattedAttributes:a,fieldName:i,chartType:o,relatedFieldName:e,fieldInfos:r}))}))})),"one-to-many"===v||"many-to-many"===v?l:[l[0]]}},{key:"_getTooltip",value:function(e){var t=e.label,n=e.value;return"pie-chart"===e.chartType?"".concat(t):"".concat(t,": ").concat(n)}},{key:"_getChartOption",value:function(e){var t,n=e.value,r=e.attributes,i=e.formattedAttributes,a=e.fieldName,o=e.relatedFieldName,s=e.fieldInfos,l=e.chartType,u=this.layer,c=this.fieldInfoMap,d=n.normalizeField,f=n.tooltipField,p=d?Se(d)?r[fn(d).fieldName]:r[d]:null,h=o&&void 0!==r[o]?r[o]:void 0!==r[a]?r[a]:i[a],v=new C.e({fieldName:a,value:void 0===h?null:h&&p?h/p:h});if(Se(a)){var m,y,g,b,_,w=c.get(a.toLowerCase()),I=c.get(f.toLowerCase()),k=null!==(m=null===w||void 0===w?void 0:w.fieldName)&&void 0!==m?m:a,M=null!==(y=null!==(g=null!==(b=i[null!==(_=null===I||void 0===I?void 0:I.fieldName)&&void 0!==_?_:f])&&void 0!==b?b:null===w||void 0===w?void 0:w.label)&&void 0!==g?g:null===w||void 0===w?void 0:w.fieldName)&&void 0!==y?y:o,x=i[k];return v.tooltip=this._getTooltip({label:M,value:x,chartType:l}),v}var A=we(s,a),F=ce(a,u),Z=f&&void 0!==i[f]?i[f]:ue(A||new C.a({fieldName:F}),null===(t=this.popupTemplate)||void 0===t?void 0:t.expressionInfos),T=i[F];return v.tooltip=this._getTooltip({label:Z,value:T,chartType:l}),v}}]),n}(v.y);(0,v.e)([(0,v.d)()],Mn.prototype,"abilities",void 0),(0,v.e)([(0,v.H)("abilities")],Mn.prototype,"castAbilities",null),(0,v.e)([(0,v.d)()],Mn.prototype,"activeMediaInfoIndex",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Mn.prototype,"activeMediaInfo",null),(0,v.e)([(0,v.d)()],Mn.prototype,"attributes",void 0),(0,v.e)([(0,v.d)()],Mn.prototype,"description",void 0),(0,v.e)([(0,v.d)()],Mn.prototype,"fieldInfoMap",void 0),(0,v.e)([(0,v.d)()],Mn.prototype,"formattedAttributes",void 0),(0,v.e)([(0,v.d)()],Mn.prototype,"expressionAttributes",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Mn.prototype,"formattedMediaInfos",null),(0,v.e)([(0,v.d)()],Mn.prototype,"layer",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Mn.prototype,"formattedMediaInfoCount",null),(0,v.e)([(0,v.d)()],Mn.prototype,"mediaInfos",void 0),(0,v.e)([(0,v.d)()],Mn.prototype,"popupTemplate",void 0),(0,v.e)([(0,v.d)()],Mn.prototype,"relatedInfos",void 0),(0,v.e)([(0,v.d)()],Mn.prototype,"title",void 0);var xn,An,Fn=Mn=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],Mn),Zn=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],Cn=[{name:"default",colors:[].concat(Zn.slice(30,39),Zn.slice(28,30).reverse())},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}],Tn="en-us",En=new Map([["ar",function(){return n.e(5211).then(n.bind(n,55211)).then((function(e){return e.a}))}],["bg-bg",function(){return n.e(3879).then(n.bind(n,63879)).then((function(e){return e.b}))}],["bs-ba",function(){return n.e(4446).then(n.bind(n,44446)).then((function(e){return e.b}))}],["ca-es",function(){return n.e(8948).then(n.bind(n,98948)).then((function(e){return e.c}))}],["cs-cz",function(){return n.e(3467).then(n.bind(n,33467)).then((function(e){return e.c}))}],["da-dk",function(){return n.e(2155).then(n.bind(n,92155)).then((function(e){return e.d}))}],["de-de",function(){return n.e(2610).then(n.bind(n,52610)).then((function(e){return e.d}))}],["de-ch",function(){return n.e(7977).then(n.bind(n,47977)).then((function(e){return e.d}))}],["el-gr",function(){return n.e(9369).then(n.bind(n,19369)).then((function(e){return e.e}))}],["en-us",function(){return n.e(8437).then(n.bind(n,18437)).then((function(e){return e.e}))}],["en-ca",function(){return n.e(2944).then(n.bind(n,32944)).then((function(e){return e.e}))}],["es-es",function(){return n.e(9094).then(n.bind(n,19094)).then((function(e){return e.e}))}],["et-ee",function(){return n.e(3120).then(n.bind(n,3120)).then((function(e){return e.e}))}],["fi-fi",function(){return n.e(3485).then(n.bind(n,23485)).then((function(e){return e.f}))}],["fr-fr",function(){return n.e(4728).then(n.bind(n,4728)).then((function(e){return e.f}))}],["he-il",function(){return n.e(1443).then(n.bind(n,91443)).then((function(e){return e.h}))}],["hr-hr",function(){return n.e(4299).then(n.bind(n,84299)).then((function(e){return e.h}))}],["hu-hu",function(){return n.e(7082).then(n.bind(n,17082)).then((function(e){return e.h}))}],["id-id",function(){return n.e(4695).then(n.bind(n,94695)).then((function(e){return e.i}))}],["it-it",function(){return n.e(2176).then(n.bind(n,12176)).then((function(e){return e.i}))}],["ja-jp",function(){return n.e(7624).then(n.bind(n,47624)).then((function(e){return e.j}))}],["ko-kr",function(){return n.e(4742).then(n.bind(n,4742)).then((function(e){return e.k}))}],["lt-lt",function(){return n.e(7987).then(n.bind(n,97987)).then((function(e){return e.l}))}],["lv-lv",function(){return n.e(9956).then(n.bind(n,59956)).then((function(e){return e.l}))}],["nb-no",function(){return n.e(1271).then(n.bind(n,11271)).then((function(e){return e.n}))}],["nl-nl",function(){return n.e(3064).then(n.bind(n,53064)).then((function(e){return e.n}))}],["pl-pl",function(){return n.e(4389).then(n.bind(n,14389)).then((function(e){return e.p}))}],["pt-br",function(){return n.e(1357).then(n.bind(n,41357)).then((function(e){return e.p}))}],["pt-pt",function(){return n.e(1011).then(n.bind(n,1011)).then((function(e){return e.p}))}],["ro-ro",function(){return n.e(5202).then(n.bind(n,75202)).then((function(e){return e.r}))}],["ru-ru",function(){return n.e(229).then(n.bind(n,32980)).then((function(e){return e.r}))}],["sk-sk",function(){return n.e(8785).then(n.bind(n,68785)).then((function(e){return e.s}))}],["sl-sl",function(){return n.e(3771).then(n.bind(n,23771)).then((function(e){return e.s}))}],["sr-rs",function(){return n.e(5446).then(n.bind(n,15446)).then((function(e){return e.s}))}],["sv-se",function(){return n.e(6347).then(n.bind(n,86347)).then((function(e){return e.s}))}],["th-th",function(){return n.e(7961).then(n.bind(n,67961)).then((function(e){return e.t}))}],["tr-tr",function(){return n.e(5131).then(n.bind(n,15131)).then((function(e){return e.t}))}],["uk-ua",function(){return n.e(2101).then(n.bind(n,22101)).then((function(e){return e.u}))}],["vi-vn",function(){return n.e(8865).then(n.bind(n,68865)).then((function(e){return e.v}))}],["zh-cn",function(){return n.e(6106).then(n.bind(n,56106)).then((function(e){return e.z}))}],["zh-hk",function(){return n.e(5597).then(n.bind(n,95597)).then((function(e){return e.z}))}],["zh-tw",function(){return n.e(5597).then(n.bind(n,95597)).then((function(e){return e.z}))}]]);function Ln(e){return e?En.has(e.toLowerCase())?e.toLowerCase():function(e){var t,n=e.split("-")[0].toLowerCase(),r=null,a=(0,i.Z)(En.keys());try{for(a.s();!(t=a.n()).done;){var o=t.value;if(o.startsWith(n)){r=o;break}}}catch(s){a.e(s)}finally{a.f()}return r}(e)||Tn:Tn}function Sn(){return Rn.apply(this,arguments)}function Rn(){return Rn=(0,h.Z)((0,s.Z)().mark((function e(){var t,r,i,o,l,u=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Ln(t=u.length>0&&void 0!==u[0]?u[0]:(0,O.l)()),!xn||t!==An){e.next=3;break}return e.abrupt("return",xn);case 3:return xn=n.e(696).then(n.bind(n,50696)).then((function(e){return e.i})),An=t,e.prev=4,e.next=7,Promise.all([xn,En.get(An)()]);case 7:r=e.sent,i=(0,a.Z)(r,2),o=i[0],l=i[1],An===t&&(o.am4core.options.defaultLocale=l.default),o.am4core.options.suppressWarnings=!0,o.am4core.options.autoDispose=!0,e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(4),e.abrupt("return",(xn=null,An=null,null));case 17:return e.abrupt("return",xn);case 18:case"end":return e.stop()}}),e,null,[[4,14]])}))),Rn.apply(this,arguments)}var Nn="esri-feature-media",On="esri-feature-media__container",Pn="esri-feature-media__item-container",zn="esri-feature-media__item",jn="esri-feature-media__item-title",Vn="esri-feature-media__item-caption",Un="esri-feature-media__previous",qn="esri-feature-media__previous-icon",Dn="esri-feature-media__previous-icon--rtl",Wn="esri-feature-media__next",Bn="esri-feature-media__next-icon",Kn="esri-feature-media__next-icon--rtl",$n="esri-feature-media__chart",Gn="esri-feature-media__button",Hn="esri-feature-media__icon",Yn="esri-icon-left-triangle-arrow",Qn="esri-icon-right-triangle-arrow",Xn=.05,Jn=.95,er="color",tr="tooltip",nr="value",rr="default-line-value",ir=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,i){var a;return(0,l.Z)(this,n),(a=t.call(this,e,i))._refreshTimer=null,a._refreshIntervalInfo=null,a._featureElementInfo=null,a.attributes=null,a.activeMediaInfoIndex=null,a.description=null,a.fieldInfoMap=null,a.layer=null,a.mediaInfos=null,a.popupTemplate=null,a.relatedInfos=null,a.title=null,a.viewModel=new Fn,a.messages=null,a._getChartDependencies=function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,i,o,l,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn();case 2:if(n=e.sent,i=(0,r.Z)(a),o=i.destroyed,l=i.viewModel,!o&&l&&t){e.next=8;break}return e.abrupt("return");case 8:return u=l.activeMediaInfo,e.next=11,a._getRendererColors(n);case 11:c=e.sent,a._renderChart({chartDiv:t,mediaInfo:u,chartsModule:n,colorMap:c});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new Ut,this.own([(0,y.l)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.activeMediaInfo,null===(n=e.viewModel)||void 0===n?void 0:n.activeMediaInfoIndex]}),(function(){return e._setupMediaRefreshTimer()}),y.h),(0,y.l)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(n=e.viewModel)||void 0===n?void 0:n.title]}),(function(){return e._setupFeatureElementInfo()}),y.h)])}},{key:"destroy",value:function(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}},{key:"render",value:function(){var e;return(0,b.n)("div",{bind:this,class:Nn,onkeyup:this._handleMediaKeyup},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderMedia())}},{key:"renderMedia",value:function(){return this.viewModel.formattedMediaInfoCount?(0,b.n)("div",{key:"media-element-container",class:On},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}},{key:"renderImageMediaInfo",value:function(e){var t=this._refreshIntervalInfo,n=this.viewModel,r=n.activeMediaInfoIndex,i=n.formattedMediaInfoCount,a=e.value,o=e.refreshInterval,s=e.altText,l=e.title,u=e.type,c=a.sourceURL,d=a.linkURL,f=se(d)?"_blank":"_self",p="_blank"===f?"noreferrer":"",h=o?t:null,v=h?h.timestamp:0,m=h?h.sourceURL:c,y=(0,b.n)("img",{alt:s||l,key:"media-".concat(u,"-").concat(r,"-").concat(i,"-").concat(v),src:m});return(d?(0,b.n)("a",{title:l,href:d,rel:p,target:f},y):null)||y}},{key:"renderChartMediaInfo",value:function(e){var t=this.viewModel,n=t.activeMediaInfoIndex,r=t.formattedMediaInfoCount;return(0,b.n)("div",{key:"media-".concat(e.type,"-").concat(n,"-").concat(r),bind:this,class:$n,afterCreate:this._getChartDependencies})}},{key:"renderMediaInfoType",value:function(){var e=this.viewModel.activeMediaInfo;return e?"image"===e.type?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}},{key:"renderMediaInfo",value:function(){var e=this.viewModel.activeMediaInfo;if(!e)return null;var t=e.title?(0,b.n)("div",{key:"media-title",class:jn,innerHTML:e.title}):null,n=e.caption?(0,b.n)("div",{key:"media-caption",class:Vn,innerHTML:e.caption}):null;return(0,b.n)("div",{key:"media-container",class:Pn},(0,b.n)("div",{key:"media-item-container",class:zn},this.renderMediaInfoType()),t,n)}},{key:"renderMediaPageButton",value:function(e){if(this.viewModel.formattedMediaInfoCount<2)return null;var t="previous"===e,n=t?this.messages.previous:this.messages.next,r=t?this.classes(Gn,Un):this.classes(Gn,Wn),i=t?this.classes(Hn,qn,Yn):this.classes(Hn,Bn,Qn),a=t?this.classes(Hn,Dn,Qn):this.classes(Hn,Kn,Yn),o=t?"media-previous":"media-next",s=t?this._previous:this._next;return(0,b.n)("button",{type:"button",key:o,title:n,"aria-label":n,tabIndex:0,class:r,bind:this,onclick:s},(0,b.n)("span",{"aria-hidden":"true",class:i}),(0,b.n)("span",{"aria-hidden":"true",class:a}))}},{key:"_setupFeatureElementInfo",value:function(){var e=this.description,t=this.title;this._featureElementInfo.set({description:e,title:t})}},{key:"_next",value:function(){this.viewModel.next()}},{key:"_previous",value:function(){this.viewModel.previous()}},{key:"_getRendererColors",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.am4core,i=null===(n=this.viewModel)||void 0===n?void 0:n.layer,a=new Map,i){e.next=3;break}return e.abrupt("return",a);case 3:return e.next=5,(0,E.h)(i.renderer);case 5:return(o=e.sent).delete(null),e.abrupt("return",Array.from(o.values()).every((function(e){return 1===(null===e||void 0===e?void 0:e.length)}))?(a.set(rr,r.color({r:50,g:50,b:50,a:1})),Array.from(o.keys()).forEach((function(e){e&&a.set(e,r.color(o.get(e)[0].toCss(!0)))})),a):a);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_handleMediaKeyup",value:function(e){var t=(0,v.i)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}},{key:"_renderChart",value:function(e){var t=this.viewModel.abilities,n=e.chartsModule,r=e.chartDiv,i=e.mediaInfo,a=e.colorMap,s=i.value,l=i.type,u=n.am4core,c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=Cn.find((function(e){return e.name===t}));return n?n.colors.map((function(t){return e.color(t)})):null}(u);(0,E.r)()&&u.useTheme(n.am4themes_dark);var d=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!d.matches?u.useTheme(n.am4themes_animated):u.unuseTheme(n.am4themes_animated),u.useTheme((function(e){e instanceof u.ColorSet&&c&&(e.list=c)}));var f="pie-chart"===l?this._createPieChart(e):this._createXYChart(e);r.setAttribute("aria-label",i.altText||i.title),f.data=s.series.map((function(e){var t;return t={},(0,o.Z)(t,tr,e.tooltip),(0,o.Z)(t,nr,e.value),(0,o.Z)(t,er,a.get(e.fieldName)),t})).filter((function(e){return"pie-chart"!==l||e.value>0}))}},{key:"_customizeChartTooltip",value:function(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}},{key:"_createPieChart",value:function(e){var t=e.chartDiv,n=e.chartsModule,r=n.am4core,i=n.am4charts,a=r.create(t,i.PieChart);a.rtl=(0,b.f)(this.container);var o=a.series.push(new i.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value=nr,o.dataFields.category=tr,this._customizeChartTooltip(o.tooltip,r),o.slices.template.tooltipText=a.rtl?"{category}: %{value.percent.formatNumber('#.0')}":"{category}: {value.percent.formatNumber('#.0')}%",o.slices.template.propertyFields.fill=er,o.slices.template.propertyFields.stroke=er,a}},{key:"_getMinSeriesValue",value:function(e){var t=0;return e.forEach((function(e){return t=Math.min(e.value,t)})),t}},{key:"_createColumnChart",value:function(e,t){var n=t.chartsModule,r=t.mediaInfo.value,i=n.am4core,a=n.am4charts,o=e.xAxes.push(new a.CategoryAxis);o.dataFields.category=tr,o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,i),o.tooltip.events.on("sizechanged",(function(){o.tooltip.dy=-o.tooltip.contentHeight}));var s=e.yAxes.push(new a.ValueAxis),l=s.renderer.labels.template;s.renderer.minLabelPosition=Xn,s.renderer.maxLabelPosition=Jn,s.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(s.tooltip,i),l.wrap=!0;var u=e.series.push(new a.ColumnSeries);u.dataFields.valueY=nr,u.dataFields.categoryX=tr,u.columns.template.propertyFields.fill=er,u.columns.template.propertyFields.stroke=er,e.cursor=new a.XYCursor,r.series.length>15&&(e.scrollbarX=new i.Scrollbar)}},{key:"_createBarChart",value:function(e,t){var n=t.chartsModule,r=t.mediaInfo.value,i=n.am4core,a=n.am4charts,o=e.yAxes.push(new a.CategoryAxis);o.dataFields.category=tr,o.renderer.inversed=!0,o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,i),o.tooltip.events.on("sizechanged",(function(){o.tooltip.dx=o.tooltip.contentWidth}));var s=e.xAxes.push(new a.ValueAxis),l=s.renderer.labels.template;s.renderer.minLabelPosition=Xn,s.renderer.maxLabelPosition=Jn,s.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(s.tooltip,i),l.wrap=!0;var u=e.series.push(new a.ColumnSeries);u.dataFields.valueX=nr,u.dataFields.categoryY=tr,u.columns.template.propertyFields.fill=er,u.columns.template.propertyFields.stroke=er,e.cursor=new a.XYCursor,r.series.length>15&&(e.scrollbarY=new i.Scrollbar)}},{key:"_createLineChart",value:function(e,t){var n=t.chartsModule,r=t.mediaInfo,i=t.colorMap,a=r.value,o=n.am4core,s=n.am4charts,l=e.xAxes.push(new s.CategoryAxis);l.dataFields.category=tr,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,o),l.tooltip.events.on("sizechanged",(function(){l.tooltip.dy=-l.tooltip.contentHeight}));var u=e.yAxes.push(new s.ValueAxis),c=u.renderer.labels.template;u.renderer.minLabelPosition=Xn,u.renderer.maxLabelPosition=Jn,u.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(u.tooltip,o),c.wrap=!0;var d=e.series.push(new s.LineSeries);d.dataFields.categoryX=tr,d.dataFields.valueY=nr,d.strokeWidth=1;var f=i.get(rr);f&&(d.stroke=f);var p=d.bullets.push(new s.CircleBullet);p.propertyFields.fill=er,p.propertyFields.stroke=er,e.cursor=new s.XYCursor,a.series.length>15&&(e.scrollbarX=new o.Scrollbar)}},{key:"_createXYChart",value:function(e){var t=e.chartDiv,n=e.chartsModule,r=e.mediaInfo.type,i=n.am4core,a=n.am4charts,o=i.create(t,a.XYChart);return o.rtl=(0,b.f)(this.container),"column-chart"===r&&this._createColumnChart(o,e),"bar-chart"===r&&this._createBarChart(o,e),"line-chart"===r&&this._createLineChart(o,e),o}},{key:"_clearMediaRefreshTimer",value:function(){var e=this._refreshTimer;e&&(clearTimeout(e),this._refreshTimer=null)}},{key:"_updateMediaInfoTimestamp",value:function(e){var t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}},{key:"_setupMediaRefreshTimer",value:function(){this._clearMediaRefreshTimer();var e=this.viewModel.activeMediaInfo;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}},{key:"_setRefreshTimeout",value:function(e){var t=this,n=e.refreshInterval,r=e.value;if(n){var i=6e4*n;this._updateMediaInfoTimestamp(r.sourceURL);var a=setInterval((function(){t._updateMediaInfoTimestamp(r.sourceURL)}),i);this._refreshTimer=a}}},{key:"_getImageSource",value:function(e,t){var n=e.includes("?")?"&":"?",r=e.split("#"),i=(0,a.Z)(r,2),o=i[0],s=i[1],l=void 0===s?"":s;return"".concat(o).concat(n,"timestamp=").concat(t).concat(l?"#":"").concat(l)}}]),n}(b.O);(0,v.e)([(0,g.o)("viewModel.attributes")],ir.prototype,"attributes",void 0),(0,v.e)([(0,g.o)("viewModel.activeMediaInfoIndex")],ir.prototype,"activeMediaInfoIndex",void 0),(0,v.e)([(0,g.o)("viewModel.description")],ir.prototype,"description",void 0),(0,v.e)([(0,g.o)("viewModel.fieldInfoMap")],ir.prototype,"fieldInfoMap",void 0),(0,v.e)([(0,g.o)("viewModel.layer")],ir.prototype,"layer",void 0),(0,v.e)([(0,g.o)("viewModel.mediaInfos")],ir.prototype,"mediaInfos",void 0),(0,v.e)([(0,g.o)("viewModel.popupTemplate")],ir.prototype,"popupTemplate",void 0),(0,v.e)([(0,g.o)("viewModel.relatedInfos")],ir.prototype,"relatedInfos",void 0),(0,v.e)([(0,g.o)("viewModel.title")],ir.prototype,"title",void 0),(0,v.e)([(0,v.d)({type:Fn})],ir.prototype,"viewModel",void 0),(0,v.e)([(0,v.d)(),(0,b.e)("esri/widgets/Feature/t9n/Feature")],ir.prototype,"messages",void 0);var ar=ir=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureMedia")],ir);function or(e,t,n,r){var i=null,a=1e3;"number"==typeof t?(a=t,r=n):(i=null!==t&&void 0!==t?t:null,a=n);var o,s=0,l=function(){s=0,e.apply(r,o)},u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i&&i.apply(r,t),o=t,a?s||(s=setTimeout(l,a)):l()};return u.remove=function(){s&&(clearTimeout(s),s=0)},u.forceUpdate=function(){s&&(clearTimeout(s),l())},u.hasPendingUpdates=function(){return!!s},u}var sr=["$datastore","$map","$layer","$aggregatedfeatures"],lr=v.s.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function ur(e){return"string"==typeof e?Me(ke(e)):Array.isArray(e)?function(e){return'<ul class="esri-widget__list">'.concat(e.map((function(e){return"<li>".concat("string"==typeof e?Me(ke(e)):e,"</li>")})).join(""),"</ul>")}(e):"esri.arcade.Dictionary"===(null===e||void 0===e?void 0:e.declaredClass)?function(e){return'<table class="esri-widget__table">'.concat(e.keys().map((function(t){var n=e.field(t);return"<tr><th>".concat(t,"</th><td>").concat("string"==typeof n?Me(ke(n)):n,"</td></tr>")})).join(""),"</table>")}(e):e}function cr(e){var t=e.aggregatedFeatures,n=e.arcadeUtils,r=e.featureSetVars,i=e.context,a=e.viewInfo,o=e.map,s=e.graphic,l=e.interceptor;r.forEach((function(e){var r=e.toLowerCase(),u={map:o,spatialReference:a.sr,interceptor:l};if("$map"===r&&(i.vars[r]=n.convertMapToFeatureSetCollection(u)),"$layer"===r&&(i.vars[r]=n.convertFeatureLayerToFeatureSet({layer:s.sourceLayer,spatialReference:a.sr,interceptor:l})),"$datastore"===r&&(i.vars[r]=n.convertServiceUrlToWorkspace({url:s.sourceLayer.url,spatialReference:a.sr,interceptor:l})),"$aggregatedfeatures"===r){var c=s.layer,d=c.fields,f=c.objectIdField,h=c.geometryType,v=c.spatialReference,m=c.displayField,y=new z.K((0,p.Z)((0,p.Z)({fields:d,objectIdField:f,geometryType:h,spatialReference:v,displayField:m},"feature"===c.type?{templates:c.templates,typeIdField:c.typeIdField,types:c.types}:null),{},{source:t}));i.vars[r]=n.convertFeatureLayerToFeatureSet({layer:y,spatialReference:a.sr,interceptor:l})}}))}function dr(){return n.e(1837).then(n.bind(n,41837)).then((function(e){return e.t}))}function fr(e){return pr.apply(this,arguments)}function pr(){return pr=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.graphic,r=t.view,i=n.isAggregate,a=n.layer,i&&a&&"2d"===(null===r||void 0===r?void 0:r.type)){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,r.whenLayerView(a);case 6:if((o=e.sent).createQuery&&o.queryFeatures){e.next=9;break}return e.abrupt("return",[]);case 9:return(l=o.createQuery()).aggregateIds=[n.getObjectId()],e.next=13,o.queryFeatures(l);case 13:return u=e.sent,c=u.features,e.abrupt("return",c);case 16:case"end":return e.stop()}}),e)}))),pr.apply(this,arguments)}function hr(e){return vr.apply(this,arguments)}function vr(){return vr=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,o,l,u,c,d,f,p,h,v,m,y,g;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.expressionInfo,r=t.arcadeUtils,i=t.interceptor,o=t.spatialReference,l=t.map,u=t.graphic,c=t.view,n&&n.expression){e.next=3;break}return e.abrupt("return",null);case 3:return d=r.createSyntaxTree(n.expression),f=sr.filter((function(e){return r.hasVariable(d,e)})),e.next=7,Promise.all([fr({graphic:u,view:c}),r.loadScriptDependencies(d,!0,f)]);case 7:return p=e.sent,h=(0,a.Z)(p,1),v=h[0],m=r.getViewInfo({spatialReference:o}),(y=r.createExecContext(u,m)).interceptor=i,y.useAsync=!0,cr({aggregatedFeatures:v,arcadeUtils:r,featureSetVars:f,context:y,viewInfo:m,map:l,graphic:u,interceptor:i}),g=r.createFunction(d,y),e.abrupt("return",r.executeAsyncFunction(g,y).catch((function(e){return lr.error("arcade-execution-error",{error:e,graphic:u,expressionInfo:n})})));case 15:case"end":return e.stop()}}),e)}))),vr.apply(this,arguments)}function mr(e){return yr.apply(this,arguments)}function yr(){return yr=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,a,o,l,u,c,d,f,p,h,m,y,g;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.expressionInfos,r=t.spatialReference,a=t.graphic,o=t.interceptor,l=t.map,u=t.view,n&&n.length){e.next=3;break}return e.abrupt("return",{});case 3:return e.next=5,dr();case 5:c=e.sent,d={},f=(0,i.Z)(n);try{for(f.s();!(p=f.n()).done;)h=p.value,d["expression/".concat(h.name)]=hr({expressionInfo:h,arcadeUtils:c,interceptor:o,spatialReference:r,map:l,graphic:a,view:u})}catch(s){f.e(s)}finally{f.f()}return e.next=11,(0,v.E)(d);case 11:for(g in m=e.sent,y={},m)y[g]=ur(m[g].value);return e.abrupt("return",y);case 15:case"end":return e.stop()}}),e)}))),yr.apply(this,arguments)}var gr=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var i;return(0,l.Z)(this,n),(i=t.call(this,e))._abortController=null,i.expressionInfo=null,i.graphic=null,i.contentElement=null,i.contentElementViewModel=null,i.interceptor=null,i.view=null,i._cancelQuery=function(){var e=(0,r.Z)(i)._abortController;e&&e.abort(),i._abortController=null},i._createVM=function(){var e,t,n=null===(e=i.contentElement)||void 0===e?void 0:e.type;null===(t=i.contentElementViewModel)||void 0===t||t.destroy();var r="fields"===n?new Jt:"media"===n?new Fn:"text"===n?new Kt:null;i._set("contentElementViewModel",r)},i._compile=(0,h.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i._cancelQuery(),t=new AbortController,i._abortController=t,e.next=5,i._compileExpression();case 5:i._abortController===t&&(i._abortController=null);case 6:case"end":return e.stop()}}),e)}))),i._compileThrottled=or(i._compile,1,(0,r.Z)(i)),i._compileExpression=(0,h.Z)((0,s.Z)().mark((function e(){var t,n,a,o,l,u,c,d,f,p,h,v,m;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,r.Z)(i),n=t.expressionInfo,a=t.graphic,o=t.interceptor,l=t.spatialReference,u=t.map,c=t.view,d=t._abortController,n&&a&&l&&u){e.next=3;break}return e.abrupt("return",void i._set("contentElement",null));case 3:return e.next=5,dr();case 5:if(f=e.sent,d===i._abortController){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,hr({arcadeUtils:f,expressionInfo:n,graphic:a,interceptor:o,map:u,spatialReference:l,view:c});case 10:if((p=e.sent)&&"esri.arcade.Dictionary"===p.declaredClass){e.next=13;break}return e.abrupt("return",void i._set("contentElement",null));case 13:return e.next=15,(0,P.M)(p,d.signal);case 15:h=e.sent,v=null===h||void 0===h?void 0:h.type,m="media"===v?C.I.fromJSON(h):"text"===v?C.f.fromJSON(h):"fields"===v?C.b.fromJSON(h):null,i._set("contentElement",m);case 19:case"end":return e.stop()}}),e)}))),i.handles.add([(0,y.l)((function(){return[i.expressionInfo,i.graphic,i.map,i.spatialReference,i.view]}),(function(){return i._compileThrottled()}),y.h),(0,y.l)((function(){return[i.contentElement]}),(function(){return i._createVM()}),y.h)]),i}return(0,u.Z)(n,[{key:"destroy",value:function(){var e;this._cancelQuery(),null!==(e=this.contentElementViewModel)&&void 0!==e&&e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}},{key:"spatialReference",get:function(){var e;return(null===(e=this.view)||void 0===e?void 0:e.spatialReference)||null},set:function(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}},{key:"state",get:function(){var e=this._abortController,t=this.contentElement,n=this.contentElementViewModel;return e?"loading":t||n?"ready":"disabled"}},{key:"map",get:function(){var e;return(null===(e=this.view)||void 0===e?void 0:e.map)||null},set:function(e){void 0!==e?this._override("map",e):this._clearOverride("map")}}]),n}((0,L.a)(v.y));(0,v.e)([(0,v.d)()],gr.prototype,"_abortController",void 0),(0,v.e)([(0,v.d)({type:C.g})],gr.prototype,"expressionInfo",void 0),(0,v.e)([(0,v.d)({type:M.g})],gr.prototype,"graphic",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],gr.prototype,"contentElement",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],gr.prototype,"contentElementViewModel",void 0),(0,v.e)([(0,v.d)()],gr.prototype,"interceptor",void 0),(0,v.e)([(0,v.d)()],gr.prototype,"spatialReference",null),(0,v.e)([(0,v.d)({readOnly:!0})],gr.prototype,"state",null),(0,v.e)([(0,v.d)()],gr.prototype,"map",null),(0,v.e)([(0,v.d)()],gr.prototype,"view",void 0);var br=gr=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],gr),_r="esri-icon-loading-indicator esri-rotating",wr="esri-feature-expression",Ir="esri-feature__loading-container",kr="esri-feature__loading-spinner",Mr=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r)).viewModel=new br,i}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this.own((0,y.l)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentElementViewModel}),(function(){return e._setupExpressionWidget()}),y.h))}},{key:"destroy",value:function(){this._destroyContentWidget()}},{key:"renderLoading",value:function(){return(0,b.n)("div",{key:"loading-container",class:Ir},(0,b.n)("span",{class:this.classes(_r,kr)}))}},{key:"render",value:function(){var e,t=this.viewModel.state;return(0,b.n)("div",{class:wr},"loading"===t?this.renderLoading():"disabled"===t?null:null===(e=this._contentWidget)||void 0===e?void 0:e.render())}},{key:"_destroyContentWidget",value:function(){var e=this._contentWidget;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}},{key:"_setupExpressionWidget",value:function(){var e=this.viewModel,t=e.contentElementViewModel,n=e.contentElement,r=null===n||void 0===n?void 0:n.type;this._destroyContentWidget();var i=t?"fields"===r?new un({viewModel:t}):"media"===r?new ar({viewModel:t}):"text"===r?new Qt({viewModel:t}):null:null;this._contentWidget=i,this.scheduleRender()}}]),n}(b.O);(0,v.e)([(0,v.d)({type:br})],Mr.prototype,"viewModel",void 0);var xr,Ar=Mr=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureExpression")],Mr),Fr=(0,u.Z)((function e(t,n){(0,l.Z)(this,e),this.preLayerQueryCallback=t,this.preRequestCallback=n,this.preLayerQueryCallback||(this.preLayerQueryCallback=function(e){}),this.preRequestCallback||(this.preLayerQueryCallback=function(e){})})),Zr="content-view-models",Cr="esri.widgets.FeatureViewModel",Tr=v.s.getLogger(Cr),Er={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0},Lr=xr=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var i;return(0,l.Z)(this,n),(i=t.call(this,e))._handles=new j.u,i._error=null,i._featureAbortController=null,i.graphicChangedThrottled=or(i._graphicChanged,1,(0,r.Z)(i)),i._expressionAttributes=null,i._graphicExpressionAttributes=null,i.abilities=(0,p.Z)({},Er),i.content=null,i.contentViewModels=[],i.defaultPopupTemplateEnabled=!1,i.formattedAttributes=null,i.lastEditInfo=null,i.relatedInfos=new Map,i.title="",i.view=null,i._isAllowedContentType=function(e){var t=(0,r.Z)(i).abilities;return"attachments"===e.type&&t.attachmentsContent||"custom"===e.type&&t.customContent||"fields"===e.type&&t.fieldsContent||"media"===e.type&&t.mediaContent||"text"===e.type&&t.textContent||"expression"===e.type&&t.expressionContent},i._handles.add((0,y.l)((function(){return[i.graphic,i._effectivePopupTemplate,i.abilities]}),(function(){return i.graphicChangedThrottled()}),y.h)),i}return(0,u.Z)(n,[{key:"destroy",value:function(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}},{key:"_effectivePopupTemplate",get:function(){return(0,v.r)(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}},{key:"_fieldInfoMap",get:function(){return function(e,t){var n=new Map;return e&&e.forEach((function(e){var r=ce(e.fieldName,t);e.fieldName=r,n.set(r.toLowerCase(),e)})),n}(Ie(this._effectivePopupTemplate),this._sourceLayer)}},{key:"_sourceLayer",get:function(){return ie(this.graphic)}},{key:"castAbilities",value:function(e){return(0,p.Z)((0,p.Z)({},Er),e)}},{key:"state",get:function(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}},{key:"graphic",set:function(e){this._set("graphic",e?e.clone():null)}},{key:"spatialReference",get:function(){return this.get("view.spatialReference")||null},set:function(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}},{key:"map",get:function(){return this.get("view.map")||null},set:function(e){void 0!==e?this._override("map",e):this._clearOverride("map")}},{key:"waitingForContent",get:function(){return!!this._featureAbortController}},{key:"setActiveMedia",value:function(e,t){var n=this.contentViewModels[e];n instanceof Fn&&n.setActiveMedia(t)}},{key:"nextMedia",value:function(e){var t=this.contentViewModels[e];t instanceof Fn&&t.next()}},{key:"previousMedia",value:function(e){var t=this.contentViewModels[e];t instanceof Fn&&t.previous()}},{key:"_clear",value:function(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}},{key:"_graphicChanged",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cancelFeatureQuery(),this._error=null,this._clear(),t=this.graphic){e.next=4;break}return e.abrupt("return");case 4:return n=new AbortController,this._featureAbortController=n,e.prev=6,e.next=9,this._queryFeature({signal:n.signal});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),(0,v.I)(e.t0)||(this._error=e.t0,Tr.error("error","The popupTemplate could not be displayed for this feature.",{error:e.t0,graphic:t,popupTemplate:this._effectivePopupTemplate}));case 14:this._featureAbortController===n&&(this._featureAbortController=null);case 15:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"_cancelFeatureQuery",value:function(){var e=this._featureAbortController;e&&e.abort(),this._featureAbortController=null}},{key:"_compileContentElement",value:function(e,t){return"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):"expression"===e.type?this._compileExpression(e,t):void 0}},{key:"_compileContent",value:function(e){var t=this;if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map((function(e,n){return t._compileContentElement(e,n)})):"string"==typeof e?this._compileText(new C.f({text:e}),0).text:e}},{key:"_destroyContentViewModels",value:function(){var e;null!==(e=this._handles)&&void 0!==e&&e.remove(Zr),this.contentViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("contentViewModels",[])}},{key:"_setExpressionContentVM",value:function(e,t){var n=this.formattedAttributes,r=e.contentElement,i=e.contentElementViewModel,a=null===r||void 0===r?void 0:r.type;i&&a&&("fields"===a&&(this._createFieldsFormattedAttributes({contentElement:r,contentElementIndex:t,formattedAttributes:n}),i.set(this._createFieldsVMParams(r,t))),"media"===a&&(this._createMediaFormattedAttributes({contentElement:r,contentElementIndex:t,formattedAttributes:n}),i.set(this._createMediaVMParams(r,t))),"text"===a&&i.set(this._createTextVMParams(r)))}},{key:"_compileExpression",value:function(e,t){var n=this,r=e.expressionInfo,i=this.graphic,a=this.map,o=this.spatialReference,s=this.view,l=new br({expressionInfo:r,graphic:i,interceptor:xr.interceptor,map:a,spatialReference:o,view:s});return this.contentViewModels[t]=l,this._handles.add((0,y.l)((function(){return l.contentElementViewModel}),(function(){return n._setExpressionContentVM(l,t)}),y.h),Zr),e}},{key:"_compileAttachments",value:function(e,t){var n=this.graphic,r=e.description,i=e.title;return this.contentViewModels[t]=new Ot((0,p.Z)({graphic:n},this._compileTitleAndDesc({title:i,description:r}))),e}},{key:"_compileCustom",value:function(e,t){var n=this.graphic,r=e.creator,i=e.destroyer;return this.contentViewModels[t]=new Kt({graphic:n,creator:r,destroyer:i}),e}},{key:"_compileTitleAndDesc",value:function(e){var t=e.title,n=e.description,r=this._fieldInfoMap,i=this._sourceLayer,a=this.graphic,o=this.formattedAttributes,s=this._expressionAttributes,l=a.attributes,u=o.global;return{title:pe({attributes:l,fieldInfoMap:r,globalAttributes:u,expressionAttributes:s,layer:i,text:t}),description:pe({attributes:l,fieldInfoMap:r,globalAttributes:u,expressionAttributes:s,layer:i,text:n})}}},{key:"_createFieldsVMParams",value:function(e,t){var n,r=this._effectivePopupTemplate,i=this.formattedAttributes,a=(0,p.Z)((0,p.Z)({},i.global),i.content[t]),o=null===(n=(null===e||void 0===e?void 0:e.fieldInfos)||(null===r||void 0===r?void 0:r.fieldInfos))||void 0===n?void 0:n.filter((function(e){var t=e.fieldName;return le(t)||Se(t)||a.hasOwnProperty(t)})),s=null===r||void 0===r?void 0:r.expressionInfos,l=e.description,u=e.title;return(0,p.Z)({attributes:a,expressionInfos:s,fieldInfos:o},this._compileTitleAndDesc({title:u,description:l}))}},{key:"_compileFields",value:function(e,t){var n=e.clone(),r=new Jt(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=r,n.fieldInfos=r.formattedFieldInfos.slice(0),n}},{key:"_createMediaVMParams",value:function(e,t){var n=this.abilities,r=this.graphic,i=this._fieldInfoMap,a=this.formattedAttributes,o=this._effectivePopupTemplate,s=this.relatedInfos,l=this._sourceLayer,u=this._expressionAttributes,c=r.attributes,d=e.description,f=e.mediaInfos,h=e.title;return(0,p.Z)({abilities:{chartAnimation:n.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:c,layer:l,fieldInfoMap:i,formattedAttributes:(0,p.Z)((0,p.Z)({},a.global),a.content[t]),expressionAttributes:u,mediaInfos:f,popupTemplate:o,relatedInfos:s},this._compileTitleAndDesc({title:h,description:d}))}},{key:"_compileMedia",value:function(e,t){var n=e.clone(),r=new Fn(this._createMediaVMParams(e,t));return n.mediaInfos=r.formattedMediaInfos.slice(0),this.contentViewModels[t]=r,n}},{key:"_createTextVMParams",value:function(e){var t=this.graphic,n=this._fieldInfoMap,r=this._sourceLayer,i=this._expressionAttributes;if(e&&e.text){var a=t.attributes,o=this.formattedAttributes.global;e.text=pe({attributes:a,fieldInfoMap:n,globalAttributes:o,expressionAttributes:i,layer:r,text:e.text})}return{graphic:t,creator:e.text}}},{key:"_compileText",value:function(e,t){var n=e.clone();return this.contentViewModels[t]=new Kt(this._createTextVMParams(n)),n}},{key:"_compileLastEditInfo",value:function(){var e=this._effectivePopupTemplate,t=this._sourceLayer,n=this.graphic;if(e){var r=e.lastEditInfoEnabled,i=null===t||void 0===t?void 0:t.editFieldsInfo;return r&&i?function(e,t){var n=e.creatorField,r=e.creationDateField,i=e.editorField,a=e.editDateField;if(t){var o=t[a];if("number"==typeof o){var s=t[i];return{type:"edit",date:(0,k.L)(o,re),user:s}}var l=t[r];if("number"==typeof l){var u=t[n];return{type:"create",date:(0,k.L)(l,re),user:u}}return null}}(i,n.attributes):void 0}}},{key:"_compileTitle",value:function(e){var t=this._fieldInfoMap,n=this._sourceLayer,r=this.graphic,i=this._expressionAttributes;return pe({attributes:r.attributes,fieldInfoMap:t,globalAttributes:this.formattedAttributes.global,expressionAttributes:i,layer:n,text:e})}},{key:"_getTitle",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._effectivePopupTemplate,n=this.graphic,r=null===t||void 0===t?void 0:t.title,e.abrupt("return",ae(r,{graphic:n}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getContent",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._effectivePopupTemplate,n=this.graphic,r=null===t||void 0===t?void 0:t.content,e.abrupt("return",ae(r,{graphic:n}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryFeature",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l,u,c,d,f,h,m;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._featureAbortController,r=this._sourceLayer,i=this.graphic,a=this._effectivePopupTemplate,o=this.spatialReference,l=this.map,u=this.view,e.next=9,(0,v.E)({content:this._getContent(),title:this._getTitle()});case 9:if(c=e.sent,d=c.content.value,f=c.title.value,n===this._featureAbortController&&i){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,Ee({graphic:i,popupTemplate:a,layer:r,spatialReference:o},t);case 16:return e.next=18,(0,v.E)({checkForRelatedFeatures:this._checkForRelatedFeatures(t),expressionAttributes:mr({expressionInfos:null===a||void 0===a?void 0:a.expressionInfos,spatialReference:o,graphic:i,map:l,interceptor:xr.interceptor,view:u})});case 18:h=e.sent,m=h.expressionAttributes.value,n===this._featureAbortController&&i&&(this._expressionAttributes=m,this._graphicExpressionAttributes=(0,p.Z)((0,p.Z)({},i.attributes),m),this._set("formattedAttributes",this._createFormattedAttributes(d)),this._set("title",this._compileTitle(f)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(d)||null));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createMediaFormattedAttributes",value:function(e){var t=e.contentElement,n=e.contentElementIndex,r=e.formattedAttributes,i=this._effectivePopupTemplate,a=this.graphic,o=this.relatedInfos,s=this._sourceLayer,l=this._fieldInfoMap,u=this._graphicExpressionAttributes;r.content[n]=Ae({fieldInfos:null===i||void 0===i?void 0:i.fieldInfos,graphic:a,attributes:(0,p.Z)((0,p.Z)({},u),t.attributes),layer:s,fieldInfoMap:l,relatedInfos:o})}},{key:"_createFieldsFormattedAttributes",value:function(e){var t=e.contentElement,n=e.contentElementIndex,r=e.formattedAttributes;if(t.fieldInfos){var i=this.graphic,a=this.relatedInfos,o=this._sourceLayer,s=this._fieldInfoMap,l=this._graphicExpressionAttributes;r.content[n]=Ae({fieldInfos:t.fieldInfos,graphic:i,attributes:(0,p.Z)((0,p.Z)({},l),t.attributes),layer:o,fieldInfoMap:s,relatedInfos:a})}}},{key:"_createFormattedAttributes",value:function(e){var t=this,n=this._effectivePopupTemplate,r=this.graphic,i=this.relatedInfos,a=this._sourceLayer,o=this._fieldInfoMap,s=this._graphicExpressionAttributes,l={global:Ae({fieldInfos:null===n||void 0===n?void 0:n.fieldInfos,graphic:r,attributes:s,layer:a,fieldInfoMap:o,relatedInfos:i}),content:[]};return Array.isArray(e)&&e.forEach((function(e,n){"fields"===e.type&&t._createFieldsFormattedAttributes({contentElement:e,contentElementIndex:n,formattedAttributes:l}),"media"===e.type&&t._createMediaFormattedAttributes({contentElement:e,contentElementIndex:n,formattedAttributes:l})})),l}},{key:"_checkForRelatedFeatures",value:function(e){var t=this.graphic,n=this._effectivePopupTemplate;return this._queryRelatedInfos(t,Ie(n),e)}},{key:"_queryRelatedInfos",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t,n,r){var i,a,o,l,u,c,d=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.relatedInfos,a=this._sourceLayer,i.clear(),!(0,v.r)(a.associatedLayer)){e.next=8;break}return e.next=5,a.associatedLayer.load(r);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=a;case 9:if(o=e.t0){e.next=12;break}return e.abrupt("return");case 12:if(l=n.filter((function(e){return e&&Se(e.fieldName)})),l&&l.length){e.next=15;break}return e.abrupt("return");case 15:return n.forEach((function(e){return d._configureRelatedInfo(e,o)})),e.next=18,_n({relatedInfos:i,layer:o},r);case 18:return u=e.sent,Object.keys(u).forEach((function(e){var t,n=i.get(e.toString()),r=null===(t=u[e])||void 0===t?void 0:t.value;n&&r&&(n.layerInfo=r.data)})),e.next=22,wn({graphic:t,relatedInfos:i,layer:o},r);case 22:c=e.sent,Object.keys(c).forEach((function(e){var t;mn(null===(t=c[e])||void 0===t?void 0:t.value,i.get(e.toString()))}));case 24:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_configureRelatedInfo",value:function(e,t){var n=this.relatedInfos,r=fn(e.fieldName);if(r){var i=r.layerId,a=r.fieldName;if(i){var o=n.get(i.toString())||vn(i,t);o&&(function(e){var t=e.relatedInfo,n=e.fieldName,r=e.fieldInfo;if(t.relatedFields.push(n),r.statisticType){var i=new N.m({statisticType:r.statisticType,onStatisticField:n,outStatisticFieldName:n});t.outStatistics.push(i)}}({relatedInfo:o,fieldName:a,fieldInfo:e}),this.relatedInfos.set(i,o))}}}}]),n}(v.y);Lr.interceptor=new Fr((function(e){var t=e.query,n=e.layer,r=e.method;Oe({layer:n,method:r,query:t,definitionExpression:"".concat(n.definitionExpression," ").concat(n.serviceDefinitionExpression)})}),(function(e){var t=e.queryPayload,n=e.layer,r=e.method;Oe({layer:n,method:r,query:t,definitionExpression:"".concat(n.definitionExpression," ").concat(n.serviceDefinitionExpression)})})),(0,v.e)([(0,v.d)()],Lr.prototype,"_error",void 0),(0,v.e)([(0,v.d)()],Lr.prototype,"_featureAbortController",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"_effectivePopupTemplate",null),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"_fieldInfoMap",null),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"_sourceLayer",null),(0,v.e)([(0,v.d)()],Lr.prototype,"abilities",void 0),(0,v.e)([(0,v.H)("abilities")],Lr.prototype,"castAbilities",null),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"content",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"contentViewModels",void 0),(0,v.e)([(0,v.d)({type:Boolean})],Lr.prototype,"defaultPopupTemplateEnabled",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"state",null),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"formattedAttributes",void 0),(0,v.e)([(0,v.d)({type:M.g,value:null})],Lr.prototype,"graphic",null),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"lastEditInfo",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"relatedInfos",void 0),(0,v.e)([(0,v.d)()],Lr.prototype,"spatialReference",null),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"title",void 0),(0,v.e)([(0,v.d)()],Lr.prototype,"map",null),(0,v.e)([(0,v.d)({readOnly:!0})],Lr.prototype,"waitingForContent",null),(0,v.e)([(0,v.d)()],Lr.prototype,"view",void 0);var Sr=Lr=xr=(0,v.e)([(0,v.n)(Cr)],Lr),Rr=function(e){var t=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;return(0,l.Z)(this,n),(e=t.apply(this,arguments)).renderNodeContent=function(t){return(0,S.e)(t)&&!t.destroyed?(0,b.n)("div",{key:t},t.render()):t instanceof HTMLElement?(0,b.n)("div",{key:t,bind:t,afterCreate:e._attachToNode}):(0,S.t)(t)?(0,b.n)("div",{key:t,bind:t.domNode,afterCreate:e._attachToNode}):null},e}return(0,u.Z)(n,[{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),n}(e);return t=(0,v.e)([(0,v.n)("esri.widgets.Feature.ContentMixin")],t)},Nr="esri-icon-loading-indicator esri-rotating",Or="esri-widget",Pr="esri-feature",zr="esri-feature__size-container",jr="esri-feature__title",Vr="esri-feature__main-container",Ur="esri-feature__content-element",qr="esri-feature__text",Dr="esri-feature__last-edited-info",Wr="esri-feature__loading-container",Br="esri-feature__loading-spinner",Kr={title:!0,content:!0,lastEditedInfo:!0},$r=function(e){(0,c.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;return(0,l.Z)(this,r),(i=t.call(this,e,n))._contentWidgets=[],i.graphic=null,i.defaultPopupTemplateEnabled=!1,i.headingLevel=2,i.label=void 0,i.messages=null,i.messagesCommon=null,i.messagesURIUtils=null,i.spatialReference=null,i.title=null,i.visibleElements=(0,p.Z)({},Kr),i.map=null,i.view=null,i.viewModel=new Sr,i}return(0,u.Z)(r,[{key:"initialize",value:function(){var e=this;this.own((0,y.l)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentViewModels}),(function(){return e._setupContentWidgets()}),y.h))}},{key:"loadDependencies",value:function(){return n.e(1308).then(n.bind(n,91308))}},{key:"destroy",value:function(){this._destroyContentWidgets()}},{key:"castVisibleElements",value:function(e){return(0,p.Z)((0,p.Z)({},Kr),e)}},{key:"render",value:function(){var e=this.viewModel.state,t=(0,b.n)("div",{class:zr,key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return(0,b.n)("div",{class:this.classes(Pr,Or)},t)}},{key:"setActiveMedia",value:function(e,t){this.viewModel.setActiveMedia(e,t)}},{key:"nextMedia",value:function(e){this.viewModel.nextMedia(e)}},{key:"previousMedia",value:function(e){this.viewModel.previousMedia(e)}},{key:"renderError",value:function(){var e=this.messagesCommon,t=this.messages,n=this.visibleElements;return(0,b.n)("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},n.title?(0,b.n)("div",{key:"error-title",slot:"title"},e.errorMessage):null,(0,b.n)("div",{key:"error-message",slot:"message"},t.loadingError))}},{key:"renderLoading",value:function(){return(0,b.n)("div",{key:"loading-container",class:Wr},(0,b.n)("span",{class:this.classes(Nr,Br)}))}},{key:"renderContentContainer",value:function(){return this.visibleElements.content?(0,b.n)("div",{class:Vr},[this.renderContent(),this.renderLastEditInfo()]):null}},{key:"renderTitle",value:function(){var e=this.visibleElements,t=this.title;return e.title?(0,b.n)(E.n,{level:this.headingLevel,class:jr,innerHTML:t}):null}},{key:"renderContent",value:function(){var e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?(0,b.n)("div",{key:"".concat(t,"-content-elements")},e.map(this.renderContentElement,this)):null;if("string"==typeof e){var n=this._contentWidgets[0];return!n||n.destroyed?null:(0,b.n)("div",{key:"".concat(t,"-content")},n.render())}return this.renderNodeContent(e)}},{key:"renderContentElement",value:function(e,t){var n=this.visibleElements;if("boolean"!=typeof n.content&&!n.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);case"expression":return this.renderExpression(t);default:return null}}},{key:"renderAttachments",value:function(e){var t=this._contentWidgets[e];if(!t||t.destroyed)return null;var n=t.viewModel,r=n.state,i=n.attachmentInfos;return"loading"===r||i.length>0?(0,b.n)("div",{key:this._buildKey("attachments-element",e),class:this.classes(Ur)},t.render()):null}},{key:"renderExpression",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,b.n)("div",{key:this._buildKey("expression-element",e),class:Ur},t.render())}},{key:"renderCustom",value:function(e,t){var n=e.creator,r=this._contentWidgets[t];return!r||r.destroyed?null:n?(0,b.n)("div",{key:this._buildKey("custom-element",t),class:Ur},r.render()):null}},{key:"renderFields",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,b.n)("div",{key:this._buildKey("fields-element",e),class:Ur},t.render())}},{key:"renderMedia",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,b.n)("div",{key:this._buildKey("media-element",e),class:Ur},t.render())}},{key:"renderLastEditInfo",value:function(){var e=this.visibleElements,t=this.messages,n=this.viewModel.lastEditInfo;if(!n||!e.lastEditedInfo)return null;var r=n.date,i=n.user,a="edit"===n.type?i?t.lastEditedByUser:t.lastEdited:i?t.lastCreatedByUser:t.lastCreated,o=(0,m.s)(a,{date:r,user:i});return(0,b.n)("div",{key:"edit-info-element",class:this.classes(Dr,Ur)},o)}},{key:"renderText",value:function(e,t){var n=e.text,r=this._contentWidgets[t];return!r||r.destroyed?null:n?(0,b.n)("div",{key:this._buildKey("text-element",t),class:this.classes(Ur,qr)},r.render()):null}},{key:"_buildKey",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"".concat(e,"__").concat(this.get("viewModel.graphic.uid")||"0","-").concat(n.join("-"))}},{key:"_destroyContentWidget",value:function(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}},{key:"_destroyContentWidgets",value:function(){var e=this;this._contentWidgets.forEach((function(t){return e._destroyContentWidget(t)})),this._contentWidgets=[]}},{key:"_setupContentWidgets",value:function(){var e=this;this._destroyContentWidgets();var t=this.headingLevel,n=this.visibleElements,r=this.get("viewModel.content"),i=this.viewModel.contentViewModels;if(Array.isArray(r))r.forEach((function(r,a){"attachments"===r.type&&(e._contentWidgets[a]=new Wt({displayType:r.displayType,headingLevel:n.title?t+1:t,viewModel:i[a]})),"fields"===r.type&&(e._contentWidgets[a]=new un({viewModel:i[a]})),"media"===r.type&&(e._contentWidgets[a]=new ar({viewModel:i[a]})),"text"===r.type&&(e._contentWidgets[a]=new Qt({viewModel:i[a]})),"custom"===r.type&&(e._contentWidgets[a]=new Qt({viewModel:i[a]})),"expression"===r.type&&(e._contentWidgets[a]=new Ar({viewModel:i[a]}))}),this);else{var a=i[0];a&&!a.destroyed&&(this._contentWidgets[0]=new Qt({viewModel:a}))}this.scheduleRender()}}]),r}(Rr(b.O));(0,v.e)([(0,g.o)("viewModel.graphic")],$r.prototype,"graphic",void 0),(0,v.e)([(0,g.o)("viewModel.defaultPopupTemplateEnabled")],$r.prototype,"defaultPopupTemplateEnabled",void 0),(0,v.e)([(0,v.d)()],$r.prototype,"headingLevel",void 0),(0,v.e)([(0,v.d)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],$r.prototype,"label",void 0),(0,v.e)([(0,v.d)(),(0,b.e)("esri/widgets/Feature/t9n/Feature")],$r.prototype,"messages",void 0),(0,v.e)([(0,v.d)(),(0,b.e)("esri/t9n/common")],$r.prototype,"messagesCommon",void 0),(0,v.e)([(0,v.d)(),(0,b.e)("esri/widgets/support/t9n/uriUtils")],$r.prototype,"messagesURIUtils",void 0),(0,v.e)([(0,g.o)("viewModel.spatialReference")],$r.prototype,"spatialReference",void 0),(0,v.e)([(0,g.o)("viewModel.title")],$r.prototype,"title",void 0),(0,v.e)([(0,v.d)()],$r.prototype,"visibleElements",void 0),(0,v.e)([(0,v.H)("visibleElements")],$r.prototype,"castVisibleElements",null),(0,v.e)([(0,g.o)("viewModel.map")],$r.prototype,"map",void 0),(0,v.e)([(0,g.o)("viewModel.view")],$r.prototype,"view",void 0),(0,v.e)([(0,v.d)({type:Sr})],$r.prototype,"viewModel",void 0);var Gr=$r=(0,v.e)([(0,v.n)("esri.widgets.Feature")],$r),Hr=Object.freeze({__proto__:null,default:Gr})},37243:function(e,t,n){n.d(t,{n:function(){return m},p:function(){return h}});var r=n(43144),i=n(15671),a=n(60136),o=n(29388),s=n(50165),l=n(78697),u=n(32335),c=n(77322),d=n(49961),f=new(n(13994).s)({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"}),p=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).name=null,r.description=null,r.drawingTool=null,r.prototype=null,r.thumbnail=null,r}return(0,r.Z)(n)}((0,l.l)(u.l));(0,s.e)([(0,s.d)({json:{write:!0}})],p.prototype,"name",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],p.prototype,"description",void 0),(0,s.e)([(0,s.d)({json:{read:f.read,write:f.write}})],p.prototype,"drawingTool",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],p.prototype,"prototype",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],p.prototype,"thumbnail",void 0);var h=p=(0,s.e)([(0,s.n)("esri.layers.support.FeatureTemplate")],p),v=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).id=null,r.name=null,r.domains=null,r.templates=null,r}return(0,r.Z)(n,[{key:"readDomains",value:function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t[i]=(0,d.t)(e[i])}return t}},{key:"writeDomains",value:function(e,t){for(var n={},r=0,i=Object.keys(e);r<i.length;r++){var a,o=i[r];e[o]&&(n[o]=null===(a=e[o])||void 0===a?void 0:a.toJSON())}t.domains=n}}]),n}((0,l.l)(u.l));(0,s.e)([(0,s.d)({json:{write:!0}})],v.prototype,"id",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],v.prototype,"name",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],v.prototype,"domains",void 0),(0,s.e)([(0,c.o)("domains")],v.prototype,"readDomains",null),(0,s.e)([(0,c.r)("domains")],v.prototype,"writeDomains",null),(0,s.e)([(0,s.d)({type:[h],json:{write:!0}})],v.prototype,"templates",void 0);var m=v=(0,s.e)([(0,s.n)("esri.layers.support.FeatureType")],v)},17493:function(e,t,n){n.d(t,{o:function(){return d},s:function(){return c}});var r=n(43144),i=n(15671),a=n(97326),o=n(60136),s=n(29388),l=n(50165),u=0,c=function(e){var t=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,i.Z)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object.defineProperty((0,a.Z)(e),"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+u++}),e}return(0,r.Z)(n)}(e);return t=(0,l.e)([(0,l.n)("esri.core.Identifiable")],t)},d=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n)}(c(function(){return(0,r.Z)((function e(){(0,i.Z)(this,e)}))}()));d=(0,l.e)([(0,l.n)("esri.core.Identifiable")],d)},84913:function(e,t,n){n.d(t,{p:function(){return f}});var r,i=n(15671),a=n(43144),o=n(60136),s=n(29388),l=n(50165),u=n(40133),c=n(32335),d=r=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).floorField=null,r.viewAllMode=!1,r.viewAllLevelIds=new u.j,r}return(0,a.Z)(n,[{key:"clone",value:function(){return new r({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}}]),n}(c.l);(0,l.e)([(0,l.d)({type:String,json:{write:!0}})],d.prototype,"floorField",void 0),(0,l.e)([(0,l.d)({json:{read:!1,write:!1}})],d.prototype,"viewAllMode",void 0),(0,l.e)([(0,l.d)({json:{read:!1,write:!1}})],d.prototype,"viewAllLevelIds",void 0);var f=d=r=(0,l.e)([(0,l.n)("esri.layers.support.LayerFloorInfo")],d)},80933:function(e,t,n){n.d(t,{I:function(){return w},L:function(){return b},S:function(){return g},b:function(){return _},d:function(){return f},g:function(){return y},h:function(){return v},j:function(){return I},m:function(){return p},w:function(){return h},y:function(){return m}});var r=n(29439),i=n(50165),a=n(13994),o=n(3029),s={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},l=Object.values(s),u=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),c=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),d=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function f(e){return!!u.test(e)}function p(e){if((0,i.t)(e))return null;var t=(0,a.j)(e),n=t.path.match(u)||t.path.match(c);if(!n)return null;var o=(0,r.Z)(n,5),l=o[1],d=o[2],f=o[3],p=o[4],h=d.indexOf("/");return{title:v(-1!==h?d.slice(h+1):d),serverType:s[f.toLowerCase()],sublayer:null!=p&&""!==p?parseInt(p,10):null,url:{path:l}}}function h(e){var t=(0,a.j)(e).path.match(d);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function v(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function m(e,t){var n=[];if(e){var r=p(e);(0,i.r)(r)&&r.title&&n.push(r.title)}if(t){var a=v(t);n.push(a)}if(2===n.length){if(n[0].toLowerCase().includes(n[1].toLowerCase()))return n[0];if(n[1].toLowerCase().includes(n[0].toLowerCase()))return n[1]}return n.join(" - ")}function y(e){if(!e)return!1;var t=(e=e.toLowerCase()).includes(".arcgis.com/"),n=e.includes("//services")||e.includes("//tiles")||e.includes("//features");return t&&n}function g(e,t){return e?(0,a.C)((0,a.A)(e,t)):e}function b(e){var t=e.url;if(!t)return{url:t};t=(0,a.A)(t,e.logger);var n,r=(0,a.j)(t),o=p(r.path);if((0,i.r)(o))null!=o.sublayer&&null==e.layer.layerId&&(n=o.sublayer),t=o.url.path;else if(e.nonStandardUrlAllowed){var s=h(r.path);(0,i.r)(s)&&(t=s.serviceUrl,n=s.sublayerId)}return{url:(0,a.C)(t),layerId:n}}function _(e,t,n,r,i){(0,o.p)(t,r,"url",i),r.url&&null!=e.layerId&&(r.url=(0,a.G)(r.url,n,e.layerId.toString()))}function w(e){if(!e)return!1;var t=e.toLowerCase(),n=t.includes("/services/"),r=t.includes("/mapserver/wmsserver"),i=t.includes("/imageserver/wmsserver"),a=t.includes("/wmsserver");return n&&(r||i||a)}function I(e){if(!e)return!1;var t=new a.y((0,a.Q)(e)).authority.toLowerCase();return"server.arcgisonline.com"===t||"services.arcgisonline.com"===t}},48561:function(e,t,n){function r(e){return 32+e.length}function i(){return 16}function a(e){if(!e)return 0;var t=32;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];switch(typeof i){case"string":t+=r(i);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function o(e,t){return 32+e.length*t}var s;n.d(t,{e:function(){return o},n:function(){return r},o:function(){return s},r:function(){return a},t:function(){return i}}),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(s||(s={}))},50338:function(e,t,n){n.d(t,{S:function(){return s},e:function(){return r},i:function(){return i},l:function(){return a},o:function(){return o},r:function(){return u},s:function(){return c},t:function(){return l},y:function(){return d}});var r=[252,146,31,255],i=[153,153,153,255],a={type:"esriSMS",style:"esriSMSCircle",size:6,color:r,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},o={type:"esriSLS",style:"esriSLSSolid",width:.75,color:r},s={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},l={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},u={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},c={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},d={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},86931:function(e,t,n){n.d(t,{a:function(){return k},l:function(){return _},s:function(){return w}});var r,i=n(1413),a=n(74165),o=n(15861),s=n(15671),l=n(43144),u=n(60136),c=n(29388),d=n(50165),f=n(32335),p=n(51613),h=n(80392),v=n(82046),m=n(53089);function y(e){var t=e.exifInfo,n=e.exifName,r=e.tagName;if(!t||!n||!r)return null;var i=t.find((function(e){return e.name===n}));return i?function(e){var t=e.tagName,n=e.tags;if(!n||!t)return null;var r=n.find((function(e){return e.name===t}));return r&&r.value||null}({tagName:r,tags:i.tags}):null}var g={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}},b=r=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).contentType=null,r.exifInfo=null,r.id=null,r.globalId=null,r.keywords=null,r.name=null,r.parentGlobalId=null,r.parentObjectId=null,r.size=null,r.url=null,r}return(0,l.Z)(n,[{key:"orientationInfo",get:function(){var e=y({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return g[e]||null}},{key:"clone",value:function(){return new r({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}}]),n}(f.l);(0,d.e)([(0,d.d)({type:String})],b.prototype,"contentType",void 0),(0,d.e)([(0,d.d)()],b.prototype,"exifInfo",void 0),(0,d.e)([(0,d.d)({readOnly:!0})],b.prototype,"orientationInfo",null),(0,d.e)([(0,d.d)({type:d.S})],b.prototype,"id",void 0),(0,d.e)([(0,d.d)({type:String})],b.prototype,"globalId",void 0),(0,d.e)([(0,d.d)({type:String})],b.prototype,"keywords",void 0),(0,d.e)([(0,d.d)({type:String})],b.prototype,"name",void 0),(0,d.e)([(0,d.d)({json:{read:!1}})],b.prototype,"parentGlobalId",void 0),(0,d.e)([(0,d.d)({json:{read:!1}})],b.prototype,"parentObjectId",void 0),(0,d.e)([(0,d.d)({type:d.S})],b.prototype,"size",void 0),(0,d.e)([(0,d.d)({json:{read:!1}})],b.prototype,"url",void 0);var _=b=r=(0,d.e)([(0,d.n)("esri.layers.support.AttachmentInfo")],b);function w(e,t,n){return I.apply(this,arguments)}function I(){return I=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t,n,r);case 2:return i=e.sent,e.abrupt("return",v.default.fromJSON(i));case 4:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function k(e,t,n){return M.apply(this,arguments)}function M(){return M=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var o,s,l,u,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,p.n)(t),s=(0,i.Z)({},r),l=m.b.from(n),e.next=5,(0,h.c)(o,l,l.sourceSpatialReference,s);case 5:return u=e.sent,c=u.data,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)}))),M.apply(this,arguments)}},90339:function(e,t,n){n.d(t,{r:function(){return o}});var r=n(37762),i=n(50165),a=n(76375);function o(e,t,n){if(n&&n.features&&n.hasZ){var o=(0,a.o)(n.geometryType,t,e.outSpatialReference);if(!(0,i.t)(o)){var s,l=(0,r.Z)(n.features);try{for(l.s();!(s=l.n()).done;){o(s.value.geometry)}}catch(u){l.e(u)}finally{l.f()}}}}},51613:function(e,t,n){n.d(t,{e:function(){return o},n:function(){return s},o:function(){return l}});var r=n(1413),i=n(50165),a=n(13994);function o(e,t){return t?(0,r.Z)((0,r.Z)({},t),{},{query:(0,r.Z)((0,r.Z)({},e),t.query)}):{query:e}}function s(e){return"string"==typeof e?(0,a.j)(e):(0,i.m)(e)}function l(e,t,n){var r={};for(var i in e)if("declaredClass"!==i){var a=e[i];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){r[i]=[];for(var o=0;o<a.length;o++)r[i][o]=l(a[o])}else if("object"==typeof a)if(a.toJSON){var s=a.toJSON(n&&n[i]);r[i]=t?s:JSON.stringify(s)}else r[i]=t?a:JSON.stringify(a);else r[i]=a}return r}},43895:function(e,t,n){n.d(t,{e:function(){return r},t:function(){return i}});n(73393);function r(e){return e&&"function"==typeof e.render}function i(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}},76375:function(e,t,n){n.d(t,{o:function(){return s}});var r=n(37762),i=n(50165),a=n(73428),o=n(77322);function s(e,t,n){if((0,i.t)(t)||(0,i.t)(n)||n.vcsWkid||(0,o.E)(t,n))return null;var s=(0,a.W)(t)/(0,a.W)(n);if(1===s)return null;switch(e){case"point":case"esriGeometryPoint":return function(e){return function(e,t){e&&null!=e.z&&(e.z*=t)}(e,s)};case"polyline":case"esriGeometryPolyline":return function(e){return function(e,t){if(e){var n,i=(0,r.Z)(e.paths);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=(0,r.Z)(o);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.length>2&&(l[2]*=t)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){i.e(u)}finally{i.f()}}}(e,s)};case"polygon":case"esriGeometryPolygon":return function(e){return function(e,t){if(e){var n,i=(0,r.Z)(e.rings);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=(0,r.Z)(o);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.length>2&&(l[2]*=t)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){i.e(u)}finally{i.f()}}}(e,s)};case"multipoint":case"esriGeometryMultipoint":return function(e){return function(e,t){if(e){var n,i=(0,r.Z)(e.points);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.length>2&&(a[2]*=t)}}catch(o){i.e(o)}finally{i.f()}}}(e,s)};case"extent":case"esriGeometryExtent":return function(e){return function(e,t){e&&null!=e.zmin&&null!=e.zmax&&(e.zmin*=t,e.zmax*=t)}(e,s)};default:return null}}}}]);
//# sourceMappingURL=4621.a6da43f7.chunk.js.map