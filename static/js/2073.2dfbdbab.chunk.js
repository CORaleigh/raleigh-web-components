"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[2073],{75272:function(e,t,r){r.d(t,{a:function(){return u},c:function(){return c},e:function(){return v},o:function(){return d},r:function(){return h},t:function(){return l}});var n=r(15671),i=r(43144),o=r(60136),s=r(29388),a=r(50165);function u(e){return e&&"function"==typeof e.highlight}function l(e){return e&&"function"==typeof e.maskOccludee}function c(e,t,r){return(0,a.t)(e)||e>r&&(0===t||e<t)}function d(e,t){return e>0||t>0}function h(e){var t,r,n=e.effectiveScaleRange;return{minScale:null!==(t=null===n||void 0===n?void 0:n.minScale)&&void 0!==t?t:0,maxScale:null!==(r=null===n||void 0===n?void 0:n.maxScale)&&void 0!==r?r:0}}var v=function(e){var t=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,n.Z)(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).goToOverride=null,e.view=null,e}return(0,i.Z)(r,[{key:"callGoTo",value:function(e){var t=this.view;return this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}}]),r}(e);return(0,a.e)([(0,a.d)()],t.prototype,"goToOverride",void 0),(0,a.e)([(0,a.d)()],t.prototype,"view",void 0),t=(0,a.e)([(0,a.n)("esri.widgets.support.GoTo")],t)}},32073:function(e,t,r){r.r(t);var n,i=r(4942),o=r(93433),s=r(74165),a=r(1413),u=r(15671),l=r(43144),c=r(97326),d=r(60136),h=r(29388),v=r(15861),p=r(50165),f=r(87110),g=r(69738),y=r(73627),m=r(17691),_=r(73393),w=r(61772),S=r(89031),b=r(98496),k=r(62980),M=r(40133),x=r(39853),I=r(77322),R=r(52155),T=r(72577),L=r(78330),C=r(75272),F=r(1960),E=r(73428),Z=r(31278),N=r(42),A=r(13994),O=(r(33530),r(96263),r(32335)),P=r(78664),G=r(80581),D=r(4197),B=r(82162),j=(r(92870),r(26079),r(78697),r(4483),r(79747),r(75662),r(17493),r(16377),r(9887),r(88406),r(66307),r(2760),r(42488),r(9330),r(79146),r(3029),r(42687),r(96305),r(51613),r(44932),r(66339),/https?:\/\/services.*\.arcgis\.com/i),U=/(?:\{([^}]+)\})/g,J=p.s.getLogger("esri.widgets.Search.support.layerSearchUtils");function H(e,t){var r=e.exactMatch,n=void 0!==r&&r,i=e.location,o=e.maxResults,s=e.spatialReference,a=e.source,u=e.sourceIndex,l=e.suggestResult,c=e.view,d=a.layer,h=a.filter,v=a.zoomScale,f=c&&c.scale,g=W(a,c),y=t&&t.signal;return z(d).then((function(){var e=d.popupTemplate;return e?e.getRequiredFields(d.fieldsIndex):null})).then((function(e){var t,r,m,_=d.objectIdField,w=d.returnZ,S=X(a);if(!Y(d,S))throw J.error("invalid-field: displayField is invalid."),new p.a("getResults():invalid-field","displayField is invalid.");var b=e&&e.length?e:[S],k=a.outFields||b,M=K(k);if(k.includes(_)||M||k.push(_),(null===(t=d.floorInfo)||void 0===t?void 0:t.floorField)&&k.push(d.floorInfo.floorField),!M&&!$(d,k))throw J.error("invalid-field: outField is invalid."),new p.a("getResults():invalid-field","outField is invalid.");var x=d.createQuery(),I=a.orderByFields;if(I&&(x.orderByFields=I),s){x.outSpatialReference=s;var R=1/(0,E.z)(s);R&&(x.maxAllowableOffset=R)}var T="mesh"===d.geometryType||"multipatch"===d.geometryType,L=(null===(r=d.capabilities)||void 0===r||null===(m=r.data)||void 0===m?void 0:m.supportsZ)&&!T;if(x.returnZ=L&&!1!==w,x.returnGeometry=!0,x.multipatchOption=T?"xyFootprint":null,k&&(x.outFields=k),i)x.geometry=i;else if(l.key)x.objectIds=[l.key];else{var C=a.searchFields||[S];if(!$(d,C))throw J.error("invalid-field: search field is invalid."),new p.a("getResults():invalid-field","search field is invalid.");if(Q(d)&&(x.num=o),g&&(x.geometry=g),!l.text.trim())return[];var F=a.prefix,Z=void 0===F?"":F,N=a.suffix,A=void 0===N?"":N,O=re({searchTerm:ee("".concat(Z).concat(l.text).concat(A)),layer:d,searchFields:C,filter:h,exactMatch:n,type:"search"});if(!O)return[];x.where=O}return d.queryFeatures(x,{signal:y}).then((function(e){return function(e,t,r,n,i,o,s){return e.features.map((function(e){return ie(e,t,r,n,i,o,s)}))}(e,c,a,u,S,f,v)}))}))}function V(e,t){var r=e.source,n=e.spatialReference,i=e.view,o=e.suggestTerm,s=e.maxSuggestions,a=e.sourceIndex,u=e.exactMatch,l=r.layer,c=r.filter,d=t&&t.signal,h=W(r,i);return z(l).then((function(){if(!Q(l))return[];var e=X(r),t=r.searchFields||[e],i=[];r.suggestionTemplate?r.suggestionTemplate.replace(U,(function(e,t){return i.push(t),e})):i.push(e);var v=K(i);i.includes(l.objectIdField)||v||i.push(l.objectIdField);var f=Y(l,e),g=v||$(l,i),y=$(l,t);if(!f)throw J.error("invalid-field: displayField is invalid."),new p.a("getSuggestions():invalid-field","displayField is invalid.");if(!g)throw J.error("invalid-field: outField is invalid."),new p.a("getSuggestions():invalid-field","outField is invalid.");if(!y)throw J.error("invalid-field: search field is invalid."),new p.a("getSuggestions():invalid-field","search field is invalid.");var m=l.createQuery(),_=r.orderByFields;if(_&&(m.orderByFields=_),m.outSpatialReference=n,m.returnGeometry=!1,m.num=s,m.outFields=i,h&&(m.geometry=h),!o.trim())return[];var w=r.prefix,S=void 0===w?"":w,b=r.suffix,k=void 0===b?"":b,M=re({searchTerm:ee("".concat(S).concat(o).concat(k)),layer:l,searchFields:t,filter:c,exactMatch:u,type:"suggest"});return M?(m.where=M,l.queryFeatures(m,{signal:d}).then((function(t){return function(e,t,r,n){return e.features.map((function(e){return function(e,t,r,n){var i=e.sourceLayer,o=e.attributes,s=i.objectIdField,a=o[s];return{text:ne(e,t.suggestionTemplate,n),key:a,sourceIndex:r}}(e,t,r,n)}))}(t,r,a,e)}))):[]}))}function W(e,t){var r=e.filter,n=e.withinViewEnabled,i=t&&t.extent;return r&&r.geometry||(n&&i?i:void 0)}function K(e){return e&&e.includes("*")}function z(e){return q.apply(this,arguments)}function q(){return(q=(0,v.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=4;break}return e.next=4,t.load();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){var t,r,n;return null!==(t=null===e||void 0===e||null===(r=e.capabilities)||void 0===r||null===(n=r.query)||void 0===n?void 0:n.supportsPagination)&&void 0!==t&&t}function X(e){return e.displayField||e.layer.displayField||function(e){var t,r,n,i;return null!==(t=null===e||void 0===e||null===(r=e.fieldsIndex)||void 0===r||null===(n=r.fields)||void 0===n||null===(i=n.find((function(e){return"string"===e.type})))||void 0===i?void 0:i.name)&&void 0!==t?t:""}(e.layer)}function $(e,t){return!(!e||!t)&&t.every((function(t){return Y(e,t)}))}function Y(e,t){return!!e.getField(t)}function ee(e){return e.replace(/\'/g,"''")}function te(e,t){var r=t&&t.where;return r?"(".concat(e,") AND (").concat(r,")"):e}function re(e){var t=e.searchTerm,r=e.layer,n=e.searchFields,i=e.filter,o=e.exactMatch,s=e.type,a=r.definitionExpression,u=r.url,l="";return t&&n&&n.forEach((function(e){var n=r.getField(e),a="function"==typeof r.getFieldDomain&&r.getFieldDomain(e),c=(a&&"coded-value"===a.type?function(e,t,r){var n=null,i=e.codedValues;return i&&i.some((function(e){var i=e.name,o=r?i:i.toLowerCase();return(r?t:t.toLowerCase())===o&&(n=e.code.toString(),!0)})),n}(a,t,o):null)||t||null;if(null!==c){var d=function(e){var t=e.currentTerm,r=e.field,n=e.filter,i=e.exactMatch,o=e.url,s=e.type,a=r.type,u=r.name;if("string"===a||"date"===a||"global-id"===a){var l=j.test(o),c=l&&function(e){for(var t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!0;return!1}(t)?"N":"";if(i&&"search"===s)return te("".concat(u," = ").concat(c,"'").concat(t,"'"),n);var d=l?u:"UPPER(".concat(u,")"),h=l?t:t.toUpperCase();return te("".concat(d," LIKE ").concat(c).concat(i?"'".concat(h,"%'"):"'%".concat(h,"%'")),n)}if("oid"===a||"small-integer"===a||"integer"===a||"single"===a||"double"===a){var v=Number(t);return isNaN(v)?null:te("".concat(u," = ").concat(v),n)}return te("".concat(u," = ").concat(t),n)}({currentTerm:c,field:n,filter:i,exactMatch:o,url:u,type:s});d&&(l+=function(e,t){return e?" OR (".concat(t,")"):"(".concat(t,")")}(l,d))}})),a?"(".concat(a,") AND (").concat(l,")"):l}function ne(e,t,r){var n=e.sourceLayer,i=e.attributes,o="function"==typeof n.getFieldDomain&&n.getFieldDomain(r);if(t)return(0,f.s)(t,i);if(r&&i){var s=n.getField(r),a=function(e,t){return e[Object.keys(e).find((function(e){return e.toLowerCase()===t.toLowerCase()}))]}(i,r);return null==a?"":o&&"coded-value"===o.type?function(e,t){var r=null,n=e.codedValues;return n&&n.length&&n.some((function(e){return e.code===t&&(r=e.name,!0)})),r}(o,a):"date"===(null===s||void 0===s?void 0:s.type)?(0,N.L)(new Date(a)):"number"==typeof a?a.toString():"string"!=typeof a?"":a.trim()}return""}function ie(e,t,r,n,i,o,s){var a=e.clone(),u=e.sourceLayer,l=u&&u.objectIdField,c=l&&e.attributes[l],d=ne(e,r.searchTemplate,i),h=(0,F.a)(a.geometry,t,o),v="number"==typeof s?(0,F.p)((0,p.m)(h),t,s):h,f=e.clone();return(0,p.r)(v)&&(f.geometry=Z.v.fromExtent(v)),{extent:v,target:f,feature:a,key:c,name:d,sourceIndex:n}}var oe=n=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).displayField=null,n.exactMatch=null,n.orderByFields=null,n.searchFields=null,n.searchTemplate=null,n.suggestionTemplate=null,n.getResults=function(e,t){return H((0,a.Z)({source:(0,c.Z)(n)},e),t)},n.getSuggestions=function(e,t){return V((0,a.Z)({source:(0,c.Z)(n)},e),t)},n}return(0,l.Z)(r,[{key:"layer",set:function(e){this._set("layer",e),e&&e.load().catch((function(){}))}},{key:"name",get:function(){return this._getLayerTitle()||""},set:function(e){void 0!==e?this._override("name",e):this._clearOverride("name")}},{key:"clone",value:function(){return new n({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?(0,p.m)(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?(0,p.m)(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}},{key:"_getFirstStringField",value:function(){var e,t;return null!==(e=null===(t=this.layer.fieldsIndex.fields.find((function(e){return"string"===e.type})))||void 0===t?void 0:t.name)&&void 0!==e?e:""}},{key:"_getDisplayField",value:function(){return this.displayField||this.layer.displayField||this._getFirstStringField()}},{key:"_getSearchFieldsString",value:function(){var e=this.layer,t=this.searchFields;return e.loaded?": ".concat((t||[this._getDisplayField()]).map((function(t){var r=e.getField(t);return r&&r.alias||t})).join(", ")):""}},{key:"_getLayerTitle",value:function(){var e=this.layer;if(e){var t=e.title;return t?"".concat(t).concat(this._getSearchFieldsString()):void 0}}}]),r}(F.i);(0,p.e)([(0,p.d)({json:{read:{source:"field.name"},write:{target:"field.name"}}})],oe.prototype,"displayField",void 0),(0,p.e)([(0,p.d)({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],oe.prototype,"exactMatch",void 0),(0,p.e)([(0,p.d)({value:null})],oe.prototype,"layer",null),(0,p.e)([(0,p.d)()],oe.prototype,"name",null),(0,p.e)([(0,p.d)({type:[String],json:{write:!0}})],oe.prototype,"orderByFields",void 0),(0,p.e)([(0,p.d)()],oe.prototype,"searchFields",void 0),(0,p.e)([(0,p.d)()],oe.prototype,"searchTemplate",void 0),(0,p.e)([(0,p.d)()],oe.prototype,"suggestionTemplate",void 0);var se=oe=n=(0,p.e)([(0,p.n)("esri.widgets.Search.LayerSearchSource")],oe);new A.s({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"}),new A.s({109006:"centimeters",9102:"decimal-degrees",109005:"decimeters",9002:"feet",109009:"inches",9036:"kilometers",9001:"meters",9035:"miles",109007:"millimeters",109012:"nautical-miles",9096:"yards"});var ae=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).deviationUnit=null,n.geometries=null,n.maxDeviation=null,n}return(0,l.Z)(r)}(O.l);(0,p.e)([(0,p.d)({type:String,json:{write:!0}})],ae.prototype,"deviationUnit",void 0),(0,p.e)([(0,p.d)({json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.d)(e)})):null}},write:{writer:function(e,t){t.geometries=e.map((function(e){return e.toJSON()}))}}}})],ae.prototype,"geometries",void 0),(0,p.e)([(0,p.d)({type:Number,json:{write:!0}})],ae.prototype,"maxDeviation",void 0),(ae=(0,p.e)([(0,p.n)("esri.rest.support.GeneralizeParameters")],ae)).from=(0,p.b)(ae),new A.s({preserveShape:"preserve-shape"});var ue=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).calculationType=null,n.geodesic=null,n.lengthUnit=null,n.polylines=null,n}return(0,l.Z)(r)}(O.l);(0,p.e)([(0,p.d)({type:String,json:{write:!0}})],ue.prototype,"calculationType",void 0),(0,p.e)([(0,p.d)({type:Boolean,json:{write:!0}})],ue.prototype,"geodesic",void 0),(0,p.e)([(0,p.d)({json:{write:!0}})],ue.prototype,"lengthUnit",void 0),(0,p.e)([(0,p.d)({type:[Z.m],json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.d)(e)})):null}},write:{writer:function(e,t){t.polylines=e.map((function(e){return e.toJSON()}))}}}})],ue.prototype,"polylines",void 0),(ue=(0,p.e)([(0,p.n)("esri.rest.support.LengthsParameters")],ue)).from=(0,p.b)(ue),new A.s({esriGeometryOffsetBevelled:"bevelled",esriGeometryOffsetMitered:"mitered",esriGeometryOffsetRounded:"rounded"}),new A.s({9001:"meters",9002:"feet",9036:"kilometers",9093:"miles",109012:"nautical-miles",109001:"yards"});var le=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).bevelRatio=null,n.geometries=null,n.offsetDistance=null,n.offsetHow=null,n.offsetUnit=null,n}return(0,l.Z)(r)}(O.l);(0,p.e)([(0,p.d)({type:Number,json:{write:!0}})],le.prototype,"bevelRatio",void 0),(0,p.e)([(0,p.d)({json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.d)(e)})):null}},write:{writer:function(e,t){t.geometries=e.map((function(e){return e.toJSON()}))}}}})],le.prototype,"geometries",void 0),(0,p.e)([(0,p.d)({type:Number,json:{write:!0}})],le.prototype,"offsetDistance",void 0),(0,p.e)([(0,p.d)({type:String,json:{write:!0}})],le.prototype,"offsetHow",void 0),(0,p.e)([(0,p.d)({type:String,json:{write:!0}})],le.prototype,"offsetUnit",void 0),(le=(0,p.e)([(0,p.n)("esri.rest.support.OffsetParameters")],le)).from=(0,p.b)(le),new A.s({esriGeometryRelationCross:"cross",esriGeometryRelationDisjoint:"disjoint",esriGeometryRelationIn:"in",esriGeometryRelationInteriorIntersection:"interior-intersection",esriGeometryRelationIntersection:"intersection",esriGeometryRelationLineCoincidence:"line-coincidence",esriGeometryRelationLineTouch:"line-touch",esriGeometryRelationOverlap:"overlap",esriGeometryRelationPointTouch:"point-touch",esriGeometryRelationTouch:"touch",esriGeometryRelationWithin:"within",esriGeometryRelationRelation:"relation"});var ce=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).geometries1=null,n.geometries2=null,n.relation=null,n.relationParameter=null,n}return(0,l.Z)(r)}(O.l);(0,p.e)([(0,p.d)({json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.d)(e)})):null}},write:{writer:function(e,t){t.geometries1=e.map((function(e){return e.toJSON()}))}}}})],ce.prototype,"geometries1",void 0),(0,p.e)([(0,p.d)({json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.d)(e)})):null}},write:{writer:function(e,t){t.geometries2=e.map((function(e){return e.toJSON()}))}}}})],ce.prototype,"geometries2",void 0),(0,p.e)([(0,p.d)({type:String,json:{write:!0}})],ce.prototype,"relation",void 0),(0,p.e)([(0,p.d)({type:String,json:{write:!0}})],ce.prototype,"relationParameter",void 0),(ce=(0,p.e)([(0,p.n)("esri.rest.support.RelationParameters")],ce)).from=(0,p.b)(ce),new A.s({0:"default-curve-extension",1:"relocate-ends",2:"keep-end-attributes",4:"no-end-attributes",8:"no-extend-at-from",16:"no-extend-at-to"});var de=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).extendHow="default-curve-extension",n.polylines=null,n.trimExtendTo=null,n}return(0,l.Z)(r)}(O.l);(0,p.e)([(0,p.d)({type:String,json:{write:!0}})],de.prototype,"extendHow",void 0),(0,p.e)([(0,p.d)({type:[Z.m],json:{read:{reader:function(e){return e?e.map((function(e){return(0,P.d)(e)})):null}},write:{writer:function(e,t){t.polylines=e.map((function(e){return e.toJSON()}))}}}})],de.prototype,"polylines",void 0),(0,p.e)([(0,p.d)({json:{read:{reader:function(e){return e?(0,P.d)(e):null}},write:{writer:function(e,t){t.trimExtendTo=e.toJSON()}}}})],de.prototype,"trimExtendTo",void 0),(de=(0,p.e)([(0,p.n)("esri.rest.support.TrimExtendParameters")],de)).from=(0,p.b)(de);var he=p.s.getLogger("esri.widgets.support.geolocationUtils"),ve={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function pe(){return function(){var e=(0,p.c)("esri-geolocation");return e||he.warn("geolocation-unsupported","Geolocation unsupported."),e}()&&function(){var e=window.isSecureContext;return e||he.warn("insecure-context","Geolocation requires a secure origin."),e}()}function fe(e,t){var r=e.position,n=e.view;return function(e,t,r){if(!t)return Promise.resolve(e);var n=t.spatialReference;return n.isWGS84?Promise.resolve(e):n.isWebMercator?Promise.resolve((0,I.R)(e)):function(e){if(p.f.geometryServiceUrl)return Promise.resolve(p.f.geometryServiceUrl);var t=L.B.getDefault();return t.load(e).catch((function(){})).then((function(){return t.get("helperServices.geometry.url")}))}(r).then((function(t){if(!t)throw new p.a("geometry-service:missing-url","Geometry service URL is missing");var i=new G.a({geometries:[e],outSpatialReference:n});return(0,G.n)(t,i,r).then((function(e){return e[0]}))}))}(function(e){var t=e&&e.coords;return t?new I.j({longitude:t.longitude,latitude:t.latitude,z:t.altitude||null,spatialReference:{wkid:4326}}):null}(function(e){var t=e&&e.coords||{},r={accuracy:t.accuracy,altitude:t.altitude,altitudeAccuracy:t.altitudeAccuracy,heading:t.heading,latitude:t.latitude,longitude:t.longitude,speed:t.speed};return e?{coords:r,timestamp:e.timestamp}:e}(r)),n,t)}function ge(e,t){return e.hasOwnProperty(t)&&null!=e[t]&&""!==e[t]}var ye="esri.widgets.Search.SearchViewModel",me=p.s.getLogger(ye),_e="highlight",we=M.j.ofType({key:function(e){return e.layer?"layer":"locator"},base:F.i,typeMap:{layer:se,locator:F.c}}),Se=I.k.WGS84,be=/<(?:.|\s)*?>/g,ke=-1,Me=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e))._handles=new g.u,n._gotoController=null,n._searching=null,n._createdFeatureLayers=[],n.autoNavigate=!0,n.autoSelect=!0,n.defaultPopupTemplate=null,n.defaultSources=new we,n.defaultSymbols={point:new k.n({url:(0,w.a)("esri/images/search/search-symbol-32.png"),size:24,width:24,height:24}),polyline:new k.m({color:[130,130,130,1],width:2}),polygon:new k.S({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},n.includeDefaultSources=!0,n.maxInputLength=128,n.maxResults=6,n.maxSuggestions=6,n.messages=null,n.minSuggestCharacters=3,n.popupEnabled=!0,n.popupTemplate=null,n.portal=L.B.getDefault(),n.resultCount=null,n.resultGraphicEnabled=!0,n.resultGraphic=null,n.results=null,n.selectedSuggestion=null,n.searchAllEnabled=!0,n.selectedResult=null,n.sources=new we,n.suggestionDelay=350,n.suggestionCount=null,n.suggestions=null,n.suggestionsEnabled=!0,n.view=null,n}return(0,l.Z)(r,[{key:"initialize",value:function(){var e=this,t=function(){var t=(0,v.Z)((0,s.Z)().mark((function t(){var r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,T.h)("esri/widgets/Search/t9n/Search");case 2:r=t.sent,e.messages=r,e.defaultPopupTemplate=new b.B({title:r.searchResult,content:"{Match_addr}"});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t(),this._handles.add([(0,y.l)((function(){return[e.includeDefaultSources,e.view,e.portal]}),(function(){return e._update()}),y.h),(0,R.s)(t)])}},{key:"destroy",value:function(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics(),this._handles.destroy(),this._handles=null}},{key:"activeSource",get:function(){return this.allSources.getItemAt(this.activeSourceIndex)||null}},{key:"activeSourceIndex",get:function(){return 1!==this.allSources.length&&this.searchAllEnabled?ke:0},set:function(e){void 0!==e?this._override("activeSourceIndex",e):this._clearOverride("activeSourceIndex")}},{key:"allPlaceholder",get:function(){var e;return null===(e=this.messages)||void 0===e?void 0:e.allPlaceholder},set:function(e){e?this._override("allPlaceholder",e):this._clearOverride("allPlaceholder")}},{key:"allSources",get:function(){var e=this.sources,t=this.defaultSources,r=this.includeDefaultSources,n="function"==typeof r?r.call(null,{sources:e,defaultSources:t}):r?t.concat(e):e,i=this._get("allSources")||new we;return i.removeAll(),i.addMany(n.filter(Boolean)),i}},{key:"defaultSymbol",get:function(){return(0,x.r)(me,"defaultSymbol",{replacement:"defaultSymbols",version:"4.22"}),this._get("defaultSymbol")},set:function(e){(0,x.r)(me,"defaultSymbol",{replacement:"defaultSymbols",version:"4.22"}),this._set("defaultSymbol",e)}},{key:"locationEnabled",get:function(){return this._get("locationEnabled")||pe()},set:function(e){if(void 0!==e){var t=pe();if(e&&!t){var r=new p.a("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});me.error(r)}this._override("locationEnabled",e&&t)}else this._clearOverride("locationEnabled")}},{key:"placeholder",get:function(){var e=this.allSources,t=this.activeSourceIndex,r=this.allPlaceholder;if(t===ke)return r;var n=e.getItemAt(t);return n?n.placeholder:""}},{key:"searchTerm",get:function(){return this._get("searchTerm")||""},set:function(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),""===e&&this._clear()}},{key:"state",get:function(){return this._searching?"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}},{key:"updating",get:function(){return null!=this._updatingPromise}},{key:"clear",value:function(){this.searchTerm=""}},{key:"clearGraphics",value:function(){this._removeHighlight(),this._closePopup(),this.view&&this.view.graphics.remove(this.resultGraphic),this._set("resultGraphic",null)}},{key:"search",value:function(e,t){var r=this;this.emit("search-start"),this.clearGraphics();var n=this._createSuggestionForSearch(e),i=this.when().then((function(){return r._getResultsFromSources(n,t).then((function(e){var i;if(null!==(i=(0,p.g)(null===t||void 0===t?void 0:t.signal))&&void 0!==i&&i.aborted)return null;var o={activeSourceIndex:r.activeSourceIndex,searchTerm:n.text,numResults:0,numErrors:0,errors:[],results:[]};r._formatResponse(o,e,n);var s=r._getFirstResult(o.results),a=(n.location&&s?s.name:n.text).replace(be,"");return r._set("searchTerm",a),(n.key&&"number"==typeof n.sourceIndex||n.location)&&r._set("selectedSuggestion",n),r._set("results",o.results),r._set("resultCount",o.results.reduce((function(e,t){return e+t.results.length}),0)),r.emit("search-complete",o),r._selectFirstResult(s).then((function(){return o}))}))})).then((function(e){return r._clearSearching(),e}),(function(e){throw r._clearSearching(),e}));return this._searching=i,i}},{key:"searchNearby",value:function(e){var t=this;if(!this.locationEnabled){var r=new p.a("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});return me.error(r),Promise.reject(r)}var n=function(e){return e||(e=ve),new Promise((function(t,r){setTimeout((function(){return r(new p.a("geolocation:timeout","getting the current geolocation position timed out"))}),15e3),navigator.geolocation.getCurrentPosition(t,r,e)}))}().then((function(r){return fe({position:r,view:t.view},e)})).then((function(r){return t.search(r,e)}));return this._searching=n,n.catch((function(){})).then((function(){return t._clearSearching()})),n}},{key:"select",value:function(e){var t=this;if(this.clearGraphics(),!e){var r=new p.a("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});return me.error(r),Promise.reject(r)}var n=this.view,i=ge(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),o=this.allSources.getItemAt(i);if(!o){var s=new p.a("select:missing-source","Cannot select without a source.",{source:o});return me.error(s),Promise.reject(s)}var a=o instanceof se?this._getLayerSourcePopupTemplate(o):o.popupTemplate,u=o.resultSymbol||this._getDefaultSymbol(e),l=ge(o,"resultGraphicEnabled")?o.resultGraphicEnabled:this.resultGraphicEnabled,c=ge(o,"autoNavigate")?o.autoNavigate:this.autoNavigate,d=ge(o,"popupEnabled")?o.popupEnabled:this.popupEnabled,h=d?a||this.popupTemplate||this.defaultPopupTemplate:null,v=e.feature;if(!v){var f=new p.a("select:missing-feature","Cannot select without a feature.",{feature:v});return me.error(f),Promise.reject(f)}var g=v.attributes,y=v.geometry,m=v.layer,_=v.sourceLayer,w=(0,F.m)(y),b={layerViewQuery:this._getLayerView(v),elevationQuery:n&&(0,p.r)(w)?(0,F.s)(w,n).catch((function(){return w})):Promise.resolve(w)};return(0,p.E)(b).then((function(r){var s=r.layerViewQuery.value,a=r.elevationQuery.value;u instanceof k.a&&(u.text=e.name);var f=n&&c?e.target||e.extent:null;return((0,p.r)(f)?t._goToSearchResult(f):Promise.resolve()).then((function(){var r,c=s?v:new S.g({geometry:y,symbol:u,attributes:g,layer:m,sourceLayer:_,popupTemplate:h}),p=d&&(null===(r=t.view)||void 0===r?void 0:r.popup),f=p&&c.getEffectivePopupTemplate(p.defaultPopupTemplateEnabled);return f&&n.popup.open({features:[c],location:a}),s&&(0,C.a)(s)&&!f&&t._highlightFeature({graphic:c,layerView:s}),!s&&l&&n&&n.graphics.push(c),t._setResultFloor(e),t._set("selectedResult",e),t._set("resultGraphic",c),t.emit("select-result",{result:e,source:o,sourceIndex:i}),e}))}))}},{key:"suggest",value:function(e,t,r){var n=this,i=e||this.searchTerm;return this.emit("suggest-start",{searchTerm:i}),this._suggestTimer(t,r).then((function(){return n._suggestImmediate(i,r).then((function(e){return n._set("suggestions",e.results),n._set("suggestionCount",e.results.reduce((function(e,t){return e+t.results.length}),0)),n.emit("suggest-complete",e),e}))}))}},{key:"when",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(){var t=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.j)((function(){return!t.updating}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_update",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(){var t,r,n,i=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.portal,r=this.view,!this.includeDefaultSources){e.next=9;break}if(n=this._updatingPromise=(0,p.E)([null===t||void 0===t?void 0:t.load(),null===r||void 0===r?void 0:r.when()]),!this.destroyed){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,n;case 7:if(n===this._updatingPromise){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,(0,y.j)((function(){return i.messages}));case 11:this.destroyed||this._updateDefaultSources(),this._updatingPromise=null;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_clearSearching",value:function(){this._searching=null}},{key:"_convertHelperServices",value:function(){var e,t,r=this,n=null===(e=this.portal)||void 0===e||null===(t=e.helperServices)||void 0===t?void 0:t.geocode;return n?n.map((function(e){if(!1!==e.placefinding){var t=p.f.apiKey&&(0,F.S)(e.url)?{url:F.w}:null,n=F.c.fromJSON((0,a.Z)((0,a.Z)({},e),t)),i=n.url;if((0,F.S)(i)||(0,F.v)(i)||(0,F.x)(i)){var o=n.outFields||["Addr_type","Match_addr","StAddr","City"],s=n.placeholder||r.messages.placeholder,u="number"==typeof n.defaultZoomScale?n.defaultZoomScale:2500;n.set({singleLineFieldName:"SingleLine",outFields:o,placeholder:s,defaultZoomScale:u})}return n.singleLineFieldName?n:void 0}})).filter(Boolean):[]}},{key:"_destroyFeatureLayers",value:function(){this._createdFeatureLayers.forEach((function(e){return null===e||void 0===e?void 0:e.destroy()})),this._createdFeatureLayers=[]}},{key:"_getLayerSources",value:function(e,t){var r,n=this,i=null===(r=this.view)||void 0===r?void 0:r.map;return e.map((function(e){var r=i.findLayerById(e.id);if(r){var o=n._getLayerJSON(e),s=se.fromJSON(o);return s.placeholder=t,n._getLayer(r,o).then((function(e){s.layer=e})),s}})).filter(Boolean).toArray()}},{key:"_getTableSources",value:function(e,t){var r,n=this,i=null===(r=this.view)||void 0===r?void 0:r.map;return e.map((function(e){var r=i.findTableById(e.id);if(r){var o=n._getLayerJSON(e),s=se.fromJSON(o);return s.placeholder=t,n._getLayer(r,o).then((function(e){s.layer=e})),s}})).filter(Boolean).toArray()}},{key:"_convertApplicationProperties",value:function(){var e,t,r,n=null===(e=this.view)||void 0===e?void 0:e.map,i=null===n||void 0===n||null===(t=n.applicationProperties)||void 0===t||null===(r=t.viewing)||void 0===r?void 0:r.search;if(!i)return[];var s=i.enabled,a=i.hintText,u=i.layers,l=i.tables;return s?[].concat((0,o.Z)(this._getLayerSources(u,a)),(0,o.Z)(this._getTableSources(l,a))):[]}},{key:"_getSubLayer",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(t,r){var n,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:if(t.allSublayers){e.next=4;break}throw new Error;case 4:if(n=t.allSublayers.find((function(e){return e.id===r.subLayer}))){e.next=7;break}throw new Error;case 7:return e.next=9,n.createFeatureLayer();case 9:return i=e.sent,e.abrupt("return",(this._createdFeatureLayers.push(i),i));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getBuildingSubLayer",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(t,r){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:if("building-component"===(null===(n=t.allSublayers.find((function(e){return e.id===r.subLayer})))||void 0===n?void 0:n.type)){e.next=5;break}throw new Error;case 5:return e.next=7,n.load();case 7:if(null!=n.associatedLayer){e.next=9;break}throw new Error;case 9:return e.next=11,n.associatedLayer.load();case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getLayer",value:function(e,t){return"feature"===e.type||"scene"===e.type||"csv"===e.type||"geojson"===e.type||"ogc-feature"===e.type?Promise.resolve(e):"map-image"===e.type?this._getSubLayer(e,t).catch((function(){var t=new p.a("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return me.error(t),null})):"building-scene"===e.type?this._getBuildingSubLayer(e,t):Promise.resolve(null)}},{key:"_getLayerJSON",value:function(e){return"function"==typeof e.toJSON?e.toJSON():e}},{key:"_updateDefaultSources",value:function(){var e=this.defaultSources,t=this.includeDefaultSources;this._destroyFeatureLayers(),e.removeAll(),t&&e.addMany([].concat((0,o.Z)(this._convertApplicationProperties()),(0,o.Z)(this._convertHelperServices())))}},{key:"_abortGoTo",value:function(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}},{key:"_clear",value:function(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}},{key:"_closePopup",value:function(){var e,t=null===(e=this.view)||void 0===e?void 0:e.popup,r=this.resultGraphic;if(t&&r){var n=t.selectedFeature;n&&n===r&&t.close()}}},{key:"_suggestTimer",value:function(e,t){var r=null!=e?e:this.suggestionDelay;return(0,p.L)(r,null,t&&t.signal)}},{key:"_createLocationForSearch",value:function(e){return e instanceof S.g?(0,F.m)(e.geometry):e instanceof I.j?e:Array.isArray(e)&&2===e.length?new I.j({longitude:e[0],latitude:e[1]}):null}},{key:"_createSuggestionForSearch",value:function(e){if(e&&ge(e,"key")&&ge(e,"text")&&ge(e,"sourceIndex"))return e;var t=this._createLocationForSearch(e),r="string"==typeof e?e:this.searchTerm,n=this.selectedSuggestion,i=this.selectedResult,o=!e&&n&&i,s=o&&n.key===i.key&&n.sourceIndex===i.sourceIndex,a=o&&n.location;return s||a?n:{location:(0,p.g)(t),text:t?"":r,sourceIndex:null,key:null}}},{key:"_getFirstResult",value:function(e){var t=null;return e&&e.some((function(e){var r=e.results[0],n=!!r;return n&&(t=r),n})),t}},{key:"_selectFirstResult",value:function(e){return this.autoSelect&&e?this.select(e):Promise.resolve(null)}},{key:"_suggestImmediate",value:function(e,t){var r=this;return this.when().then((function(){return r._getSuggestionsFromSources(e,t)})).then((function(n){var i;if(null!==(i=(0,p.g)(null===t||void 0===t?void 0:t.signal))&&void 0!==i&&i.aborted)return null;var o={activeSourceIndex:r.activeSourceIndex,searchTerm:e,numResults:0,numErrors:0,errors:[],results:[]};return r._formatResponse(o,n),o}))}},{key:"_formatSourceResponse",value:function(e,t,r){var n=t&&t.value||[],i=t&&t.error,o=this.allSources.getItemAt(r);if(i){var s={sourceIndex:r,source:o,error:i};e.errors.push(s),me.error(i),e.numErrors++}else{var a={sourceIndex:r,source:o,results:n};e.results.push(a),e.numResults+=n.length}}},{key:"_formatResponse",value:function(e,t,r){var n=this;if(t)if(e.activeSourceIndex===ke){var i=r&&ge(r,"sourceIndex")&&-1!==r.sourceIndex?r.sourceIndex:void 0;t.forEach((function(t,r){var o=void 0!==i?i:r;n._formatSourceResponse(e,t,o)}))}else this._formatSourceResponse(e,t[0],e.activeSourceIndex)}},{key:"_getResultsFromSources",value:function(e,t){var r=this,n=this.allSources,i=!e.location&&ge(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,o=[];if(!n.length){var s=new p.a("search:no-sources-defined","At least one source is required.",{allSources:n});return me.error(s),Promise.reject(s)}return i===ke?n.forEach((function(n,i){o.push(r._getResultsFromSource(e,i,t))})):o.push(this._getResultsFromSource(e,i,t)),(0,p.E)(o)}},{key:"_getSuggestionsFromSources",value:function(e,t){var r=this,n=this.allSources,i=this.activeSourceIndex,o=[];if(!n.length){var s=new p.a("suggest:no-sources-defined","At least one source is required.",{allSources:n});return me.error(s),Promise.reject(s)}return i===ke?n.forEach((function(n,i){o.push(r._getSuggestionsFromSource(e,i,t))})):o.push(this._getSuggestionsFromSource(e,i,t)),(0,p.E)(o)}},{key:"_getResultsFromSource",value:function(e,t,r){var n,i=this.allSources.getItemAt(t),o=e.location,s=void 0===o?null:o,a=(null===(n=this.view)||void 0===n?void 0:n.spatialReference)||Se,u=ge(i,"maxResults")?i.maxResults:this.maxResults,l=!!(i instanceof se&&ge(i,"exactMatch"))&&i.exactMatch,c=this.view;return i.getResults({view:c,sourceIndex:t,location:s,suggestResult:e,spatialReference:a,exactMatch:l,maxResults:u},r)}},{key:"_getSuggestionsFromSource",value:function(e,t,r){var n=this.allSources.getItemAt(t),i=ge(n,"suggestionsEnabled")?n.suggestionsEnabled:this.suggestionsEnabled,o=e.length,s=ge(n,"minSuggestCharacters")?n.minSuggestCharacters:this.minSuggestCharacters;if(i&&e.trim()&&o>=s){var a,u=(null===(a=this.view)||void 0===a?void 0:a.spatialReference)||Se,l=ge(n,"maxSuggestions")?n.maxSuggestions:this.maxSuggestions,c=this.view,d=!!(n instanceof se&&ge(n,"exactMatch"))&&n.exactMatch;return n.getSuggestions({view:c,sourceIndex:t,suggestTerm:e,spatialReference:u,maxSuggestions:l,exactMatch:d},r)}return Promise.resolve(null)}},{key:"_getLayerSourcePopupTemplate",value:function(e){var t=e.layer;if(t)return ge(e,"popupTemplate")?e.popupTemplate:t.popupTemplate}},{key:"_getSourceIndexOfResult",value:function(e){var t=this.results,r=null;return t.some((function(t){return t.results.some((function(n){return n===e&&(r=t.sourceIndex,!0)}))})),r}},{key:"_goToSearchResult",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(t){var r,n,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!!t,this._abortGoTo(),n=new AbortController,this._gotoController=n,i={target:{target:t},options:{animate:r,signal:n.signal}},e.next=7,this.callGoTo(i);case 7:this._gotoController=null;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getDefaultSymbol",value:function(e){var t,r=this.defaultSymbols,n=null===(t=e.feature)||void 0===t?void 0:t.geometry;if((0,p.t)(n))return null;var i=this._get("defaultSymbol");if(i&&("point"===n.type||"multipoint"===n.type))return i;switch(n.type){case"point":case"multipoint":return r.point;case"polyline":return r.polyline;case"extent":case"polygon":return r.polygon;default:return null}}},{key:"_removeHighlight",value:function(){this._handles.remove(_e)}},{key:"_getLayerView",value:function(){var e=(0,v.Z)((0,s.Z)().mark((function e(t){var r,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.view,t&&r&&"building-component"!==t.layer.type&&"subtype-sublayer"!==t.layer.type){e.next=3;break}return e.abrupt("return",null);case 3:return n=t.layer,e.next=6,r.when();case 6:return e.abrupt("return",r.whenLayerView(n));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_highlightFeature",value:function(e){var t=e.graphic,r=e.layerView,n=t.attributes,i=t.layer.objectIdField,o=n&&n[i],s=r.highlight(o||t);this._handles.add(s,_e)}},{key:"_setResultFloor",value:function(e){var t,r,n,i=this.view,o=null===(t=e.feature)||void 0===t?void 0:t.attributes,s=null===(r=e.feature)||void 0===r?void 0:r.sourceLayer;if(s&&"floorInfo"in s&&null!==s&&void 0!==s&&null!==(n=s.floorInfo)&&void 0!==n&&n.floorField&&o){var a=o[s.floorInfo.floorField];i.emit("select-result-floor",a)}}}]),r}((0,C.e)(M.n.EventedMixin(p.y)));Me.ALL_INDEX=ke,(0,p.e)([(0,p.d)()],Me.prototype,"_searching",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"_updatingPromise",void 0),(0,p.e)([(0,p.d)({readOnly:!0,value:null})],Me.prototype,"activeSource",null),(0,p.e)([(0,p.d)()],Me.prototype,"activeSourceIndex",null),(0,p.e)([(0,p.d)()],Me.prototype,"allPlaceholder",null),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"allSources",null),(0,p.e)([(0,p.d)()],Me.prototype,"autoNavigate",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"autoSelect",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"defaultPopupTemplate",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"defaultSources",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"defaultSymbol",null),(0,p.e)([(0,p.d)()],Me.prototype,"defaultSymbols",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"includeDefaultSources",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"locationEnabled",null),(0,p.e)([(0,p.d)()],Me.prototype,"maxInputLength",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"maxResults",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"maxSuggestions",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"messages",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"minSuggestCharacters",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"placeholder",null),(0,p.e)([(0,p.d)()],Me.prototype,"popupEnabled",void 0),(0,p.e)([(0,p.d)({type:b.B})],Me.prototype,"popupTemplate",void 0),(0,p.e)([(0,p.d)({type:L.B})],Me.prototype,"portal",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"resultCount",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"resultGraphicEnabled",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"resultGraphic",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"results",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"selectedSuggestion",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"searchAllEnabled",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"selectedResult",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"searchTerm",null),(0,p.e)([(0,p.d)({type:we})],Me.prototype,"sources",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"state",null),(0,p.e)([(0,p.d)()],Me.prototype,"suggestionDelay",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"suggestionCount",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"suggestions",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"suggestionsEnabled",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],Me.prototype,"updating",null),(0,p.e)([(0,p.d)()],Me.prototype,"view",void 0),(0,p.e)([(0,p.d)()],Me.prototype,"clear",null);var xe=Me=(0,p.e)([(0,p.n)(ye)],Me),Ie="esri-search-result-renderer esri-widget",Re="esri-widget__anchor",Te="esri-search-result-renderer__more-results--show-more-results",Le="esri-search-result-renderer__more-results",Ce="esri-search-result-renderer__more-results-list",Fe="esri-search-result-renderer__more-results-item",Ee="esri-search-result-renderer__more-results-list-header",Ze=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e,n){var i;return(0,u.Z)(this,r),(i=t.call(this,e,n)).messages=null,i.showMoreResultsOpen=!1,i.viewModel=null,i}return(0,l.Z)(r,[{key:"render",value:function(){var e=(0,i.Z)({},Te,this.showMoreResultsOpen);return(0,_.n)("div",{class:Ie},(0,_.n)("div",{key:"esri-search-renderer__container",class:this.classes(Le,e)},this.renderSearchResultName(),this.renderMoreResults()))}},{key:"renderMoreResults",value:function(){return(0,_.n)("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())}},{key:"renderSearchResultName",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.selectedResult,r=t&&t.name||"";return(0,_.n)("div",{key:"esri-search-renderer__result-name",class:Fe},r)}},{key:"renderMoreResultsLists",value:function(){var e,t=this,r=null===(e=this.viewModel)||void 0===e?void 0:e.results;if(this.viewModel.resultCount<2)return null;var n=r.map((function(e){return t.renderMoreResultsList(e)}));return(0,_.n)("div",{key:"esri-search-renderer__more-results-container",class:Ce},n)}},{key:"renderMoreResultsButton",value:function(){var e=this.messages;return this.viewModel.resultCount<2?null:(0,_.n)("div",{key:"esri-search-renderer__more-results-button",class:Fe},(0,_.n)("a",{class:Re,href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults))}},{key:"renderMoreResultsHeader",value:function(e,t){return(0,_.n)("div",{key:"esri-search-result-renderer__header-".concat(t),class:Ee},e)}},{key:"renderMoreResultsList",value:function(e){var t,r,n=this,i=e.results,o=i.length,s=!!o,a=null===(t=this.viewModel)||void 0===t?void 0:t.selectedResult,u=1===o&&i[0]===a,l=this._getSourceName(e.source,e.sourceIndex),c=(null===(r=this.viewModel)||void 0===r?void 0:r.results.length)>1&&!u?this.renderMoreResultsHeader(l,e.sourceIndex):null,d=s&&i.map((function(e,t){return n.renderMoreResultsListItem(e,t)})),h=s&&!u?(0,_.n)("ul",{key:"esri-search-result-renderer__list-".concat(e.sourceIndex)},d):null;return s?(0,_.n)("div",{key:"esri-search-result-renderer__results-".concat(e.sourceIndex)},c,h):null}},{key:"renderMoreResultsListItem",value:function(e,t){return e!==this.get("viewModel.selectedResult")?(0,_.n)("li",{key:"esri-search-result-renderer__list-item-".concat(t)},(0,_.n)("a",{class:Re,href:"#",tabindex:"0",bind:this,"data-result":e,onclick:this._selectResultClick,onkeydown:this._selectResultClick},e.name)):null}},{key:"_showMoreResultsClick",value:function(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;var t=this.get("viewModel.view.popup");t&&t.reposition()}},{key:"_selectResultClick",value:function(e){e.preventDefault();var t=e.currentTarget["data-result"];this.viewModel&&this.viewModel.select(t)}},{key:"_getSourceName",value:function(e,t){return t===xe.ALL_INDEX?this.messages.all:e.name}}]),r}(_.O);(0,p.e)([(0,p.d)(),(0,_.e)("esri/widgets/Search/t9n/Search")],Ze.prototype,"messages",void 0),(0,p.e)([(0,p.d)()],Ze.prototype,"showMoreResultsOpen",void 0),(0,p.e)([(0,p.d)()],Ze.prototype,"viewModel",void 0),(0,p.e)([(0,D.t)()],Ze.prototype,"_showMoreResultsClick",null),(0,p.e)([(0,D.t)()],Ze.prototype,"_selectResultClick",null);var Ne=Ze=(0,p.e)([(0,p.n)("esri.widgets.Search.SearchResultRenderer")],Ze),Ae="esri-search esri-widget",Oe="esri-widget__loader",Pe="esri-widget__loader-text",Ge="esri-widget__loader-animation",De="esri-input",Be="esri-search--multiple-sources",je="esri-search--loading",Ue="esri-search--searching",Je="esri-search--show-suggestions",He="esri-search--sources",Ve="esri-search--warning",We="esri-search__container",Ke="esri-search__input",ze="esri-search__input-container",qe="esri-search__form",Qe="esri-search__submit-button",Xe="esri-search__sources-button",$e="esri-search__clear-button",Ye="esri-search__source-name",et="esri-search__suggestions-menu",tt="esri-search__suggestions-list",rt="esri-search__suggestions-list--current-location",nt="esri-search__sources-menu",it="esri-search__source",ot="esri-search__warning-menu",st="esri-search__warning-body",at="esri-search__warning-header",ut="esri-search__warning-text",lt="esri-search__no-value-text",ct="esri-widget--disabled",dt="esri-widget--button",ht="esri-icon-font-fallback-text",vt="esri-icon-locate-circled",pt="esri-menu",ft="esri-menu__list",gt="esri-menu__list-item",yt="esri-menu__list-item--active",mt="esri-menu__list-item--focus",_t="esri-menu__header",wt="esri-icon-search",St="esri-icon-down-arrow esri-search__sources-button--down",bt="esri-icon-up-arrow esri-search__sources-button--up",kt="esri-icon-close",Mt="esri-icon-notice-triangle",xt="esri-icon-search",It="esri-disabled",Rt=/<[a-z/][\s\S]*>/i,Tt=function(e){(0,d.Z)(r,e);var t=(0,h.Z)(r);function r(e,n){var i;return(0,u.Z)(this,r),(i=t.call(this,e,n))._activeMenuItemIndex=-1,i._handles=new g.u,i._inputNode=null,i._menuItemCount=0,i._sourceMenuButtonNode=null,i._sourceListNode=null,i._suggestionListNode=null,i._searchResultRenderer=new Ne,i._locateFailed=null,i._container=null,i.activeMenu="none",i.activeSource=null,i.activeSourceIndex=null,i.allPlaceholder=null,i.allSources=null,i.autoNavigate=null,i.autoSelect=null,i.defaultSources=null,i.disabled=!1,i.goToOverride=null,i.iconClass=xt,i.includeDefaultSources=null,i.label=void 0,i.locationEnabled=null,i.maxResults=null,i.maxSuggestions=null,i.messages=null,i.messagesCommon=null,i.minSuggestCharacters=null,i.popupEnabled=null,i.popupTemplate=null,i.portal=null,i.resultGraphic=null,i.resultGraphicEnabled=null,i.results=null,i.searchAllEnabled=null,i.searchTerm=null,i.selectedResult=null,i.sources=null,i.suggestions=null,i.suggestionsEnabled=null,i.view=null,i.viewModel=new xe,i._clearActiveMenu=function(){i.activeMenu="none"},i._removeActiveMenu=function(e){var t,r=e.relatedTarget;r&&(null===(t=i._container)||void 0===t?void 0:t.contains(r))||i._clearActiveMenu()},i.own([(0,y.l)((function(){return i.searchTerm}),(function(e){(e&&"warning"===i.activeMenu||!e&&!i.get("viewModel.selectedSuggestion.location"))&&i._clearActiveMenu()})),(0,y.a)((function(){var e;return null===(e=i.viewModel)||void 0===e?void 0:e.allSources}),"change",(function(){return i._watchSourceChanges()})),(0,y.l)((function(){return i.activeMenu}),(function(){return i._resetActiveMenuItemIndex()}),y.h),(0,y.l)((function(){var e;return null===(e=i.viewModel)||void 0===e?void 0:e.defaultPopupTemplate}),(function(e){e&&(e.content=i._renderSearchResultsContent.bind((0,c.Z)(i)))}),y.h)]),i}return(0,l.Z)(r,[{key:"destroy",value:function(){this._handles.destroy(),this._handles=null,this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)}},{key:"displayedSearchTerm",get:function(){return"".concat(this.viewModel.searchTerm).trim()}},{key:"inputId",get:function(){return this._buildId("input")}},{key:"suggestionsMenuId",get:function(){return this._buildId("suggest-menu")}},{key:"sourceMenuId",get:function(){return this._buildId("source-menu")}},{key:"sourceMenuButtonId",get:function(){return this._buildId("source-menu-button")}},{key:"clear",value:function(){}},{key:"focus",value:function(){var e;null!==(e=this._inputNode)&&void 0!==e&&e.focus(),this.emit("search-focus")}},{key:"blur",value:function(){var e;null!==(e=this._inputNode)&&void 0!==e&&e.blur(),this.emit("search-blur")}},{key:"search",value:function(e){var t=this;this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();var r=new AbortController,n=r.signal;return this._searchController=r,this.viewModel.search(e,{signal:n}).catch((function(e){if(t._searchController===r)return t._clearActiveMenu(),t._searchController=null,e})).then((function(e){if(t._searchController===r)return t.activeMenu=e.numResults?"none":"warning",t._searchController=null,e}))}},{key:"suggest",value:function(e){var t=this;this._cancelSuggest();var r=new AbortController,n=r.signal;return this._suggestController=r,this.viewModel.suggest(e,null,{signal:n}).then((function(e){if(t._suggestController===r)return t._suggestController=null,e.numResults&&t._openSuggestionMenu(),t._scrollToTopSuggestion(),e})).catch((function(){if(t._suggestController===r)return t._suggestController=null,null}))}},{key:"render",value:function(){var e,t=this.viewModel.state,r=(e={},(0,i.Z)(e,It,"disabled"===t),(0,i.Z)(e,ct,this.disabled),e);return(0,_.n)("div",{class:this.classes(Ae,r)},"loading"===t?this.renderLoader():this.renderContainer())}},{key:"renderSubmitButton",value:function(){var e=this.messages,t=this.disabled;return(0,_.n)("button",{"aria-label":e.searchButtonTitle,bind:this,disabled:t,class:this.classes(Qe,dt),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle,type:"button"},(0,_.n)("span",{"aria-hidden":"true",class:wt}))}},{key:"renderWarningMenu",value:function(){return(0,_.n)("div",{key:"esri-search__error-menu",class:this.classes(pt,ot)},(0,_.n)("div",{class:st},this.renderWarning()))}},{key:"renderSourceMenuButton",value:function(){var e=this.messages,t=this.activeMenu,r=this.sourceMenuId,n=this.sourceMenuButtonId,i=this.disabled,o=this.viewModel,s=o.activeSourceIndex;return o.allSources.length>1?(0,_.n)("button",{id:n,key:"esri-search__source-menu-button",bind:this,disabled:i,"aria-label":e.searchIn,title:e.searchIn,"aria-haspopup":"true","aria-expanded":("source"===t).toString(),"aria-controls":r,class:this.classes(Xe,dt),onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,afterCreate:_.v,"data-node-ref":"_sourceMenuButtonNode",type:"button"},(0,_.n)("span",{"aria-hidden":"true",class:St}),(0,_.n)("span",{"aria-hidden":"true",class:bt}),(0,_.n)("span",{class:Ye},this._getSourceName(s))):null}},{key:"renderSourcesList",value:function(){var e=this,t=this.viewModel,r=t.allSources,n=t.searchAllEnabled,i=this._activeMenuItemIndex,o=this.activeMenu,s=this.sourceMenuId,a=this.sourceMenuButtonId,u="source"===o&&i>-1?this._buildId("source-item",i):null;return r.length>1?(0,_.n)("ul",{"aria-activedescendant":u,"aria-labelledby":a,id:s,role:"menu",bind:this,afterCreate:_.v,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:ft,tabIndex:-1},n?this.renderSource(xe.ALL_INDEX):null,r.map((function(t,r){return e.renderSource(r)})).toArray()):null}},{key:"renderSourcesMenu",value:function(){return this.viewModel.allSources.length>1?(0,_.n)("div",{key:"esri-search__source-menu",class:this.classes(pt,nt)},this.renderSourcesList()):null}},{key:"renderLoader",value:function(){var e=this.messages,t=this.messagesCommon,r=this.disabled;return(0,_.n)("div",{class:Oe,key:"base-loader",tabIndex:r?-1:null},(0,_.n)("span",{"aria-hidden":"true",class:Ge}),(0,_.n)("span",{class:ht},e.searchButtonTitle),(0,_.n)("span",{class:Pe},t.loading))}},{key:"renderContainer",value:function(){var e,t=this,r=this.viewModel,n=r.allSources,o=r.state,s=this.activeMenu,a=(e={},(0,i.Z)(e,Be,n.length>1),(0,i.Z)(e,je,"loading"===o),(0,i.Z)(e,Ue,"searching"===o),(0,i.Z)(e,Ve,"warning"===s),(0,i.Z)(e,He,"source"===s),(0,i.Z)(e,Je,"suggestion"===s),e);return(0,_.n)("div",{tabIndex:-1,afterCreate:function(e){t._container=e,e.addEventListener("focusout",t._removeActiveMenu)},afterRemoved:function(e){e.removeEventListener("focusout",t._removeActiveMenu)},class:this.classes(a,We),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}},{key:"renderClearButton",value:function(){return this.searchTerm?(0,_.n)("button",{bind:this,disabled:this.disabled,class:this.classes($e,dt),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},(0,_.n)("span",{"aria-hidden":"true",class:kt})):null}},{key:"renderLocationGroup",value:function(){var e=this.messages,t=this.locationEnabled,r=this.displayedSearchTerm,n=t&&!r,i="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return n?(0,_.n)("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes(ft,tt,rt)},(0,_.n)("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),role:"option",class:this.classes(gt,i?mt:null)},(0,_.n)("span",{"aria-hidden":"true",class:vt})," ",e.useCurrentLocation)):null}},{key:"renderInput",value:function(){var e=this.activeMenu,t=this.locationEnabled,r=this.displayedSearchTerm,n=this.messages,i=this.suggestionsMenuId,o=this.inputId,s=this._activeMenuItemIndex,a=this.disabled,u=this.viewModel,l=u.maxInputLength,c=u.placeholder,d=u.searchTerm,h=u.suggestionCount,v=!((!t||r)&&!h),p="suggestion"===e&&s>-1?this._buildId("suggestion-item",s):null;return(0,_.n)("input",{"aria-activedescendant":p,"aria-autocomplete":"list","aria-expanded":(v&&"suggestion"===e).toString(),"aria-controls":v?i:null,"aria-haspopup":"listbox","aria-label":n.searchButtonTitle,bind:this,disabled:a,placeholder:c,maxlength:l,autocomplete:"off",type:"text",class:this.classes(De,Ke),value:d,id:o,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:_.v,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:d?"":c})}},{key:"renderForm",value:function(){return(0,_.n)("form",{key:"esri-search__form",bind:this,disabled:this.disabled,class:qe,onsubmit:this._formSubmit,role:"search"},this.renderInput())}},{key:"renderSuggestList",value:function(e){var t=this,r=e.sourceIndex,n=e.results.length,i=e.results;return n?(0,_.n)("ul",{role:"group",key:"esri-search__suggestion-list-".concat(r),class:this.classes(ft,tt)},i.map((function(e){return t.renderSuggestion(e,t._menuItemCount++)}))):null}},{key:"renderSuggestionsGroup",value:function(){var e=this,t=this.viewModel.suggestions;return t?t.map((function(t){return[e.renderSuggestionHeader(t),e.renderSuggestList(t)]})):null}},{key:"renderSuggestionsMenu",value:function(){var e=this.displayedSearchTerm,t=this.locationEnabled,r=this.suggestionsMenuId,n=this.inputId,i=this.viewModel.suggestionCount,o=t&&!e||i;return this._menuItemCount=0,o?(0,_.n)("div",{id:r,key:"esri-search__suggestions-menu",class:this.classes(pt,et),role:"listbox","aria-labelledby":n,bind:this,afterCreate:_.v,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}},{key:"renderInputContainer",value:function(){return(0,_.n)("div",{key:"esri-search__input-container",class:ze},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}},{key:"renderSuggestionHeader",value:function(e){var t=this.viewModel,r=t.allSources,n=t.activeSourceIndex,i=e.sourceIndex,o=e.results.length,s=r.length>1&&n===xe.ALL_INDEX;return o&&s?(0,_.n)("div",{key:"esri-search__suggestion-header-".concat(i),class:_t},this._getSourceName(i)):null}},{key:"renderSuggestion",value:function(e,t){var r=this._activeMenuItemIndex,n=this.messages,i=this.viewModel.searchTerm;if(i){var o=e.text||n.untitledResult,s=Rt.test(o),a=[];if(s)a.push((0,_.n)("div",{innerHTML:o}));else{var u=this._splitResult(o,i),l=i.toLowerCase();u.forEach((function(e,t){e&&e.length&&(e.toLowerCase()===l?a.push((0,_.n)("strong",{key:t},e)):a.push(e))}))}var c="suggestion"===this.activeMenu&&r===t;return(0,_.n)("li",{bind:this,id:this._buildId("suggestion-item",t),"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===t).toString(),onclick:this._handleSuggestionClick,key:"esri-search__suggestion_".concat(t),"data-suggestion":e,role:"option",class:this.classes(gt,c?mt:null)},a)}}},{key:"renderSource",value:function(e){var t,r=this.viewModel,n=r.activeSourceIndex,o=r.searchAllEnabled,s=(t={},(0,i.Z)(t,yt,e===n),(0,i.Z)(t,mt,"source"===this.activeMenu&&e===(o?this._activeMenuItemIndex-1:this._activeMenuItemIndex)),t),a=o?e+1:e;return(0,_.n)("li",{bind:this,key:"esri-search__source-".concat(e),id:this._buildId("source-item",a),"aria-checked":(e===n).toString(),onclick:this._handleSourceClick,"data-source-index":e,role:"menuitemradio",class:this.classes(it,gt,s)},this._getSourceName(e))}},{key:"renderNoResultsWarning",value:function(e){var t=this.messages,r=e?(0,f.s)(t.noResultsFoundForValue,{value:'"'.concat(e,'"')}):t.noResultsFound;return(0,_.n)("div",{key:"esri-search__no_results"},(0,_.n)("div",{class:at},t.noResults),(0,_.n)("div",{class:ut},r))}},{key:"renderEmptySearchWarning",value:function(){var e=this.messages;return(0,_.n)("div",{key:"esri-search__empty-search"},(0,_.n)("span",{"aria-hidden":"true",class:Mt}),(0,_.n)("span",{class:lt},e.emptyValue))}},{key:"renderLocateWarning",value:function(){var e=this.messages;return(0,_.n)("div",{key:"esri-search__locate-error"},(0,_.n)("span",{"aria-hidden":"true",class:Mt}),(0,_.n)("span",{class:lt},e.locateError))}},{key:"renderWarning",value:function(){var e,t=this.displayedSearchTerm,r=this._locateFailed,n=this.viewModel;return r?this.renderLocateWarning():null!==(e=n.selectedSuggestion)&&void 0!==e&&e.location||t?this.renderNoResultsWarning(t):this.renderEmptySearchWarning()}},{key:"_resetActiveMenuItemIndex",value:function(){this._activeMenuItemIndex=-1}},{key:"_buildId",value:function(e,t){return"".concat(this.id,"-").concat(e).concat(void 0===t?"":"-".concat(t))}},{key:"_watchSourceChanges",value:function(){var e=this,t=this._handles,r=this.viewModel.allSources,n="sources";t.remove(n),r.forEach((function(r){return t.add((0,y.l)((function(){return r.name}),(function(){return e.scheduleRender()})),n)}))}},{key:"_handleSourcesMenuToggleFocus",value:function(){"source"!==this.activeMenu&&this._clearActiveMenu()}},{key:"_handleSourcesMenuToggleClick",value:function(){var e,t="source"===this.activeMenu;this.activeMenu=t?"none":"source",this.renderNow(),"source"===this.activeMenu&&(null===(e=this._sourceListNode)||void 0===e||e.focus())}},{key:"_handleClearButtonClick",value:function(){this.viewModel.clear(),this._focus()}},{key:"_handleSearchButtonClick",value:function(){this.search()}},{key:"_handleSuggestionClick",value:function(e){var t=e.currentTarget["data-suggestion"];t&&(this._focus(),this.search(t))}},{key:"_handleUseCurrentLocationClick",value:function(){this._useCurrentLocation()}},{key:"_useCurrentLocation",value:function(){var e=this;this._focus("none"),this._cancelSuggest(),this._cancelSearch();var t=new AbortController,r=t.signal;this._searchController=t,this.viewModel.searchNearby({signal:r}).then((function(t){e.activeMenu=t.numResults?"none":"warning"})).catch((function(){e._locateFailed=!0,e.activeMenu="warning"})).then((function(){e._searchController=null}))}},{key:"_handleSourceClick",value:function(e){this._setSourceFromMenuItem(e.currentTarget)}},{key:"_setSourceFromMenuItem",value:function(e){var t;if(e){var r=e["data-source-index"];this.viewModel.activeSourceIndex=r,this._clearActiveMenu(),null===(t=this._sourceMenuButtonNode)||void 0===t||t.focus()}}},{key:"_cancelSuggest",value:function(){this._suggestController&&(this._suggestController.abort(),this._suggestController=null)}},{key:"_cancelSearch",value:function(){this._searchController&&(this._searchController.abort(),this._searchController=null),this._locateFailed=!1}},{key:"_handleInputKeyup",value:function(e){var t,r=(0,p.i)(e);if(!e.ctrlKey&&!e.metaKey&&"Copy"!==r&&"ArrowLeft"!==r&&"ArrowRight"!==r&&"Shift"!==r){if("Tab"===r||"Escape"===r||e.shiftKey&&"Tab"===r)return this._cancelSuggest(),void("Escape"===r&&this._clearActiveMenu());var n="Home"===r||"End"===r||"ArrowUp"===r||"ArrowDown"===r;if("Enter"===r&&this._activeMenuItemIndex<0)this._cancelSuggest();else{var i=null===(t=this._suggestionListNode)||void 0===t?void 0:t.getElementsByTagName("li");if(null!==i&&void 0!==i&&i.length){if("suggestion"!==this.activeMenu&&this._openSuggestionMenu(),n)return e.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(r,i,this._suggestionListNode);var o=i[this._activeMenuItemIndex];if("Enter"===r&&o){var s=o["data-suggestion"];return void(s?(this._focus(),this.search(s)):o["data-current-location-item"]&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}}}},{key:"_handleItemNavigation",value:function(e,t,r){var n=this._activeMenuItemIndex;"Home"===e&&(this._activeMenuItemIndex=0),"End"===e&&(this._activeMenuItemIndex=t.length-1),"ArrowUp"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?t.length-1:this._activeMenuItemIndex-1),"ArrowDown"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex===t.length-1?0:this._activeMenuItemIndex+1),n!==this._activeMenuItemIndex&&(0,_.A)(t[this._activeMenuItemIndex],r)}},{key:"_scrollToTopSuggestion",value:function(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}},{key:"_openSuggestionMenu",value:function(){this.activeMenu="suggestion"}},{key:"_handleInputPaste",value:function(e){var t=e.target;this.viewModel.searchTerm!==t.value&&(this.viewModel.searchTerm=t.value),this.viewModel.searchTerm&&this.suggest()}},{key:"_handleSourceMenuKeydown",value:function(e){var t=(0,p.i)(e);if((0,_.k)(t)){e.preventDefault();var r=this._sourceListNode.getElementsByTagName("li")[this._activeMenuItemIndex];this._setSourceFromMenuItem(r)}else"ArrowUp"!==t&&"ArrowDown"!==t&&"End"!==t&&"Home"!==t||e.preventDefault()}},{key:"_handleSourceMenuKeyup",value:function(e){var t,r,n=(0,p.i)(e),i="ArrowUp"===n||"ArrowDown"===n||"End"===n||"Home"===n;if(i&&e.preventDefault(),"Escape"===n)return this._clearActiveMenu(),void(null===(t=this._sourceMenuButtonNode)||void 0===t||t.focus());var o=null===(r=this._sourceListNode)||void 0===r?void 0:r.getElementsByTagName("li");return o&&0!==o.length&&i?("source"!==this.activeMenu&&(this.activeMenu="source"),void this._handleItemNavigation(n,o,this._sourceListNode.parentElement)):void 0}},{key:"_focus",value:function(e){this.focus(),e&&(this.activeMenu=e)}},{key:"_formSubmit",value:function(e){e.preventDefault(),-1===this._activeMenuItemIndex&&this.search()}},{key:"_getSourceName",value:function(e){var t=this.messages,r=this.viewModel.allSources.getItemAt(e);return e===xe.ALL_INDEX?t.all:r&&r.name||t.untitledSource}},{key:"_splitResult",value:function(e,t){var r=(0,p.o)(t);return e.replace(new RegExp("(^|)(".concat(r,")(|$)"),"ig"),"$1|$2|$3").split("|")}},{key:"_renderSearchResultsContent",value:function(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}}]),r}(_.O);(0,p.e)([(0,p.d)()],Tt.prototype,"_activeMenuItemIndex",void 0),(0,p.e)([(0,p.d)()],Tt.prototype,"displayedSearchTerm",null),(0,p.e)([(0,p.d)({readOnly:!0})],Tt.prototype,"inputId",null),(0,p.e)([(0,p.d)({readOnly:!0})],Tt.prototype,"suggestionsMenuId",null),(0,p.e)([(0,p.d)({readOnly:!0})],Tt.prototype,"sourceMenuId",null),(0,p.e)([(0,p.d)({readOnly:!0})],Tt.prototype,"sourceMenuButtonId",null),(0,p.e)([(0,p.d)()],Tt.prototype,"activeMenu",void 0),(0,p.e)([(0,m.o)("viewModel.activeSource")],Tt.prototype,"activeSource",void 0),(0,p.e)([(0,m.o)("viewModel.activeSourceIndex")],Tt.prototype,"activeSourceIndex",void 0),(0,p.e)([(0,m.o)("viewModel.allPlaceholder")],Tt.prototype,"allPlaceholder",void 0),(0,p.e)([(0,m.o)("viewModel.allSources")],Tt.prototype,"allSources",void 0),(0,p.e)([(0,m.o)("viewModel.autoNavigate")],Tt.prototype,"autoNavigate",void 0),(0,p.e)([(0,m.o)("viewModel.autoSelect")],Tt.prototype,"autoSelect",void 0),(0,p.e)([(0,m.o)("viewModel.defaultSources")],Tt.prototype,"defaultSources",void 0),(0,p.e)([(0,p.d)()],Tt.prototype,"disabled",void 0),(0,p.e)([(0,m.o)("viewModel.goToOverride")],Tt.prototype,"goToOverride",void 0),(0,p.e)([(0,p.d)()],Tt.prototype,"iconClass",void 0),(0,p.e)([(0,m.o)("viewModel.includeDefaultSources")],Tt.prototype,"includeDefaultSources",void 0),(0,p.e)([(0,p.d)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Tt.prototype,"label",void 0),(0,p.e)([(0,m.o)("viewModel.locationEnabled")],Tt.prototype,"locationEnabled",void 0),(0,p.e)([(0,m.o)("viewModel.maxResults")],Tt.prototype,"maxResults",void 0),(0,p.e)([(0,m.o)("viewModel.maxSuggestions")],Tt.prototype,"maxSuggestions",void 0),(0,p.e)([(0,p.d)(),(0,_.e)("esri/widgets/Search/t9n/Search")],Tt.prototype,"messages",void 0),(0,p.e)([(0,p.d)(),(0,_.e)("esri/t9n/common")],Tt.prototype,"messagesCommon",void 0),(0,p.e)([(0,m.o)("viewModel.minSuggestCharacters")],Tt.prototype,"minSuggestCharacters",void 0),(0,p.e)([(0,m.o)("viewModel.popupEnabled")],Tt.prototype,"popupEnabled",void 0),(0,p.e)([(0,m.o)("viewModel.popupTemplate")],Tt.prototype,"popupTemplate",void 0),(0,p.e)([(0,m.o)("viewModel.portal")],Tt.prototype,"portal",void 0),(0,p.e)([(0,m.o)("viewModel.resultGraphic")],Tt.prototype,"resultGraphic",void 0),(0,p.e)([(0,m.o)("viewModel.resultGraphicEnabled")],Tt.prototype,"resultGraphicEnabled",void 0),(0,p.e)([(0,m.o)("viewModel.results")],Tt.prototype,"results",void 0),(0,p.e)([(0,m.o)("viewModel.searchAllEnabled")],Tt.prototype,"searchAllEnabled",void 0),(0,p.e)([(0,m.o)("viewModel.searchTerm")],Tt.prototype,"searchTerm",void 0),(0,p.e)([(0,m.o)("viewModel.selectedResult")],Tt.prototype,"selectedResult",void 0),(0,p.e)([(0,m.o)("viewModel.sources")],Tt.prototype,"sources",void 0),(0,p.e)([(0,m.o)("viewModel.suggestions")],Tt.prototype,"suggestions",void 0),(0,p.e)([(0,m.o)("viewModel.suggestionsEnabled")],Tt.prototype,"suggestionsEnabled",void 0),(0,p.e)([(0,m.o)("viewModel.view")],Tt.prototype,"view",void 0),(0,p.e)([(0,B.t)(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),(0,p.d)({type:xe})],Tt.prototype,"viewModel",void 0),(0,p.e)([(0,m.o)("viewModel.clear")],Tt.prototype,"clear",null);var Lt=Tt=(0,p.e)([(0,p.n)("esri.widgets.Search")],Tt);t.default=Lt},4197:function(e,t,r){r.d(t,{t:function(){return i}});var n=r(73393);function i(){return function(e,t){if(!e[t])throw new TypeError("Cannot auto bind undefined function '".concat(t,"'"));return{value:s(e[t])}}}function o(e){var t=e.type;return e instanceof KeyboardEvent||"keyup"===t||"keydown"===t||"keypress"===t}function s(e){return function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];o(t)?(0,n.k)(t.key)&&(t.preventDefault(),t.stopPropagation(),t.target.click()):e.call.apply(e,[this,t].concat(i))}}},17691:function(e,t,r){r.d(t,{o:function(){return o}});var n=r(1413),i=r(50165);function o(e,t){var r=t?(0,n.Z)((0,n.Z)({},t),{},{source:e}):e;return(0,i.d)({aliasOf:r})}},39853:function(e,t,r){r.d(t,{r:function(){return s},s:function(){return a}});var n=r(50165),i=new Set;function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r&&i.has(t)||(r&&i.add(t),e.warn("\ud83d\uded1 DEPRECATED - ".concat(t)))}function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((0,n.c)("esri-deprecation-warnings")){var i=r.moduleName;a(e,"Property: ".concat((i?i+"::":"")+t),r)}}function a(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((0,n.c)("esri-deprecation-warnings")){var i=r.replacement,s=r.version,a=r.see,u=r.warnOnce,l=t;i&&(l+="\n\t\ud83d\udee0\ufe0f Replacement: ".concat(i)),s&&(l+="\n\t\u2699\ufe0f Version: ".concat(s)),a&&(l+="\n\t\ud83d\udd17 See ".concat(a," for more details.")),o(e,l,u)}}},87110:function(e,t,r){r.d(t,{s:function(){return v}});var n=r(74165),i=r(15671),o=r(43144),s=r(15861),a=r(42),u=r(50165),l=(r(52155),r(72577)),c=r(13994),d=r(61772),h=u.s.getLogger("esri.intl");function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.format,i=void 0===n?{}:n;return(0,u.h)(e,(function(e){return p(e,t,i)}))}function p(e,t,r){var n,i,o=e.indexOf(":");if(-1===o?n=e.trim():(n=e.slice(0,o).trim(),i=e.slice(o+1).trim()),!n)return"";var s=(0,u.j)(n,t);if(null==s)return"";var l=r[i]||r[n];return l?function(e,t){switch(t.type){case"date":return(0,a.L)(e,t.intlOptions);case"number":return(0,a.m)(e,t.intlOptions);default:return h.warn("missing format descriptor for key {key}"),f(e)}}(s,l):i?function(e,t){switch(t.toLowerCase()){case"dateformat":return(0,a.L)(e);case"numberformat":return(0,a.m)(e);default:return h.warn("inline format is unsupported since 4.12: ".concat(t)),/^(dateformat|datestring)/i.test(t)?(0,a.L)(e):/^numberformat/i.test(t)?(0,a.m)(e):f(e)}}(s,i):f(s)}function f(e){switch(typeof e){case"string":return e;case"number":return(0,a.m)(e);case"boolean":return""+e;default:return e instanceof Date?(0,a.L)(e):""}}function g(){return g=(0,s.Z)((0,n.Z)().mark((function e(t,r,i,o){var s,a,c,d,h,v,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r.exec(i)){e.next=3;break}throw new u.a("esri-intl:invalid-bundle",'Bundle id "'.concat(i,'" is not compatible with the pattern "').concat(r,'"'));case 3:return a=s[1]?"".concat(s[1],"/"):"",c=s[2],d=(0,l.u)(o),h="".concat(a).concat(c,".json"),v=d?"".concat(a).concat(c,"_").concat(d,".json"):h,e.prev=4,e.next=7,y(t(v));case 7:case 17:p=e.sent,e.next=23;break;case 10:if(e.prev=10,e.t0=e.catch(4),v!==h){e.next=14;break}throw new u.a("intl:unknown-bundle",'Bundle "'.concat(i,'" cannot be loaded'),{error:e.t0});case 14:return e.prev=14,e.next=17,y(t(h));case 20:throw e.prev=20,e.t1=e.catch(14),new u.a("intl:unknown-bundle",'Bundle "'.concat(i,'" cannot be loaded'),{error:e.t1});case 23:return e.abrupt("return",p);case 24:case"end":return e.stop()}}),e,null,[[4,10],[14,20]])}))),g.apply(this,arguments)}function y(e){return m.apply(this,arguments)}function m(){return(m=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,u.r)(S.fetchBundleAsset)){e.next=2;break}return e.abrupt("return",S.fetchBundleAsset(t));case 2:return e.next=4,(0,c.U)(t,{responseType:"text"});case 4:return r=e.sent,e.abrupt("return",JSON.parse(r.data));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _=function(){function e(t){var r,n=t.base,o=void 0===n?"":n,s=t.pattern,a=t.location,u=void 0===a?new URL(window.location.href):a;(0,i.Z)(this,e),r="string"==typeof u?function(e){return new URL(e,new URL(u,window.location.href)).href}:u instanceof URL?function(e){return new URL(e,u).href}:u,this.pattern="string"==typeof s?new RegExp("^".concat(s)):s,this.getAssetUrl=r,o=o?o.endsWith("/")?o:o+"/":"",this.matcher=new RegExp("^".concat(o,"(?:(.*)/)?(.*)$"))}return(0,o.Z)(e,[{key:"fetchMessageBundle",value:function(e,t){return function(e,t,r,n){return g.apply(this,arguments)}(this.getAssetUrl,this.matcher,e,t)}}]),e}();var w,S={};(0,l.l)((w={pattern:"esri/",location:d.a},new _(w)))},80581:function(e,t,r){r.d(t,{a:function(){return g},n:function(){return m}});var n=r(74165),i=r(1413),o=r(15861),s=r(15671),a=r(43144),u=r(60136),l=r(29388),c=r(13994),d=r(50165),h=r(78664),v=r(51613);function p(e,t,r){var n=(0,h.a)(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))}var f=function(e){(0,u.Z)(r,e);var t=(0,l.Z)(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e)).geometries=null,n.outSpatialReference=null,n.transformation=null,n.transformForward=null,n}return(0,a.Z)(r,[{key:"toJSON",value:function(){var e=this.geometries.map((function(e){return e.toJSON()})),t=this.geometries[0],r={};return r.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),r.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),r.geometries=JSON.stringify({geometryType:(0,h.v)(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(r.transformForward=this.transformForward),r}}]),r}(r(32335).l);(0,d.e)([(0,d.d)()],f.prototype,"geometries",void 0),(0,d.e)([(0,d.d)({json:{read:{source:"outSR"}}})],f.prototype,"outSpatialReference",void 0),(0,d.e)([(0,d.d)()],f.prototype,"transformation",void 0),(0,d.e)([(0,d.d)()],f.prototype,"transformForward",void 0);var g=f=(0,d.e)([(0,d.n)("esri.rest.support.ProjectParameters")],f),y=(0,d.b)(g);function m(e,t,r){return _.apply(this,arguments)}function _(){return _=(0,o.Z)((0,n.Z)().mark((function e(t,r,o){var s,a,u,l,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y(r),s=(0,v.n)(t),a=(0,i.Z)((0,i.Z)({},s.query),{},{f:"json"},r.toJSON()),u=r.outSpatialReference,l=(0,h.v)(r.geometries[0]),d=(0,v.e)(a,o),e.abrupt("return",(0,c.U)(s.path+"/project",d).then((function(e){return p(e.data.geometries,l,u)})));case 3:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}},82162:function(e,t,r){r.d(t,{t:function(){return i}});var n=r(93433);function i(e){return function(t){t.hasOwnProperty("_delegatedEventNames")||(t._delegatedEventNames=t._delegatedEventNames?t._delegatedEventNames.slice():[]);var r=t._delegatedEventNames,i=Array.isArray(e)?e:function(e){return e.split(",").map((function(e){return e.trim()}))}(e);r.push.apply(r,(0,n.Z)(i))}}}}]);
//# sourceMappingURL=2073.2dfbdbab.chunk.js.map