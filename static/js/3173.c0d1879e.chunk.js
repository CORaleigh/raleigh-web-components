"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[3173],{53173:function(e,t,r){r.r(t);var i=r(37762),n=r(15671),l=r(43144),u=r(11752),s=r(61120),a=r(60136),o=r(29388),d=r(50165),c=r(89031),y=r(73627),h=r(92637),f=r(56389),v=r(42814),p=r(53089),g=r(73552),F=r(29398),_=r(53823),b=r(29322),w=r(92692),I=r(35691),E=r(72355),C=r(73764),k=r(67871),S=(r(33530),r(96263),r(77322),r(32335),r(31278),r(13994),r(98496),r(40133),r(4483),r(79747),r(42),r(52155),r(75662),r(17493),r(62980),r(16377),r(9887),r(88406),r(66307),r(2760),r(42488),r(9330),r(79146),r(3029),r(42687),r(78330),r(78697),r(78664),r(36235),r(61340),r(83172),r(49350),r(84539),r(89354),r(16897),r(47642),r(63334),r(73428),r(38419),r(84231),r(97823),r(38665),r(32717),r(59075),r(17691),r(39853),r(94872),r(3969),r(86738),r(69205),r(50338),r(49961),r(31412),r(48561),r(96401),r(68634),r(69738),r(73393),r(87110),r(72577),r(61772),r(92870),r(26079),r(22984),r(15508),r(55269),r(86931),r(51613),r(80392),r(10489),r(62298),r(2815),r(2326),r(90339),r(76375),r(82046),r(66270),r(60418),r(75366),r(5233),r(57439),r(43895),r(30594),r(73267),r(22628),r(24982),r(46584),r(7093),r(85966),r(28003),r(49796),r(58428),r(8049),r(80933),r(40858),r(95076),r(33074),r(31134),r(41524),r(68668),r(55916),r(66319),r(24781),r(2329),r(37243),r(97345),r(39001),r(84913),r(84823),r(9411),r(14826),r(64620),r(22225),r(75272),r(4197),r(86905),r(64997),r(26208),r(2816),r(46237),r(98428),r(5792),r(42094),r(75097),r(47672),r(98643),r(83745),r(87833),r(21523),r(84192),r(99057),r(26995),r(57952),r(39972),r(27670),r(75105),r(71871),r(94867),r(92694),r(25715),r(71573),r(83262),r(7225),r(21286),r(47901),r(6819),r(12989),r(6243),r(40438),r(12317),r(24695),r(74021),r(47692),r(48968),r(92820),r(37783),r(20838),r(64747),r(56864),r(15820),r(50252),r(95013),r(89180),r(28360),r(8180),r(43750),r(13089),r(55985),r(18392),r(44217),r(66339),r(34095),r(34428),r(76821),r(21984),r(60470),r(17704),r(45940),r(62335),r(70146),r(35650),r(7513),r(29173),r(14739),r(7671),r(13445),r(57405),r(61377),r(64591),r(14023),r(44365),r(50463),r(49734),r(66156),r(62469),r(85490),r(77576),r(38969),r(8369),r(21277),r(80581),r(85245),r(75777),r(68792),r(99797),r(49510),r(33117),d.s.getLogger("esri.views.3d.layers.SceneLayerView3D")),x=(0,_.b)(),q=function(e){(0,a.Z)(r,e);var t=(0,o.Z)(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).type="scene-layer-3d",e.lodFactor=1,e.progressiveLoadFactor=1,e._elevationContext="scene",e._isIntegratedMesh=!1,e._supportsLabeling=!0,e._interactiveEditingSessions=new Map,e._queryEngine=null,e}return(0,l.Z)(r,[{key:"filter",get:function(){return this._get("filter")},set:function(e){this._set("filter",b.C.checkSupport(e)?e:null)}},{key:"viewFilter",get:function(){var e=this,t=this.filter;if((0,d.t)(t)&&(0,d.t)(this.layerFilter))return null;var r=this._get("viewFilter");return(0,d.t)(r)?new b.C({layerFilter:this.layerFilter,viewFilter:t,layerFieldsIndex:this.layer.fieldsIndex,loadAsyncModule:function(t){return e._loadAsyncModule(t)},applyFilters:function(){return e._applyFilters(!0)},addSqlFilter:function(t,r){return e.addSqlFilter(t,r,e.logError)}}):(r.viewFilter=this.filter,r.layerFilter=this.layerFilter,this.notifyChange("viewFilter"),r)}},{key:"requiredFields",get:function(){var e,t;return null!==(e=null===(t=this.fieldsHelper)||void 0===t?void 0:t.requiredFields)&&void 0!==e?e:[]}},{key:"floorFilterClause",get:function(){var e=(0,v.o)(this);return(0,d.r)(e)?h.WhereClause.create(e,this.layer.fieldsIndex):null}},{key:"excludeObjectIdsSorted",get:function(){var e=this.layer.excludeObjectIds;return e.length?e.toArray().sort((function(e,t){return e-t})):null}},{key:"lodCrossfadeinDuration",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.qualitySettings.sceneService["3dObject"].lodCrossfadeinDuration)&&void 0!==e?e:0}},{key:"lodCrossfadeoutDuration",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.qualitySettings.sceneService["3dObject"].lodCrossfadeoutDuration)&&void 0!==e?e:0}},{key:"lodCrossfadeUncoveredDuration",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.qualitySettings.sceneService["3dObject"].lodCrossfadeUncoveredDuration)&&void 0!==e?e:0}},{key:"initialize",value:function(){var e=this;this.fieldsHelper=new _.c({layerView:this}),this.updatingHandles.add((function(){return e.layer.rangeInfos}),(function(t){return e._rangeInfosChanged(t)}),y.h),this.updatingHandles.add((function(){return e.layer.renderer}),(function(t){return e.updatingHandles.addPromise(e._rendererChange(t))}),y.h),this.updatingHandles.add((function(){return[e.parsedDefinitionExpression,e.filter,e.layer.filter,e.floorFilterClause,e.excludeObjectIdsSorted,(0,d.aq)(e.viewFilter,(function(e){return[e.parsedWhereClause,e.parsedGeometry,e.sortedObjectIds]}))]}),(function(){return e._filterChange()})),this.updatingHandles.add((function(){return[e.filter,(0,d.aq)(e.viewFilter,(function(e){return e.parsedGeometry}))]}),(function(){return e._geometryFilterChange()})),this.handles.add(this.layer.on("apply-edits",(function(t){return e.updatingHandles.addPromise(t.result)}))),this.handles.add(this.layer.on("edits",(function(t){return e._handleEdits(t)})))}},{key:"destroy",value:function(){this.fieldsHelper=(0,d.G)(this.fieldsHelper)}},{key:"_rangeInfosChanged",value:function(e){null!=e&&e.length>0&&S.warn("Unsupported property: rangeInfos are currently only serialized to and from web scenes but do not affect rendering.")}},{key:"createQuery",value:function(){var e={outFields:["*"],returnGeometry:!1,outSpatialReference:this.view.spatialReference};return(0,d.r)(this.filter)?this.filter.createQuery(e):new p.b(e)}},{key:"queryExtent",value:function(e,t){return this._ensureQueryEngine().executeQueryForExtent(this._ensureQuery(e),null===t||void 0===t?void 0:t.signal)}},{key:"queryFeatureCount",value:function(e,t){return this._ensureQueryEngine().executeQueryForCount(this._ensureQuery(e),null===t||void 0===t?void 0:t.signal)}},{key:"queryFeatures",value:function(e,t){var r=this;return this._ensureQueryEngine().executeQuery(this._ensureQuery(e),null===t||void 0===t?void 0:t.signal).then((function(e){if(null===e||void 0===e||!e.features)return e;var t,n=r.layer,l=(0,i.Z)(e.features);try{for(l.s();!(t=l.n()).done;){var u=t.value;u.layer=n,u.sourceLayer=n}}catch(s){l.e(s)}finally{l.f()}return e}))}},{key:"queryObjectIds",value:function(e,t){return this._ensureQueryEngine().executeQueryForIds(this._ensureQuery(e),null===t||void 0===t?void 0:t.signal)}},{key:"_ensureQueryEngine",value:function(){return this._queryEngine||(this._queryEngine=this._createQueryEngine()),this._queryEngine}},{key:"_createQueryEngine",value:function(){var e=this,t=(0,g.u)(this.view.spatialReference,this.view.renderSpatialReference,this._collection);return new b.p({layerView:this,priority:k.L.FEATURE_QUERY_ENGINE,spatialIndex:new b.f({featureAdapter:new b.n({objectIdField:this.layer.objectIdField,attributeStorageInfo:this.layer.attributeStorageInfo,getFeatureExtent:t}),toArray:function(){var t=new Array;return e._forAllFeatures((function(e,r,i){return t.push({id:e,index:r,meta:i}),g.L.CONTINUE}),null,g.I.ALL_IN_CLIPPING_AREA),t},forAllFeatures:function(t,r){return e._forAllFeatures((function(e,r,i){return t({id:e,index:r,meta:i})}),r,g.I.ALL_IN_CLIPPING_AREA)},getFeatureExtent:t,sourceSpatialReference:(0,I.K)(this.layer),viewSpatialReference:this.view.spatialReference})})}},{key:"highlight",value:function(e){var t=this._highlights;if(e instanceof p.b){var i=t.acquireSet(),n=i.set,l=i.handle;return this.queryObjectIds(e).then((function(e){return t.setFeatureIds(n,e)})),l}return(0,u.Z)((0,s.Z)(r.prototype),"highlight",this).call(this,e)}},{key:"createInteractiveEditSession",value:function(e){return(0,_.i)(this.attributeEditingContext,e)}},{key:"_createLayerGraphic",value:function(e){var t=new c.g(null,null,e);return t.layer=this.layer,t.sourceLayer=this.layer,t}},{key:"canResume",value:function(){return(0,u.Z)((0,s.Z)(r.prototype),"canResume",this).call(this)&&(!this._controller||this._controller.rootNodeVisible)}},{key:"getFilters",value:function(){var e=(0,u.Z)((0,s.Z)(r.prototype),"getFilters",this).call(this),t=this.excludeObjectIdsSorted;return(0,d.r)(t)&&e.push((function(e){return(0,I.ad)(t,!1,e)})),this.floorFilterClause&&this.addSqlFilter(e,this.floorFilterClause,this.logError),this.addSqlFilter(e,this.parsedDefinitionExpression,this.logError),(0,d.r)(this.viewFilter)&&this.viewFilter.addFilters(e,this.view,this._controller.crsIndex,this._collection),e}},{key:"isUpdating",value:function(){return(0,u.Z)((0,s.Z)(r.prototype),"isUpdating",this).call(this)||this.layerFilterUpdating}},{key:"_ensureQuery",value:function(e){return this._addDefinitionExpressionToQuery((0,d.t)(e)?this.createQuery():p.b.from(e))}},{key:"attributeEditingContext",get:function(){var e=this;return{sessions:this._interactiveEditingSessions,fieldsIndex:this.layer.fieldsIndex,objectIdField:this._getObjectIdField(),forEachNode:function(t){return e._forAllNodes((function(e){return(0,d.r)(e)?t(e.node,e.featureIds):null}))},attributeStorageInfo:this.i3slayer.attributeStorageInfo,attributeOverrides:this.attributeOverrides,getAttributeData:function(t){return e.getAttributeData(t)},setAttributeData:function(t,r){return e.setAttributeData(t,r)},clearMemCache:function(){return e.clearMemCache()}}}},{key:"_handleEdits",value:function(e){(0,_.a)(this.attributeEditingContext,e)}},{key:"hasGeometryFilter",get:function(){var e=this.viewFilter;return(0,d.r)(e)&&(0,d.r)(e.parsedGeometry)}},{key:"computeNodeFiltering",value:function(e){var t=this.viewFilter;return(0,d.t)(t)||t.isMBSGeometryVisible(e,this.view.spatialReference,this._controller.crsIndex)?w.n.Unmodified:w.n.Culled}}]),r}((0,g.p)((0,E.p)((0,C.c)((0,F.n)(_.g)))));(0,d.e)([(0,d.d)({aliasOf:"layer"})],q.prototype,"i3slayer",void 0),(0,d.e)([(0,d.d)(I.t)],q.prototype,"updatingProgress",void 0),(0,d.e)([(0,d.d)({type:f.y})],q.prototype,"filter",null),(0,d.e)([(0,d.d)({readOnly:!0})],q.prototype,"viewFilter",null),(0,d.e)([(0,d.d)(x.requiredFields)],q.prototype,"requiredFields",null),(0,d.e)([(0,d.d)(x.availableFields)],q.prototype,"availableFields",void 0),(0,d.e)([(0,d.d)()],q.prototype,"fieldsHelper",void 0),(0,d.e)([(0,d.d)()],q.prototype,"floorFilterClause",null),(0,d.e)([(0,d.d)()],q.prototype,"excludeObjectIdsSorted",null),(0,d.e)([(0,d.d)({readOnly:!0,aliasOf:"view.qualitySettings.sceneService.3dObject.lodFactor"})],q.prototype,"lodFactor",void 0),(0,d.e)([(0,d.d)({readOnly:!0,aliasOf:"_controller.updatingProgress"})],q.prototype,"updatingProgressValue",void 0);var O=q=(0,d.e)([(0,d.n)("esri.views.3d.layers.SceneLayerView3D")],q);t.default=O}}]);
//# sourceMappingURL=3173.c0d1879e.chunk.js.map