"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[2352],{2352:function(e,t,i){i.d(t,{A:function(){return P},a:function(){return V},c:function(){return z},f:function(){return A},l:function(){return T},o:function(){return S},q:function(){return D}});var n=i(74165),r=i(1413),a=i(15861),s=i(93433),u=i(37762),l=i(15671),o=i(43144),c=i(93661),f=i(74384),h=i(45184),d=i(82474),p=i(48848),m=i(43976),v=i(62470),y=i(54622),g=i(62753),x=i(58492),Z=i(94663),b=i(59984),_=function(){function e(t,i){(0,l.Z)(this,e),this._cache=new m.e(t),this._invalidCache=new m.e(i)}return(0,o.Z)(e,[{key:"get",value:function(e,t){var i="".concat(t.uid,":").concat(e),n=this._cache.get(i);if(n)return n;if(void 0!==this._invalidCache.get(i))return null;try{var r=v.WhereClause.create(e,t);return this._cache.put(i,r),r}catch(a){return this._invalidCache.put(i,null),null}}}]),e}(),F=new _(50,500),w="feature-store:unsupported-query",I=" as ",k=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function S(e,t){if(!t)return!0;var i=F.get(t,e);if(!i)throw new p.s(w,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new p.s(w,"where clause is not standard",{where:t});return z(e,i.fieldNames,"where clause contains missing fields"),!0}function V(e,t,i){if(!t)return!0;var n=F.get(t,e);if(!n)throw new p.s(w,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new p.s(w,"having does not contain a valid aggregate function",{having:t});var r=n.fieldNames;if(z(e,r,"having contains missing fields"),!n.getExpressions().every((function(t){var n=t.aggregateType,r=t.field,a=e.has(r)&&e.get(r).name;return i.some((function(t){var i=t.onStatisticField,r=t.statisticType;return(e.has(i)&&e.get(i).name)===a&&r.toLowerCase().trim()===n}))})))throw new p.s(w,"expressions in having should also exist in outStatistics",{having:t});return!0}function T(e,t){return e?F.get(e,t):null}function z(e,t,i){var n,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[],l=(0,u.Z)(t);try{for(l.s();!(n=l.n()).done;){var o=n.value;if("*"!==o&&!e.has(o))if(r){var c=R(o);try{var f=T(c,e);if(!f)throw new p.s(w,"invalid SQL expression",{where:c});if(!f.isStandardized)throw new p.s(w,"expression is not standard",{clause:f});z(e,f.fieldNames,"expression contains missing fields")}catch(V){var h=V&&V.details;if(h&&(h.clause||h.where))throw V;h&&h.missingFields?a.push.apply(a,(0,s.Z)(h.missingFields)):a.push(o)}}else a.push(o)}}catch(d){l.e(d)}finally{l.f()}if(a.length)throw new p.s(w,i,{missingFields:a})}function R(e){return e.split(I)[0]}function M(e){return e.split(I)[1]}function A(e,t){var i=t.get(e);return!!i&&!k.has(i.type)}var D,E,C=function(){function e(t,i,n){var r;(0,l.Z)(this,e),this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=null!==(r=t.returnDistinctValues)&&void 0!==r&&r,this.fieldsIndex=n,this.featureAdapter=i;var a=t.outFields;if(a&&!a.includes("*")){this.outFields=a;var s,o=0,c=(0,u.Z)(a);try{for(c.s();!(s=c.n()).done;){var f=s.value,h=R(f),d=this.fieldsIndex.get(h),p=d?null:T(h,n),m=d?d.name:M(f)||"FIELD_EXP_"+o++;this._fieldDataCache.set(f,{alias:m,clause:p})}}catch(v){c.e(v)}finally{c.f()}}}return(0,o.Z)(e,[{key:"countDistinctValues",value:function(e){var t=this;return this.returnDistinctValues?(e.forEach((function(e){return t.getAttributes(e)})),this._returnDistinctMap.size):e.length}},{key:"getAttributes",value:function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}},{key:"getFieldValue",value:function(e,t,i){var n=i?i.name:t,r=null;return this._fieldDataCache.has(n)?r=this._fieldDataCache.get(n).clause:i||(r=T(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:r})),i?this.featureAdapter.getAttribute(e,n):r.calculateValue(e,this.featureAdapter)}},{key:"getDataValue",value:function(e,t){var i=t.normalizationType,n=t.normalizationTotal,r=this.getFieldValue(e,t.field,this.fieldsIndex.get(t.field));if(t.field2&&(r="".concat((0,y.c)(r)).concat(t.fieldDelimiter).concat((0,y.c)(this.getFieldValue(e,t.field2,this.fieldsIndex.get(t.field2)))),t.field3&&(r="".concat(r).concat(t.fieldDelimiter).concat((0,y.c)(this.getFieldValue(e,t.field3,this.fieldsIndex.get(t.field3)))))),i&&Number.isFinite(r)){var a="field"===i&&t.normalizationField?this.getFieldValue(e,t.normalizationField,this.fieldsIndex.get(t.normalizationField)):null;r=(0,y.x)(r,i,a,n)}return r}},{key:"getExpressionValue",value:function(e,t,i,n){var r={attributes:this.featureAdapter.getAttributes(e),layer:{fields:this.fieldsIndex.fields}},a=n.createExecContext(r,i);return n.executeFunction(t,a)}},{key:"getExpressionValues",value:function(e,t,i,n){var r=this,a={fields:this.fieldsIndex.fields};return e.map((function(e){var s={attributes:r.featureAdapter.getAttributes(e),layer:a},u=n.createExecContext(s,i);return n.executeFunction(t,u)}))}},{key:"validateItem",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:T(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}},{key:"validateItems",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:T(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}},{key:"_processAttributesForOutFields",value:function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);var i,n={},r=(0,u.Z)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value,s=this._fieldDataCache.get(a),l=s.alias,o=s.clause;n[l]=o?o.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,l)}}catch(c){r.e(c)}finally{r.f()}return n}},{key:"_processAttributesForDistinctValues",value:function(e){if((0,c.t)(e)||!this.returnDistinctValues)return e;var t=this.outFields,i=[];if(t){var n,r=(0,u.Z)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value,s=this._fieldDataCache.get(a).alias;i.push(e[s])}}catch(h){r.e(h)}finally{r.f()}}else for(var l in e)i.push(e[l]);var o="".concat((t||["*"]).join(","),"=").concat(i.join(",")),f=this._returnDistinctMap.get(o)||0;return this._returnDistinctMap.set(o,++f),f>1?null:e}}]),e}(),P=function(){function e(t,i,n){(0,l.Z)(this,e),this.items=t,this.query=i,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.fieldsIndex=n.fieldsIndex,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.featureAdapter=n.featureAdapter}return(0,o.Z)(e,[{key:"size",get:function(){return this.items.length}},{key:"createQueryResponseForCount",value:function(){var e=new C(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);var t=this.query,i=t.groupByFieldsForStatistics,n=t.having,r=t.outStatistics;if(!(null===i||void 0===i?void 0:i.length))return 1;var a,s=new Map,l=new Map,o=new Set,c=(0,u.Z)(r);try{for(c.s();!(a=c.n()).done;){var f=a.value,h="exceedslimit"!==f.statisticType?f.onStatisticField:void 0;if(!l.has(h)){var d,p=[],m=(0,u.Z)(i);try{for(m.s();!(d=m.n()).done;){var v=d.value,y=this._getAttributeValues(e,v,s);p.push(y)}}catch(w){m.e(w)}finally{m.f()}l.set(h,this._calculateUniqueValues(p,e.returnDistinctValues))}var g=l.get(h);for(var x in g){var Z=g[x],b=Z.data,_=Z.items,F=b.join(",");n&&!e.validateItems(_,n)||o.add(F)}}}catch(w){c.e(w)}finally{c.f()}return o.size}},{key:"createQueryResponse",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.query.outStatistics){e.next=11;break}if(!this.query.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))){e.next=5;break}e.t0=this._createExceedsLimitQueryResponse(this.query),e.next=8;break;case 5:return e.next=7,this._createStatisticsQueryResponse(this.query);case 7:e.t0=e.sent;case 8:t=e.t0,e.next=12;break;case 11:t=this._createFeatureQueryResponse(this.query);case 12:return e.abrupt("return",(this.query.returnQueryGeometry&&((0,d.I)(this.query.outSR)&&!(0,d.E)(this.query.geometry.spatialReference,this.query.outSR)?t.queryGeometry=(0,Z.E)((0,r.Z)({spatialReference:this.query.outSR},(0,g.g)(this.query.geometry,this.query.geometry.spatialReference,this.query.outSR))):t.queryGeometry=(0,Z.E)((0,r.Z)({spatialReference:this.query.outSR},this.query.geometry))),t));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createSnappingResponse",value:function(e,t){var i,n=this.featureAdapter,r=q(this.hasZ,this.hasM),a=e.point,s="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,o={candidates:[]},f="esriGeometryPolygon"===this.geometryType,h=null!=a.z,d=null!=a.m,p=this._getPointCreator(a,h,d,this.spatialReference,t),m=new G(null,0),v=new G(null,0),y={x:0,y:0,z:0},g=(0,u.Z)(this.items);try{for(g.s();!(i=g.n()).done;){var Z=i.value,b=n.getGeometry(Z);if(!(0,c.t)(b)){var _=b.coords,F=b.lengths;if(m.coords=_,v.coords=_,e.types&D.EDGE)for(var w=0,I=0;I<F.length;I++)for(var k=F[I],S=0;S<k;S++,w+=r){var V=m;if(V.coordsIndex=w,S!==k-1){var T=v;T.coordsIndex=w+r;var z=y;N(y,a,V,T);var R=(a.x-z.x)/s,M=(a.y-z.y)/l,A=R*R+M*M;A<=1&&o.candidates.push((0,x.e)(n.getObjectId(Z),p(z),Math.sqrt(A),p(V),p(T)))}}if(e.types&D.VERTEX)for(var E=f?_.length-r:_.length,C=0;C<E;C+=r){var P=m;P.coordsIndex=C;var O=(a.x-P.x)/s,j=(a.y-P.y)/l,B=O*O+j*j;B<=1&&o.candidates.push((0,x.t)(n.getObjectId(Z),p(P),Math.sqrt(B)))}}}}catch(Q){g.e(Q)}finally{g.f()}return o.candidates.sort((function(e,t){return e.distance-t.distance})),o}},{key:"_getPointCreator",value:function(e,t,i,n,r){var a=(0,c.r)(r)&&!(0,d.E)(n,r)?function(e){return(0,g.g)(e,n,r)}:function(e){return e},s=this.hasZ,u=e.m;return t&&i?s?function(e){var t=e.x,i=e.y,n=e.z;return a({x:t,y:i,z:n,m:u})}:function(e){var t=e.x,i=e.y;return a({x:t,y:i,z:0,m:u})}:t?s?function(e){var t=e.x,i=e.y,n=e.z;return a({x:t,y:i,z:n})}:function(e){var t=e.x,i=e.y;return a({x:t,y:i,z:0})}:i?function(e){var t=e.x,i=e.y;return a({x:t,y:i,m:u})}:function(e){var t=e.x,i=e.y;return a({x:t,y:i})}}},{key:"createSummaryStatisticsResponse",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var i,r,a,s,u,l,o,c,f,h,d,p,m,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.field,r=t.valueExpression,a=t.normalizationField,s=t.normalizationType,u=t.normalizationTotal,l=t.minValue,o=t.maxValue,c=t.scale,f=this.fieldsIndex.isDateField(i),e.next=11,this._getDataValues({field:i,valueExpression:r,normalizationField:a,normalizationType:s,normalizationTotal:u,scale:c});case 11:return h=e.sent,d=(0,y.m)({normalizationType:s,normalizationField:a,minValue:l,maxValue:o}),p=this.fieldsIndex.get(i),m={value:.5,fieldType:null===p||void 0===p?void 0:p.type},v=(0,b.t)(p)?(0,y.f)({values:h,supportsNullCount:d,percentileParams:m}):(0,y.d)({values:h,minValue:l,maxValue:o,useSampleStdDev:!s,supportsNullCount:d,percentileParams:m}),e.abrupt("return",(0,y.V)(v,f));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createUniqueValuesResponse",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var i,r,a,s,u,l,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.field,r=t.valueExpression,a=t.domains,s=t.returnAllCodedValues,u=t.scale,e.next=7,this._getDataValues({field:i,field2:t.field2,field3:t.field3,fieldDelimiter:t.fieldDelimiter,valueExpression:r,scale:u});case 7:return l=e.sent,o=(0,y.T)(l),e.abrupt("return",(0,y.F)(o,a,s,t.fieldDelimiter));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createClassBreaksResponse",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var i,r,a,s,u,l,o,c,f,h,d,p,m;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.field,r=t.valueExpression,a=t.normalizationField,s=t.normalizationType,u=t.normalizationTotal,l=t.classificationMethod,o=t.standardDeviationInterval,c=t.minValue,f=t.maxValue,h=t.numClasses,d=t.scale,e.next=13,this._getDataValues({field:i,valueExpression:r,normalizationField:a,normalizationType:s,normalizationTotal:u,scale:d});case 13:return p=e.sent,m=(0,y.D)(p,{field:i,normalizationField:a,normalizationType:s,normalizationTotal:u,classificationMethod:l,standardDeviationInterval:o,minValue:c,maxValue:f,numClasses:h}),e.abrupt("return",(0,y.N)(m,l));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createHistogramResponse",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var i,r,a,s,u,l,o,c,f,h,d,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.field,r=t.valueExpression,a=t.normalizationField,s=t.normalizationType,u=t.normalizationTotal,l=t.classificationMethod,o=t.standardDeviationInterval,c=t.minValue,f=t.maxValue,h=t.numBins,d=t.scale,e.next=13,this._getDataValues({field:i,valueExpression:r,normalizationField:a,normalizationType:s,normalizationTotal:u,scale:d});case 13:return p=e.sent,e.abrupt("return",(0,y.S)(p,{field:i,normalizationField:a,normalizationType:s,normalizationTotal:u,classificationMethod:l,standardDeviationInterval:o,minValue:c,maxValue:f,numBins:h}));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_sortFeatures",value:function(e,t,i){var n=this;if(e.length>1&&t&&t.length){var r,a=(0,u.Z)(t.reverse());try{var s=function(){var t=r.value.split(" "),a=t[0],s=n.fieldsIndex.get(a),u=t[1]&&"desc"===t[1].toLowerCase(),l=(0,y.v)(null===s||void 0===s?void 0:s.type,u);e.sort((function(e,t){var n=i(e,a,s),r=i(t,a,s);return l(n,r)}))};for(a.s();!(r=a.n()).done;)s()}catch(l){a.e(l)}finally{a.f()}}}},{key:"_createFeatureQueryResponse",value:function(e){var t=this,i=this.items,n=this.geometryType,r=this.hasM,a=this.hasZ,u=this.objectIdField,l=this.spatialReference,o=e.outFields,c=e.outSR,f=e.quantizationParameters,d=e.resultRecordCount,p=e.resultOffset,m=e.returnZ,v=e.returnM,y=null!=d&&i.length>(p||0)+d,g=o&&(o.includes("*")?(0,s.Z)(this.fieldsIndex.fields):o.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:y,features:this._createFeatures(e,i),fields:g,geometryType:n,hasM:r&&v,hasZ:a&&m,objectIdFieldName:u,spatialReference:(0,Z.E)(c||l),transform:f&&(0,h.s)(f)||null}}},{key:"_createFeatures",value:function(e,t){var i=new C(e,this.featureAdapter,this.fieldsIndex),n=this.hasM,r=this.hasZ,a=e.orderByFields,l=e.quantizationParameters,o=e.returnGeometry,c=e.returnCentroid,f=e.maxAllowableOffset,d=e.resultOffset,p=e.resultRecordCount,m=e.returnZ,v=void 0!==m&&m,y=e.returnM,g=r&&v,x=n&&(void 0!==y&&y),b=[],_=0,F=(0,s.Z)(t);if(this._sortFeatures(F,a,(function(e,t,n){return i.getFieldValue(e,t,n)})),o||c){var w=(0,h.s)(l);if(o&&!c){var I,k=(0,u.Z)(F);try{for(k.s();!(I=k.n()).done;){var S=I.value;b[_++]={attributes:i.getAttributes(S),geometry:(0,Z.v)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(S),f,w,g,x)}}}catch(O){k.e(O)}finally{k.f()}}else if(!o&&c){var V,T=(0,u.Z)(F);try{for(T.s();!(V=T.n()).done;){var z=V.value;b[_++]={attributes:i.getAttributes(z),centroid:(0,Z.b)(this,this.featureAdapter.getCentroid(z,this),w)}}}catch(O){T.e(O)}finally{T.f()}}else{var R,M=(0,u.Z)(F);try{for(M.s();!(R=M.n()).done;){var A=R.value;b[_++]={attributes:i.getAttributes(A),centroid:(0,Z.b)(this,this.featureAdapter.getCentroid(A,this),w),geometry:(0,Z.v)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(A),f,w,g,x)}}}catch(O){M.e(O)}finally{M.f()}}}else{var D,E=(0,u.Z)(F);try{for(E.s();!(D=E.n()).done;){var P=D.value,N=i.getAttributes(P);N&&(b[_++]={attributes:N})}}catch(O){E.e(O)}finally{E.f()}}var q=d||0;if(null!=p){var G=q+p;b=b.slice(q,Math.min(b.length,G))}return b}},{key:"_createExceedsLimitQueryResponse",value:function(e){var t,i=!1,n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=(0,u.Z)(e.outStatistics);try{for(s.s();!(t=s.n()).done;){var l=t.value;if("exceedslimit"===l.statisticType){n=null!=l.maxPointCount?l.maxPointCount:Number.POSITIVE_INFINITY,r=null!=l.maxRecordCount?l.maxRecordCount:Number.POSITIVE_INFINITY,a=null!=l.maxVertexCount?l.maxVertexCount:Number.POSITIVE_INFINITY;break}}}catch(h){s.e(h)}finally{s.f()}if("esriGeometryPoint"===this.geometryType)i=this.items.length>n;else if(this.items.length>r)i=!0;else{var o=q(this.hasZ,this.hasM),f=this.featureAdapter;i=this.items.reduce((function(e,t){var i=f.getGeometry(t);return e+((0,c.r)(i)&&i.coords.length||0)}),0)/o>a}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(i)}}]}}},{key:"_createStatisticsQueryResponse",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var i,r,a,s,l,o,c,f,h,d,p,m,v,y,g,x,Z,b,_,F,w,I,k,S,V,T,z,R,M,A,D,E,P,N,q,G,O,j,B=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={attributes:{}},r=[],a=new Map,s=new Map,l=new Map,o=new Map,c=new C(t,this.featureAdapter,this.fieldsIndex),f=t.outStatistics,h=t.groupByFieldsForStatistics,d=t.having,p=t.orderByFields,m=h&&h.length,y=(v=!!m)&&h[0],g=v&&!this.fieldsIndex.get(y),x=(0,u.Z)(f),e.prev=2,x.s();case 4:if((Z=x.n()).done){e.next=34;break}if(b=Z.value,_=b.outStatisticFieldName,F=b.statisticType,w=b,I="exceedslimit"!==F?b.onStatisticField:void 0,k="percentile_disc"===F||"percentile_cont"===F,S="EnvelopeAggregate"===F||"CentroidAggregate"===F||"ConvexHullAggregate"===F,V=v&&1===m&&(I===y||g)&&"count"===F,!v){e.next=19;break}if(!l.has(I)){T=[],z=(0,u.Z)(h);try{for(z.s();!(R=z.n()).done;)M=R.value,A=this._getAttributeValues(c,M,a),T.push(A)}catch(Q){z.e(Q)}finally{z.f()}l.set(I,this._calculateUniqueValues(T,!S&&c.returnDistinctValues))}D=l.get(I),E=(0,n.Z)().mark((function e(t){var i,r,s,u,l,f,p,m,v,y,g,x,Z,b;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=D[t],r=i.count,s=i.data,u=i.items,l=i.itemPositions,f=s.join(","),d&&!c.validateItems(u,d)){e.next=18;break}if(p=o.get(f)||{attributes:{}},!S){e.next=13;break}return p.aggregateGeometries||(p.aggregateGeometries={}),e.next=7,B._getAggregateGeometry(w,u);case 7:m=e.sent,v=m.aggregateGeometries,y=m.outStatisticFieldName,p.aggregateGeometries[y]=v,e.next=16;break;case 13:g=null,V?g=r:(x=B._getAttributeValues(c,I,a),Z=l.map((function(e){return x[e]})),g=k&&"statisticParameters"in w?B._getPercentileValue(w,Z):B._getStatisticValue(w,Z,null,c.returnDistinctValues)),p.attributes[_]=g;case 16:b=0,h.forEach((function(e,t){return p.attributes[B.fieldsIndex.get(e)?e:"EXPR_"+ ++b]=s[t]})),o.set(f,p);case 18:case"end":return e.stop()}}),e)})),e.t0=(0,n.Z)().keys(D);case 12:if((e.t1=e.t0()).done){e.next=17;break}return P=e.t1.value,e.delegateYield(E(P),"t2",15);case 15:e.next=12;break;case 17:e.next=31;break;case 19:if(!S){e.next=29;break}return i.aggregateGeometries||(i.aggregateGeometries={}),e.next=23,this._getAggregateGeometry(w,this.items);case 23:N=e.sent,q=N.aggregateGeometries,G=N.outStatisticFieldName,i.aggregateGeometries[G]=q,e.next=31;break;case 29:O=this._getAttributeValues(c,I,a),i.attributes[_]=k&&"statisticParameters"in w?this._getPercentileValue(w,O):this._getStatisticValue(w,O,s,c.returnDistinctValues);case 31:r.push({name:_,alias:_,type:"esriFieldTypeDouble"});case 32:e.next=4;break;case 34:e.next=39;break;case 36:e.prev=36,e.t3=e.catch(2),x.e(e.t3);case 39:return e.prev=39,x.f(),e.finish(39);case 42:return j=v?Array.from(o.values()):[i],e.abrupt("return",(this._sortFeatures(j,p,(function(e,t){return e.attributes[t]})),{fields:r,features:j}));case 44:case"end":return e.stop()}}),e,this,[[2,36,39,42]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_getAggregateGeometry",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,a){var s,u,l,o,c,h,d,p,m,v,y,g,x;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([i.e(6951),i.e(9009)]).then(i.bind(i,79009));case 2:return s=e.sent,u=t.statisticType,l=t.outStatisticFieldName,o=this.featureAdapter,c=this.spatialReference,h=this.geometryType,d=this.hasZ,p=this.hasM,m=a.map((function(e){return(0,Z.v)(h,d,p,o.getGeometry(e))})),v=s.convexHull(c,m,!0)[0],y={aggregateGeometries:null,outStatisticFieldName:null},"EnvelopeAggregate"===u?(g=v?(0,f.f)(v):(0,f.l)(s.union(c,m)),y.aggregateGeometries=(0,r.Z)((0,r.Z)({},g),{},{spatialReference:c}),y.outStatisticFieldName=l||"extent"):"CentroidAggregate"===u?(x=v?(0,f.r)(v):(0,f.g)((0,f.l)(s.union(c,m))),y.aggregateGeometries={x:x[0],y:x[1],spatialReference:c},y.outStatisticFieldName=l||"centroid"):"ConvexHullAggregate"===u&&(y.aggregateGeometries=v,y.outStatisticFieldName=l||"convexHull"),e.abrupt("return",y);case 15:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_getStatisticValue",value:function(e,t,i,n){var r,a=e.onStatisticField,s=e.statisticType;return r=null!==i&&void 0!==i&&i.has(a)?i.get(a):(0,b.t)(this.fieldsIndex.get(a))?(0,y.f)({values:t,returnDistinct:n}):(0,y.d)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(a,r),r["var"===s?"variance":s]}},{key:"_getPercentileValue",value:function(e,t){var i=e.onStatisticField,n=e.statisticParameters,r=e.statisticType,a=n.value,s=n.orderBy,u=this.fieldsIndex.get(i);return(0,y.p)(t,{value:a,orderBy:s,fieldType:null===u||void 0===u?void 0:u.type,isDiscrete:"percentile_disc"===r})}},{key:"_getAttributeValues",value:function(e,t,i){if(i.has(t))return i.get(t);var n=this.fieldsIndex.get(t),r=this.items.map((function(i){return e.getFieldValue(i,t,n)}));return i.set(t,r),r}},{key:"_getAttributeDataValues",value:function(e,t){return this.items.map((function(i){return e.getDataValue(i,{field:t.field,field2:t.field2,field3:t.field3,fieldDelimiter:t.fieldDelimiter,normalizationField:t.normalizationField,normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})}))}},{key:"_getAttributeExpressionValues",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,i,r){var a,s,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,b.i)();case 2:return a=e.sent,s=a.arcadeUtils,u=s.createFunction(i),l=r&&s.getViewInfo(r),e.abrupt("return",t.getExpressionValues(this.items,u,l,s));case 7:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_calculateUniqueValues",value:function(e,t){for(var i={},n=this.items,r=n.length,a=0;a<r;a++){var s,l=n[a],o=[],c=(0,u.Z)(e);try{for(c.s();!(s=c.n()).done;){var f=s.value;o.push(f[a])}}catch(d){c.e(d)}finally{c.f()}var h=o.join(",");t?null==i[h]&&(i[h]={count:1,data:o,items:[l],itemPositions:[a]}):null==i[h]?i[h]={count:1,data:o,items:[l],itemPositions:[a]}:(i[h].count++,i[h].items.push(l),i[h].itemPositions.push(a))}return i}},{key:"_getDataValues",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var i,r,a,s,u,l,o,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new C(this.query,this.featureAdapter,this.fieldsIndex),r=t.valueExpression,a=t.field,s=t.normalizationField,u=t.normalizationType,l=t.normalizationTotal,o=t.scale,c=r?{viewingMode:"map",scale:o,spatialReference:this.query.outSR||this.spatialReference}:null,e.abrupt("return",r?this._getAttributeExpressionValues(i,r,c):this._getAttributeDataValues(i,{field:a,field2:t.field2,field3:t.field3,fieldDelimiter:t.fieldDelimiter,normalizationField:s,normalizationType:u,normalizationTotal:l}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function N(e,t,i,n){var r=n.x-i.x,a=n.y-i.y,s=r*r+a*a,u=(t.x-i.x)*r+(t.y-i.y)*a,l=Math.min(1,Math.max(0,u/s));e.x=i.x+r*l,e.y=i.y+a*l}function q(e,t){return e?t?4:3:t?3:2}(E=D||(D={}))[E.NONE=0]="NONE",E[E.EDGE=1]="EDGE",E[E.VERTEX=2]="VERTEX";var G=function(){function e(t,i){(0,l.Z)(this,e),this.coords=t,this.coordsIndex=i}return(0,o.Z)(e,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]),e}()},83948:function(e,t,i){i.d(t,{t:function(){return a}});var n=i(43144),r=i(15671),a={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,i){var n=new s(e.getPointX(t),e.getPointY(t),i),r=e.hasZ(t),a=e.hasM(t);return r&&(n.z=e.getPointZ(t)),a&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,i){return new u(e.exportPaths(t),i,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,i){return new l(e.exportPaths(t),i,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,i){return new o(e.exportPoints(t),i,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,i){var n=e.hasZ(t),r=e.hasM(t),a=new c(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),i);if(n){var s=e.getZExtent(t);a.zmin=s.vmin,a.zmax=s.vmax}if(r){var u=e.getMExtent(t);a.mmin=u.vmin,a.mmax=u.vmax}return a}};var s=(0,n.Z)((function e(t,i,n){(0,r.Z)(this,e),this.x=t,this.y=i,this.spatialReference=n,this.z=void 0,this.m=void 0}));var u=(0,n.Z)((function e(t,i,n,a){(0,r.Z)(this,e),this.rings=t,this.spatialReference=i,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)}));var l=(0,n.Z)((function e(t,i,n,a){(0,r.Z)(this,e),this.paths=t,this.spatialReference=i,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)}));var o=(0,n.Z)((function e(t,i,n,a){(0,r.Z)(this,e),this.points=t,this.spatialReference=i,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)}));var c=(0,n.Z)((function e(t,i,n,a,s){(0,r.Z)(this,e),this.xmin=t,this.ymin=i,this.xmax=n,this.ymax=a,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}))},62753:function(e,t,i){i.d(t,{M:function(){return w},f:function(){return y},g:function(){return b}});var n=i(74165),r=i(15671),a=i(43144),s=i(15861),u=i(37762),l=i(29439),o=i(93661),c=i(95249),f=i(83948),h=i(82474),d=[0,0];function p(e,t){if(!t)return null;if("x"in t){var i,n,r={x:0,y:0};return i=e(t.x,t.y,d),n=(0,l.Z)(i,2),r.x=n[0],r.y=n[1],null!=t.z&&(r.z=t.z),null!=t.m&&(r.m=t.m),r}if("xmin"in t){var a,s,u,o,c={xmin:0,ymin:0,xmax:0,ymax:0};return a=e(t.xmin,t.ymin,d),s=(0,l.Z)(a,2),c.xmin=s[0],c.ymin=s[1],u=e(t.xmax,t.ymax,d),o=(0,l.Z)(u,2),c.xmax=o[0],c.ymax=o[1],t.hasZ&&(c.zmin=t.zmin,c.zmax=t.zmax,c.hasZ=!0),t.hasM&&(c.mmin=t.mmin,c.mmax=t.mmax,c.hasM=!0),c}return"rings"in t?{rings:m(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:m(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:v(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function m(e,t){var i,n=[],r=(0,u.Z)(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;n.push(v(a,t))}}catch(s){r.e(s)}finally{r.f()}return n}function v(e,t){var i,n=[],r=(0,u.Z)(e);try{for(r.s();!(i=r.n()).done;){var a=i.value,s=t(a[0],a[1],[0,0]);n.push(s),a.length>2&&s.push(a[2]),a.length>3&&s.push(a[3])}}catch(l){r.e(l)}finally{r.f()}return n}function y(e,t){return g.apply(this,arguments)}function g(){return(g=(0,s.Z)((0,n.Z)().mark((function e(t,i){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&i){e.next=2;break}return e.abrupt("return");case 2:return r=Array.isArray(t)?t.map((function(e){return(0,o.r)(e.geometry)?e.geometry.spatialReference:null})).filter(o.r):[t],e.next=5,(0,c._)(r.map((function(e){return{source:e,dest:i}})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=p.bind(null,h.y),Z=p.bind(null,h.q);function b(e,t,i,n){if(!e)return e;if(i||(i=t,t=e.spatialReference),!(0,h.I)(t)||!(0,h.I)(i)||(0,h.E)(t,i))return e;if((0,h.g)(t,i)){var r=(0,h.b)(i)?x(e):Z(e);return r.spatialReference=i,r}return(0,c.l)(f.t,[e],t,i,null,n)[0]}var _=function(){function e(){(0,r.Z)(this,e),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return(0,a.Z)(e,[{key:"push",value:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t,i,r){var a,s=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length&&i&&r&&!(0,h.E)(i,r)){e.next=2;break}return e.abrupt("return",t);case 2:return a={geometries:t,inSpatialReference:i,outSpatialReference:r,resolve:null},e.abrupt("return",(this._jobs.push(a),new Promise((function(e){a.resolve=e,null===s._timer&&(s._timer=setTimeout(s._process,10))}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,i=e.inSpatialReference,n=e.outSpatialReference,r=e.resolve;(0,h.g)(i,n)?(0,h.b)(n)?r(t.map(x)):r(t.map(Z)):r((0,c.l)(f.t,t,i,n,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),e}(),F=new _;function w(e,t,i){return F.push(e,t,i)}},94663:function(e,t,i){i.d(t,{E:function(){return D},F:function(){return y},J:function(){return k},b:function(){return _},v:function(){return F},z:function(){return w}});var n=i(74165),r=i(15861),a=i(40558),s=i(93661),u=i(47855),l=i(95249),o=i(74384),c=i(56162),f=i(63212),h=i(82474),d=i(52559),p=i(62466),m=i(62753),v=new a.s({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),y=Object.freeze({}),g=new p.t,x=new p.t,Z=new p.t,b={esriGeometryPoint:d.F,esriGeometryPolyline:d.$,esriGeometryPolygon:d.D,esriGeometryMultipoint:d.O};function _(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM;if((0,s.t)(t))return null;var a=e.hasZ&&n,u=e.hasM&&r;if(i){var l=(0,d.a)(Z,t,e.hasZ,e.hasM,"esriGeometryPoint",i,n,r);return(0,d.F)(l,a,u)}return(0,d.F)(t,a,u)}function F(e,t,i,n,r,a){var u,l,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:i,f=t&&o,h=i&&c,p=(0,s.r)(n)?"coords"in n?n:n.geometry:null;if((0,s.t)(p))return null;if(r){var m,v,y=(0,d.h)(x,p,t,i,e,r,o,c);return a&&(y=(0,d.a)(Z,y,f,h,e,a)),null!==(m=null===(v=b[e])||void 0===v?void 0:v.call(b,y,f,h))&&void 0!==m?m:null}if(a){var _,F,w=(0,d.a)(Z,p,t,i,e,a,o,c);return null!==(_=null===(F=b[e])||void 0===F?void 0:F.call(b,w,f,h))&&void 0!==_?_:null}return(0,d.I)(g,p,t,i,o,c),null!==(u=null===(l=b[e])||void 0===l?void 0:l.call(b,g,f,h))&&void 0!==u?u:null}function w(e,t,i){return I.apply(this,arguments)}function I(){return(I=(0,r.Z)((0,n.Z)().mark((function e(t,i,r){var a,s,u,l,o,c,f,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.outFields,s=t.orderByFields,u=t.groupByFieldsForStatistics,l=t.outStatistics,a)for(o=0;o<a.length;o++)a[o]=a[o].trim();if(s)for(c=0;c<s.length;c++)s[c]=s[c].trim();if(u)for(f=0;f<u.length;f++)u[f]=u[f].trim();if(l)for(h=0;h<l.length;h++)l[h].onStatisticField&&(l[h].onStatisticField=l[h].onStatisticField.trim());return e.abrupt("return",(t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),k(t,i,r)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t,i){return S.apply(this,arguments)}function S(){return(S=(0,r.Z)((0,n.Z)().mark((function e(t,i,r){var a,u,l,h,d,p,v,g,x;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(a=t.where,t.where=a=a&&a.trim(),(!a||/^1 *= *1$/.test(a)||i&&i===a)&&(t.where=null),t.geometry){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,z(t);case 7:if(u=e.sent,t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel&&(l=t.geometry.spatialReference,(u=(0,o.l)(u)).spatialReference=l),!u){e.next=27;break}return e.next=12,(0,m.f)(u.spatialReference,r);case 12:return u=T(u,r),e.next=15,(0,f.v)((0,c.v)(u));case 15:if(d=e.sent[0],!(0,s.t)(d)){e.next=18;break}throw y;case 18:return p="quantizationParameters"in t&&(null===(h=t.quantizationParameters)||void 0===h?void 0:h.tolerance)||"maxAllowableOffset"in t&&t.maxAllowableOffset||0,v=p&&V(u,r)?{densificationStep:8*p}:void 0,g=d.toJSON(),e.next=23,(0,m.g)(g,g.spatialReference,r,v);case 23:if(x=e.sent){e.next=26;break}throw y;case 26:x.spatialReference=r,t.geometry=x;case 27:return e.abrupt("return",t);case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,t){if(!e)return!1;var i=e.spatialReference;return((0,c.u)(e)||(0,c.y)(e)||(0,c.f)(e))&&!(0,h.E)(i,t)&&!(0,l.A)(i,t)}function T(e,t){var i=e.spatialReference;return V(e,t)&&(0,c.u)(e)?{spatialReference:i,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:e}function z(e){return R.apply(this,arguments)}function R(){return(R=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,s,l,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.distance,r=t.units,a=t.geometry,null!=i&&!("vertexAttributes"in a)){e.next=3;break}return e.abrupt("return",a);case 3:if(s=a.spatialReference,l=r?v.fromJSON(r):(0,u.X)(s),!s||!(0,h.h)(s)&&!(0,h.b)(s)){e.next=9;break}e.t0=a,e.next=12;break;case 9:return e.next=11,(0,m.f)(s,h.n).then((function(){return(0,m.g)(a,h.n)}));case 11:e.t0=e.sent;case 12:return o=e.t0,e.next=15,M();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t1)(o.spatialReference,o,i,l));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return A.apply(this,arguments)}function A(){return(A=(0,r.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([i.e(6951),i.e(9009)]).then(i.bind(i,79009));case 2:return e.abrupt("return",e.sent.geodesicBuffer);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return e&&E in e?JSON.parse(JSON.stringify(e,C)):e}var E="_geVersion",C=function(e,t){return e!==E?t:void 0}}}]);
//# sourceMappingURL=2352.bada73da.chunk.js.map