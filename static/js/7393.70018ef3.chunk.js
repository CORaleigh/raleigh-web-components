"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[7393],{37393:function(e,t,n){n.r(t),n.d(t,{find_my_service:function(){return l}});var r=n(93433),i=n(74165),o=n(29439),a=n(15861),s=n(15671),c=n(43144),u=n(61118),l=function(){function e(t){(0,s.Z)(this,e),(0,u.r)(this,t),this.groupId=void 0,this.council=!1,this.categories=void 0,this.layers=void 0,this.sections=[],this.councilInfo=[]}return(0,c.Z)(e,[{key:"loadSearchWidget",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,r,a,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Promise,e.next=3,Promise.all([n.e(3314),n.e(4662),n.e(7944),n.e(5577),n.e(8848),n.e(2474),n.e(558),n.e(4384),n.e(6817),n.e(3116),n.e(9325),n.e(3661),n.e(2968),n.e(4544)]).then(n.bind(n,44544));case 3:return e.t1=e.sent,e.next=6,Promise.all([n.e(3314),n.e(4662),n.e(7944),n.e(5577),n.e(8848),n.e(2474),n.e(558),n.e(4384),n.e(6817),n.e(3116),n.e(3661),n.e(2968),n.e(730)]).then(n.bind(n,34350)).then((function(e){return e.L}));case 6:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=10,e.t0.all.call(e.t0,e.t3);case 10:return t=e.sent,r=(0,o.Z)(t,2),a=r[0].default,s=r[1].default,c=new a({container:this.searchDiv,includeDefaultSources:!1,sources:[new s({url:"https://maps.raleighnc.gov/arcgis/rest/services/Locators/FindMyService/GeocodeServer",placeholder:"Enter your address"})]}),e.abrupt("return",c);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadGroup",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,a,s,c,u,l,p;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Promise,e.next=3,Promise.all([n.e(8848),n.e(2474),n.e(558),n.e(6817),n.e(3116),n.e(3661),n.e(5094)]).then(n.bind(n,93116)).then((function(e){return e.P}));case 3:return e.t1=e.sent,e.t2=[e.t1],e.next=7,e.t0.all.call(e.t0,e.t2);case 7:return r=e.sent,a=(0,o.Z)(r,1),s=a[0].default,c=new s,e.next=13,c.queryGroups({query:"id: ".concat(t),sortField:"title"});case 13:if(!(u=e.sent).results.length){e.next=21;break}return l=u.results[0],e.next=18,l.queryItems({query:"type: map",sortField:"title"});case 18:if(!(p=e.sent).results.length){e.next=21;break}return e.abrupt("return",p.results);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadMaps",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,a,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Promise,e.next=3,Promise.all([n.e(9557),n.e(3314),n.e(4662),n.e(630),n.e(3103),n.e(7944),n.e(5577),n.e(5249),n.e(2821),n.e(642),n.e(2959),n.e(5113),n.e(6570),n.e(7859),n.e(7093),n.e(4581),n.e(8848),n.e(1517),n.e(727),n.e(8987),n.e(2474),n.e(558),n.e(4384),n.e(6817),n.e(3116),n.e(1015),n.e(7686),n.e(8765),n.e(3661),n.e(1233),n.e(530)]).then(n.bind(n,12864)).then((function(e){return e.W}));case 3:return e.t1=e.sent,e.t2=[e.t1],e.next=7,e.t0.all.call(e.t0,e.t2);case 7:return r=e.sent,a=(0,o.Z)(r,1),s=a[0].default,c=[],t.forEach((function(e){c.push(new s({portalItem:{id:e.id}}).loadAll().catch((function(e){console.log(e)})))})),e.next=14,Promise.all(c);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchMapLayers",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var o,s,c=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sections=[].concat(),o=[].concat(),this.councilInfo=[].concat(),s=0,(n=n.filter((function(e){var t;return void 0===c.categories||(null===(t=c.categories)||void 0===t?void 0:t.split(",").includes(e.portalItem.title))}))).forEach(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(u){var l,p,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=[].concat(),p=[],u.layers.filter((function(e){var t;return void 0===c.layers||(null===(t=c.layers)||void 0===t?void 0:t.split(",").includes(e.title))})).forEach(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p.push(n.queryFeatures({geometry:t,outFields:["*"]}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.all(p);case 5:h=e.sent,s+=1,h.forEach((function(e,t){l=[].concat((0,r.Z)(l),[{title:u.layers.getItemAt(t).title,features:e.features,id:u.layers.getItemAt(t).id}]),c.council&&u.layers.getItemAt(t).title.includes("City Council")&&e.features.length>0&&(e.features[0].layer.popupTemplate.content[0].text='<img alt="" src="{expression/expr0}" style="padding-right:1em;max-height:200px;"/>',e.features[0].layer.popupTemplate.content[0].text+="<h6>{COUNCIL_PERSON}</h6><span>Raleigh City Council</span><div>District {COUNCIL_DIST}</div><div><a href='https://www.raleighnc.gov/services/government/city-council-and-committees'><span>Website </span></a></div>",e.features[0].layer.popupTemplate.title="",c.councilInfo.push(e.features[0]))})),o=[].concat((0,r.Z)(o),[{title:u.portalItem.title,layers:l}]),s===n.length&&(c.sections=(0,r.Z)(o),o.sort((function(e,t){return e.title<t.title?-1:e.title>t.title?0:void 0})),c.sections=(0,r.Z)(o),console.log(c.sections));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadFeatureWidget",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var a,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Promise,e.next=3,Promise.all([n.e(9557),n.e(3314),n.e(4662),n.e(630),n.e(3103),n.e(7944),n.e(5577),n.e(2821),n.e(642),n.e(2959),n.e(5113),n.e(6570),n.e(7859),n.e(7093),n.e(4581),n.e(8848),n.e(1517),n.e(2559),n.e(727),n.e(8987),n.e(2474),n.e(558),n.e(4384),n.e(6817),n.e(3116),n.e(9871),n.e(1015),n.e(9325),n.e(3661),n.e(7997),n.e(7276),n.e(3581)]).then(n.bind(n,98598)).then((function(e){return e.F}));case 3:return e.t1=e.sent,e.t2=[e.t1],e.next=7,e.t0.all.call(e.t0,e.t2);case 7:a=e.sent,s=(0,o.Z)(a,1),c=s[0].default,setTimeout((function(){new c({container:t,graphic:r})}),100);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"componentWillLoad",value:function(){this.search&&this.search.destroy(),this.sections=[].concat()}},{key:"componentDidLoad",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadSearchWidget();case 2:return this.search=e.sent,e.next=5,this.loadGroup(this.groupId);case 5:return t=e.sent,e.next=8,this.loadMaps(t);case 8:n=e.sent,this.search.on("search-complete",(function(e){e.results.length&&r.searchMapLayers(e.results[0].results[0].feature.geometry,n)}));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disconnectedCallback",value:function(){document.getElementById("councilDiv").innerHTML=""}},{key:"render",value:function(){var e=this;return(0,u.h)(u.H,null,(0,u.h)("div",{class:"t-sky o-layout-v-inset--tight o-layout-h-inset"},(0,u.h)("div",{ref:function(t){return e.searchDiv=t}}),(0,u.h)("div",{class:"o-layout-sidebar-after o-layout-sidebar-after--tight"},this.council&&this.councilInfo&&(0,u.h)("div",null,this.councilInfo.map((function(t){return(0,u.h)("div",{id:"councilDiv",ref:function(n){e.councilDiv=n,e.loadFeatureWidget(e.councilDiv,t)}})}))),(0,u.h)("ol",{class:this.council?"o-layout-grid o-layout-grid--3  o-layout-sidebar-after__primary":"o-layout-grid o-layout-grid--3"},this.sections.map((function(t){return(0,u.h)("li",{class:"o-layout-grid__item"},(0,u.h)("div",null,(0,u.h)("h3",null,t.title),t.layers.map((function(t){return t.features.length>0?(0,u.h)("div",null,t.features.map((function(n,r){if(!e.council||!t.title.toLowerCase().includes("council"))return(0,u.h)("div",{id:t.id+"_"+r,ref:function(t){return e.loadFeatureWidget(t,n)}})}))):(0,u.h)("div",{class:"esri-feature esri-widget"},(0,u.h)("h2",{class:"esri-widget__heading esri-feature__title",role:"heading","aria-level":"2"},t.title),(0,u.h)("div",{class:"esri-feature__text esri-feature__content-element"},(0,u.h)("div",{class:"esri-feature__main-container"},"Service not provided for this address")))}))))}))))))}}]),e}();l.style="@import url('https://js.arcgis.com/4.25/@arcgis/core/assets/esri/themes/light/main.css');:host{display:block}input,textarea{font-size:0.88889rem !important;border:1px solid #999 !important;border-top-color:#333 !important;max-width:100% !important;padding:0.5rem 0.66667rem !important;-webkit-transition:all .2s ease-out !important;transition:all .2s ease-out !important}input:focus,textarea:focus{line-height:22px !important}.esri-search__input-container{height:100% !important}.esri-feature__title{font-size:1rem;line-height:1.333;color:#01426A;font-family:'Typold W05',sans-serif;font-weight:500;margin:1em 0}@media (min-width: 37.5em){input,textarea{font-size:0.77778rem !important}}@media (min-width: 37.5em){input,textarea{padding:0.66667rem 1rem !important}}button,input,optgroup,select,textarea{color:inherit !important;font:inherit !important;margin:0 !important;font-size:1rem !important;color:#333 !important;font-family:'Merriweather', serif !important;width:100%}.esri-search{width:100% !important;flex-flow:row nowrap !important;justify-content:center !important;align-items:center !important;overflow:visible !important;line-height:22px !important;-webkit-transition:none !important;transition:none !important}.esri-search__submit-button{background-color:#4C8C2B !important;border:1px solid #4C8C2B !important;color:#fff !important;font-size:0.83333rem !important;font-family:'Typold W05', sans-serif !important;font-weight:500 !important;letter-spacing:.1em !important;line-height:1rem !important;padding:0.5rem 0.66667rem !important;text-transform:uppercase !important;height:50px !important;width:120px !important}.esri-input[type='text']{border:none !important;flex-flow:row nowrap !important;justify-content:center !important;align-items:center !important;overflow:visible !important;padding:12px 18px !important;-webkit-transition:none !important;transition:none !important;height:48px !important}.esri-input[type='text']:focus-within{-webkit-box-shadow:none !important;box-shadow:none !important;outline:none}.esri-search__input-container{border-top-color:#333 !important;border:1px solid #999 !important}.esri-search__input-container:focus-within{border-color:#01426A !important;-webkit-box-shadow:0 1px 5px 2px rgba(1, 66, 106, 0.25) !important;box-shadow:0 1px 5px 2px rgba(1, 66, 106, 0.25) !important;outline:none !important}.esri-menu__list-item{color:#333;font-family:'Merriweather', serif !important}.esri-icon-search:before{content:'SEARCH' !important;background-color:#4C8C2B;border:1px solid #4C8C2B;color:#fff;font-size:0.83333rem;font-family:'Typold W05', sans-serif;font-weight:500;letter-spacing:.1em;line-height:1rem;padding:0.5rem 0.66667rem;text-transform:uppercase}.esri-feature{background:none !important;font-family:'Merriweather', serif !important}@media (min-width: 37.5em){body{font-size:1rem !important}}.esri-search__clear-button:hover{background:none !important}.esri-icon-close{height:100%}h2.esri-widget__heading{color:#01426A;font-family:\"Typold W05\",sans-serif}"}}]);
//# sourceMappingURL=7393.70018ef3.chunk.js.map