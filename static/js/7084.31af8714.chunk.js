"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[7084],{55540:function(e,t,n){n.d(t,{i:function(){return c}});var i=n(15671),r=n(43144),a=n(11752),s=n(61120),o=n(60136),l=n(29388),u=n(3441),c=function(e){(0,o.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"renderChildren",value:function(e){this.attributeView.bindTextures(e.context,!1),this.children.some((function(e){return e.hasData}))&&((0,a.Z)((0,s.Z)(n.prototype),"renderChildren",this).call(this,e),e.drawPhase===u.I.MAP&&this._renderChildren(e),this.hasHighlight()&&e.drawPhase===u.I.HIGHLIGHT&&this._renderHighlight(e),this._boundsRenderer&&this._boundsRenderer.doRender(e))}},{key:"_renderHighlight",value:function(e){var t=e.painter.effects.highlight;t.bind(e),this._renderChildren(e,t.defines),t.draw(e),t.unbind()}}]),n}(n(28372).t)},77084:function(e,t,n){n.r(t);var i=n(93433),r=n(1413),a=n(29439),s=n(37762),o=n(74165),l=n(15861),u=n(60136),c=n(29388),f=n(43144),h=n(15671),p=n(50165),y=n(13994),d=n(40133),v=n(73627),m=n(96263),g=n(98643),b=n(77322),w=n(1809),_=n(51613),k=n(42094),V=n(73151),x=n(34780),S=n(35744),I=n(55540),Z=n(28372),P=n(60470),C=(n(2760),n(73428),n(61340),n(31278),n(61772),n(79146),n(76375),n(32335),n(98496),n(4483),n(33530),n(79747),n(42),n(52155),n(75662),n(17493),n(9330),n(97823),n(49350),n(62980),n(16377),n(9887),n(88406),n(66307),n(42488),n(3029),n(42687),n(78330),n(78697),n(84539),n(89354),n(16897),n(47642),n(89031),n(78664),n(63334),n(83172),n(38419),n(84231),n(38665),n(32717),n(59075),n(17691),n(39853),n(94872),n(3969),n(82046),n(49961),n(31412),n(22984),n(69738),n(96401),n(68634),n(73393),n(87110),n(72577),n(92870),n(26079),n(15508),n(48561),n(55269),n(86931),n(80392),n(10489),n(62298),n(2815),n(2326),n(90339),n(53089),n(66270),n(60418),n(75366),n(5233),n(36235),n(57439),n(43895),n(30594),n(73267),n(22628),n(24982),n(46584),n(7093),n(85966),n(28003),n(49796),n(58428),n(8049),n(80933),n(40858),n(95076),n(56389),n(86738),n(69205),n(50338),n(33074),n(31134),n(41524),n(68668),n(55916),n(66319),n(24781),n(2329),n(37243),n(97345),n(39001),n(84913),n(84823),n(9411),n(14826),n(64620),n(22225),n(75272),n(4197),n(86905),n(64997),n(26208),n(2816),n(46237),n(98428),n(5792),n(67871),n(75097),n(47672),n(83745),n(87833),n(21523),n(84192),n(99057),n(26995),n(99797),n(6819),n(47692),n(35341),n(25346),n(50463),n(48968),n(45578),n(3441),n(94640),n(14023),n(27969),n(77372),n(66281),n(69754),n(38802),n(48308),n(14527),n(3096),n(66156),n(33265),n(20592),n(44365),n(77006),n(29648),n(35650),n(7513),n(48606),n(68792),n(49510),n(6927),n(82909),n(95734),n(25593),n(69379),n(22494),n(18392),n(89324),n(6283),n(98057),n(20422),n(38969),n(75105),n(25715),n(51386),n(81044),n(40100),n(88533),n(77639),n(13089),n(49862),n(37783),(0,f.Z)((function e(){(0,h.Z)(this,e),this.allSublayers=new Map,this.allPoints=[],this.allPolylines=[],this.allPolygons=[],this.allMapImages=[]}))),M=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;return(0,h.Z)(this,n),(e=t.apply(this,arguments))._bitmapIndex=new Map,e._mapImageContainer=new x.t,e._kmlVisualData=new C,e.allVisiblePoints=new k.c,e.allVisiblePolylines=new k.c,e.allVisiblePolygons=new k.c,e.allVisibleMapImages=new d.j,e}return(0,f.Z)(n,[{key:"hitTest",value:function(){var e=(0,l.Z)((0,o.Z)().mark((function e(t,n){var i,r,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.layer,e.abrupt("return",[null===(i=this._pointsView)||void 0===i?void 0:i.hitTest(t),null===(r=this._polylinesView)||void 0===r?void 0:r.hitTest(t),null===(a=this._polygonsView)||void 0===a?void 0:a.hitTest(t)].flat().filter(Boolean).map((function(e){return e.layer=s,e.sourceLayer=s,{type:"graphic",graphic:e,layer:s,mapPoint:t}})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"update",value:function(e){this._polygonsView&&this._polygonsView.processUpdate(e),this._polylinesView&&this._polylinesView.processUpdate(e),this._pointsView&&this._pointsView.processUpdate(e)}},{key:"attach",value:function(){var e=this;this._fetchController=new AbortController,this.container.addChild(this._mapImageContainer),this._polygonsView=new Z.a({view:this.view,graphics:this.allVisiblePolygons,requestUpdateCallback:function(){return e.requestUpdate()},container:new I.i(this.view.featuresTilingScheme)}),this.container.addChild(this._polygonsView.container),this._polylinesView=new Z.a({view:this.view,graphics:this.allVisiblePolylines,requestUpdateCallback:function(){return e.requestUpdate()},container:new I.i(this.view.featuresTilingScheme)}),this.container.addChild(this._polylinesView.container),this._pointsView=new Z.a({view:this.view,graphics:this.allVisiblePoints,requestUpdateCallback:function(){return e.requestUpdate()},container:new I.i(this.view.featuresTilingScheme)}),this.container.addChild(this._pointsView.container),this.handles.add([this.allVisibleMapImages.on("change",(function(t){t.added.forEach((function(t){return e._addMapImage(t)})),t.removed.forEach((function(t){return e._removeMapImage(t)}))})),(0,v.l)((function(){return e.layer.visibleSublayers}),(function(t){var n,i=(0,s.Z)(e._kmlVisualData.allSublayers);try{for(i.s();!(n=i.n()).done;){var r=(0,a.Z)(n.value,2);r[0];r[1].visibility=0}}catch(f){i.e(f)}finally{i.f()}var o,l=(0,s.Z)(t);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=e._kmlVisualData.allSublayers.get(u.id);c&&(c.visibility=1)}}catch(f){l.e(f)}finally{l.f()}e._refreshCollections()}))]),this.updatingHandles.addPromise(this._fetchService(this._fetchController.signal))}},{key:"detach",value:function(){this._fetchController.abort(),this._fetchController=null,this._mapImageContainer.removeAllChildren(),this.container.removeAllChildren(),this._bitmapIndex.clear(),this._polygonsView&&(this._polygonsView.destroy(),this._polygonsView=null),this._polylinesView&&(this._polylinesView.destroy(),this._polylinesView=null),this._pointsView&&(this._pointsView.destroy(),this._pointsView=null)}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){this._polygonsView.viewChange(),this._polylinesView.viewChange(),this._pointsView.viewChange()}},{key:"moveEnd",value:function(){}},{key:"isUpdating",value:function(){return this._pointsView.updating||this._polygonsView.updating||this._polylinesView.updating}},{key:"_addMapImage",value:function(e){var t=this;(this.view.spatialReference.isWGS84||this.view.spatialReference.isWebMercator)&&(0,y.U)(e.href,{responseType:"image"}).then((function(n){var i=n.data,r=m.M.fromJSON(e.extent);(0,b.g)(r,t.view.spatialReference)&&(r=(0,b.M)(r,t.view.spatialReference));var a=new V.v(i,"standard");a.x=r.xmin,a.y=r.ymax,a.resolution=r.width/i.naturalWidth,a.rotation=e.rotation,t._mapImageContainer.addChild(a),t._bitmapIndex.set(e,a)}))}},{key:"_getViewDependentUrl",value:function(){var e=(0,l.Z)((0,o.Z)().mark((function e(t,n){var i,a,s,l,u,c,f,h,d,v,w,k,V,x,S,I,Z,P;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.viewFormat,a=t.viewBoundScale,s=t.httpQuery,!(0,p.r)(i)){e.next=20;break}if(!(0,p.t)(n)){e.next=4;break}throw new Error("Loading this network link requires a view state.");case 4:return e.next=6,(0,g.t)();case 6:if(!(0,p.r)(a)||1===a){e.next=11;break}(u=new m.M(n.extent)).expand(a),l=u,e.next=12;break;case 11:l=n.extent;case 12:return l=(0,g.r)(l,b.k.WGS84),c=(0,g.r)(l,b.k.WebMercator),f=l.xmin,h=l.xmax,d=l.ymin,v=l.ymax,w=n.size[0]*n.pixelRatio,k=n.size[1]*n.pixelRatio,V=Math.max(c.width,c.height),x={"[bboxWest]":f.toString(),"[bboxEast]":h.toString(),"[bboxSouth]":d.toString(),"[bboxNorth]":v.toString(),"[lookatLon]":l.center.x.toString(),"[lookatLat]":l.center.y.toString(),"[lookatRange]":V.toString(),"[lookatTilt]":"0","[lookatHeading]":n.rotation.toString(),"[lookatTerrainLon]":l.center.x.toString(),"[lookatTerrainLat]":l.center.y.toString(),"[lookatTerrainAlt]":"0","[cameraLon]":l.center.x.toString(),"[cameraLat]":l.center.y.toString(),"[cameraAlt]":V.toString(),"[horizFov]":"60","[vertFov]":"60","[horizPixels]":w.toString(),"[vertPixels]":k.toString(),"[terrainEnabled]":"0","[clientVersion]":y.c,"[kmlVersion]":"2.2","[clientName]":"ArcGIS API for JavaScript","[language]":"en-US"},S=function(e){for(var t in e)for(var n in x)e[t]=e[t].replace(n,x[n])},I=(0,y.l)(i),S(I),Z={},(0,p.r)(s)&&(Z=(0,y.l)(s),S(Z)),(P=(0,_.n)(t.href)).query=(0,r.Z)((0,r.Z)((0,r.Z)({},P.query),I),Z),e.abrupt("return","".concat(P.path,"?").concat((0,y.h)(I)));case 20:return e.abrupt("return",t.href);case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_fetchService",value:function(){var e=(0,l.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new C,e.next=3,this._loadVisualData(this.layer.url,n,t);case 3:this._kmlVisualData=n,this._refreshCollections();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_refreshCollections",value:function(){var e=this;this.allVisiblePoints.removeAll(),this.allVisiblePolylines.removeAll(),this.allVisiblePolygons.removeAll(),this.allVisibleMapImages.removeAll(),this.allVisiblePoints.addMany(this._kmlVisualData.allPoints.filter((function(t){return e._isSublayerVisible(t.sublayerId)})).map((function(e){return e.item}))),this.allVisiblePolylines.addMany(this._kmlVisualData.allPolylines.filter((function(t){return e._isSublayerVisible(t.sublayerId)})).map((function(e){return e.item}))),this.allVisiblePolygons.addMany(this._kmlVisualData.allPolygons.filter((function(t){return e._isSublayerVisible(t.sublayerId)})).map((function(e){return e.item}))),this.allVisibleMapImages.addMany(this._kmlVisualData.allMapImages.filter((function(t){return e._isSublayerVisible(t.sublayerId)})).map((function(e){return e.item})))}},{key:"_isSublayerVisible",value:function(e){var t=this._kmlVisualData.allSublayers.get(e);return!!t.visibility&&(-1===t.parentFolderId||this._isSublayerVisible(t.parentFolderId))}},{key:"_loadVisualData",value:function(e,t,n){var r=this;return this._fetchParsedKML(e,n).then(function(){var e=(0,l.Z)((0,o.Z)().mark((function e(a){var l,u,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=(0,s.Z)(a.sublayers),e.prev=1,c=(0,o.Z)().mark((function e(){var a,s,l,c,f,h,p,y,d,v;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f=u.value,t.allSublayers.set(f.id,f),!f.points){e.next=8;break}return e.next=5,(0,w.b)(f.points);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:if(h=e.t0,!f.polylines){e.next=16;break}return e.next=13,(0,w.b)(f.polylines);case 13:e.t1=e.sent,e.next=17;break;case 16:e.t1=[];case 17:if(p=e.t1,!f.polygons){e.next=24;break}return e.next=21,(0,w.b)(f.polygons);case 21:e.t2=e.sent,e.next=25;break;case 24:e.t2=[];case 25:if(y=e.t2,d=f.mapImages||[],(a=t.allPoints).push.apply(a,(0,i.Z)(h.map((function(e){return{item:e,sublayerId:f.id}})))),(s=t.allPolylines).push.apply(s,(0,i.Z)(p.map((function(e){return{item:e,sublayerId:f.id}})))),(l=t.allPolygons).push.apply(l,(0,i.Z)(y.map((function(e){return{item:e,sublayerId:f.id}})))),(c=t.allMapImages).push.apply(c,(0,i.Z)(d.map((function(e){return{item:e,sublayerId:f.id}})))),!f.networkLink){e.next=33;break}return e.next=30,r._getViewDependentUrl(f.networkLink,r.view.state);case 30:return v=e.sent,e.next=33,r._loadVisualData(v,t,n);case 33:case"end":return e.stop()}}),e)})),l.s();case 4:if((u=l.n()).done){e.next=8;break}return e.delegateYield(c(),"t0",6);case 6:e.next=4;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(1),l.e(e.t1);case 13:return e.prev=13,l.f(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,10,13,16]])})));return function(t){return e.apply(this,arguments)}}())}},{key:"_fetchParsedKML",value:function(e,t){return(0,w.g)(e,this.view.spatialReference,this.layer.refreshInterval,t).then((function(e){return(0,w.d)(e.data)}))}},{key:"_removeMapImage",value:function(e){var t=this._bitmapIndex.get(e);t&&(this._mapImageContainer.removeChild(t),this._bitmapIndex.delete(e))}}]),n}((0,S.f)(P.u));(0,p.e)([(0,p.d)()],M.prototype,"_pointsView",void 0),(0,p.e)([(0,p.d)()],M.prototype,"_polylinesView",void 0),(0,p.e)([(0,p.d)()],M.prototype,"_polygonsView",void 0),(0,p.e)([(0,p.d)()],M.prototype,"updating",void 0);var G=M=(0,p.e)([(0,p.n)("esri.views.2d.layers.KMLLayerView2D")],M);t.default=G},1809:function(e,t,n){n.d(t,{S:function(){return m},b:function(){return b},d:function(){return d},g:function(){return v},j:function(){return _}});var i=n(74165),r=n(15861),a=n(37762),s=n(50165),o=n(13994),l=n(98496),u=n(77322),c=n(9330),f=n(31278),h=n(97823),p=n(82046),y={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};function d(e){var t=e.folders||[],n=t.slice(),i=new Map,r=new Map,o=new Map,l=new Map,u=new Map,c={esriGeometryPoint:r,esriGeometryPolyline:o,esriGeometryPolygon:l};(e.featureCollection&&e.featureCollection.layers||[]).forEach((function(e){var t=(0,s.m)(e);t.featureSet.features=[];var n=e.featureSet.geometryType;i.set(n,t);var a=e.layerDefinition.objectIdField;"esriGeometryPoint"===n?g(r,a,e.featureSet.features):"esriGeometryPolyline"===n?g(o,a,e.featureSet.features):"esriGeometryPolygon"===n&&g(l,a,e.featureSet.features)})),e.groundOverlays&&e.groundOverlays.forEach((function(e){u.set(e.id,e)})),t.forEach((function(t){t.networkLinkIds.forEach((function(i){var r=function(e,t,n){var i=function(e,t){var n;return t.some((function(t){return t.id===e&&(n=t,!0)})),n}(e,n);return i&&(i.parentFolderId=t,i.networkLink=i),i}(i,t.id,e.networkLinks);r&&n.push(r)}))})),n.forEach((function(e){if(e.featureInfos){e.points=(0,s.m)(i.get("esriGeometryPoint")),e.polylines=(0,s.m)(i.get("esriGeometryPolyline")),e.polygons=(0,s.m)(i.get("esriGeometryPolygon")),e.mapImages=[];var t,n=(0,a.Z)(e.featureInfos);try{for(n.s();!(t=n.n()).done;){var r=t.value;switch(r.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":var o=c[r.type].get(r.id);o&&e[y[r.type]].featureSet.features.push(o);break;case"GroundOverlay":var l=u.get(r.id);l&&e.mapImages.push(l)}}}catch(f){n.e(f)}finally{n.f()}e.fullExtent=_([e])}}));var f=_(n);return{folders:t,sublayers:n,extent:f}}function v(e,t,n,i){var r=o.a&&o.a.findCredential(e);e=(0,o.B)(e,{token:r&&r.token});var a=s.f.kmlServiceUrl;return(0,o.U)(a,{query:{url:e,model:"simple",folders:"",refresh:0!==n||void 0,outSR:JSON.stringify(t)},responseType:"json",signal:i})}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=[],a={},s=t.sublayers,o=t.folders.map((function(e){return e.id}));return s.forEach((function(t){var s=new e;if(n?s.read(t,n):s.read(t),i.length&&o.includes(s.id)&&(s.visible=i.includes(s.id)),a[t.id]=s,null!=t.parentFolderId&&-1!==t.parentFolderId){var l=a[t.parentFolderId];l.sublayers||(l.sublayers=[]),l.sublayers.unshift(s)}else r.unshift(s)})),r}function g(e,t,n){n.forEach((function(n){e.set(n.attributes[t],n)}))}function b(e){return w.apply(this,arguments)}function w(){return(w=(0,r.Z)((0,i.Z)().mark((function e(t){var n,r,s,o,u,c,f,y,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=p.default.fromJSON(t.featureSet).features,r=t.layerDefinition,s=(0,h.t)(r.drawingInfo.renderer),o=l.B.fromJSON(t.popupInfo),u=[],c=(0,a.Z)(n),e.prev=2,c.s();case 4:if((f=c.n()).done){e.next=12;break}return y=f.value,e.next=8,s.getSymbolAsync(y);case 8:d=e.sent,y.symbol=d,y.popupTemplate=o,y.visible=!0,u.push(y);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),c.e(e.t0);case 17:return e.prev=17,c.f(),e.finish(17);case 20:return e.abrupt("return",u);case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})))).apply(this,arguments)}function _(e){var t,n=(0,c.a)(c.D),i=(0,c.a)(c.D),r=(0,a.Z)(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;if(s.polygons&&s.polygons.featureSet&&s.polygons.featureSet.features){var o,l=(0,a.Z)(s.polygons.featureSet.features);try{for(l.s();!(o=l.n()).done;){var h=o.value;(0,f.j)(n,h.geometry),(0,c.f)(i,n)}}catch(k){l.e(k)}finally{l.f()}}if(s.polylines&&s.polylines.featureSet&&s.polylines.featureSet.features){var p,y=(0,a.Z)(s.polylines.featureSet.features);try{for(y.s();!(p=y.n()).done;){var d=p.value;(0,f.j)(n,d.geometry),(0,c.f)(i,n)}}catch(k){y.e(k)}finally{y.f()}}if(s.points&&s.points.featureSet&&s.points.featureSet.features){var v,m=(0,a.Z)(s.points.featureSet.features);try{for(m.s();!(v=m.n()).done;){var g=v.value;(0,f.j)(n,g.geometry),(0,c.f)(i,n)}}catch(k){m.e(k)}finally{m.f()}}if(s.mapImages){var b,w=(0,a.Z)(s.mapImages);try{for(w.s();!(b=w.n()).done;){var _=b.value;(0,f.j)(n,_.extent),(0,c.f)(i,n)}}catch(k){w.e(k)}finally{w.f()}}}}catch(k){r.e(k)}finally{r.f()}return(0,c.k)(i,c.D)?null:{xmin:i[0],ymin:i[1],zmin:i[2],xmax:i[3],ymax:i[4],zmax:i[5],spatialReference:u.k.WGS84}}}}]);
//# sourceMappingURL=7084.31af8714.chunk.js.map