"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[9151],{3226:function(e,r,t){t.d(r,{d:function(){return v}});var n,i=t(15671),a=t(43144),u=t(60136),s=t(29388),l=t(23132),o=t(80175),d=t(38843),c=(t(75610),t(23860)),y={type:o.j,readOnly:!0,json:{origins:{service:{read:{source:"sublayers",reader:p}}},read:!1}};function p(e,r,t){if(e&&Array.isArray(e))return new o.j(e.map((function(e){var r=function(e){return"group"===e.layerType?h:c.E}(e);if(r){var n=new r;return n.read(e,t),n}t&&t.messages&&e&&t.messages.push(new l.G("building-scene-layer:unsupported-sublayer-type","Building scene sublayer of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:t}))})))}var f,h=n=function(e){(0,u.Z)(t,e);var r=(0,s.Z)(t);function t(e){var n;return(0,i.Z)(this,t),(n=r.call(this,e)).type="building-group",n.listMode="show",n.sublayers=null,n}return(0,a.Z)(t,[{key:"loadAll",value:function(){var e=this;return(0,d.i)(this,(function(r){return n.forEachSublayer(e.sublayers,(function(e){"building-group"!==e.type&&r(e)}))}))}}]),t}(c.n);(0,l.e)([(0,l.d)({type:["hide","show","hide-children"],json:{write:!0}})],h.prototype,"listMode",void 0),(0,l.e)([(0,l.d)(y)],h.prototype,"sublayers",void 0),h=n=(0,l.e)([(0,l.n)("esri.layers.buildingSublayers.BuildingGroupSublayer")],h),(f=h||(h={})).sublayersProperty=y,f.readSublayers=p,f.forEachSublayer=function e(r,t){r.forEach((function(r){t(r),"building-group"===r.type&&e(r.sublayers,t)}))};var v=h},29151:function(e,r,t){t.r(r);var n,i,a=t(74165),u=t(15861),s=t(93433),l=t(37762),o=t(29439),d=t(11752),c=t(61120),y=t(1413),p=t(15671),f=t(43144),h=t(60136),v=t(29388),g=t(23132),b=t(83822),w=t(80175),k=t(75610),m=t(36551),F=(t(3226),t(81019)),_=(t(23860),t(25838)),x=t(50526),E=t(34860),Z=t(97033),I=t(77196),S=t(43920),V=t(40023),C=t(3969),M=t(58687),L=t(91309),A=t(39149),P=t(28930),O=t(42152),R=t(14181),q=t(3964),Q=t(5900),N=(t(91204),t(80262),t(30709),t(70441),t(36460),t(57714),t(51451),t(50448),t(41742),t(1773),t(24980),t(3114),t(22144),t(78674),t(66307),t(2760),t(88370),t(72820),t(78311),t(96349),t(9055),t(79611),t(2157),t(30604),t(21583),t(38843),t(38304),t(67154),t(96636),t(79054),t(29709),t(47642),t(18411),t(36638),t(44455),t(43782),t(33976),t(407),t(28210),t(17436),t(25316),t(77389),t(53373),t(94872),t(74575),t(77470),t(9575),t(53249),t(43124),t(69797),t(83996),t(72763),t(6794),t(33703),t(49580),t(54841),t(28999),t(69953),t(15612),t(28681),t(38929),t(97866),t(68890),t(83024),t(61340),t(31513),t(28623),t(10312),t(95254),t(61099),t(12158),t(93874),t(62446),t(27264),t(50905),t(78945),t(55827),t(54539),t(19967),t(50338),t(70516),t(25279),t(22268),t(10590),t(40452),t(94835),t(20852),t(45246),t(48561),t(96401),t(40273),t(84538),t(92870),t(72692),t(55269),t(32568),t(69202),t(27597),t(1241),t(67417),t(15181),t(33642),t(19948),t(30664),t(47626),t(79042),t(61495),t(16485),t(92029),t(60424),t(22225),t(38425),t(42471),t(78470),t(1665),t(24892),t(48889),t(30150),t(53647),t(81663),t(86270),t(47672),t(63022),t(10815),t(87833),t(21523),t(84192),t(71710),t(45332),t(57952),t(48466),t(86148),t(60912),t(68528),t(55806),t(44344),t(71573),t(64571),t(94867),t(45414),t(6819),t(58394),t(20005),t(62400),t(16936),t(84452),t(63662),t(86068),t(75370),t(62268),t(18392),t(97627),t(64296),t(14432),t(6243),t(37783),t(74021),t(56864),t(64004),t(21924),t(13425),t(21165),t(21984),t(50982),t(83262),t(32990),t(83059),t(4720),t(90138),t(97566),t(61349),t(2822),t(52376),t(48373),t(61473),t(14946),t(44365),t(90584),t(98907),t(66156),t(10534),t(25459),t(78556),t(77787),t(85511),t(87603),t(22051),t(46123),t(75777),t(76071),t(42446),t(59819),t(25715),t(20880),t(73554),t(68826),t(61212),t(83712),t(7513),t(75955),t(14739),t(10780),function(e,r){var t=function(e){(0,h.Z)(t,e);var r=(0,v.Z)(t);function t(e){var n;return(0,p.Z)(this,t),(n=r.call(this,e)).sublayer=null,n.parent=null,n.view=null,n}return(0,f.Z)(t,[{key:"initialize",value:function(){}},{key:"suspended",get:function(){return!this.canResume()}},{key:"updating",get:function(){return!this.suspended&&this.isUpdating()}},{key:"visible",get:function(){return!0===this.get("sublayer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")}},{key:"fullOpacity",get:function(){var e=function(e){return null!=e?e:1};return e(this.get("sublayer.opacity"))*e(this.get("parent.fullOpacity"))}},{key:"canResume",value:function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.visible||!1}},{key:"isUpdating",value:function(){return!1}}]),t}((0,S.m)((0,Z.a)((0,I.s)(w.n.EventedMixin(e)))));return(0,g.e)([(0,g.d)()],t.prototype,"sublayer",void 0),(0,g.e)([(0,g.d)()],t.prototype,"parent",void 0),(0,g.e)([(0,g.d)({readOnly:!0})],t.prototype,"suspended",null),(0,g.e)([(0,g.d)({type:Boolean,readOnly:!0})],t.prototype,"updating",null),(0,g.e)([(0,g.d)()],t.prototype,"view",void 0),(0,g.e)([(0,g.d)()],t.prototype,"visible",null),(0,g.e)([(0,g.d)()],t.prototype,"fullOpacity",null),t=(0,g.e)([(0,g.n)("esri.views.3d.layers.BuildingSublayerView3D")],t)});(i=n||(n={}))[i.Solid=0]="Solid",i[i.WireFrame=1]="WireFrame",i[i.XRay=2]="XRay";function G(e){switch(e.filterMode.type){case"solid":return{mode:n.Solid};case"wire-frame":return{mode:n.WireFrame,edgeMaterial:(0,M.I)(e.filterMode.edges,{})};case"x-ray":return{mode:n.XRay}}}function j(e,r){if((0,k.t)(r))return e.color[3]=0,e.edgeMaterial=null,void(e.pickable=!1);switch(r.mode){case n.Solid:return;case n.WireFrame:return e.color[3]=0,e.edgeMaterial=r.edgeMaterial,void(e.pickable=!1);case n.XRay:return e.color[0]=1,e.color[1]=1,e.color[2]=1,e.color[3]*=.15,e.colorMixMode=L.b4.Replace,e.castShadows=!1,e.pickable=!1,void(e.edgeMaterial=(t=e.edgeMaterial,(0,k.t)(t)?null:(B.lastMaterial!==t&&(B.cachedMaterial=function(e){var r=(0,C.t)(e.color);return r[3]*=.075,(0,y.Z)((0,y.Z)({},e),{},{color:r})}(t),B.lastMaterial=t),B.cachedMaterial)))}var t}var B={cachedMaterial:null,lastMaterial:null},U=function(e){(0,h.Z)(t,e);var r=(0,v.Z)(t);function t(){var e;return(0,p.Z)(this,t),(e=r.apply(this,arguments)).sublayer=null,e}return(0,f.Z)(t,[{key:"updating",get:function(){return!1}},{key:"suspended",get:function(){return!1}},{key:"availableFields",get:function(){return[]}},{key:"filter",get:function(){return null},set:function(e){throw new Error("Not implemented")}},{key:"queryFeatures",value:function(e,r){throw new Error("Not implemented")}},{key:"queryObjectIds",value:function(e,r){throw new Error("Not implemented")}},{key:"queryFeatureCount",value:function(e,r){throw new Error("Not implemented")}},{key:"createQuery",value:function(){throw new Error("Not implemented")}},{key:"queryExtent",value:function(e,r){throw new Error("Not implemented")}},{key:"highlight",value:function(e){throw new Error("Not implemented")}}]),t}(g.y);(0,g.e)([(0,g.d)()],U.prototype,"sublayer",void 0),(0,g.e)([(0,g.d)()],U.prototype,"availableFields",null),(0,g.e)([(0,g.d)()],U.prototype,"filter",null);var T=g.s.getLogger("esri.views.3d.layers.BuildingComponentSublayerView3D"),D=function(e){(0,h.Z)(t,e);var r=(0,v.Z)(t);function t(){var e;return(0,p.Z)(this,t),(e=r.apply(this,arguments)).type="building-component-sublayer-3d",e.layerView=null,e._elevationContext="scene",e._isIntegratedMesh=!1,e._supportsLabeling=!1,e.lodFactor=1,e.progressiveLoadFactor=1,e._queryEngine=null,e}return(0,f.Z)(t,[{key:"layerUid",get:function(){return this.sublayer.layer.uid}},{key:"sublayerUid",get:function(){return this.sublayer.uid}},{key:"initialize",value:function(){var e=this;this.updatingHandles.add((function(){return[e.sublayer.renderer,e.definitionExpressionFields,e.filterExpressionFields]}),(function(){return e._updateRequiredFields()})),this.updatingHandles.add((function(){return e.sublayer.renderer}),(function(r){return e._rendererChange(r)}),m.h),this.updatingHandles.add((function(){return[e.parsedDefinitionExpression,e.filter,(0,k.h)(e._filter,(function(e){return[e.parsedWhereClause,e.parsedGeometry,e.sortedObjectIds]}))]}),(function(){return e._filterChange()})),this.updatingHandles.add((function(){return e.parsedFilterExpressions}),(function(){return e._updateSymbologyOverride()}),m.h),this.addResolvingPromise(this._updateRequiredFields())}},{key:"parsedFilterExpressions",get:function(){var e=this;return"Overview"===this.sublayer.modelName?[]:this.layerView.filterExpressions.map((function(r){var t,i=(0,o.Z)(r,2),a=i[0],u=i[1];try{t=F.WhereClause.create(a,e.sublayer.fieldsIndex)}catch(n){return T.error("Failed to parse filterExpression: "+n),null}if(!t.isStandardized)return T.error("filterExpression is using non standard function"),null;var s=[],l=t.fieldNames;return(0,M.J)(l,e.sublayer.fields,{missingFields:s}),s.length>0?(T.error("filterExpression references unknown fields: ".concat(s.join(", "))),null):[t,u]})).filter((function(e){return null!=e}))}},{key:"filter",get:function(){return(0,k.r)(this._filter)?this._filter.viewFilter:null},set:function(e){var r=this;!(0,k.t)(e)&&A.C.checkSupport(e)?(0,k.r)(this._filter)?this._filter.viewFilter=e:this._filter=new A.C({viewFilter:e,layerFieldsIndex:this.sublayer.fieldsIndex,loadAsyncModule:function(e){return r._loadAsyncModule(e)},applyFilters:function(){return r._applyFilters(!0)},addSqlFilter:function(e,t){return r.addSqlFilter(e,t,r.logError)}}):this._filter=null}},{key:"_updateSymbologyOverride",value:function(){var e=this,r=this.parsedFilterExpressions;r.length>0?this._setSymbologyOverride((function(t,n){var i,a=(0,l.Z)(r);try{for(a.s();!(i=a.n()).done;){var u=(0,o.Z)(i.value,2),s=u[0],d=u[1];try{if(s.testFeature(t))return j(n,d)}catch(c){e.logError(c)}}}catch(y){a.e(y)}finally{a.f()}return j(n,null)}),this.filterExpressionFields):this._setSymbologyOverride(null,null)}},{key:"filterExpressionFields",get:function(){return(0,x.y)(this.sublayer.fieldsIndex,this.parsedFilterExpressions.reduce((function(e,r){var t=(0,o.Z)(r,1)[0];return e.concat(t.fieldNames)}),[]))}},{key:"availableFields",get:function(){var e=this.sublayer,r=e.fieldsIndex,t=this.requiredFields;if(e.outFields||e.layer.outFields){var n=[].concat((0,s.Z)(e.outFields||[]),(0,s.Z)(e.layer.outFields||[]));t=[].concat((0,s.Z)((0,x.I)(r,n)),(0,s.Z)(t))}return(0,x.y)(r,t)}},{key:"_createLayerGraphic",value:function(e){var r=new b.g(null,null,e);return r.layer=this.sublayer.layer,r.sourceLayer=this.sublayer,r}},{key:"canResume",value:function(){return(0,d.Z)((0,c.Z)(t.prototype),"canResume",this).call(this)&&(!this._controller||this._controller.rootNodeVisible)}},{key:"fetchPopupFeatures",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(r,t){var n,i,u,s,o,d,c,y,p;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._validateFetchPopupFeatures(t))){e.next=3;break}throw n;case 3:if(!(0,k.t)(t)&&t.clientGraphics&&0!==t.clientGraphics.length){e.next=5;break}return e.abrupt("return",[]);case 5:if(i=[],u=[],!(0,k.r)(this.sublayer.associatedLayer)){e.next=13;break}return e.next=10,this.sublayer.associatedLayer.load();case 10:e.t0=e.sent,e.next=14;break;case 13:e.t0=this.sublayer;case 14:return s=e.t0,e.t1=x.I,e.t2=this.sublayer.fieldsIndex,e.next=19,(0,O.d)(s,(0,O.s)(this.sublayer,t));case 19:e.t3=e.sent,o=(0,e.t1)(e.t2,e.t3),d=new Set,c=(0,l.Z)(t.clientGraphics);try{for(c.s();!(y=c.n()).done;)p=y.value,(0,x.p)(o,p,d)?u.push(p):i.push(p)}catch(r){c.e(r)}finally{c.f()}if(0!==u.length){e.next=28;break}e.t4=i,e.next=33;break;case 28:if(e.t5=(0,k.r)(this.sublayer.associatedLayer),!e.t5){e.next=32;break}return e.next=32,this.sublayer.associatedLayer.load().catch((function(){return T.warn("Failed to load associated feature layer. Displaying popup attributes from cached attributes.")}));case 32:e.t4=this.whenGraphicAttributes(u,Array.from(d)).catch((function(){return u})).then((function(e){return i.concat(e)}));case 33:return e.abrupt("return",e.t4);case 34:case"end":return e.stop()}}),e,this)})));return function(r,t){return e.apply(this,arguments)}}()},{key:"_updateRequiredFields",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=x.y,e.t1=this.sublayer.fieldsIndex,e.t2=[],e.t3=s.Z,!this.sublayer.renderer){e.next=10;break}return e.next=7,this.sublayer.renderer.getRequiredFields(this.sublayer.fieldsIndex);case 7:e.t4=e.sent,e.next=11;break;case 10:e.t4=[];case 11:e.t5=e.t4,e.t6=(0,e.t3)(e.t5),e.t7=(0,s.Z)(this.definitionExpressionFields||[]),e.t8=(0,s.Z)(this.filterExpressionFields||[]),e.t9=e.t2.concat.call(e.t2,e.t6,e.t7,e.t8),r=(0,e.t0)(e.t1,e.t9),this._set("requiredFields",r);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_validateFetchPopupFeatures",value:function(e){var r=this.sublayer;return r.popupEnabled?(0,O.s)(r,e)?void 0:new g.a("buildingscenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{sublayer:r}):new g.a("buildingscenelayerview3d:fetchPopupFeatures","Popups are disabled",{sublayer:r})}},{key:"getFilters",value:function(){var e=(0,d.Z)((0,c.Z)(t.prototype),"getFilters",this).call(this);return this.addSqlFilter(e,this.parsedDefinitionExpression,this.logError),(0,k.r)(this._filter)&&this._filter.addFilters(e,this.view,this._controller.crsIndex,this._collection),e}},{key:"createQuery",value:function(){var e={outFields:["*"],returnGeometry:!1,outSpatialReference:this.view.spatialReference};return(0,k.r)(this.filter)?this.filter.createQuery(e):new E.b(e)}},{key:"queryExtent",value:function(e,r){return this._ensureQueryEngine().executeQueryForExtent(this._ensureQuery(e),null===r||void 0===r?void 0:r.signal)}},{key:"queryFeatureCount",value:function(e,r){return this._ensureQueryEngine().executeQueryForCount(this._ensureQuery(e),null===r||void 0===r?void 0:r.signal)}},{key:"queryFeatures",value:function(e,r){var t=this;return this._ensureQueryEngine().executeQuery(this._ensureQuery(e),null===r||void 0===r?void 0:r.signal).then((function(e){if(null===e||void 0===e||!e.features)return e;var r,n=t.sublayer,i=n.layer,a=(0,l.Z)(e.features);try{for(a.s();!(r=a.n()).done;){var u=r.value;u.layer=i,u.sourceLayer=n}}catch(s){a.e(s)}finally{a.f()}return e}))}},{key:"queryObjectIds",value:function(e,r){return this._ensureQueryEngine().executeQueryForIds(this._ensureQuery(e),null===r||void 0===r?void 0:r.signal)}},{key:"_ensureQueryEngine",value:function(){return(0,k.t)(this._queryEngine)&&(this._queryEngine=this._createQueryEngine()),this._queryEngine}},{key:"_createQueryEngine",value:function(){var e=this,r=(0,V.u)(this.view.spatialReference,this.view.renderSpatialReference,this._collection);return new A.p({layerView:this,priority:R.L.FEATURE_QUERY_ENGINE,spatialIndex:new A.f({featureAdapter:new A.n({objectIdField:this.sublayer.objectIdField,attributeStorageInfo:this.sublayer.attributeStorageInfo,getFeatureExtent:r}),toArray:function(){var r=new Array;return e._forAllFeatures((function(e,t,n){return r.push({id:e,index:t,meta:n}),V.L.CONTINUE}),null,V.I.ALL_IN_CLIPPING_AREA),r},forAllFeatures:function(r,t){return e._forAllFeatures((function(e,t,n){return r({id:e,index:t,meta:n})}),t,V.I.ALL_IN_CLIPPING_AREA)},getFeatureExtent:r,sourceSpatialReference:(0,M.K)(this.sublayer),viewSpatialReference:this.view.spatialReference})})}},{key:"_ensureQuery",value:function(e){return this._addDefinitionExpressionToQuery((0,k.t)(e)?this.createQuery():E.b.from(e))}}]),t}((0,P.p)((0,V.p)(N(U))));(0,g.e)([(0,g.d)({aliasOf:"sublayer"})],D.prototype,"i3slayer",void 0),(0,g.e)([(0,g.d)()],D.prototype,"layerView",void 0),(0,g.e)([(0,g.d)()],D.prototype,"suspended",void 0),(0,g.e)([(0,g.d)({readOnly:!0,aliasOf:"view.qualitySettings.sceneService.3dObject.lodFactor"})],D.prototype,"lodFactor",void 0),(0,g.e)([(0,g.d)({readOnly:!0})],D.prototype,"parsedFilterExpressions",null),(0,g.e)([(0,g.d)({type:_.y})],D.prototype,"filter",null),(0,g.e)([(0,g.d)()],D.prototype,"_filter",void 0),(0,g.e)([(0,g.d)({type:[String],readOnly:!0})],D.prototype,"filterExpressionFields",null),(0,g.e)([(0,g.d)({type:[String],readOnly:!0})],D.prototype,"requiredFields",void 0),(0,g.e)([(0,g.d)({type:[String],readOnly:!0})],D.prototype,"availableFields",null);var z=D=(0,g.e)([(0,g.n)("esri.views.3d.layers.BuildingComponentSublayerView3D")],D),W=function(e){(0,h.Z)(t,e);var r=(0,v.Z)(t);function t(){var e;return(0,p.Z)(this,t),(e=r.apply(this,arguments)).layer=null,e.sublayerViews=null,e}return(0,f.Z)(t,[{key:"highlight",value:function(e){throw new Error("Not implemented")}}]),t}(Q.u);(0,g.e)([(0,g.d)()],W.prototype,"layer",void 0),(0,g.e)([(0,g.d)()],W.prototype,"sublayerViews",void 0);var H=g.s.getLogger("esri.views.3d.layers.BuildingSceneLayerView3D"),X=N(g.y),J=function(e){(0,h.Z)(t,e);var r=(0,v.Z)(t);function t(){var e;return(0,p.Z)(this,t),(e=r.apply(this,arguments)).type="building-scene-3d",e.sublayerViews=new w.j,e._abortController=new AbortController,e._loadingComponents=0,e}return(0,f.Z)(t,[{key:"filterExpression",get:function(){var e=this.layer.activeFilterId,r=null!=e?this.layer.filters.find((function(r){return r.id===e})):null,t=null!=r?r.filterBlocks.find((function(e){return"solid"===e.filterMode.type})):null;return t?t.filterExpression:null}},{key:"filterExpressions",get:function(){var e=this.layer.activeFilterId,r=null!=e?this.layer.filters.find((function(r){return r.id===e})):null;return r&&r.filterBlocks?r.filterBlocks.toArray().map((function(e){return[e.filterExpression,G(e)]})):[]}},{key:"updatingProgressValue",get:function(){var e=this.sublayerViews,r=this._loadingComponents+(e?e.length:0);return e.reduce((function(e,r){return e+r.updatingProgress}),0)/r}},{key:"isUpdating",value:function(){return this._loadingComponents>0||this.sublayerViews&&this.sublayerViews.some((function(e){return e.updating}))}},{key:"initialize",value:function(){(0,M.M)(this.layer.spatialReference,this.view.spatialReference,this.view.viewingMode),this._initializeSubLayerViews(this.layer.sublayers,this)}},{key:"destroy",value:function(){this.sublayerViews&&(this.sublayerViews.forEach((function(e){return e.destroy()})),this.sublayerViews=null),this._abortController.abort(),this._abortController=null}},{key:"_initializeSubLayerViews",value:function(e,r){var t=this,n=this,i=this.view;e.forEach((function(e){if(!e.isEmpty)if("building-group"===e.type){var a=new X({sublayer:e,view:i,parent:r});t._initializeSubLayerViews(e.sublayers,a)}else"mesh"===e.geometryType&&(t._loadingComponents++,e.load({signal:t._abortController.signal}).then((function(){var a=new z({sublayer:e,layerView:n,view:i,parent:r});t.sublayerViews.push(a),t.handles.add([(0,m.l)((function(){return a.updating}),(function(){return t.notifyChange("updating")}),m.w),(0,m.l)((function(){return a.updatingProgress}),(function(){return t.notifyChange("updatingProgressValue")}),m.w)])})).catch((function(r){(0,g.u)(r)||H.error("Error while creating view for sublayer ".concat(e.id,"\nLayer: ").concat(t.layer.url,"\n"),r)})).then((function(){t._loadingComponents--,t.notifyChange("updating"),t.notifyChange("updatingProgressValue")})))}))}},{key:"getGraphicFromIntersectorTarget",value:function(e){var r,t=(0,l.Z)(this.sublayerViews.items);try{for(t.s();!(r=t.n()).done;){var n=r.value;if(n.sublayer.uid===e.sublayerUid)return n.getGraphicFromIntersectorTarget(e)}}catch(i){t.e(i)}finally{t.f()}return null}},{key:"fetchPopupFeatures",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(r,t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,k.t)(t)&&t.clientGraphics&&0!==t.clientGraphics.length){e.next=2;break}return e.abrupt("return");case 2:return n=this._findComponent(t.clientGraphics[0].sourceLayer),e.abrupt("return",(0,k.t)(n)?void 0:n.fetchPopupFeatures(r,t));case 4:case"end":return e.stop()}}),e,this)})));return function(r,t){return e.apply(this,arguments)}}()},{key:"whenGraphicBounds",value:function(e){var r=this._findComponent(e.sourceLayer);return(0,k.t)(r)?Promise.reject():r.whenGraphicBounds(e)}},{key:"getAABBFromIntersectorTarget",value:function(e){var r,t=(0,l.Z)(this.sublayerViews.items);try{for(t.s();!(r=t.n()).done;){var n=r.value;if(n.sublayer.uid===e.sublayerUid)return n.getAABBFromIntersectorTarget(e)}}catch(i){t.e(i)}finally{t.f()}return null}},{key:"_findComponent",value:function(e){return this.sublayerViews.find((function(r){return e===r.sublayer}))}},{key:"highlight",value:function(e){e instanceof b.g?e=[e]:e instanceof w.j&&(e=e.toArray());var r=[];if(Array.isArray(e)&&e.length>0&&e[0]instanceof b.g){var t,n=e,i=new Map,a=(0,l.Z)(n);try{for(a.s();!(t=a.n()).done;){var u=t.value,s=i.get(u.sourceLayer);null==s&&(s=[],i.set(u.sourceLayer,s)),s.push(u)}}catch(o){a.e(o)}finally{a.f()}this.sublayerViews.forEach((function(e){var t=i.get(e.sublayer);t&&r.push(e.highlight(t))}))}return(0,g.h)(r)}},{key:"getUsedMemory",value:function(){return this.sublayerViews.reduce((function(e,r){return e+r.getUsedMemory()}),0)}},{key:"getUnloadedMemory",value:function(){return this.sublayerViews.reduce((function(e,r){return e+r.getUnloadedMemory()}),0)}},{key:"ignoresMemoryFactor",value:function(){return!1}}]),t}((0,q.n)(W));(0,g.e)([(0,g.d)()],J.prototype,"sublayerViews",void 0),(0,g.e)([(0,g.d)({readOnly:!0})],J.prototype,"filterExpression",null),(0,g.e)([(0,g.d)({readOnly:!0})],J.prototype,"filterExpressions",null),(0,g.e)([(0,g.d)(M.t)],J.prototype,"updatingProgress",void 0),(0,g.e)([(0,g.d)({readOnly:!0,dependsOn:[]})],J.prototype,"updatingProgressValue",null);var K=J=(0,g.e)([(0,g.n)("esri.views.3d.layers.BuildingSceneLayerView3D")],J);r.default=K},20852:function(e,r,t){t.d(r,{n:function(){return l}});var n=t(74165),i=t(15861),a=t(57714),u=t(23132),s=t(75610);function l(e,r,t,n,i,a){return o.apply(this,arguments)}function o(){return o=(0,i.Z)((0,n.Z)().mark((function e(r,t,i,l,o,d){var c,y,p,f,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=null,!(0,s.r)(i)){e.next=17;break}return y="".concat(r,"/nodepages/"),p=y+Math.floor(i.rootIndex/i.nodesPerPage),e.prev=3,e.next=6,(0,a.U)(p,{query:{f:"json",token:l},responseType:"json",signal:d});case 6:return e.t0=e.sent.data,e.t1=i.rootIndex,e.t2=i.nodesPerPage,e.t3=i.lodSelectionMetricType,e.t4=y,e.abrupt("return",{type:"page",rootPage:e.t0,rootIndex:e.t1,pageSize:e.t2,lodMetric:e.t3,urlPrefix:e.t4});case 14:e.prev=14,e.t5=e.catch(3),(0,s.r)(o)&&o.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",p,e.t5),c=e.t5;case 17:if(t){e.next=19;break}return e.abrupt("return",null);case 19:return f="".concat(r,"/nodes/"),h=f+(t&&t.split("/").pop()),e.prev=20,e.next=23,(0,a.U)(h,{query:{f:"json",token:l},responseType:"json",signal:d});case 23:return e.t6=e.sent.data,e.t7=f,e.abrupt("return",{type:"node",rootNode:e.t6,urlPrefix:e.t7});case 28:throw e.prev=28,e.t8=e.catch(20),new u.a("sceneservice:root-node-missing","Root node missing.",{pageError:c,nodeError:e.t8,url:h});case 31:case"end":return e.stop()}}),e,null,[[3,14],[20,28]])}))),o.apply(this,arguments)}}}]);
//# sourceMappingURL=9151.e2724ad6.chunk.js.map