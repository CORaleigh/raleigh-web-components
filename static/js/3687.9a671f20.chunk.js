"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[3687],{73764:function(e,t,r){r.d(t,{c:function(){return y}});var n=r(93433),i=r(37762),a=r(74165),u=r(15861),o=r(15671),s=r(43144),l=r(60136),c=r(29388),d=r(50165),f=r(4483),p=r(33117),y=function(e){var t=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,[{key:"_validateFetchPopupFeatures",value:function(e){var t=this.layer;return t.popupEnabled?(0,p.s)(t,e)?void 0:new d.a("scenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:t}):new d.a("scenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:t})}},{key:"prepareFetchPopupFeatures",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchPopupFeatures",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,r){var u,o,s,l,c,y,v,h,g,m;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(u=this._validateFetchPopupFeatures(r))){e.next=3;break}throw u;case 3:if((o=(0,d.r)(r)?r.clientGraphics:null)&&0!==o.length){e.next=6;break}return e.abrupt("return",[]);case 6:return s="scene"===this.layer.type&&(0,d.r)(this.layer.associatedLayer)?this.layer.associatedLayer:this.layer,e.t0=f.I,e.t1=this.layer.fieldsIndex,e.next=11,(0,p.d)(s,(0,p.s)(this.layer,r));case 11:return e.t2=e.sent,l=(0,e.t0)(e.t1,e.t2),e.next=15,this.prepareFetchPopupFeatures(l);case 15:c=new Set,y=[],v=[],h=(0,i.Z)(o);try{for(h.s();!(g=h.n()).done;)m=g.value,(0,f.p)(l,m,c)?v.push(m):y.push(m)}catch(t){h.e(t)}finally{h.f()}return e.abrupt("return",0===v.length?y:this.whenGraphicAttributes(v,(0,n.Z)(c)).catch((function(){return v})).then((function(e){return y.concat(e)})));case 19:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(e);return t=(0,d.e)([(0,d.n)("esri.views.3d.layers.support.PopupSceneLayerView")],t)}},53823:function(e,t,r){r.d(t,{a:function(){return I},b:function(){return x},c:function(){return S},g:function(){return D},i:function(){return F}});var n,i,a=r(74165),u=r(15861),o=r(15671),s=r(43144),l=r(60136),c=r(29388),d=r(93433),f=r(37762),p=r(50165),y=r(82414),v=r(4483),h=r(22984),g=r(73627),m=r(98643),w=r(60470),b={setAttribute:function(){},rollback:function(){},commit:function(){}};function F(e,t){var r=t.attributes[e.objectIdField],i=e.sessions.get(r);if(i)return i;var a=(0,p.m)(t.attributes),u=new Set;if(null==r)return b;var o=e.attributeOverrides.createInteractiveEditSession(r),s=new Map,l=function(e,t){var n=s.get(e);if(null==n){var i=t.indexOf(r);return s.set(e,i),i}return n},c=n.EDITING,d={setAttribute:function(r,i){if(c===n.EDITING){var a=e.fieldsIndex.get(r);if(!(0,p.t)(a)){var s=e.attributeStorageInfo.findIndex((function(e){return e.name===a.name}));if(!(s<0)){o.set(s,i);var d=e.attributeStorageInfo[s],f=!1;u.add(r),e.forEachNode((function(r,n){var a=l(r,n);if(-1!==a){var u=e.getAttributeData(r.index);if(u){var o=u[d.name];o&&(o[a]=i,e.setAttributeData(r.index,u,t),f=!0)}}})),f&&e.clearMemCache()}}}},rollback:function(){if(c===n.EDITING){var t,i=(0,f.Z)(u);try{for(i.s();!(t=i.n()).done;){var s=t.value;this.setAttribute(s,a[s])}}catch(l){i.e(l)}finally{i.f()}o.rollback(),c=n.ROLLED_BACK,e.sessions.delete(r)}},commit:function(){c===n.EDITING&&(o.commit(),c=n.COMMITTED,e.sessions.delete(r))}};return e.sessions.set(r,d),d}function I(e,t){var r=function(e,t){var r=t.edits.updateFeatures;if(!r||0===r.length)return new k;for(var n=function(e){var t=new Set;if(!e.updatedFeatures)return t;var r,n=(0,f.Z)(e.updatedFeatures);try{for(n.s();!(r=n.n()).done;){var i=r.value;null!=i.objectId&&null==i.error&&t.add(i.objectId)}}catch(a){n.e(a)}finally{n.f()}return t}(t),i=new k,a=new Map,u=0;u<e.attributeStorageInfo.length;u++)a.set(e.attributeStorageInfo[u].name,u);var o=e.fieldsIndex,s=e.objectIdField,l=r.filter((function(e){var t=(0,y.n)(o,e.attributes,s);return n.has(t)}));return e.forEachNode((function(t,r){var n,a=new Set(r),u=(0,f.Z)(l);try{for(u.s();!(n=u.n()).done;){var c=n.value,d=(0,y.n)(o,c.attributes,s);if(a.has(d)){var p=r.indexOf(d);for(var v in c.attributes){var h=e.fieldsIndex.normalizeFieldName(v),g=Z(i,t.index,h),m=c.attributes[v];g.push({featureIndex:p,featureId:d,value:m})}}}}catch(w){u.e(w)}finally{u.f()}})),i}(e,t);if(0!==r.size){for(var n=new Map,i=0;i<e.attributeStorageInfo.length;i++)n.set(e.attributeStorageInfo[i].name,i);var a=!1;r.forEach((function(t,r){var i=e.getAttributeData(r),u=!1;t.forEach((function(t,r){var o,s=(0,p.r)(i)?i[r]:null,l=n.get(r),c=(0,f.Z)(t);try{for(c.s();!(o=c.n()).done;){var d=o.value,y=d.featureIndex,v=d.value,h=d.featureId;s&&(s[y]=v,u=!0,a=!0),e.attributeOverrides.updateValue(h,l,v)}}catch(g){c.e(g)}finally{c.f()}})),u&&e.setAttributeData(r,i,null)})),a&&e.clearMemCache()}}function Z(e,t,r){var n=function(e,t){var r=e.get(t);if(r)return r;var n=new E;return e.set(t,n),n}(e,t),i=n.get(r);if(i)return i;var a=new Array;return n.set(r,a),a}(i=n||(n={}))[i.EDITING=0]="EDITING",i[i.ROLLED_BACK=1]="ROLLED_BACK",i[i.COMMITTED=2]="COMMITTED";var E=Map,k=Map;function x(){return{requiredFields:{type:[String],readOnly:!0},availableFields:{type:[String],readOnly:!0,get:function(){var e=this.layer,t=this.layer.fieldsIndex,r=this.requiredFields;return e.outFields?(0,v.y)(t,[].concat((0,d.Z)((0,v.I)(t,e.outFields)),(0,d.Z)(r))):(0,v.y)(t,r)}}}}var _,A=function(e){var t=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments))._numUpdating=0,e.asyncUpdateState=new Map,e}return(0,s.Z)(r,[{key:"updating",get:function(){return this._numUpdating>0}},{key:"autoUpdateAsync",value:function(e,t){var r=this;return function(e,t){var r=function(){a&&!u&&e(n)},n=function(){if(!a||u)return t();a.clear(),u=!0;var e=(0,p.D)(a,t);return u=!1,e},i=function(){a&&(a.destroy(),a=null)},a=new p.C(r),u=!1;return e(n),{remove:i}}((function(t){return r._updateAsync(e,t)}),t)}},{key:"_updateAsync",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,r){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._startAsyncUpdate(t)){e.next=12;break}return e.prev=1,e.next=4,r();case 4:n=e.sent,this._set(t,n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),p.s.getLogger(this.declaredClass).warn('Async update of "'.concat(String(t),'" failed. Async update functions should not throw exceptions.'));case 11:this._endAsyncUpdate(t)&&this._updateAsync(t,r);case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_startAsyncUpdate",value:function(e){var t,r=null!==(t=this.asyncUpdateState.get(e))&&void 0!==t?t:_.None;return r&_.Updating?(this.asyncUpdateState.set(e,r|_.Invalidated),!0):(++this._numUpdating,this.asyncUpdateState.set(e,r|_.Updating),!1)}},{key:"_endAsyncUpdate",value:function(e){var t;--this._numUpdating;var r=(null!==(t=this.asyncUpdateState.get(e))&&void 0!==t?t:_.None)&~_.Updating;return r&_.Invalidated?(this.asyncUpdateState.set(e,r&~_.Invalidated),!0):(this.asyncUpdateState.set(e,r),!1)}}]),r}(e);return(0,p.e)([(0,p.d)({readOnly:!0})],t.prototype,"updating",null),(0,p.e)([(0,p.d)()],t.prototype,"_numUpdating",void 0),t=(0,p.e)([(0,p.n)("esri.core.AsyncUpdate")],t)};!function(e){e[e.None=0]="None",e[e.Updating=1]="Updating",e[e.Invalidated=2]="Invalidated"}(_||(_={}));var N=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r)}(A(p.y));N=(0,p.e)([(0,p.n)("esri.core.AsyncUpdate")],N);var U=p.s.getLogger("esri.views.3d.layers.support.SceneLayerViewRequiredFields"),S=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(e){return(0,o.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"requiredFields",get:function(){var e=this.layerView,t=e.layer.fieldsIndex,r=e.definitionExpressionFields,n=this.rendererFields,i=this.labelingFields,a=this.viewFilterFields;return(0,v.y)(t,[].concat((0,d.Z)((0,p.af)(r,[])),(0,d.Z)((0,p.af)(n,[])),(0,d.Z)((0,p.af)(i,[])),(0,d.Z)((0,p.af)(a,[]))))}},{key:"initialize",value:function(){var e=this,t=this.layerView.layer;this.layer=t,this.handles.add([this.autoUpdateAsync("rendererFields",(function(){var t=e.layer,r=t.fieldsIndex,n=t.renderer;return n?L((function(e){return n.collectRequiredFields(e,r)})):null})),this.autoUpdateAsync("labelingFields",(function(){var t=e.layer;return t.labelsVisible?L((function(e){return(0,v.l)(e,t)})):null})),this.autoUpdateAsync("viewFilterFields",(function(){var t=e.layerView,r=t.layer,n=t.filter;return L((function(e){return(0,v.V)(e,r,n)}))}))])}}]),r}(A(h.d));function L(e){return O.apply(this,arguments)}function O(){return(O=(0,u.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Set,e.prev=1,e.next=4,t(r);case 4:return e.abrupt("return",Array.from(r).sort());case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",(U.error(e.t0),null));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}(0,p.e)([(0,p.d)()],S.prototype,"layerView",void 0),(0,p.e)([(0,p.d)()],S.prototype,"layer",void 0),(0,p.e)([(0,p.d)()],S.prototype,"requiredFields",null),(0,p.e)([(0,p.d)()],S.prototype,"rendererFields",void 0),(0,p.e)([(0,p.d)()],S.prototype,"labelingFields",void 0),(0,p.e)([(0,p.d)()],S.prototype,"viewFilterFields",void 0),S=(0,p.e)([(0,p.n)("esri.views.3d.layers.support.SceneLayerViewRequiredFields")],S);var j=p.s.getLogger("esri.views.layers.SceneLayerView"),D=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments)).layer=null,e.filter=null,e._geometryEngine=null,e._projectionEngineLoaded=!1,e}return(0,s.Z)(n,[{key:"availableFields",get:function(){return[]}},{key:"maximumNumberOfFeatures",get:function(){return 0},set:function(e){throw new Error("Not implemented")}},{key:"maximumNumberOfFeaturesExceeded",get:function(){return!1}},{key:"layerFilter",get:function(){var e=this.layer.filter;if((0,p.t)(e)||e.geometries.length<1)return null;var t=this._geometryEngine;if((0,p.t)(t)||!this._projectionEngineLoaded&&this._filterNeedsProjectionEngine)return null;try{for(var r=t.simplify(e.geometries.getItemAt(0)),n=r.spatialReference,i=1;i<e.geometries.length;i++){var a=t.simplify(e.geometries.getItemAt(i));a.spatialReference.equals(n)||(a=(0,m.r)(a,n)),r=t.union(r,a)}return{spatialRelationship:e.spatialRelationship,geometry:r}}catch(u){return j.warnOncePerTick("Failed to merge scene filter geometries. Layer mask will be ignored."),null}}},{key:"_filterNeedsProjectionEngine",get:function(){var e=this.layer.filter;if((0,p.t)(e)||e.geometries.length<=1)return!1;var t=e.geometries.getItemAt(0).spatialReference;return e.geometries.some((function(e){var r=e.spatialReference;return!r.equals(t)&&!(0,m.A)(r,t)}))}},{key:"layerFilterUpdating",get:function(){return(0,p.r)(this.layer.filter)&&this.layer.filter.geometries.length&&(!this._geometryEngine||!this._projectionEngineLoaded&&this._filterNeedsProjectionEngine)}},{key:"initialize",value:function(){var e=this;(0,g.j)((function(){return!e._geometryEngine&&(0,p.r)(e.layer.filter)&&e.layer.filter.geometries.length})).then((0,u.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([r.e(6549),r.e(942)]).then(r.bind(r,40942));case 2:return t.abrupt("return",e._geometryEngine=t.sent);case 3:case"end":return t.stop()}}),t)})))),this._projectionEngineLoaded=(0,m.e)(),(0,g.j)((function(){return!e._projectionEngineLoaded&&e._filterNeedsProjectionEngine})).then((0,u.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,m.t)();case 2:e._projectionEngineLoaded=!0;case 3:case"end":return t.stop()}}),t)}))))}},{key:"highlight",value:function(e){throw new Error("Not implemented")}},{key:"queryFeatures",value:function(e,t){throw new Error("Not implemented")}},{key:"queryObjectIds",value:function(e,t){throw new Error("Not implemented")}},{key:"queryFeatureCount",value:function(e,t){throw new Error("Not implemented")}},{key:"createQuery",value:function(){throw new Error("Not implemented")}},{key:"queryExtent",value:function(e,t){throw new Error("Not implemented")}}]),n}(w.u);(0,p.e)([(0,p.d)()],D.prototype,"layer",void 0),(0,p.e)([(0,p.d)()],D.prototype,"availableFields",null),(0,p.e)([(0,p.d)()],D.prototype,"maximumNumberOfFeatures",null),(0,p.e)([(0,p.d)({readOnly:!0})],D.prototype,"maximumNumberOfFeaturesExceeded",null),(0,p.e)([(0,p.d)()],D.prototype,"filter",void 0),(0,p.e)([(0,p.d)({readOnly:!0})],D.prototype,"layerFilter",null),(0,p.e)([(0,p.d)()],D.prototype,"_geometryEngine",void 0),(0,p.e)([(0,p.d)()],D.prototype,"_projectionEngineLoaded",void 0),(0,p.e)([(0,p.d)()],D.prototype,"_filterNeedsProjectionEngine",null),(0,p.e)([(0,p.d)()],D.prototype,"layerFilterUpdating",null)},42814:function(e,t,r){function n(e){var t,r=e.layer;return"floorInfo"in r&&null!==(t=r.floorInfo)&&void 0!==t&&t.floorField&&"floors"in e.view?a(e.view.floors,r.floorInfo.floorField):null}function i(e,t){var r;return"floorInfo"in t&&null!==(r=t.floorInfo)&&void 0!==r&&r.floorField?a(e,t.floorInfo.floorField):null}function a(e,t){if(null===e||void 0===e||!e.length)return null;var r=e.filter((function(e){return""!==e})).map((function(e){return"'".concat(e,"'")}));return r.push("''"),"".concat(t," IN (").concat(r.join(","),") OR ").concat(t," IS NULL")}r.d(t,{n:function(){return i},o:function(){return n}})}}]);
//# sourceMappingURL=3687.9a671f20.chunk.js.map