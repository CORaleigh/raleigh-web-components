"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[2219,5751],{62610:function(e,t,n){n.d(t,{i:function(){return f},l:function(){return h}});var r=n(29439),i=n(37762),a=n(15671),u=n(43144),s=n(60136),o=n(29388),l=n(48848),c=n(93661),f=function(e){var t=function(e){(0,s.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,u.Z)(n,[{key:"clone",value:function(){var e=(0,c.i)((0,l.x)(this),"unable to clone instance of non-accessor class"),t=e.metadatas,n=e.store,a={},u=new Map;for(var s in t){var o=t[s],f=null===n||void 0===n?void 0:n.originOf(s),h=o.clonable;if(!(o.readOnly||!1===h||f!==l.r.USER&&f!==l.r.DEFAULTS&&f!==l.r.WEB_MAP&&f!==l.r.WEB_SCENE)){var d,p=this[s];d="function"==typeof h?h(p):"reference"===h?p:(0,c.m)(p),null!=p&&null==d||(f===l.r.DEFAULTS?u.set(s,d):a[s]=d)}}var v=new(Object.getPrototypeOf(this).constructor)(a);if(u.size){var y,g=null===(y=(0,l.x)(v))||void 0===y?void 0:y.store;if(g){var m,_=(0,i.Z)(u);try{for(_.s();!(m=_.n()).done;){var w=(0,r.Z)(m.value,2),k=w[0],b=w[1];g.set(k,b,l.r.DEFAULTS)}}catch(x){_.e(x)}finally{_.f()}}}return v}}]),n}(e);return t=(0,l.e)([(0,l.n)("esri.core.Clonable")],t),t},h=function(e){(0,s.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,u.Z)(n)}(f(l.m));h=(0,l.e)([(0,l.n)("esri.core.Clonable")],h)},89794:function(e,t,n){n.d(t,{l:function(){return h}});var r=n(15671),i=n(43144),a=n(48200),u=n(71802),s=n(93661),o=n(48848);function l(e){return(0,u.a)((0,o.$)(e),0,255)}function c(e,t,n){return e=Number(e),isNaN(e)?n:e<t?t:e>n?n:e}var f=function(){function e(t){(0,r.Z)(this,e),this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}return(0,i.Z)(e,[{key:"isBright",get:function(){return.299*this.r+.587*this.g+.114*this.b>=127}},{key:"setColor",value:function(t){var n,r,i,a;return"string"==typeof t?e.fromString(t,this):Array.isArray(t)?e.fromArray(t,this):(this._set(null!==(n=t.r)&&void 0!==n?n:0,null!==(r=t.g)&&void 0!==r?r:0,null!==(i=t.b)&&void 0!==i?i:0,null!==(a=t.a)&&void 0!==a?a:1),t instanceof e||this._sanitize()),this}},{key:"toRgb",value:function(){return[this.r,this.g,this.b]}},{key:"toRgba",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toHex",value:function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return"#".concat(e.length<2?"0"+e:e).concat(t.length<2?"0"+t:t).concat(n.length<2?"0"+n:n)}},{key:"toCss",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.r+", "+this.g+", "+this.b;return e?"rgba(".concat(t,", ").concat(this.a,")"):"rgb(".concat(t,")")}},{key:"toString",value:function(){return this.toCss(!0)}},{key:"toJSON",value:function(){return this.toArray()}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.AlphaMode.ALWAYS,n=l(this.r),r=l(this.g),i=l(this.b);return t===e.AlphaMode.ALWAYS||1!==this.a?[n,r,i,l(255*this.a)]:[n,r,i]}},{key:"clone",value:function(){return new e(this.toRgba())}},{key:"hash",value:function(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}},{key:"equals",value:function(e){return(0,s.r)(e)&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}},{key:"_sanitize",value:function(){return this.r=Math.round(c(this.r,0,255)),this.g=Math.round(c(this.g,0,255)),this.b=Math.round(c(this.b,0,255)),this.a=c(this.a,0,1),this}},{key:"_set",value:function(e,t,n,r){this.r=e,this.g=t,this.b=n,this.a=r}}],[{key:"blendColors",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e;return i.r=Math.round(t.r+(n.r-t.r)*r),i.g=Math.round(t.g+(n.g-t.g)*r),i.b=Math.round(t.b+(n.b-t.b)*r),i.a=t.a+(n.a-t.a)*r,i._sanitize()}},{key:"fromRgb",value:function(t,n){var r=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(r){var i=r[2].split(/\s*,\s*/),u=r[1];if("rgb"===u&&3===i.length||"rgba"===u&&4===i.length){var s=i[0];if("%"===s.charAt(s.length-1)){var o=i.map((function(e){return 2.56*parseFloat(e)}));return 4===i.length&&(o[3]=parseFloat(i[3])),e.fromArray(o,n)}return e.fromArray(i.map((function(e){return parseFloat(e)})),n)}if("hsl"===u&&3===i.length||"hsla"===u&&4===i.length)return e.fromArray((0,a.o)(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100,parseFloat(i[3])),n)}return null}},{key:"fromHex",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;if(4!==t.length&&7!==t.length||"#"!==t[0])return null;var r=4===t.length?4:8,i=(1<<r)-1,a=Number("0x"+t.substr(1));return isNaN(a)?null:(["b","g","r"].forEach((function(e){var t=a&i;a>>=r,n[e]=4===r?17*t:t})),n.a=1,n)}},{key:"fromArray",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return n._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(n.a)&&(n.a=1),n._sanitize()}},{key:"fromString",value:function(t,n){var r=(0,a.r)(t)?(0,a.l)(t):null;return r&&e.fromArray(r,n)||e.fromRgb(t,n)||e.fromHex(t,n)}},{key:"fromJSON",value:function(t){return t&&new e([t[0],t[1],t[2],t[3]/255])}},{key:"toUnitRGB",value:function(e){return(0,s.r)(e)?[e.r/255,e.g/255,e.b/255]:null}},{key:"toUnitRGBA",value:function(e){return(0,s.r)(e)?[e.r/255,e.g/255,e.b/255,null!=e.a?e.a:1]:null}}]),e}();f.prototype.declaredClass="esri.Color",function(e){var t;(t=e.AlphaMode||(e.AlphaMode={}))[t.ALWAYS=0]="ALWAYS",t[t.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(f||(f={}));var h=f},15529:function(e,t,n){n.d(t,{m:function(){return _},n:function(){return b},r:function(){return x},x:function(){return C}});var r,i=n(11752),a=n(61120),u=n(74165),s=n(15861),o=n(15671),l=n(43144),c=n(60136),f=n(29388),h=n(48848),d=n(40558),p=n(40114),v=n(93661),y=n(82474),g=n(59984),m=n(47855),_={inches:(0,m.a)(1,"meters","inches"),feet:(0,m.a)(1,"meters","feet"),"us-feet":(0,m.a)(1,"meters","us-feet"),yards:(0,m.a)(1,"meters","yards"),miles:(0,m.a)(1,"meters","miles"),"nautical-miles":(0,m.a)(1,"meters","nautical-miles"),millimeters:(0,m.a)(1,"meters","millimeters"),centimeters:(0,m.a)(1,"meters","centimeters"),decimeters:(0,m.a)(1,"meters","decimeters"),meters:(0,m.a)(1,"meters","meters"),kilometers:(0,m.a)(1,"meters","kilometers"),"decimal-degrees":1/(0,m.Y)(1,"meters",y.s.radius)},w=r=function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"collectRequiredFields",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,g.S)(t,n,this.expression));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"clone",value:function(){return new r({expression:this.expression,title:this.title})}},{key:"equals",value:function(e){return this.expression===e.expression&&this.title===e.title}}]),n}(p.l);(0,h.e)([(0,h.y)({type:String,json:{write:!0}})],w.prototype,"expression",void 0),(0,h.e)([(0,h.y)({type:String,json:{write:!0}})],w.prototype,"title",void 0);var k=w=r=(0,h.e)([(0,h.n)("esri.layers.support.FeatureExpressionInfo")],w);function b(e){return null!=_[e]}function x(e){return 1/(_[e]||1)}var Z,S=function(){var e=Object.keys(_);return e.sort(),e}(),E=(0,d.o)()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),T=new d.s({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"}),F=Z=function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).offset=null,r}return(0,l.Z)(n,[{key:"readFeatureExpressionInfo",value:function(e,t){return null!=e?e:t.featureExpression&&0===t.featureExpression.value?{expression:"0"}:void 0}},{key:"writeFeatureExpressionInfo",value:function(e,t,n,r){t[n]=e.write({},r),"0"===e.expression&&(t.featureExpression={value:0})}},{key:"mode",get:function(){var e=this.offset,t=this.featureExpressionInfo;return this._isOverridden("mode")?this._get("mode"):(0,v.r)(e)||t?"relative-to-ground":"on-the-ground"},set:function(e){this._override("mode",e)}},{key:"unit",set:function(e){this._set("unit",e)}},{key:"write",value:function(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?(0,i.Z)((0,a.Z)(n.prototype),"write",this).call(this,e,t):null}},{key:"clone",value:function(){return new Z({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}},{key:"equals",value:function(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&(0,v.B)(this.featureExpressionInfo,e.featureExpressionInfo)}}]),n}(p.l);(0,h.e)([(0,h.y)({type:k,json:{write:!0}})],F.prototype,"featureExpressionInfo",void 0),(0,h.e)([(0,y.o)("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],F.prototype,"readFeatureExpressionInfo",null),(0,h.e)([(0,y.r)("featureExpressionInfo",{featureExpressionInfo:{type:k},"featureExpression.value":{type:[0]}})],F.prototype,"writeFeatureExpressionInfo",null),(0,h.e)([(0,h.y)({type:E.apiValues,nonNullable:!0,json:{type:E.jsonValues,read:E.read,write:{writer:E.write,isRequired:!0}}})],F.prototype,"mode",null),(0,h.e)([(0,h.y)({type:Number,json:{write:!0}})],F.prototype,"offset",void 0),(0,h.e)([(0,h.y)({type:S,json:{type:String,read:T.read,write:T.write}})],F.prototype,"unit",null);var C=F=Z=(0,h.e)([(0,h.n)("esri.layers.support.ElevationInfo")],F)},49055:function(e,t,n){n.r(t);var r=n(29439),i=n(1413),a=n(37762),u=n(74165),s=n(15861),o=n(15671),l=n(43144),c=n(60136),f=n(29388),h=n(48848),d=n(37856),p=n(93661),v=n(50690),y=n(630),g=n(82474),m=n(26593),_=n(69838),w=n(3356),k=n(92982),b=n(35237),x=n(15529),Z=n(52752),S=n(59389),E=n(46817),T=n(25456),F=n(52559),C=n(1685),I=n(53409),M=n(49871),O=n(43955),A=n(36040),R=(n(40114),n(93209),n(90325),n(53921),n(44581),n(44513),n(62466),n(6762),n(47855),n(40558),n(74384),n(56162),n(63212),n(39994),n(69717),n(2352),n(45184),n(43976),n(62470),n(54622),n(73679),n(71147),n(89794),n(48200),n(71802),n(20302),n(21385),n(62753),n(95249),n(15751),n(79557),n(75255),n(65415),n(83948),n(94663),n(59984),n(67477),n(78413),n(77755),n(47748),n(89181),n(69641),n(15436),n(69768),n(62610),n(39926),n(46337),n(35182),n(51816),function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments)).updating=!1,e._pending=[],e}return(0,l.Z)(n,[{key:"push",value:function(e,t){this._pending.push({promise:e,callback:t}),1===this._pending.length&&this._process()}},{key:"_process",value:function(){var e=this;if(this._pending.length){this.updating=!0;var t=this._pending[0];t.promise.then((function(e){return t.callback(e)})).catch((function(){})).then((function(){e._pending.shift(),e._process()}))}else this.updating=!1}}]),n}(h.m));(0,h.e)([(0,h.y)()],R.prototype,"updating",void 0),R=(0,h.e)([(0,h.n)("esri.core.AsyncSequence")],R);var z,D=function(){function e(t,n){(0,o.Z)(this,e),this.data=t,this.resolution=n,this.state={type:z.CREATED},this.alive=!0}return(0,l.Z)(e,[{key:"process",value:function(e){switch(this.state.type){case z.CREATED:return this.state=this._gotoFetchCount(this.state,e),this.state.task.promise.then(e.resume,e.resume);case z.FETCH_COUNT:break;case z.FETCHED_COUNT:return this.state=this._gotoFetchFeatures(this.state,e),this.state.task.promise.then(e.resume,e.resume);case z.FETCH_FEATURES:break;case z.FETCHED_FEATURES:this.state=this._goToDone(this.state,e)}return null}},{key:"debugInfo",get:function(){return{data:this.data,featureCount:this._featureCount,state:this._stateToString}}},{key:"_featureCount",get:function(){switch(this.state.type){case z.CREATED:case z.FETCH_COUNT:return 0;case z.FETCHED_COUNT:return this.state.featureCount;case z.FETCH_FEATURES:return this.state.previous.featureCount;case z.FETCHED_FEATURES:return this.state.features.length;case z.DONE:return this.state.previous.features.length}}},{key:"_stateToString",get:function(){switch(this.state.type){case z.CREATED:return"created";case z.FETCH_COUNT:return"fetch-count";case z.FETCHED_COUNT:return"fetched-count";case z.FETCH_FEATURES:return"fetch-features";case z.FETCHED_FEATURES:return"fetched-features";case z.DONE:return"done"}}},{key:"_gotoFetchCount",value:function(e,t){var n=this;return{type:z.FETCH_COUNT,previous:e,task:(0,S.j)(function(){var e=(0,s.Z)((0,u.Z)().mark((function e(r){var i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.d)(t.fetchCount(n,r));case 2:i=e.sent,n.state.type===z.FETCH_COUNT&&(n.state=n._gotoFetchedCount(n.state,i.ok?i.value:1/0));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},{key:"_gotoFetchedCount",value:function(e,t){return{type:z.FETCHED_COUNT,featureCount:t,previous:e}}},{key:"_gotoFetchFeatures",value:function(e,t){var n=this;return{type:z.FETCH_FEATURES,previous:e,task:(0,S.j)(function(){var r=(0,s.Z)((0,u.Z)().mark((function r(i){var a;return(0,u.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,S.d)(t.fetchFeatures(n,e.featureCount,i));case 2:a=r.sent,n.state.type===z.FETCH_FEATURES&&(n.state=n._gotoFetchedFeatures(n.state,a.ok?a.value:[]));case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}}},{key:"_gotoFetchedFeatures",value:function(e,t){return{type:z.FETCHED_FEATURES,previous:e,features:t}}},{key:"_goToDone",value:function(e,t){return t.finish(this,e.features),{type:z.DONE,previous:e}}},{key:"reset",value:function(){var e=this.state;switch(this.state={type:z.CREATED},e.type){case z.CREATED:case z.FETCHED_COUNT:case z.FETCHED_FEATURES:case z.DONE:break;case z.FETCH_COUNT:case z.FETCH_FEATURES:e.task.abort()}}},{key:"intersects",value:function(e){return!(!(0,p.t)(e)&&this.data.extent)||((0,T.c)(e,N),(0,T.E)(this.data.extent,N))}}]),e}();!function(e){e[e.CREATED=0]="CREATED",e[e.FETCH_COUNT=1]="FETCH_COUNT",e[e.FETCHED_COUNT=2]="FETCHED_COUNT",e[e.FETCH_FEATURES=3]="FETCH_FEATURES",e[e.FETCHED_FEATURES=4]="FETCHED_FEATURES",e[e.DONE=5]="DONE"}(z||(z={}));var N=(0,T.u)(),j=function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).tilesOfInterest=[],r.availability=0,r._pendingTiles=new Map,r._pendingEdits=new R,r._pendingEditsAbortController=new AbortController,r}return(0,l.Z)(n,[{key:"_minimumVerticesPerFeature",get:function(){var e;switch(null===(e=this.store)||void 0===e?void 0:e.featureStore.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":return 1;case"esriGeometryPolygon":return 4;case"esriGeometryPolyline":return 2}}},{key:"filter",set:function(e){var t=this._get("filter"),n=this._filterProperties(e);JSON.stringify(t)!==JSON.stringify(n)&&this._set("filter",n)}},{key:"customParameters",set:function(e){var t=this._get("customParameters");JSON.stringify(t)!==JSON.stringify(e)&&this._set("customParameters",e)}},{key:"_configuration",get:function(){return{filter:this.filter,customParameters:this.customParameters,tileInfo:this.tileInfo,tileSize:this.tileSize}}},{key:"tileInfo",set:function(e){var t=this._get("tileInfo");t!==e&&((0,p.r)(e)&&(0,p.r)(t)&&JSON.stringify(e)===JSON.stringify(t)||(this._set("tileInfo",e),this.store.tileInfo=e))}},{key:"tileSize",set:function(e){this._get("tileSize")!==e&&this._set("tileSize",e)}},{key:"updating",get:function(){return this.updatingExcludingEdits||this._pendingEdits.updating}},{key:"updatingExcludingEdits",get:function(){return this.updatingHandles.updating}},{key:"hasZ",get:function(){return this.store.featureStore.hasZ}},{key:"initialize",value:function(){var e=this;this._initializeFetchExtent(),this.updatingHandles.add((function(){return e._configuration}),(function(){return e.refresh()})),this.updatingHandles.add((function(){return e.tilesOfInterest}),(function(t,n){(0,p.k)(t,n,(function(e,t){return e.id===t.id}))||e._process()}),v.U)}},{key:"destroy",value:function(){var e=this;this._pendingTiles.forEach((function(t){return e._deletePendingTile(t)})),this._pendingTiles.clear(),this.store.destroy(),this.tilesOfInterest.length=0,this._pendingEditsAbortController.abort(),this._pendingEditsAbortController=null}},{key:"refresh",value:function(){var e=this;this.store.refresh(),this._pendingTiles.forEach((function(t){return e._deletePendingTile(t)})),this._process()}},{key:"applyEdits",value:function(e){var t=this;this._pendingEdits.push(e,function(){var e=(0,s.Z)((0,u.Z)().mark((function e(n){var s,o,l,c;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.addedFeatures.length||0!==n.updatedFeatures.length||0!==n.deletedFeatures.length){e.next=2;break}return e.abrupt("return");case 2:s=(0,a.Z)(t._pendingTiles);try{for(s.s();!(o=s.n()).done;)l=(0,r.Z)(o.value,2),l[1].reset()}catch(u){s.e(u)}finally{s.f()}return c=(0,i.Z)((0,i.Z)({},n),{},{deletedFeatures:n.deletedFeatures.map((function(e){var n=e.objectId,r=e.globalId;return n&&-1!==n?n:t._lookupObjectIdByGlobalId(r)}))}),e.next=7,t.updatingHandles.addPromise(t.store.processEdits(c,(function(e,n){return t._queryFeaturesById(e,n)}),t._pendingEditsAbortController.signal));case 7:t._processPendingTiles();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"_initializeFetchExtent",value:function(){var e=this;if(this.capabilities.query.supportsExtent&&(0,C.g)(this.url)){var t=(0,S.j)(function(){var t=(0,s.Z)((0,u.Z)().mark((function t(n){var r,i;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,M.x)(e.url,new b.x({where:"1=1",outSpatialReference:e.spatialReference,cacheHint:!!e.capabilities.query.supportsCacheHint||void 0}),{query:e._configuration.customParameters,signal:n});case 3:i=t.sent,e.store.extent=E.w.fromJSON(null===(r=i.data)||void 0===r?void 0:r.extent),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),(0,h.w)(t.t0),h.a.getLogger(e.declaredClass).warn("Failed to fetch data extent",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}());this.updatingHandles.addPromise(t.promise.then((function(){return e._process()}))),this.handles.add((0,h.D)((function(){return t.abort()})))}}},{key:"debugInfo",get:function(){return{numberOfFeatures:this.store.featureStore.numFeatures,tilesOfInterest:this.tilesOfInterest,pendingTiles:Array.from(this._pendingTiles.values()).map((function(e){return e.debugInfo})),storedTiles:this.store.debugInfo}}},{key:"_process",value:function(){this._markTilesNotAlive(),this._createPendingTiles(),this._deletePendingTiles(),this._processPendingTiles()}},{key:"_markTilesNotAlive",value:function(){var e,t=(0,a.Z)(this._pendingTiles);try{for(t.s();!(e=t.n()).done;){(0,r.Z)(e.value,2)[1].alive=!1}}catch(n){t.e(n)}finally{t.f()}}},{key:"_createPendingTiles",value:function(){var e=this._collectMissingTilesInfo();if(this._setAvailability((0,p.t)(e)?1:e.coveredArea/e.fullArea),!(0,p.t)(e)){var t,n=(0,a.Z)(e.missingTiles);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.data,u=r.resolution,s=this._pendingTiles.get(i.id);s?(s.resolution=u,s.alive=!0):this._createPendingTile(i,u)}}catch(o){n.e(o)}finally{n.f()}}}},{key:"_collectMissingTilesInfo",value:function(){for(var e=this,t=null,n=this.tilesOfInterest.length-1;n>=0;n--){var r=this.tilesOfInterest[n],i=this.store.process(r,(function(t,n){return e._verifyTileComplexity(t,n)}));(0,p.t)(t)?t=i:t.prepend(i)}return t}},{key:"_deletePendingTiles",value:function(){var e,t=(0,a.Z)(this._pendingTiles);try{for(t.s();!(e=t.n()).done;){var n=(0,r.Z)(e.value,2)[1];n.alive||this._deletePendingTile(n)}}catch(i){t.e(i)}finally{t.f()}}},{key:"_processPendingTiles",value:function(){var e=this,t={fetchCount:function(t,n){return e._fetchCount(t,n)},fetchFeatures:function(t,n,r){return e._fetchFeatures(t,n,r)},finish:function(t,n){return e._finishPendingTile(t,n)},resume:function(){return e._processPendingTiles()}};if(this._ensureFetchAllCounts(t)){var n,i=(0,a.Z)(this._pendingTiles);try{for(i.s();!(n=i.n()).done;){var u=(0,r.Z)(n.value,2)[1];this._verifyTileComplexity(this.store.getFeatureCount(u.data),u.resolution)&&this.updatingHandles.addPromise(u.process(t))}}catch(s){i.e(s)}finally{i.f()}}}},{key:"_verifyTileComplexity",value:function(e,t){return this._verifyVertexComplexity(e)&&this._verifyFeatureDensity(e,t)}},{key:"_verifyVertexComplexity",value:function(e){return e*this._minimumVerticesPerFeature<H}},{key:"_verifyFeatureDensity",value:function(e,t){if((0,p.t)(this.tileInfo))return!1;var n=this.tileSize*t;return e*(L/(n*n))<V}},{key:"_ensureFetchAllCounts",value:function(e){var t,n=!0,i=(0,a.Z)(this._pendingTiles);try{for(i.s();!(t=i.n()).done;){var u=(0,r.Z)(t.value,2)[1];u.state.type<z.FETCHED_COUNT&&this.updatingHandles.addPromise(u.process(e)),u.state.type<=z.FETCH_COUNT&&(n=!1)}}catch(s){i.e(s)}finally{i.f()}return n}},{key:"_finishPendingTile",value:function(e,t){this.store.add(e.data,t),this._deletePendingTile(e),this._updateAvailability()}},{key:"_updateAvailability",value:function(){var e=this._collectMissingTilesInfo();this._setAvailability((0,p.t)(e)?1:e.coveredArea/e.fullArea)}},{key:"_setAvailability",value:function(e){this._set("availability",e)}},{key:"_createPendingTile",value:function(e,t){var n=new D(e,t);return this._pendingTiles.set(e.id,n),n}},{key:"_deletePendingTile",value:function(e){e.reset(),this._pendingTiles.delete(e.data.id)}},{key:"_fetchCount",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.store.fetchCount(t.data,this.url,this._createCountQuery(t),{query:this.customParameters,timeout:U,signal:n}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_fetchFeatures",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n,r){var i,a,s,o,l,c,f,h,d;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,s=0,o=n;case 1:return l=this._createFeaturesQuery(t),c=this._setPagingParameters(l,a,o),e.next=5,this._queryFeatures(l,r);case 5:if(f=e.sent,h=f.features,d=f.exceededTransferLimit,c&&(a+=(0,p.e)(l.num)),s+=h.length,i=i?i.concat(h):h,o=n-s,c&&d&&!(o<=0)){e.next=10;break}return e.abrupt("return",i);case 10:e.next=1;break;case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_filterProperties",value:function(e){return(0,p.t)(e)?{where:"1=1",gdbVersion:void 0,timeExtent:void 0}:{where:e.where||"1=1",timeExtent:e.timeExtent,gdbVersion:e.gdbVersion}}},{key:"_lookupObjectIdByGlobalId",value:function(e){var t=this.globalIdField,n=this.objectIdField;if((0,p.t)(t))throw new Error("Expected globalIdField to be defined");var r=null;if(this.store.featureStore.forEach((function(i){var a;e===i.attributes[t]&&(r=null!==(a=i.objectId)&&void 0!==a?a:i.attributes[n])})),(0,p.t)(r))throw new Error("Expected to find a feature with globalId ".concat(e));return r}},{key:"_queryFeaturesById",value:function(e,t){var n=this._createFeaturesQuery();return n.objectIds=e,this._queryFeatures(n,t)}},{key:"_queryFeatures",value:function(e,t){return this.capabilities.query.supportsFormatPBF?this._queryFeaturesPBF(e,t):this._queryFeaturesJSON(e,t)}},{key:"_queryFeaturesPBF",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){var r,i,a;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.sourceSpatialReference,e.next=3,(0,M.f)(this.url,t,new I.a({sourceSpatialReference:r}),{query:this._configuration.customParameters,timeout:U,signal:n});case 3:return i=e.sent,a=i.data,e.abrupt("return",(0,F.i)(a));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_queryFeaturesJSON",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){var r,i,a;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.sourceSpatialReference,e.next=3,(0,M.c)(this.url,t,r,{query:this._configuration.customParameters,timeout:U,signal:n});case 3:return i=e.sent,a=i.data,e.abrupt("return",(0,F.l)(a,this.objectIdField));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_createCountQuery",value:function(e){var t=this._createBaseQuery(e);return this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0),t}},{key:"_createFeaturesQuery",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this._createBaseQuery(e);return t.outFields=this.globalIdField?[this.globalIdField,this.objectIdField]:[this.objectIdField],t.returnGeometry=!0,(0,p.r)(e)&&(this.capabilities.query.supportsResultType?t.resultType="tile":this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0)),t}},{key:"_createBaseQuery",value:function(e){var t=new b.x({returnZ:this.hasZ,returnM:!1,geometry:(0,p.r)(this.tileInfo)&&(0,p.r)(e)?(0,T.f)(e.data.extent,this.tileInfo.spatialReference):void 0}),n=this._configuration.filter;return(0,p.r)(n)&&(t.where=n.where,t.gdbVersion=n.gdbVersion,t.timeExtent=n.timeExtent),t.outSpatialReference=this.spatialReference,t}},{key:"_setPagingParameters",value:function(e,t,n){if(!this.capabilities.query.supportsPagination)return!1;var r=this.capabilities.query,i=r.supportsMaxRecordCountFactor,a=r.supportsCacheHint,u=r.tileMaxRecordCount,s=r.maxRecordCount,o=r.supportsResultType,l=i?b.x.MAX_MAX_RECORD_COUNT_FACTOR:1,c=l*((o||a)&&u?u:s||P);return e.start=t,i?(e.maxRecordCountFactor=Math.min(l,Math.ceil(n/c)),e.num=Math.min(n,e.maxRecordCountFactor*c)):e.num=Math.min(n,c),!0}}]),n}(y.d);(0,h.e)([(0,h.y)({constructOnly:!0})],j.prototype,"url",void 0),(0,h.e)([(0,h.y)({constructOnly:!0})],j.prototype,"objectIdField",void 0),(0,h.e)([(0,h.y)({constructOnly:!0})],j.prototype,"globalIdField",void 0),(0,h.e)([(0,h.y)({constructOnly:!0})],j.prototype,"capabilities",void 0),(0,h.e)([(0,h.y)({constructOnly:!0})],j.prototype,"sourceSpatialReference",void 0),(0,h.e)([(0,h.y)({constructOnly:!0})],j.prototype,"spatialReference",void 0),(0,h.e)([(0,h.y)({constructOnly:!0})],j.prototype,"store",void 0),(0,h.e)([(0,h.y)({readOnly:!0})],j.prototype,"_minimumVerticesPerFeature",null),(0,h.e)([(0,h.y)()],j.prototype,"filter",null),(0,h.e)([(0,h.y)()],j.prototype,"customParameters",null),(0,h.e)([(0,h.y)({readOnly:!0})],j.prototype,"_configuration",null),(0,h.e)([(0,h.y)()],j.prototype,"tileInfo",null),(0,h.e)([(0,h.y)()],j.prototype,"tileSize",null),(0,h.e)([(0,h.y)()],j.prototype,"tilesOfInterest",void 0),(0,h.e)([(0,h.y)({readOnly:!0})],j.prototype,"updating",null),(0,h.e)([(0,h.y)({readOnly:!0})],j.prototype,"updatingExcludingEdits",null),(0,h.e)([(0,h.y)({readOnly:!0})],j.prototype,"availability",void 0),(0,h.e)([(0,h.y)()],j.prototype,"hasZ",null),j=(0,h.e)([(0,h.n)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher")],j);var P=2e3,U=6e5,H=1e6,L=25,V=1,B=function(e){function t(){(0,o.Z)(this,t),this._store=new Map,this._byteSize=0}return(0,l.Z)(t,[{key:"set",value:function(e,t){this.delete(e),this._store.set(e,t),this._byteSize+=t.byteSize}},{key:"delete",value:function(e){var t=this._store.get(e);return!!this._store.delete(e)&&(null!=t&&(this._byteSize-=t.byteSize),!0)}},{key:"get",value:function(e){return this._used(e),this._store.get(e)}},{key:"has",value:function(e){return this._used(e),this._store.has(e)}},{key:"clear",value:function(){this._store.clear()}},{key:"applyByteSizeLimit",value:function(e,t){var n,i=(0,a.Z)(this._store);try{for(i.s();!(n=i.n()).done;){var u=(0,r.Z)(n.value,2),s=u[0],o=u[1];if(this._byteSize<=e)break;this.delete(s),t(o)}}catch(l){i.e(l)}finally{i.f()}}},{key:"values",value:function(){return this._store.values()}},{key:e,value:function(){return this._store[Symbol.iterator]()}},{key:"_used",value:function(e){var t=this._store.get(e);t&&(this._store.delete(e),this._store.set(e,t))}}]),t}(Symbol.iterator),q=function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).tileInfo=null,r.extent=null,r.maximumByteSize=10*O.s.MEGABYTES,r._tileBounds=new m.o,r._tiles=new B,r._refCounts=new Map,r._tileFeatureCounts=new Map,r._tmpBoundingRect=(0,T.u)(),r}return(0,l.Z)(n,[{key:"add",value:function(e,t){var n,r=this,i=[],u=(0,a.Z)(t);try{for(u.s();!(n=u.n()).done;){var s=n.value;this._referenceFeature(s.objectId)===G.ADDED&&i.push(s)}}catch(o){u.e(o)}finally{u.f()}this._addTileStorage(e,new Set(t.map((function(e){return e.objectId}))),function(e){return e.reduce((function(e,t){return e+function(e){return 32+function(e){if((0,p.t)(e))return 0;var t=(0,O.c)(e.lengths,4);return 32+(0,O.c)(e.coords,8)+t}(e.geometry)+(0,O.t)(e.attributes)}(t)}),0)}(t)),this.featureStore.addMany(i),this._tiles.applyByteSizeLimit(this.maximumByteSize,(function(e){return r._removeTileStorage(e)}))}},{key:"destroy",value:function(){this.clear(),this._tileFeatureCounts.clear()}},{key:"clear",value:function(){this.featureStore.clear(),this._tileBounds.clear(),this._tiles.clear(),this._refCounts.clear()}},{key:"refresh",value:function(){this.clear(),this._tileFeatureCounts.clear()}},{key:"processEdits",value:function(e,t,n){return this._processEditsDelete(e.deletedFeatures.concat(e.updatedFeatures)),this._processEditsRefetch(e.addedFeatures.concat(e.updatedFeatures),t,n)}},{key:"_addTileStorage",value:function(e,t,n){this._tiles.set(e.id,new J(e,t,n)),this._tileBounds.set(e.id,e.extent),this._tileFeatureCounts.set(e.id,t.size)}},{key:"_remove",value:function(e){var t=e.id,n=this._tiles.get(t);n&&this._removeTileStorage(n)}},{key:"_removeTileStorage",value:function(e){var t,n=[],r=(0,a.Z)(e.objectIds);try{for(r.s();!(t=r.n()).done;){var i=t.value;this._unreferenceFeature(i)===G.REMOVED&&n.push(i)}}catch(s){r.e(s)}finally{r.f()}this.featureStore.removeManyById(n);var u=e.data.id;this._tiles.delete(u),this._tileBounds.delete(u)}},{key:"_processEditsDelete",value:function(e){this.featureStore.removeManyById(e);var t,n=(0,a.Z)(this._tiles);try{for(n.s();!(t=n.n()).done;){var i,u=(0,r.Z)(t.value,2)[1],s=(0,a.Z)(e);try{for(s.s();!(i=s.n()).done;){var o=i.value;u.objectIds.delete(o)}}catch(h){s.e(h)}finally{s.f()}this._tileFeatureCounts.set(u.data.id,u.objectIds.size)}}catch(h){n.e(h)}finally{n.f()}var l,c=(0,a.Z)(e);try{for(c.s();!(l=c.n()).done;){var f=l.value;this._refCounts.delete(f)}}catch(h){c.e(h)}finally{c.f()}}},{key:"_processEditsRefetch",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n,r){var i,s,o,l,c,f,h,d=this;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t,r);case 2:i=e.sent.features,s=this.featureStore,o=s.hasZ,l=s.hasM,c=(0,a.Z)(i);try{for(h=function(){var e=f.value,t=(0,F.g)(d._tmpBoundingRect,e.geometry,o,l);(0,p.t)(t)||d._tileBounds.forEachInBounds(t,(function(t){var n=d._tiles.get(t);d.featureStore.add(e),n.objectIds.has(e.objectId)||(n.objectIds.add(e.objectId),d._referenceFeature(e.objectId),d._tileFeatureCounts.set(n.data.id,n.objectIds.size))}))},c.s();!(f=c.n()).done;)h()}catch(u){c.e(u)}finally{c.f()}case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"process",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};if((0,p.t)(this.tileInfo)||!e.extent||(0,p.r)(this.extent)&&!(0,T.E)((0,T.c)(this.extent,this._tmpBoundingRect),e.extent))return new Q(e);if(this._tiles.has(e.id))return new Q(e);var n=this._createTileTree(e,this.tileInfo);return this._simplify(n,t,null,0,1),this._collectMissingTiles(e,n,this.tileInfo)}},{key:"debugInfo",get:function(){var e=this;return Array.from(this._tiles.values()).map((function(t){var n=t.data;return{data:n,featureCount:e._tileFeatureCounts.get(n.id)||0}}))}},{key:"getFeatureCount",value:function(e){var t;return null!==(t=this._tileFeatureCounts.get(e.id))&&void 0!==t?t:0}},{key:"fetchCount",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n,r,i){var a,s;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(a=this._tileFeatureCounts.get(t.id))){e.next=3;break}return e.abrupt("return",a);case 3:return e.next=5,(0,M.S)(n,r,i);case 5:return s=e.sent,e.abrupt("return",(this._tileFeatureCounts.set(t.id,s.data.count),s.data.count));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_createTileTree",value:function(e,t){var n=this,r=new Y(e.level,e.row,e.col);return t.updateTileInfo(r,w.j.ExtrapolateOptions.POWER_OF_TWO),this._tileBounds.forEachInBounds(e.extent,(function(i){var a=n._tiles.get(i).data;n._tilesAreRelated(e,a)&&n._populateChildren(r,a,t,n._tileFeatureCounts.get(a.id)||0)})),r}},{key:"_tilesAreRelated",value:function(e,t){if(!e||!t)return!1;if(e.level===t.level)return e.row===t.row&&e.col===t.col;var n=e.level<t.level,r=n?e:t,i=n?t:e,a=1<<i.level-r.level;return Math.floor(i.row/a)===r.row&&Math.floor(i.col/a)===r.col}},{key:"_populateChildren",value:function(e,t,n,r){var i=t.level-e.level-1;if(i<0)e.isLeaf=!0;else{var a=t.row>>i,u=t.col>>i,s=e.row<<1,o=u-(e.col<<1)+(a-s<<1),l=e.children[o];if((0,p.r)(l))this._populateChildren(l,t,n,r);else{var c=new Y(e.level+1,a,u);n.updateTileInfo(c,w.j.ExtrapolateOptions.POWER_OF_TWO),e.children[o]=c,this._populateChildren(c,t,n,r)}}}},{key:"_simplify",value:function(e,t,n,r,i){var a=i*i;if(e.isLeaf)return t(this.getFeatureCount(e),i)?0:(this._remove(e),(0,p.r)(n)&&(n.children[r]=null),a);for(var u=i/2,s=u*u,o=0,l=0;l<e.children.length;l++){var c=e.children[l];o+=(0,p.r)(c)?this._simplify(c,t,e,l,u):s}return 0===o?this._mergeChildren(e):1-o/a<K&&(this._purge(e),(0,p.r)(n)&&(n.children[r]=null),o=a),o}},{key:"_mergeChildren",value:function(e){var t=this,n=new Set,r=0;this._forEachLeaf(e,(function(e){var i=t._tiles.get(e.id);if(i){r+=i.byteSize;var u,s=(0,a.Z)(i.objectIds);try{for(s.s();!(u=s.n()).done;){var o=u.value;n.has(o)||(n.add(o),t._referenceFeature(o))}}catch(l){s.e(l)}finally{s.f()}t._remove(e)}})),this._addTileStorage(e,n,r),e.isLeaf=!0,e.children[0]=e.children[1]=e.children[2]=e.children[3]=null,this._tileFeatureCounts.set(e.id,n.size)}},{key:"_forEachLeaf",value:function(e,t){var n,r=(0,a.Z)(e.children);try{for(r.s();!(n=r.n()).done;){var i=n.value;(0,p.t)(i)||(i.isLeaf?t(i):this._forEachLeaf(i,t))}}catch(u){r.e(u)}finally{r.f()}}},{key:"_purge",value:function(e){if(!(0,p.t)(e))if(e.isLeaf)this._remove(e);else for(var t=0;t<e.children.length;t++){var n=e.children[t];this._purge(n),e.children[t]=null}}},{key:"_collectMissingTiles",value:function(e,t,n){var r=new X(n,e,this.extent);return this._collectMissingTilesRecurse(t,r,1),r.info}},{key:"_collectMissingTilesRecurse",value:function(e,t,n){if(!e.isLeaf)if(e.hasChildren)for(var r=n/2,i=0;i<e.children.length;i++){var a=e.children[i];(0,p.t)(a)?t.addMissing(e.level+1,(e.row<<1)+((2&i)>>1),(e.col<<1)+(1&i),r):this._collectMissingTilesRecurse(a,t,r)}else t.addMissing(e.level,e.row,e.col,n)}},{key:"_referenceFeature",value:function(e){var t=(this._refCounts.get(e)||0)+1;return this._refCounts.set(e,t),1===t?G.ADDED:G.UNCHANGED}},{key:"_unreferenceFeature",value:function(e){var t=(this._refCounts.get(e)||0)-1;return 0===t?(this._refCounts.delete(e),G.REMOVED):(t>0&&this._refCounts.set(e,t),G.UNCHANGED)}},{key:"test",get:function(){var e=this;return{tiles:Array.from(this._tiles.values()).map((function(e){return"".concat(e.data.id,":[").concat(Array.from(e.objectIds),"]")})),featureReferences:Array.from(this._refCounts.keys()).map((function(t){return"".concat(t,":").concat(e._refCounts.get(t))}))}}}]),n}(h.m);(0,h.e)([(0,h.y)({constructOnly:!0})],q.prototype,"featureStore",void 0),(0,h.e)([(0,h.y)()],q.prototype,"tileInfo",void 0),(0,h.e)([(0,h.y)()],q.prototype,"extent",void 0),(0,h.e)([(0,h.y)()],q.prototype,"maximumByteSize",void 0),q=(0,h.e)([(0,h.n)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore")],q);var G,W,J=(0,l.Z)((function e(t,n,r){(0,o.Z)(this,e),this.data=t,this.objectIds=n,this.byteSize=r})),Y=function(){function e(t,n,r){(0,o.Z)(this,e),this.level=t,this.row=n,this.col=r,this.isLeaf=!1,this.extent=null,this.children=[null,null,null,null]}return(0,l.Z)(e,[{key:"hasChildren",get:function(){return!this.isLeaf&&((0,p.r)(this.children[0])||(0,p.r)(this.children[1])||(0,p.r)(this.children[2])||(0,p.r)(this.children[3]))}}]),e}(),Q=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,o.Z)(this,e),this.missingTiles=n,this.fullArea=0,this.coveredArea=0,this.fullArea=(0,T.y)(t.extent),this.coveredArea=this.fullArea}return(0,l.Z)(e,[{key:"prepend",value:function(e){this.missingTiles=e.missingTiles.concat(this.missingTiles),this.coveredArea+=e.coveredArea,this.fullArea+=e.fullArea}}]),e}(),X=function(){function e(t,n,r){(0,o.Z)(this,e),this._tileInfo=t,this._extent=null,this.info=new Q(n),(0,p.r)(r)&&(this._extent=(0,T.c)(r))}return(0,l.Z)(e,[{key:"addMissing",value:function(e,t,n,r){var i=new A.t(null,e,t,n);this._tileInfo.updateTileInfo(i,w.j.ExtrapolateOptions.POWER_OF_TWO),(0,p.t)(i.extent)||(0,p.r)(this._extent)&&!(0,T.E)(this._extent,i.extent)||(this.info.missingTiles.push({data:i,resolution:r}),this.info.coveredArea-=(0,T.y)(i.extent))}}]),e}(),K=.18751;(W=G||(G={}))[W.ADDED=0]="ADDED",W[W.REMOVED=1]="REMOVED",W[W.UNCHANGED=2]="UNCHANGED";var $=function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments))._isInitializing=!0,e.remoteClient=null,e._whenSetup=(0,h.A)(),e._elevationAligner=(0,Z.r)(),e._elevationFilter=(0,Z.a)(),e._symbologyCandidatesFetcher=(0,Z.n)(),e._handles=new h.X,e._updatingHandles=new y.c,e._editsUpdatingHandles=new y.c,e._pendingApplyEdits=new Map,e._alignPointsInFeatures=function(){var t=(0,s.Z)((0,u.Z)().mark((function t(n,r){var i,a;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={points:n},t.next=3,e.remoteClient.invoke("alignElevation",i,{signal:r});case 3:return a=t.sent,t.abrupt("return",((0,h.f)(r),a));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e._getSymbologyCandidates=function(){var t=(0,s.Z)((0,u.Z)().mark((function t(n,r){var i,a;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={candidates:n,spatialReference:e._spatialReference.toJSON()},t.next=3,e.remoteClient.invoke("getSymbologyCandidates",i,{signal:r});case 3:return a=t.sent,t.abrupt("return",((0,h.f)(r),a));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return(0,l.Z)(n,[{key:"updating",get:function(){return this.updatingExcludingEdits||this._editsUpdatingHandles.updating||this._featureFetcher.updating}},{key:"updatingExcludingEdits",get:function(){return this._featureFetcher.updatingExcludingEdits||this._isInitializing||this._updatingHandles.updating}},{key:"destroy",value:function(){this._featureFetcher.destroy(),this._queryEngine.destroy(),this._featureStore.clear(),this._handles.destroy()}},{key:"setup",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t){var n,r,a,s,o,l,c,f,h=this;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.serviceInfo,r=n.geometryType,a=n.objectIdField,s=n.timeInfo,o=n.fields,l=t.hasZ,c=g.k.fromJSON(t.spatialReference),this._spatialReference=c,this._featureStore=new m.u((0,i.Z)((0,i.Z)({},t.serviceInfo),{},{hasZ:l,hasM:!1})),this._queryEngine=new _.Y({spatialReference:t.spatialReference,featureStore:this._featureStore,geometryType:r,fields:o,hasZ:l,hasM:!1,objectIdField:a,timeInfo:s?k.v.fromJSON(s):null}),this._featureFetcher=new j({store:new q({featureStore:this._featureStore}),url:t.serviceInfo.url,objectIdField:t.serviceInfo.objectIdField,globalIdField:t.serviceInfo.globalIdField,capabilities:t.serviceInfo.capabilities,spatialReference:c,sourceSpatialReference:g.k.fromJSON(t.serviceInfo.spatialReference)}),f="3d"===t.configuration.viewType,e.abrupt("return",(this._elevationAligner=(0,Z.r)(f,{elevationInfo:(0,p.r)(t.elevationInfo)?x.x.fromJSON(t.elevationInfo):null,alignPointsInFeatures:this._alignPointsInFeatures,spatialReference:c}),this._elevationFilter=(0,Z.a)(f),this._handles.add([(0,v.l)((function(){return h._featureFetcher.availability}),(function(e){return h.emit("notify-availability",{availability:e})}),v.U),(0,v.l)((function(){return h.updating}),(function(){return h._notifyUpdating()}))]),this._whenSetup.resolve(),this._isInitializing=!1,this.configure(t.configuration)));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._updatingHandles.addPromise(this._whenSetup.promise);case 2:return this._updateFeatureFetcherConfiguration(t),e.abrupt("return",{result:{}});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchCandidates",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){var r,i,a,s,o,l;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._whenSetup.promise;case 2:return(0,h.f)(n),r=te(t),i=(0,p.r)(n)?n.signal:null,e.next=7,this._queryEngine.executeQueryForSnapping(r,i);case 7:return a=e.sent,(0,h.f)(i),e.next=11,this._elevationAligner.alignCandidates(a.candidates,i);case 11:return s=e.sent,(0,h.f)(i),e.next=15,this._symbologyCandidatesFetcher.fetch(s,i);case 15:return o=e.sent,(0,h.f)(i),l=0===o.length?s:s.concat(o),e.abrupt("return",{result:{candidates:this._elevationFilter.filter(r,l)}});case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTiles",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._updatingHandles.addPromise(this._whenSetup.promise);case 2:return(0,h.f)(n),this._featureFetcher.tileSize=t.tileSize,this._featureFetcher.tilesOfInterest=t.tiles,this._featureFetcher.tileInfo=(0,p.r)(t.tileInfo)?w.j.fromJSON(t.tileInfo):null,e.abrupt("return",ne);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._updatingHandles.addPromise(this._whenSetup.promise);case 2:return(0,h.f)(n),this._featureFetcher.refresh(),e.abrupt("return",ne);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"whenNotUpdating",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){var r=this;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._updatingHandles.addPromise(this._whenSetup.promise);case 2:return(0,h.f)(n),e.next=5,(0,v.j)((function(){return!r.updatingExcludingEdits}),n);case 5:return(0,h.f)(n),e.abrupt("return",ne);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getDebugInfo",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",((0,h.f)(n),{result:this._featureFetcher.debugInfo}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"beginApplyEdits",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){var r;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._updatingHandles.addPromise(this._whenSetup.promise),(0,h.f)(n),r=(0,h.A)(),e.abrupt("return",(this._pendingApplyEdits.set(t.id,r),this._featureFetcher.applyEdits(r.promise),this._editsUpdatingHandles.addPromise(r.promise),ne));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"endApplyEdits",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){var r;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._pendingApplyEdits.get(t.id),e.abrupt("return",(r&&r.resolve(t.edits),(0,h.f)(n),ne));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"notifyElevationSourceChange",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this._elevationAligner.notifyElevationSourceChange(),ne));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"notifySymbologyChange",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,n){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ne);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setSymbologySnappingSupported",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this._symbologyCandidatesFetcher=(0,Z.n)(t,this._getSymbologyCandidates),ne));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateFeatureFetcherConfiguration",value:function(e){this._featureFetcher.filter=(0,p.r)(e.filter)?b.x.fromJSON(e.filter):null,this._featureFetcher.customParameters=e.customParameters}},{key:"_notifyUpdating",value:function(){this.emit("notify-updating",{updating:this.updating})}}]),n}(d.n.EventedAccessor);(0,h.e)([(0,h.y)({readOnly:!0})],$.prototype,"updating",null),(0,h.e)([(0,h.y)({readOnly:!0})],$.prototype,"updatingExcludingEdits",null),(0,h.e)([(0,h.y)()],$.prototype,"_isInitializing",void 0);var ee=$=(0,h.e)([(0,h.n)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorker")],$);function te(e){return{point:e.point,distance:e.distance,types:e.types,query:(0,p.r)(e.filter)?e.filter:{where:"1=1"}}}var ne={result:{}};t.default=ee},69641:function(e,t,n){n.d(t,{n:function(){return C},p:function(){return v},t:function(){return I},u:function(){return b},y:function(){return A}});var r,i=n(15671),a=n(43144),u=n(60136),s=n(29388),o=n(48848),l=n(40558),c=n(40114),f=n(93661),h=n(20302),d=n(82474),p=n(15436),v=r=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).name=null,r.code=null,r}return(0,a.Z)(n,[{key:"clone",value:function(){return new r({name:this.name,code:this.code})}}]),n}(c.l);(0,o.e)([(0,o.y)({type:String,json:{write:!0}})],v.prototype,"name",void 0),(0,o.e)([(0,o.y)({type:[String,Number],json:{write:!0}})],v.prototype,"code",void 0),v=r=(0,o.e)([(0,o.n)("esri.layers.support.CodedValue")],v);var y=new l.s({inherited:"inherited",codedValue:"coded-value",range:"range"}),g=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).name=null,r.type=null,r}return(0,a.Z)(n)}(c.l);(0,o.e)([(0,o.y)({type:String,json:{write:!0}})],g.prototype,"name",void 0),(0,o.e)([(0,h.r)(y)],g.prototype,"type",void 0);var m,_=g=(0,o.e)([(0,o.n)("esri.layers.support.Domain")],g),w=m=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).codedValues=null,r.type="coded-value",r}return(0,a.Z)(n,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var n=String(e);this.codedValues.some((function(e){return String(e.code)===n&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new m({codedValues:(0,f.y)(this.codedValues),name:this.name})}}]),n}(_);(0,o.e)([(0,o.y)({type:[v],json:{write:!0}})],w.prototype,"codedValues",void 0),(0,o.e)([(0,h.r)({codedValue:"coded-value"})],w.prototype,"type",void 0);var k,b=w=m=(0,o.e)([(0,o.n)("esri.layers.support.CodedValueDomain")],w),x=k=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type="inherited",r}return(0,a.Z)(n,[{key:"clone",value:function(){return new k}}]),n}(_);(0,o.e)([(0,h.r)({inherited:"inherited"})],x.prototype,"type",void 0);var Z,S=x=k=(0,o.e)([(0,o.n)("esri.layers.support.InheritedDomain")],x),E=Z=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).maxValue=null,r.minValue=null,r.type="range",r}return(0,a.Z)(n,[{key:"clone",value:function(){return new Z({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),n}(_);(0,o.e)([(0,o.y)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,n){t[n]=[this.minValue||0,e]}}}})],E.prototype,"maxValue",void 0),(0,o.e)([(0,o.y)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,n){t[n]=[e,this.maxValue||0]}}}})],E.prototype,"minValue",void 0),(0,o.e)([(0,h.r)({range:"range"})],E.prototype,"type",void 0);var T,F=E=Z=(0,o.e)([(0,o.n)("esri.layers.support.RangeDomain")],E),C={key:"type",base:_,typeMap:{range:F,"coded-value":b,inherited:S}};function I(e){if(!e||!e.type)return null;switch(e.type){case"range":return F.fromJSON(e);case"codedValue":return b.fromJSON(e);case"inherited":return S.fromJSON(e)}return null}var M=new l.s({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),O=T=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).alias=null,r.defaultValue=void 0,r.description=null,r.domain=null,r.editable=!0,r.length=-1,r.name=null,r.nullable=!0,r.type=null,r.valueType=null,r.visible=!0,r}return(0,a.Z)(n,[{key:"readDescription",value:function(e,t){var n,r,i=t.description,a=null;try{a=i?JSON.parse(i):null}catch(u){}return null!==(n=null===(r=a)||void 0===r?void 0:r.value)&&void 0!==n?n:null}},{key:"readValueType",value:function(e,t){var n=t.description,r=null;try{r=n?JSON.parse(n):null}catch(i){}return r?M.fromJSON(r.fieldValueType):null}},{key:"clone",value:function(){return new T({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}}]),n}(c.l);(0,o.e)([(0,o.y)({type:String,json:{write:!0}})],O.prototype,"alias",void 0),(0,o.e)([(0,o.y)({type:[String,Number],json:{write:{allowNull:!0}}})],O.prototype,"defaultValue",void 0),(0,o.e)([(0,o.y)()],O.prototype,"description",void 0),(0,o.e)([(0,d.o)("description")],O.prototype,"readDescription",null),(0,o.e)([(0,o.y)({types:C,json:{read:{reader:I},write:!0}})],O.prototype,"domain",void 0),(0,o.e)([(0,o.y)({type:Boolean,json:{write:!0}})],O.prototype,"editable",void 0),(0,o.e)([(0,o.y)({type:o.T,json:{write:!0}})],O.prototype,"length",void 0),(0,o.e)([(0,o.y)({type:String,json:{write:!0}})],O.prototype,"name",void 0),(0,o.e)([(0,o.y)({type:Boolean,json:{write:!0}})],O.prototype,"nullable",void 0),(0,o.e)([(0,h.r)(p.i)],O.prototype,"type",void 0),(0,o.e)([(0,o.y)()],O.prototype,"valueType",void 0),(0,o.e)([(0,d.o)("valueType",["description"])],O.prototype,"readValueType",null),(0,o.e)([(0,o.y)({type:Boolean,json:{read:!1}})],O.prototype,"visible",void 0);var A=O=T=(0,o.e)([(0,o.n)("esri.layers.support.Field")],O)},630:function(e,t,n){n.d(t,{a:function(){return h},c:function(){return c},d:function(){return d}});var r=n(15671),i=n(43144),a=n(60136),u=n(29388),s=n(48848),o=n(93661),l=n(50690),c=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).updating=!1,e._handleId=0,e._handles=new s.X,e._scheduleHandleId=0,e._pendingPromises=new Set,e}return(0,i.Z)(n,[{key:"destroy",value:function(){this.removeAll(),this._handles.destroy()}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._installWatch(e,t,n,l.l)}},{key:"addWhen",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._installWatch(e,t,n,l.f)}},{key:"addOnCollectionChange",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.initial,a=void 0!==i&&i,u=r.final,s=void 0!==u&&u,o=++this._handleId;return this._handles.add([(0,l.a)(e,"after-changes",this._createSyncUpdatingCallback(),l.U),(0,l.a)(e,"change",t,{onListenerAdd:a?function(e){return t({added:e.toArray(),removed:[]})}:void 0,onListenerRemove:s?function(e){return t({added:[],removed:e.toArray()})}:void 0})],o),{remove:function(){return n._handles.remove(o)}}}},{key:"addPromise",value:function(e){var t=this;if((0,o.t)(e))return e;var n=++this._handleId;this._handles.add({remove:function(){t._pendingPromises.delete(e)&&(0!==t._pendingPromises.size||t._handles.has(f)||t._set("updating",!1))}},n),this._pendingPromises.add(e),this._set("updating",!0);var r=function(){return t._handles.remove(n)};return e.then(r,r),e}},{key:"removeAll",value:function(){this._pendingPromises.clear(),this._handles.removeAll(),this._set("updating",!1)}},{key:"_installWatch",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,a=++this._handleId;r.sync||this._installSyncUpdatingWatch(e,a);var u=i(e,t,r);return this._handles.add(u,a),{remove:function(){return n._handles.remove(a)}}}},{key:"_installSyncUpdatingWatch",value:function(e,t){var n=this._createSyncUpdatingCallback(),r=(0,l.l)(e,n,{sync:!0,equals:function(){return!1}});return this._handles.add(r,t),r}},{key:"_createSyncUpdatingCallback",value:function(){var e=this;return function(){e._handles.remove(f),++e._scheduleHandleId;var t=e._scheduleHandleId;e._get("updating")||e._set("updating",!0),e._handles.add((0,s.k)((function(){t===e._scheduleHandleId&&(e._set("updating",e._pendingPromises.size>0),e._handles.remove(f))})),f)}}}]),n}(s.m);(0,s.e)([(0,s.y)({readOnly:!0})],c.prototype,"updating",void 0),c=(0,s.e)([(0,s.n)("esri.core.support.WatchUpdatingTracking")],c);var f=-42,h=function(e){var t=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"destroy",value:function(){var e,t;this.destroyed||(null!==(e=this._get("handles"))&&void 0!==e&&e.destroy(),null===(t=this._get("updatingHandles"))||void 0===t||t.destroy())}},{key:"handles",get:function(){return this._get("handles")||new s.X}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new c}}]),n}(e);return(0,s.e)([(0,s.y)({readOnly:!0})],t.prototype,"handles",null),(0,s.e)([(0,s.y)({readOnly:!0})],t.prototype,"updatingHandles",null),t=(0,s.e)([(0,s.n)("esri.core.HandleOwner")],t),t},d=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n)}(h(s.m));d=(0,s.e)([(0,s.n)("esri.core.HandleOwner")],d)},43976:function(e,t,n){n.d(t,{e:function(){return u}});var r=n(15671),i=n(43144),a=n(6762),u=function(){function e(t,n){(0,r.Z)(this,e),this._storage=new a.h,this._storage.maxSize=t,n&&this._storage.registerRemoveFunc("",n)}return(0,i.Z)(e,[{key:"put",value:function(e,t){this._storage.put(e,t,1,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.destroy()}}]),e}()},39926:function(e,t,n){n.d(t,{e:function(){return u}});var r=n(15671),i=n(43144),a=n(6762),u=function(){function e(t,n){(0,r.Z)(this,e),this._storage=new a.h,this._storage.maxSize=t,n&&this._storage.registerRemoveFunc("",n)}return(0,i.Z)(e,[{key:"put",value:function(e,t,n){this._storage.put(e,t,n,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.destroy()}},{key:"maxSize",get:function(){return this._storage.maxSize},set:function(e){this._storage.maxSize=e}}]),e}()},6762:function(e,t,n){n.d(t,{h:function(){return d},i:function(){return r},r:function(){return h},s:function(){return f}});var r,i,a=n(29439),u=n(37762),s=n(15671),o=n(43144),l=n(93661),c=n(48848),f=-3;(i=r||(r={}))[i.ALL=0]="ALL",i[i.SOME=1]="SOME";var h=function(){function e(t,n,r){(0,s.Z)(this,e),this._namespace=t,this._storage=n,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",r&&(this._storage.registerRemoveFunc(this._namespace,r),this._removeFunc=!0)}return(0,o.Z)(e,[{key:"destroy",value:function(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}},{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}},{key:"resetHitRate",value:function(){this._hit=this._miss=0}},{key:"put",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._storage.put(this._namespace+e,t,n,r)}},{key:"get",value:function(e){var t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"pop",value:function(e){var t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"updateSize",value:function(e,t,n){this._storage.updateSize(this._namespace+e,t,n)}},{key:"clear",value:function(){this._storage.clear(this._namespace)}},{key:"clearAll",value:function(){this._storage.clearAll()}},{key:"getStats",value:function(){return this._storage.getStats()}},{key:"resetStats",value:function(){this._storage.resetStats()}}]),e}(),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10485760;(0,s.Z)(this,e),this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new c.a6,this._users=new c.a6}return(0,o.Z)(e,[{key:"destroy",value:function(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}},{key:"register",value:function(e){this._users.push(e)}},{key:"deregister",value:function(e){this._users.removeUnordered(e)}},{key:"registerRemoveFunc",value:function(e,t){this._removeFuncs.push([e,t])}},{key:"deregisterRemoveFunc",value:function(e){this._removeFuncs.filterInPlace((function(t){return t[0]!==e}))}},{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}},{key:"put",value:function(e,t,n,i){var a=this._db.get(e);if(a&&(this._size-=a.size,this._db.delete(e),a.entry!==t&&this._notifyRemove(e,a.entry,r.ALL)),n>this._maxSize)this._notifyRemove(e,t,r.ALL);else if(void 0!==t)if(!n||n<0)console.warn("Refusing to cache entry with invalid size "+n);else{var u=1+Math.max(i,f)-f;this._db.set(e,{entry:t,size:n,lifetime:u,lives:u}),this._size+=n,this._checkSizeLimit()}else console.warn("Refusing to cache undefined entry ")}},{key:"updateSize",value:function(e,t,n){var i=this._db.get(e);if(i&&i.entry===t){for(this._size-=i.size;n>this._maxSize;){var a=this._notifyRemove(e,t,r.SOME);if(!((0,l.r)(a)&&a>0))return void this._db.delete(e);n=a}i.size=n,this._size+=n,this._checkSizeLimit()}}},{key:"pop",value:function(e){var t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}},{key:"get",value:function(e){var t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}},{key:"getStats",value:function(){var e=this,t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},n={},r=new Array;this._db.forEach((function(t,i){var a=t.lifetime;r[a]=(r[a]||0)+t.size,e._users.forAll((function(e){var r=e.namespace;if(i.startsWith(r)){var a=n[r]||0;n[r]=a+t.size}}))}));var i={};this._users.forAll((function(e){var t=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){var r=n[t]||0;n[t]=r,i[t]=Math.round(100*e.hitRate)+"%"}else i[t]="0%"}));var a=Object.keys(n);a.sort((function(e,t){return n[t]-n[e]})),a.forEach((function(e){return t[e]=Math.round(n[e]/Math.pow(2,20))+"MB / "+i[e]}));for(var u=r.length-1;u>=0;--u){var s=r[u];s&&(t["Priority "+(u+f-1)]=Math.round(s/this.size*100)+"%")}return t}},{key:"resetStats",value:function(){this._hit=this._miss=0,this._users.forAll((function(e){return e.resetHitRate()}))}},{key:"clear",value:function(e){var t=this;this._db.forEach((function(n,i){i.startsWith(e)&&(t._size-=n.size,t._db.delete(i),t._notifyRemove(i,n.entry,r.ALL))}))}},{key:"clearAll",value:function(){var e=this;this._db.forEach((function(t,n){return e._notifyRemove(n,t.entry,r.ALL)})),this._size=0,this._db.clear()}},{key:"_getHitRate",value:function(){return this._hit/(this._hit+this._miss)}},{key:"_notifyRemove",value:function(e,t,n){var r;return this._removeFuncs.some((function(i){if(e.startsWith(i[0])){var a=i[1](t,n);return"number"==typeof a&&(r=a),!0}return!1})),r}},{key:"_checkSizeLimit",value:function(){if(!(this._size<=this._maxSize)){var e,t=(0,u.Z)(this._db);try{for(t.s();!(e=t.n()).done;){var n=(0,a.Z)(e.value,2),i=n[0],s=n[1];if(this._db.delete(i),s.lives<=1){this._size-=s.size;var o=this._notifyRemove(i,s.entry,r.SOME);(0,l.r)(o)&&o>0&&(this._size+=o,s.lives=s.lifetime,s.size=o,this._db.set(i,s))}else--s.lives,this._db.set(i,s);if(this._size<=.9*this.maxSize)return}}catch(c){t.e(c)}finally{t.f()}}}}]),e}()},15751:function(e,t,n){n.d(t,{e:function(){return u}});var r=n(15671),i=n(43144),a=n(48848),u=function(){function e(){(0,r.Z)(this,e),this._observers=[]}return(0,i.Z)(e,[{key:"observe",value:function(e){return this._observers.includes(e)||this._observers.push(e),new a.W(this._observers,e)}},{key:"notify",value:function(){for(var e=this._observers.slice(),t=0;t<e.length;++t){var n=e[t];n.onInvalidated(),n.onCommitted()}}}]),e}()},58492:function(e,t,n){function r(e,t,n){return{objectId:e,target:t,distance:n,type:"vertex"}}function i(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{objectId:e,target:t,distance:n,type:"edge",start:r,end:i,draped:a}}n.d(t,{e:function(){return i},t:function(){return r}})},21385:function(e,t,n){n.d(t,{a:function(){return g}});var r=n(74165),i=n(15861),a=n(15671),u=n(43144),s=n(60136),o=n(29388),l=n(48848),c=n(89794),f=n(40558),h=n(40114),d=(n(93661),n(82474)),p=new f.s({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"}),v=0,y=function(e){(0,s.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).id="sym"+v++,r.type=null,r.color=new c.l([0,0,0,1]),r}return(0,u.Z)(n,[{key:"readColor",value:function(e){return e&&null!=e[0]?[e[0],e[1],e[2],e[3]/255]:e}},{key:"collectRequiredFields",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"hash",value:function(){return JSON.stringify(this.toJSON())}},{key:"clone",value:function(){}}]),n}(h.l);(0,l.e)([(0,l.y)({type:p.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:p.write}}})],y.prototype,"type",void 0),(0,l.e)([(0,l.y)({type:c.l,json:{write:{allowNull:!0}}})],y.prototype,"color",void 0),(0,l.e)([(0,d.o)("color")],y.prototype,"readColor",null);var g=y=(0,l.e)([(0,l.n)("esri.symbols.Symbol")],y)},3356:function(e,t,n){n.d(t,{j:function(){return b},p:function(){return _}});var r,i=n(1413),a=n(15671),u=n(43144),s=n(60136),o=n(29388),l=n(48848),c=n(40558),f=n(40114),h=n(93661),d=n(47855),p=n(82474),v=n(25456),y=n(36040),g=r=function(e){(0,s.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).cols=null,r.level=0,r.levelValue=null,r.origin=null,r.resolution=0,r.rows=null,r.scale=0,r}return(0,u.Z)(n,[{key:"clone",value:function(){return new r({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}}]),n}(f.l);(0,l.e)([(0,l.y)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],g.prototype,"cols",void 0),(0,l.e)([(0,l.y)({type:l.T,json:{write:!0}})],g.prototype,"level",void 0),(0,l.e)([(0,l.y)({type:String,json:{write:!0}})],g.prototype,"levelValue",void 0),(0,l.e)([(0,l.y)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],g.prototype,"origin",void 0),(0,l.e)([(0,l.y)({type:Number,json:{write:!0}})],g.prototype,"resolution",void 0),(0,l.e)([(0,l.y)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],g.prototype,"rows",void 0),(0,l.e)([(0,l.y)({type:Number,json:{write:!0}})],g.prototype,"scale",void 0);var m,_=g=r=(0,l.e)([(0,l.n)("esri.layers.support.LOD")],g),w=new c.s({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"}),k=m=function(e){(0,s.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).dpi=96,r.format=null,r.origin=null,r.minScale=0,r.maxScale=0,r.size=null,r.spatialReference=null,r}return(0,u.Z)(n,[{key:"isWrappable",get:function(){var e=this.spatialReference,t=this.origin;if(e&&t){var n=(0,p.a)(e);return e.isWrappable&&!!n&&Math.abs(n.origin[0]-t.x)<=n.dx}return!1}},{key:"readOrigin",value:function(e,t){return p.w.fromJSON((0,i.Z)({spatialReference:t.spatialReference},e))}},{key:"lods",set:function(e){var t=0,n=0,r=[],i=this._levelToLOD={};e&&(t=-1/0,n=1/0,e.forEach((function(e){r.push(e.scale),t=e.scale>t?e.scale:t,n=e.scale<n?e.scale:n,i[e.level]=e}))),this._set("scales",r),this._set("minScale",t),this._set("maxScale",n),this._set("lods",e),this._initializeUpsampleLevels()}},{key:"readSize",value:function(e,t){return[t.cols,t.rows]}},{key:"writeSize",value:function(e,t){t.cols=e[0],t.rows=e[1]}},{key:"zoomToScale",value:function(e){var t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];var n=Math.floor(e),r=n+1;return t[n]/Math.pow(t[n]/t[r],e-n)}},{key:"scaleToZoom",value:function(e){for(var t=this.scales,n=t.length-1,r=0;r<n;r++){var i=t[r],a=t[r+1];if(i<=e)return r;if(a===e)return r+1;if(i>e&&a<e)return r+Math.log(i/e)/Math.log(i/a)}return r}},{key:"snapScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=this.scaleToZoom(e);return n%Math.floor(n)>=t?this.zoomToScale(Math.ceil(n)):this.zoomToScale(Math.floor(n))}},{key:"tileAt",value:function(e,t,n,r){var i,a,u=this.lodAt(e);if(!u)return null;if("number"==typeof t)i=t,a=n;else if((0,p.E)(t.spatialReference,this.spatialReference))i=t.x,a=t.y,r=n;else{var s=(0,p.M)(t,this.spatialReference);if((0,h.t)(s))return null;i=s.x,a=s.y,r=n}var o=u.resolution*this.size[0],l=u.resolution*this.size[1];return r||(r=new y.t(null,0,0,0,(0,v.u)())),r.level=e,r.row=Math.floor((this.origin.y-a)/l+.001),r.col=Math.floor((i-this.origin.x)/o+.001),this.updateTileInfo(r),r}},{key:"updateTileInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.ExtrapolateOptions.NONE,n=this.lodAt(e.level);if(!n&&t===m.ExtrapolateOptions.POWER_OF_TWO){var r=this.lods[this.lods.length-1];r.level<e.level&&(n=r)}if(n){var i=e.level-n.level,a=n.resolution*this.size[0]/Math.pow(2,i),u=n.resolution*this.size[1]/Math.pow(2,i);e.id="".concat(e.level,"/").concat(e.row,"/").concat(e.col),e.extent||(e.extent=(0,v.u)()),e.extent[0]=this.origin.x+e.col*a,e.extent[1]=this.origin.y-(e.row+1)*u,e.extent[2]=e.extent[0]+a,e.extent[3]=e.extent[1]+u}}},{key:"upsampleTile",value:function(e){var t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}},{key:"getTileBounds",value:function(e,t){var n=this.lodAt(t.level);if(null==n)return null;var r=n.resolution,i=r*this.size[0],a=r*this.size[1];return e[0]=this.origin.x+t.col*i,e[1]=this.origin.y-(t.row+1)*a,e[2]=e[0]+i,e[3]=e[1]+a,e}},{key:"lodAt",value:function(e){var t,n;return null!==(t=null===(n=this._levelToLOD)||void 0===n?void 0:n[e])&&void 0!==t?t:null}},{key:"clone",value:function(){return m.fromJSON(this.write({}))}},{key:"getOrCreateCompatible",value:function(e,t){if(256===this.size[0]&&256===this.size[1])return 256===e?this:null;for(var n=[],r=this.lods.length,i=0;i<r;i++){var a=this.lods[i],u=a.resolution*t;n.push(new _({level:a.level,scale:a.scale,resolution:u}))}return new m({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:n})}},{key:"_initializeUpsampleLevels",value:function(){var e=this.lods;this._upsampleLevels=[];for(var t=null,n=0;n<e.length;n++){var r=e[n];this._upsampleLevels[r.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/r.resolution:0},t=r}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resolutionFactor,n=void 0===t?1:t,r=e.scales,i=e.size,a=void 0===i?256:i,u=e.spatialReference,s=void 0===u?p.k.WebMercator:u,o=e.numLODs,l=void 0===o?24:o;if(!(0,p.I)(s)){var c=[];if(r)for(var f=0;f<r.length;f++){var h=r[f];c.push({level:f,scale:h,resolution:h})}else for(var v=5e-4,y=l-1;y>=0;y--)c.unshift({level:y,scale:v,resolution:v}),v*=2;return new m({dpi:96,lods:c,origin:new p.w(0,0,s),size:[a,a],spatialReference:s})}var g=(0,p.a)(s),_=e.origin?new p.w({x:e.origin.x,y:e.origin.y,spatialReference:s}):new p.w(g?{x:g.origin[0],y:g.origin[1],spatialReference:s}:{x:0,y:0,spatialReference:s}),w=96,k=1/(39.37*(0,d.$)(s)*w),b=[];if(r)for(var x=0;x<r.length;x++){var Z=r[x],S=Z*k;b.push({level:x,scale:Z,resolution:S})}else{var E=(0,p.h)(s)?512/a*591657527.5917094:256/a*591657527.591555,T=Math.ceil(l/n);b.push({level:0,scale:E,resolution:E*k});for(var F=1;F<T;F++){var C=E/Math.pow(2,n),I=C*k;b.push({level:F,scale:C,resolution:I}),E=C}}return new m({dpi:w,lods:b,origin:_,size:[a,a],spatialReference:s})}}]),n}(f.l);(0,l.e)([(0,l.y)({type:Number,json:{write:!0}})],k.prototype,"compressionQuality",void 0),(0,l.e)([(0,l.y)({type:Number,json:{write:!0}})],k.prototype,"dpi",void 0),(0,l.e)([(0,l.y)({type:String,json:{read:w.read,write:w.write,origins:{"web-scene":{read:!1,write:!1}}}})],k.prototype,"format",void 0),(0,l.e)([(0,l.y)({readOnly:!0})],k.prototype,"isWrappable",null),(0,l.e)([(0,l.y)({type:p.w,json:{write:!0}})],k.prototype,"origin",void 0),(0,l.e)([(0,p.o)("origin")],k.prototype,"readOrigin",null),(0,l.e)([(0,l.y)({type:[_],value:null,json:{write:!0}})],k.prototype,"lods",null),(0,l.e)([(0,l.y)({readOnly:!0})],k.prototype,"minScale",void 0),(0,l.e)([(0,l.y)({readOnly:!0})],k.prototype,"maxScale",void 0),(0,l.e)([(0,l.y)({readOnly:!0})],k.prototype,"scales",void 0),(0,l.e)([(0,l.y)({cast:function(e){return Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]}})],k.prototype,"size",void 0),(0,l.e)([(0,p.o)("size",["rows","cols"])],k.prototype,"readSize",null),(0,l.e)([(0,p.r)("size",{cols:{type:l.T},rows:{type:l.T}})],k.prototype,"writeSize",null),(0,l.e)([(0,l.y)({type:p.k,json:{write:!0}})],k.prototype,"spatialReference",void 0),function(e){var t;(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO"}((k=m=(0,l.e)([(0,l.n)("esri.layers.support.TileInfo")],k))||(k={}));var b=k},36040:function(e,t,n){n.d(t,{t:function(){return a}});var r=n(43144),i=n(15671),a=(0,r.Z)((function e(t,n,r,a,u){(0,i.Z)(this,e),this.id=t,this.level=n,this.row=r,this.col=a,this.extent=u}))},89181:function(e,t,n){n.d(t,{T:function(){return w},g:function(){return y},n:function(){return p}});var r,i=n(15671),a=n(43144),u=n(60136),s=n(29388),o=n(48848),l=n(40114),c=n(93661),f=n(82474),h={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},d={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function p(e,t,n){var r=new Date(e.getTime());if(t&&n){var i=d[n],a=i.getter,u=i.setter,s=i.multiplier;if("months"===n){var o=function(e,t){var n=new Date(e,t+1,1);return n.setDate(0),n.getDate()}(r.getFullYear(),r.getMonth()+t);r.getDate()>o&&r.setDate(o)}r[u](r[a]()+t*s)}return r}function v(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return new Date}}function y(e,t,n){return 0===e?0:e*h[t]/h[n]}var g=r=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).end=null,r.start=null,r}return(0,a.Z)(n,[{key:"readEnd",value:function(e,t){return null!=t.end?new Date(t.end):null}},{key:"writeEnd",value:function(e,t){t.end=e?e.getTime():null}},{key:"isAllTime",get:function(){return this.equals(r.allTime)}},{key:"isEmpty",get:function(){return this.equals(r.empty)}},{key:"readStart",value:function(e,t){return null!=t.start?new Date(t.start):null}},{key:"writeStart",value:function(e,t){t.start=e?e.getTime():null}},{key:"clone",value:function(){return new r({end:this.end,start:this.start})}},{key:"equals",value:function(e){if(!e)return!1;var t=(0,c.r)(this.start)?this.start.getTime():this.start,n=(0,c.r)(this.end)?this.end.getTime():this.end,r=(0,c.r)(e.start)?e.start.getTime():e.start,i=(0,c.r)(e.end)?e.end.getTime():e.end;return t===r&&n===i}},{key:"expandTo",value:function(e){if(this.isEmpty||this.isAllTime)return this.clone();var t=(0,c.n)(this.start,(function(t){return v(t,e)})),n=(0,c.n)(this.end,(function(t){var n=v(t,e);return t.getTime()===n.getTime()?n:p(n,1,e)}));return new r({start:t,end:n})}},{key:"intersection",value:function(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return r.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();var t,n,i=(0,c.u)(this.start,-1/0,(function(e){return e.getTime()})),a=(0,c.u)(this.end,1/0,(function(e){return e.getTime()})),u=(0,c.u)(e.start,-1/0,(function(e){return e.getTime()})),s=(0,c.u)(e.end,1/0,(function(e){return e.getTime()}));if(u>=i&&u<=a?t=u:i>=u&&i<=s&&(t=i),a>=u&&a<=s?n=a:s>=i&&s<=a&&(n=s),null!=t&&null!=n&&!isNaN(t)&&!isNaN(n)){var o=new r;return o.start=t===-1/0?null:new Date(t),o.end=n===1/0?null:new Date(n),o}return r.empty}},{key:"offset",value:function(e,t){if(this.isEmpty||this.isAllTime)return this.clone();var n=new r,i=this.start,a=this.end;return(0,c.r)(i)&&(n.start=p(i,e,t)),(0,c.r)(a)&&(n.end=p(a,e,t)),n}},{key:"union",value:function(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return m.clone();var t=(0,c.r)(this.start)&&(0,c.r)(e.start)?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,n=(0,c.r)(this.end)&&(0,c.r)(e.end)?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new r({start:t,end:n})}}],[{key:"allTime",get:function(){return m}},{key:"empty",get:function(){return _}}]),n}(l.l);(0,o.e)([(0,o.y)({type:Date,json:{write:{allowNull:!0}}})],g.prototype,"end",void 0),(0,o.e)([(0,f.o)("end")],g.prototype,"readEnd",null),(0,o.e)([(0,f.r)("end")],g.prototype,"writeEnd",null),(0,o.e)([(0,o.y)({readOnly:!0,json:{read:!1}})],g.prototype,"isAllTime",null),(0,o.e)([(0,o.y)({readOnly:!0,json:{read:!1}})],g.prototype,"isEmpty",null),(0,o.e)([(0,o.y)({type:Date,json:{write:{allowNull:!0}}})],g.prototype,"start",void 0),(0,o.e)([(0,f.o)("start")],g.prototype,"readStart",null),(0,o.e)([(0,f.r)("start")],g.prototype,"writeStart",null);var m=new(g=r=(0,o.e)([(0,o.n)("esri.TimeExtent")],g)),_=new g({start:void 0,end:void 0}),w=g},92982:function(e,t,n){n.d(t,{e:function(){return p},l:function(){return g},v:function(){return b}});var r,i=n(15671),a=n(43144),u=n(60136),s=n(29388),o=n(48848),l=n(89181),c=n(40114),f=n(93661),h=n(40558),d=n(82474),p=(0,h.o)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0}),v=r=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).value=0,r.unit="milliseconds",r}return(0,a.Z)(n,[{key:"toMilliseconds",value:function(){return(0,l.g)(this.value,this.unit,"milliseconds")}},{key:"clone",value:function(){return new r({value:this.value,unit:this.unit})}}]),n}(c.l);(0,o.e)([(0,o.y)({type:Number,json:{write:!0},nonNullable:!0})],v.prototype,"value",void 0),(0,o.e)([(0,o.y)({type:p.apiValues,json:{type:p.jsonValues,read:p.read,write:p.write},nonNullable:!0})],v.prototype,"unit",void 0);var y,g=v=r=(0,o.e)([(0,o.n)("esri.TimeInterval")],v),m=y=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).respectsDaylightSaving=!1,r.timezone=null,r}return(0,a.Z)(n,[{key:"readRespectsDaylightSaving",value:function(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving}},{key:"clone",value:function(){var e=this.respectsDaylightSaving,t=this.timezone;return new y({respectsDaylightSaving:e,timezone:t})}}]),n}(c.l);(0,o.e)([(0,o.y)({type:Boolean,json:{write:!0}})],m.prototype,"respectsDaylightSaving",void 0),(0,o.e)([(0,d.o)("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],m.prototype,"readRespectsDaylightSaving",null),(0,o.e)([(0,o.y)({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],m.prototype,"timezone",void 0);var _,w=m=y=(0,o.e)([(0,o.n)("esri.layers.support.TimeReference")],m),k=_=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).cumulative=!1,r.endField=null,r.fullTimeExtent=null,r.hasLiveData=!1,r.interval=null,r.startField=null,r.timeReference=null,r.trackIdField=null,r.useTime=!0,r}return(0,a.Z)(n,[{key:"readFullTimeExtent",value:function(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;var n=new Date(t.timeExtent[0]),r=new Date(t.timeExtent[1]);return new l.T({start:n,end:r})}},{key:"writeFullTimeExtent",value:function(e,t){e&&(0,f.r)(e.start)&&(0,f.r)(e.end)?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}},{key:"readInterval",value:function(e,t){return t.timeInterval&&t.timeIntervalUnits?new g({value:t.timeInterval,unit:p.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new g({value:t.defaultTimeInterval,unit:p.fromJSON(t.defaultTimeIntervalUnits)}):null}},{key:"writeInterval",value:function(e,t){if(e){var n=e.toJSON();t.timeInterval=n.value,t.timeIntervalUnits=n.unit}else t.timeInterval=null,t.timeIntervalUnits=null}},{key:"clone",value:function(){var e=this.cumulative,t=this.endField,n=this.hasLiveData,r=this.interval,i=this.startField,a=this.timeReference,u=this.fullTimeExtent,s=this.trackIdField,o=this.useTime;return new _({cumulative:e,endField:t,hasLiveData:n,interval:r,startField:i,timeReference:(0,f.y)(a),fullTimeExtent:(0,f.y)(u),trackIdField:s,useTime:o})}}]),n}(c.l);(0,o.e)([(0,o.y)({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],k.prototype,"cumulative",void 0),(0,o.e)([(0,o.y)({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],k.prototype,"endField",void 0),(0,o.e)([(0,o.y)({type:l.T,json:{write:{enabled:!0,allowNull:!0}}})],k.prototype,"fullTimeExtent",void 0),(0,o.e)([(0,d.o)("fullTimeExtent",["timeExtent"])],k.prototype,"readFullTimeExtent",null),(0,o.e)([(0,d.r)("fullTimeExtent")],k.prototype,"writeFullTimeExtent",null),(0,o.e)([(0,o.y)({type:Boolean,json:{write:!0}})],k.prototype,"hasLiveData",void 0),(0,o.e)([(0,o.y)({type:g,json:{write:{enabled:!0,allowNull:!0}}})],k.prototype,"interval",void 0),(0,o.e)([(0,d.o)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],k.prototype,"readInterval",null),(0,o.e)([(0,d.r)("interval")],k.prototype,"writeInterval",null),(0,o.e)([(0,o.y)({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],k.prototype,"startField",void 0),(0,o.e)([(0,o.y)({type:w,json:{write:{enabled:!0,allowNull:!0}}})],k.prototype,"timeReference",void 0),(0,o.e)([(0,o.y)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],k.prototype,"trackIdField",void 0),(0,o.e)([(0,o.y)({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],k.prototype,"useTime",void 0);var b=k=_=(0,o.e)([(0,o.n)("esri.layers.support.TimeInfo")],k)},93209:function(e,t,n){n.d(t,{A:function(){return I},B:function(){return M},C:function(){return j},D:function(){return P},E:function(){return k},F:function(){return w},G:function(){return O},I:function(){return v},M:function(){return h},N:function(){return g},P:function(){return R},R:function(){return Z},S:function(){return z},V:function(){return S},Y:function(){return E},a:function(){return u},b:function(){return b},c:function(){return f},d:function(){return T},f:function(){return l},g:function(){return m},h:function(){return c},j:function(){return x},k:function(){return D},l:function(){return p},m:function(){return o},p:function(){return _},q:function(){return F},s:function(){return d},u:function(){return s},v:function(){return N},w:function(){return C},y:function(){return y}});var r=n(93661),i=n(46817),a=n(25456);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P;return[e[0],e[1],e[2],e[3],e[4],e[5]]}function s(e,t,n,r,i,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:u();return s[0]=e,s[1]=t,s[2]=n,s[3]=r,s[4]=i,s[5]=a,s}function o(e,t){var n=isFinite(e[2])||isFinite(e[5]);return new i.w(n?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function l(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function c(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[2]),e[4]=Math.max(e[4],t[3])}function f(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function h(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length/3,i=e[0],a=e[1],u=e[2],s=e[3],o=e[4],l=e[5],c=0;c<r;c++)i=Math.min(i,t[n+3*c]),a=Math.min(a,t[n+3*c+1]),u=Math.min(u,t[n+3*c+2]),s=Math.max(s,t[n+3*c]),o=Math.max(o,t[n+3*c+1]),l=Math.max(l,t[n+3*c+2]);e[0]=i,e[1]=a,e[2]=u,e[3]=s,e[4]=o,e[5]=l}function d(e,t,n){var r=t.length,i=e[0],a=e[1],u=e[2],s=e[3],o=e[4],l=e[5];if(n)for(var c=0;c<r;c++){var f=t[c];i=Math.min(i,f[0]),a=Math.min(a,f[1]),u=Math.min(u,f[2]),s=Math.max(s,f[0]),o=Math.max(o,f[1]),l=Math.max(l,f[2])}else for(var h=0;h<r;h++){var d=t[h];i=Math.min(i,d[0]),a=Math.min(a,d[1]),s=Math.max(s,d[0]),o=Math.max(o,d[1])}e[0]=i,e[1]=a,e[2]=u,e[3]=s,e[4]=o,e[5]=l}function p(e){for(var t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0}function v(e){return e[0]>=e[3]?0:e[3]-e[0]}function y(e){return e[1]>=e[4]?0:e[4]-e[1]}function g(e){return e[2]>=e[5]?0:e[5]-e[2]}function m(e){var t=v(e),n=g(e),r=y(e);return Math.sqrt(t*t+n*n+r*r)}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=e[0]+v(e)/2,t[1]=e[1]+y(e)/2,t[2]=e[2]+g(e)/2,t}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=v(e),t[1]=y(e),t[2]=g(e),t}function k(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]}function b(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[3]<=e[3]&&t[4]<=e[4]&&t[5]<=e[5]}function x(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])}function Z(e,t){return!!(0,r.t)(t)||x(e,t)}function S(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e;return i[0]=e[0]+t,i[1]=e[1]+n,i[2]=e[2]+r,i[3]=e[3]+t,i[4]=e[4]+n,i[5]=e[5]+r,i}function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=e[0]+v(e)/2,i=e[1]+y(e)/2,a=e[2]+g(e)/2;return n[0]=r+(e[0]-r)*t,n[1]=i+(e[1]-i)*t,n[2]=a+(e[2]-a)*t,n[3]=r+(e[3]-r)*t,n[4]=i+(e[4]-i)*t,n[5]=a+(e[5]-a)*t,n}function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return n[0]=t[0],n[1]=t[1],n[2]=t[2],n!==e&&(n[3]=e[3],n[4]=e[4],n[5]=e[5]),n}function F(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return n[3]=t[0],n[4]=t[1],n[5]=t[2],n!==e&&(n[0]=e[0],n[1]=e[1],n[2]=e[2]),e}function C(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function I(e){return e?C(e,j):u(j)}function M(e,t){return t||(t=(0,a.u)()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t}function O(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function A(e){return 6===e.length}function R(e){return 0===v(e)&&0===y(e)&&0===g(e)}function z(e,t,n){if((0,r.t)(e)||(0,r.t)(t))return e===t;if(!A(e)||!A(t))return!1;if(n){for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1}else for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}function D(e,t,n,r,i,a){return s(e,t,n,r,i,a,U)}var N=[-1/0,-1/0,-1/0,1/0,1/0,1/0],j=[1/0,1/0,1/0,-1/0,-1/0,-1/0],P=[0,0,0,0,0,0],U=u()},25456:function(e,t,n){n.d(t,{D:function(){return M},E:function(){return E},F:function(){return x},H:function(){return A},I:function(){return R},J:function(){return z},K:function(){return D},M:function(){return v},R:function(){return T},U:function(){return F},a:function(){return o},b:function(){return w},c:function(){return c},d:function(){return C},e:function(){return s},f:function(){return f},g:function(){return k},h:function(){return d},j:function(){return b},l:function(){return g},m:function(){return h},o:function(){return l},p:function(){return _},q:function(){return S},s:function(){return y},u:function(){return u},w:function(){return Z},x:function(){return p},y:function(){return m},z:function(){return I}});var r=n(93661),i=n(71802),a=n(46817);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N;return[e[0],e[1],e[2],e[3]]}function s(e){return[e[0],e[1],e[2],e[3]]}function o(e,t){return e!==t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e}function l(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:u();return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u();return t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax,t}function f(e,t){return new a.w({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}function h(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function d(e,t,n){if((0,r.t)(t))o(n,e);else if("length"in t)O(t)?(n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.max(e[3],t[3])):2!==t.length&&3!==t.length||(n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.max(e[2],t[0]),n[3]=Math.max(e[3],t[1]));else switch(t.type){case"extent":n[0]=Math.min(e[0],t.xmin),n[1]=Math.min(e[1],t.ymin),n[2]=Math.max(e[2],t.xmax),n[3]=Math.max(e[3],t.ymax);break;case"point":n[0]=Math.min(e[0],t.x),n[1]=Math.min(e[1],t.y),n[2]=Math.max(e[2],t.x),n[3]=Math.max(e[3],t.y)}}function p(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=t.length,i=e[0],a=e[1],u=e[2],s=e[3],o=0;o<r;o++){var l=t[o];i=Math.min(i,l[0]),a=Math.min(a,l[1]),u=Math.max(u,l[0]),s=Math.max(s,l[1])}return n[0]=i,n[1]=a,n[2]=u,n[3]=s,n}function v(e){for(var t=0;t<4;t++)if(!isFinite(e[t]))return!1;return!0}function y(e){return(0,r.t)(e)||e[0]>=e[2]?0:e[2]-e[0]}function g(e){return e[1]>=e[3]?0:e[3]-e[1]}function m(e){return y(e)*g(e)}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];return t[0]=(e[0]+e[2])/2,t[1]=(e[1]+e[3])/2,t}function w(e,t){return Z(e,t[0],t[1])}function k(e,t){var n=t[3],r=.5*(e[0]+e[2]),i=Math.abs(t[0]-r),a=.5*(e[2]-e[0]);if(i>n+a)return!1;var u=.5*(e[1]+e[3]),s=.5*(e[3]-e[1]),o=Math.abs(t[1]-u);if(o>n+s)return!1;if(i<a||o<s)return!0;var l=i-a,c=o-s;return l*l+c*c<=n*n}function b(e,t,n){var r=e[0],i=e[1],a=e[2],u=e[3],s=t.x,o=t.y,l=n.x,c=n.y,f=function(e,t){return(c-o)*e+(s-l)*t+(l*o-s*c)<0},h=f(r,u),d=f(a,u),p=f(a,i),v=f(r,i);return!(h===d&&d===p&&p===v&&v===h||s<r&&l<r||s>a&&l>a||o>u&&c>u||o<i&&c<i)}function x(e,t){return Z(e,t.x,t.y)}function Z(e,t,n){return t>=e[0]&&n>=e[1]&&t<=e[2]&&n<=e[3]}function S(e,t,n){return t[0]>=e[0]-n&&t[1]>=e[1]-n&&t[0]<=e[2]+n&&t[1]<=e[3]+n}function E(e,t){return Math.max(t[0],e[0])<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])<=Math.min(t[3],e[3])}function T(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}function F(e,t,n){if((0,r.t)(t))return o(n,e);var a=t[0],u=t[1],s=t[2],l=t[3];return n[0]=(0,i.a)(e[0],a,s),n[1]=(0,i.a)(e[1],u,l),n[2]=(0,i.a)(e[2],a,s),n[3]=(0,i.a)(e[3],u,l),n}function C(e,t){var n=(e[0]+e[2])/2,r=(e[1]+e[3])/2,i=Math.max(Math.abs(t[0]-n)-y(e)/2,0),a=Math.max(Math.abs(t[1]-r)-g(e)/2,0);return Math.sqrt(i*i+a*a)}function I(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;return r[0]=e[0]+t,r[1]=e[1]+n,r[2]=e[2]+t,r[3]=e[3]+n,r}function M(e){return e?o(e,D):u(D)}function O(e){return null!=e&&4===e.length}function A(e){return!(0!==y(e)&&isFinite(e[0])||0!==g(e)&&isFinite(e[1]))}function R(e,t){return O(e)&&O(t)?e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]:e===t}var z=[-1/0,-1/0,1/0,1/0],D=[1/0,1/0,-1/0,-1/0],N=[0,0,0,0]},1685:function(e,t,n){n.d(t,{I:function(){return k},L:function(){return _},S:function(){return m},b:function(){return w},d:function(){return h},g:function(){return g},h:function(){return v},j:function(){return b},m:function(){return d},w:function(){return p},y:function(){return y}});var r=n(29439),i=n(93661),a=n(40558),u=n(46337),s={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},o=Object.values(s),l=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(o.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),c=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(o.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),f=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function h(e){return!!l.test(e)}function d(e){if((0,i.t)(e))return null;var t=(0,a.j)(e),n=t.path.match(l)||t.path.match(c);if(!n)return null;var u=(0,r.Z)(n,5),o=u[1],f=u[2],h=u[3],d=u[4],p=f.indexOf("/");return{title:v(-1!==p?f.slice(p+1):f),serverType:s[h.toLowerCase()],sublayer:null!=d&&""!==d?parseInt(d,10):null,url:{path:o}}}function p(e){var t=(0,a.j)(e).path.match(f);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function v(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function y(e,t){var n=[];if(e){var r=d(e);(0,i.r)(r)&&r.title&&n.push(r.title)}if(t){var a=v(t);n.push(a)}if(2===n.length){if(n[0].toLowerCase().includes(n[1].toLowerCase()))return n[0];if(n[1].toLowerCase().includes(n[0].toLowerCase()))return n[1]}return n.join(" - ")}function g(e){if(!e)return!1;var t=(e=e.toLowerCase()).includes(".arcgis.com/"),n=e.includes("//services")||e.includes("//tiles")||e.includes("//features");return t&&n}function m(e,t){return e?(0,a.C)((0,a.A)(e,t)):e}function _(e){var t=e.url;if(!t)return{url:t};t=(0,a.A)(t,e.logger);var n,r=(0,a.j)(t),u=d(r.path);if((0,i.r)(u))null!=u.sublayer&&null==e.layer.layerId&&(n=u.sublayer),t=u.url.path;else if(e.nonStandardUrlAllowed){var s=p(r.path);(0,i.r)(s)&&(t=s.serviceUrl,n=s.sublayerId)}return{url:(0,a.C)(t),layerId:n}}function w(e,t,n,r,i){(0,u.f)(t,r,"url",i),r.url&&null!=e.layerId&&(r.url=(0,a.G)(r.url,n,e.layerId.toString()))}function k(e){if(!e)return!1;var t=e.toLowerCase(),n=t.includes("/services/"),r=t.includes("/mapserver/wmsserver"),i=t.includes("/imageserver/wmsserver"),a=t.includes("/wmsserver");return n&&(r||i||a)}function b(e){var t;if(!e)return!1;var n=null===(t=new a.y((0,a.Q)(e)).authority)||void 0===t?void 0:t.toLowerCase();return"server.arcgisonline.com"===n||"services.arcgisonline.com"===n}},59389:function(e,t,n){n.d(t,{b:function(){return y},c:function(){return f},d:function(){return m},h:function(){return h},j:function(){return k},v:function(){return w}});var r=n(74165),i=n(15671),a=n(43144),u=n(60136),s=n(29388),o=n(15861),l=n(48848),c=n(93661);function f(e,t,n){return(0,l.E)(e.map((function(e,r){return t.apply(n,[e,r])})))}function h(e,t,n){return d.apply(this,arguments)}function d(){return(d=(0,o.Z)((0,r.Z)().mark((function e(t,n,i){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.E)(t.map((function(e,t){return n.apply(i,[e,t])})));case 2:return e.abrupt("return",e.sent.map((function(e){return e.value})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return{ok:!0,value:e}}function v(e){return{ok:!1,error:e}}function y(e){return g.apply(this,arguments)}function g(){return(g=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,c.t)(t)){e.next=2;break}return e.abrupt("return",{ok:!1,error:new Error("no promise provided")});case 2:return e.prev=2,e.t0=p,e.next=6,t;case 6:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 10:return e.prev=10,e.t2=e.catch(2),e.abrupt("return",v(e.t2));case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function m(e){return _.apply(this,arguments)}function _(){return(_=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=p,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",((0,l.w)(e.t2),v(e.t2)));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function w(e){if(!0===e.ok)return e.value;throw e.error}function k(e,t){return new b(e,t)}var b=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var a;(0,i.Z)(this,n),(a=t.call(this,{}))._result=null,a._abortHandle=null,a.abort=function(){a._abortController=(0,c.l)(a._abortController)},a.remove=a.abort,a._abortController=new AbortController;var u=a._abortController.signal;return a.promise=e(u),a.promise.then((function(e){a._result=p(e),a._cleanup()}),(function(e){a._result=v(e),a._cleanup()})),a._abortHandle=(0,l.v)(r,a.abort),a}return(0,a.Z)(n,[{key:"value",get:function(){return e=this._result,(0,c.r)(e)&&!0===e.ok?e.value:null;var e}},{key:"error",get:function(){return e=this._result,(0,c.r)(e)&&!1===e.ok?e.error:null;var e}},{key:"finished",get:function(){return(0,c.r)(this._result)}},{key:"normalizeCtorArgs",value:function(){return{}}},{key:"destroy",value:function(){this.abort()}},{key:"_cleanup",value:function(){this._abortHandle=(0,c.f)(this._abortHandle),this._abortController=null}}]),n}(l.m);(0,l.e)([(0,l.y)()],b.prototype,"value",null),(0,l.e)([(0,l.y)()],b.prototype,"error",null),(0,l.e)([(0,l.y)()],b.prototype,"finished",null),(0,l.e)([(0,l.y)()],b.prototype,"promise",void 0),(0,l.e)([(0,l.y)()],b.prototype,"_result",void 0),b=(0,l.e)([(0,l.n)("esri.core.asyncUtils.ReactiveTask")],b)},43955:function(e,t,n){function r(e){return 32+e.length}function i(e){return 16}function a(e){if(!e)return 0;var t=c;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];switch(typeof i){case"string":t+=r(i);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function u(e){if(!e)return 0;if(Array.isArray(e))return function(e){var t=e.length;if(0===t||"number"==typeof e[0])return 32+8*t;for(var n=f,r=0;r<t;r++)n+=s(e[r]);return n}(e);var t=c;for(var n in e)e.hasOwnProperty(n)&&(t+=s(e[n]));return t}function s(e){switch(typeof e){case"object":return u(e);case"string":return r(e);case"number":return 16;case"boolean":return 4;default:return 8}}function o(e,t){return f+e.length*t}n.d(t,{c:function(){return o},e:function(){return u},n:function(){return r},r:function(){return i},s:function(){return l},t:function(){return a}});var l,c=32,f=32;!function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(l||(l={}))},71147:function(e,t,n){n.d(t,{a:function(){return m},m:function(){return _},p:function(){return w}});var r=n(43144),i=n(15671),a=n(60136),u=n(29388),s=n(48848),o=n(89794),l=n(93661),c=n(20302),f=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type=null,r}return(0,r.Z)(n)}(n(40114).l);(0,s.e)([(0,s.y)({readOnly:!0,json:{read:!1,write:!0}})],f.prototype,"type",void 0);var h,d=f=(0,s.e)([(0,s.n)("esri.rest.support.ColorRamp")],f),p=h=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).algorithm=null,r.fromColor=null,r.toColor=null,r.type="algorithmic",r}return(0,r.Z)(n,[{key:"clone",value:function(){return new h({fromColor:(0,l.y)(this.fromColor),toColor:(0,l.y)(this.toColor),algorithm:this.algorithm})}}]),n}(d);(0,s.e)([(0,c.r)({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],p.prototype,"algorithm",void 0),(0,s.e)([(0,s.y)({type:o.l,json:{type:[s.T],write:!0}})],p.prototype,"fromColor",void 0),(0,s.e)([(0,s.y)({type:o.l,json:{type:[s.T],write:!0}})],p.prototype,"toColor",void 0),(0,s.e)([(0,s.y)({type:["algorithmic"]})],p.prototype,"type",void 0);var v,y=p=h=(0,s.e)([(0,s.n)("esri.rest.support.AlgorithmicColorRamp")],p),g=v=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).colorRamps=null,r.type="multipart",r}return(0,r.Z)(n,[{key:"clone",value:function(){return new v({colorRamps:(0,l.y)(this.colorRamps)})}}]),n}(d);(0,s.e)([(0,s.y)({type:[y],json:{write:!0}})],g.prototype,"colorRamps",void 0),(0,s.e)([(0,s.y)({type:["multipart"]})],g.prototype,"type",void 0);var m=g=v=(0,s.e)([(0,s.n)("esri.rest.support.MultipartColorRamp")],g),_={key:"type",base:d,typeMap:{algorithmic:y,multipart:g}};function w(e){return e&&e.type?"algorithmic"===e.type?y.fromJSON(e):"multipart"===e.type?m.fromJSON(e):null:null}},48200:function(e,t,n){n.d(t,{a:function(){return s},i:function(){return c},l:function(){return u},o:function(){return l},r:function(){return a}});var r=n(93433),i={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function a(e){return i[e]||i[e.toLowerCase()]}function u(e){var t;return null!==(t=i[e])&&void 0!==t?t:i[e.toLowerCase()]}function s(e){return(0,r.Z)(u(e))}function o(e,t,n){n<0&&++n,n>1&&--n;var r=6*n;return r<1?e+(t-e)*r:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=(e%360+360)%360/360,a=n<=.5?n*(t+1):n+t-n*t,u=2*n-a;return[Math.round(255*o(u,a,i+1/3)),Math.round(255*o(u,a,i)),Math.round(255*o(u,a,i-1/3)),r]}function c(e){var t=e.length>5,n=t?8:4,r=(1<<n)-1,i=t?1:17,a=t?9===e.length:5===e.length,u=Number("0x"+e.substr(1));if(isNaN(u))return null;var s,o=[0,0,0,1];return a&&(s=u&r,u>>=n,o[3]=i*s/255),s=u&r,u>>=n,o[2]=i*s,s=u&r,u>>=n,o[1]=i*s,s=u&r,u>>=n,o[0]=i*s,o}},15436:function(e,t,n){n.d(t,{i:function(){return r}});var r=new(n(40558).s)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},45184:function(e,t,n){n.d(t,{B:function(){return Z},C:function(){return S},O:function(){return m},U:function(){return k},q:function(){return b},s:function(){return l},v:function(){return x}});var r=n(29439),i=n(93661),a=n(56162),u=function(e,t,n){return[t,n]},s=function(e,t,n){return[t,n,e[2]]},o=function(e,t,n){return[t,n,e[2],e[3]]};function l(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,i.r)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function c(e,t){var n=e.scale,r=e.translate;return Math.round((t-r[0])/n[0])}function f(e,t){var n=e.scale,r=e.translate;return Math.round((r[1]-t)/n[1])}function h(e,t,n){for(var r,i,a,u,s=[],o=0;o<n.length;o++){var l=n[o];o>0?(a=c(e,l[0]),u=f(e,l[1]),a===r&&u===i||(s.push(t(l,a-r,u-i)),r=a,i=u)):(r=c(e,l[0]),i=f(e,l[1]),s.push(t(l,r,i)))}return s.length>0?s:null}function d(e,t){var n=e.scale,r=e.translate;return t*n[0]+r[0]}function p(e,t){var n=e.scale;return e.translate[1]-t*n[1]}function v(e,t,n){var i=new Array(n.length);if(!n.length)return i;var a=(0,r.Z)(e.scale,2),u=a[0],s=a[1],o=d(e,n[0][0]),l=p(e,n[0][1]);i[0]=t(n[0],o,l);for(var c=1;c<n.length;c++){var f=n[c];o+=f[0]*u,l-=f[1]*s,i[c]=t(f,o,l)}return i}function y(e,t,n){for(var r=new Array(n.length),i=0;i<n.length;i++)r[i]=v(e,t,n[i]);return r}function g(e,t,n,r,i){var a;return t.points=null!==(a=function(e,t,n,r){return h(e,n?r?o:s:r?s:u,t)}(e,n.points,r,i))&&void 0!==a?a:[],t}function m(e,t,n,r,i){return t.x=c(e,n.x),t.y=f(e,n.y),t!==n&&(r&&(t.z=n.z),i&&(t.m=n.m)),t}function _(e,t,n,r,i){var a=function(e,t,n,r){for(var i=[],a=n?r?o:s:r?s:u,l=0;l<t.length;l++){var c=h(e,a,t[l]);c&&c.length>=3&&i.push(c)}return i.length?i:null}(e,n.rings,r,i);return a?(t.rings=a,t):null}function w(e,t,n,r,i){var a=function(e,t,n,r){for(var i=[],a=n?r?o:s:r?s:u,l=0;l<t.length;l++){var c=h(e,a,t[l]);c&&c.length>=2&&i.push(c)}return i.length?i:null}(e,n.paths,r,i);return a?(t.paths=a,t):null}function k(e,t){return e&&t?(0,a.s)(t)?m(e,{},t,!1,!1):(0,a.f)(t)?w(e,{},t,!1,!1):(0,a.y)(t)?_(e,{},t,!1,!1):(0,a.l)(t)?g(e,{},t,!1,!1):(0,a.u)(t)?function(e,t,n,r,i){return t.xmin=c(e,n.xmin),t.ymin=f(e,n.ymin),t.xmax=c(e,n.xmax),t.ymax=f(e,n.ymax),t!==n&&(r&&(t.zmin=n.zmin,t.zmax=n.zmax),i&&(t.mmin=n.mmin,t.mmax=n.mmax)),t}(e,{},t,!1,!1):null:null}function b(e,t,n,r,a){return(0,i.r)(n)&&(t.points=function(e,t,n,r){return v(e,n?r?o:s:r?s:u,t)}(e,n.points,r,a)),t}function x(e,t,n,r,a){return(0,i.t)(n)||(t.x=d(e,n.x),t.y=p(e,n.y),t!==n&&(r&&(t.z=n.z),a&&(t.m=n.m))),t}function Z(e,t,n,r,a){return(0,i.r)(n)&&(t.rings=function(e,t,n,r){return y(e,n?r?o:s:r?s:u,t)}(e,n.rings,r,a)),t}function S(e,t,n,r,a){return(0,i.r)(n)&&(t.paths=function(e,t,n,r){return y(e,n?r?o:s:r?s:u,t)}(e,n.paths,r,a)),t}},51816:function(e,t,n){n.d(t,{r:function(){return u}});var r=n(37762),i=n(93661),a=n(65415);function u(e,t,n){if(n&&n.features&&n.hasZ){var u=(0,a.o)(n.geometryType,t,e.outSpatialReference);if(!(0,i.t)(u)){var s,o=(0,r.Z)(n.features);try{for(o.s();!(s=o.n()).done;){u(s.value.geometry)}}catch(l){o.e(l)}finally{o.f()}}}}},52752:function(e,t,n){n.d(t,{a:function(){return x},n:function(){return T},r:function(){return p}});var r=n(29439),i=n(37762),a=n(74165),u=n(15861),s=n(15671),o=n(43144),l=n(93661),c=n(39926),f=n(48848),h=n(47855),d=n(15529);function p(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(e){var n=t.elevationInfo,r=t.alignPointsInFeatures,i=t.spatialReference;return new y(n,r,i)}return new v}var v=function(){function e(){(0,s.Z)(this,e)}return(0,o.Z)(e,[{key:"alignCandidates",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"notifyElevationSourceChange",value:function(){}}]),e}(),y=function(){function e(t,n,r){(0,s.Z)(this,e),this._elevationInfo=t,this._alignPointsInFeatures=n,this.spatialReference=r,this._alignmentsCache=new c.e(1024),this._cacheVersion=0,this._metersPerVerticalUnit=(0,h.L)(r)}return(0,o.Z)(e,[{key:"alignCandidates",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,n){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._elevationInfo,e.abrupt("return",(0,l.r)(r)&&"absolute-height"===r.mode&&!r.featureExpressionInfo?(this._alignAbsoluteElevationCandidates(t,r),t):this._alignComputedElevationCandidates(t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"notifyElevationSourceChange",value:function(){this._alignmentsCache.clear(),this._cacheVersion++}},{key:"_alignAbsoluteElevationCandidates",value:function(e,t){var n=t.offset,r=t.unit;if(!(0,l.t)(n)){var a,u=n*((0,d.r)(null!==r&&void 0!==r?r:"meters")/this._metersPerVerticalUnit),s=(0,i.Z)(e);try{for(s.s();!(a=s.n()).done;){var o=a.value;switch(o.type){case"edge":o.start.z+=u,o.end.z+=u;continue;case"vertex":o.target.z+=u;continue}}}catch(c){s.e(c)}finally{s.f()}}}},{key:"_alignComputedElevationCandidates",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,n){var u,s,o,l,c,h,d,p,v,y,g,m,w,k,b,x,Z;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=new Map,s=(0,i.Z)(t);try{for(s.s();!(o=s.n()).done;)l=o.value,(0,f.am)(u,l.objectId,_).push(l)}catch(a){s.e(a)}finally{s.f()}return c=this._prepareQuery(u),h=(0,r.Z)(c,3),d=h[0],p=h[1],v=h[2],e.next=10,this._alignPointsInFeatures(d,n);case 10:if(y=e.sent,(0,f.f)(n),v===this._cacheVersion){e.next=14;break}return e.abrupt("return",this._alignComputedElevationCandidates(t,n));case 14:this._applyCacheAndResponse(d,y,p),g=y.drapedObjectIds,m=y.failedObjectIds,w=[],k=(0,i.Z)(t);try{for(k.s();!(b=k.n()).done;)x=b.value,Z=x.objectId,g.has(Z)&&"edge"===x.type&&(x.draped=!0),m.has(Z)||w.push(x)}catch(a){k.e(a)}finally{k.f()}return e.abrupt("return",w);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_prepareQuery",value:function(e){var t,n=[],a=[],u=(0,i.Z)(e);try{for(u.s();!(t=u.n()).done;){var s,o=(0,r.Z)(t.value,2),l=o[0],c=o[1],f=[],h=(0,i.Z)(c);try{for(h.s();!(s=h.n()).done;){var d=s.value;this._addToQueriesOrCachedResult(l,d.target,f,a),"edge"===d.type&&(this._addToQueriesOrCachedResult(l,d.start,f,a),this._addToQueriesOrCachedResult(l,d.end,f,a))}}catch(p){h.e(p)}finally{h.f()}0!==f.length&&n.push({objectId:l,points:f})}}catch(p){u.e(p)}finally{u.f()}return[n,a,this._cacheVersion]}},{key:"_addToQueriesOrCachedResult",value:function(e,t,n,r){var i=m(e,t),a=this._alignmentsCache.get(i);(0,l.r)(a)?r.push(new g(t,a)):n.push(t)}},{key:"_applyCacheAndResponse",value:function(e,t,n){var r,a=t.elevations,u=t.drapedObjectIds,s=t.failedObjectIds,o=(0,i.Z)(n);try{for(o.s();!(r=o.n()).done;){r.value.apply()}}catch(x){o.e(x)}finally{o.f()}var l,c=0,f=this._alignmentsCache,h=(0,i.Z)(e);try{for(h.s();!(l=h.n()).done;){var d=l.value,p=d.objectId,v=d.points;if(s.has(p))c+=v.length;else{var y,g=!u.has(p),_=(0,i.Z)(v);try{for(_.s();!(y=_.n()).done;){var w=y.value,k=m(p,w),b=a[c++];w.z=b,g&&f.put(k,b,1)}}catch(x){_.e(x)}finally{_.f()}}}}catch(x){h.e(x)}finally{h.f()}}}]),e}(),g=function(){function e(t,n){(0,s.Z)(this,e),this.point=t,this.z=n}return(0,o.Z)(e,[{key:"apply",value:function(){this.point.z=this.z}}]),e}();function m(e,t){var n=t.x,r=t.y,i=t.z;return"".concat(e,"-").concat(n,"-").concat(r,"-").concat(null!==i&&void 0!==i?i:0,"}")}function _(){return[]}var w=function(){function e(){(0,s.Z)(this,e)}return(0,o.Z)(e,[{key:"filter",value:function(e,t){return t}},{key:"notifyElevationSourceChange",value:function(){}}]),e}(),k=function(){function e(){(0,s.Z)(this,e)}return(0,o.Z)(e,[{key:"filter",value:function(e,t){var n=e.point,r=e.distance;if(null==n.z)return t;if(0===t.length)return t;var i=function(e){return"number"==typeof e?{x:e,y:e,z:e}:e}(r),a=this._updateCandidatesTo3D(t,n,i).filter(b);return a.sort(E),a}},{key:"_updateCandidatesTo3D",value:function(e,t,n){var r,a=(0,i.Z)(e);try{for(a.s();!(r=a.n()).done;){var u=r.value;switch(u.type){case"edge":Z(u,t,n);continue;case"vertex":S(u,t,n);continue}}}catch(s){a.e(s)}finally{a.f()}return e}}]),e}();function b(e){return e.distance<=1}function x(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?new k:new w}function Z(e,t,n){var r=n.x,i=n.y,a=n.z,u=e.start,s=e.end,o=e.target;e.draped||function(e,t,n,r){var i=r.x-n.x,a=r.y-n.y,u=r.z-n.z,s=i*i+a*a+u*u,o=(t.x-n.x)*i+(t.y-n.y)*a+u*(t.z-n.z),l=Math.min(1,Math.max(0,o/s)),c=n.x+i*l,f=n.y+a*l,h=n.z+u*l;e.x=c,e.y=f,e.z=h}(o,t,u,s);var l=(t.x-o.x)/r,c=(t.y-o.y)/i,f=(t.z-o.z)/a;e.distance=Math.sqrt(l*l+c*c+f*f)}function S(e,t,n){var r=n.x,i=n.y,a=n.z,u=e.target,s=(t.x-u.x)/r,o=(t.y-u.y)/i,l=(t.z-u.z)/a,c=Math.sqrt(s*s+o*o+l*l);e.distance=c}function E(e,t){return e.distance-t.distance}function T(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return e?new C(t):new F}var F=function(){function e(){(0,s.Z)(this,e)}return(0,o.Z)(e,[{key:"fetch",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"notifySymbologyChange",value:function(){}}]),e}(),C=function(){function e(t){(0,s.Z)(this,e),this._getSymbologyCandidates=t,this._candidatesCache=new c.e(1024),this._cacheVersion=0}return(0,o.Z)(e,[{key:"fetch",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,n){var r,u,s,o,c,h,d,p,v,y,g,m,_,w,k,b,x,Z,S,E,T;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:r=[],u=[],s=this._candidatesCache,o=(0,i.Z)(t);try{for(o.s();!(c=o.n()).done;)if(h=c.value,d=I(h),p=s.get(d)){v=(0,i.Z)(p);try{for(v.s();!(y=v.n()).done;)g=y.value,u.push((0,l.y)(g))}catch(a){v.e(a)}finally{v.f()}}else r.push(h),s.put(d,[],1)}catch(a){o.e(a)}finally{o.f()}if(0!==r.length){e.next=7;break}return e.abrupt("return",u);case 7:return m=this._cacheVersion,e.next=10,this._getSymbologyCandidates(r,n);case 10:if(_=e.sent,w=_.candidates,k=_.sourceCandidateIndices,(0,f.f)(n),m===this._cacheVersion){e.next=16;break}return e.abrupt("return",this.fetch(t,n));case 16:for(b=[],x=w.length,Z=0;Z<x;++Z)S=w[Z],E=I(r[k[Z]]),(T=s.get(E)).push(S),s.put(E,T,T.length),b.push((0,l.y)(S));return e.abrupt("return",u.concat(b));case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"notifySymbologyChange",value:function(){this._candidatesCache.clear(),this._cacheVersion++}}]),e}();function I(e){switch(e.type){case"vertex":var t,n=e.objectId,r=e.target,i="".concat(n,"-vertex-").concat(r.x,"-").concat(r.y,"-").concat(null!==(t=r.z)&&void 0!==t?t:0);return(0,f.a3)(i).toString();case"edge":var a,u,s=e.objectId,o=e.start,l=e.end,c="".concat(s,"-edge-").concat(o.x,"-").concat(o.y,"-").concat(null!==(a=o.z)&&void 0!==a?a:0,"-to-").concat(l.x,"-").concat(l.y,"-").concat(null!==(u=l.z)&&void 0!==u?u:0);return(0,f.a3)(c).toString();default:return""}}}}]);
//# sourceMappingURL=2219.1567ccef.chunk.js.map