"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[330,682,2667],{60369:function(e,t,n){n.d(t,{a:function(){return d},b:function(){return g},c:function(){return h}});var r,i=n(15671),o=n(43144),a=n(60136),u=n(29388),s=n(48848),l=(n(93661),n(92072)),c=r=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).active=!1,r.className=null,r.disabled=!1,r.id=null,r.indicator=!1,r.title=null,r.type=null,r.visible=!0,r}return(0,o.Z)(n,[{key:"clone",value:function(){return new r({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}}]),n}((0,l.s)(s.m));(0,s.e)([(0,s.y)()],c.prototype,"active",void 0),(0,s.e)([(0,s.y)()],c.prototype,"className",void 0),(0,s.e)([(0,s.y)()],c.prototype,"disabled",void 0),(0,s.e)([(0,s.y)()],c.prototype,"id",void 0),(0,s.e)([(0,s.y)()],c.prototype,"indicator",void 0),(0,s.e)([(0,s.y)()],c.prototype,"title",void 0),(0,s.e)([(0,s.y)()],c.prototype,"type",void 0),(0,s.e)([(0,s.y)()],c.prototype,"visible",void 0);var f,h=c=r=(0,s.e)([(0,s.n)("esri.support.actions.ActionBase")],c),p=f=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).image=null,r.type="button",r}return(0,o.Z)(n,[{key:"clone",value:function(){return new f({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}}]),n}(h);(0,s.e)([(0,s.y)()],p.prototype,"image",void 0);var v,d=p=f=(0,s.e)([(0,s.n)("esri.support.Action.ActionButton")],p),y=v=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).image=null,r.type="toggle",r.value=!1,r}return(0,o.Z)(n,[{key:"clone",value:function(){return new v({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}}]),n}(h);(0,s.e)([(0,s.y)()],y.prototype,"image",void 0),(0,s.e)([(0,s.y)()],y.prototype,"value",void 0);var g=y=v=(0,s.e)([(0,s.n)("esri.support.Action.ActionToggle")],y)},62610:function(e,t,n){n.d(t,{i:function(){return f},l:function(){return h}});var r=n(29439),i=n(37762),o=n(15671),a=n(43144),u=n(60136),s=n(29388),l=n(48848),c=n(93661),f=function(e){var t=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"clone",value:function(){var e=(0,c.i)((0,l.x)(this),"unable to clone instance of non-accessor class"),t=e.metadatas,n=e.store,o={},a=new Map;for(var u in t){var s=t[u],f=null===n||void 0===n?void 0:n.originOf(u),h=s.clonable;if(!(s.readOnly||!1===h||f!==l.r.USER&&f!==l.r.DEFAULTS&&f!==l.r.WEB_MAP&&f!==l.r.WEB_SCENE)){var p,v=this[u];p="function"==typeof h?h(v):"reference"===h?v:(0,c.m)(v),null!=v&&null==p||(f===l.r.DEFAULTS?a.set(u,p):o[u]=p)}}var d=new(Object.getPrototypeOf(this).constructor)(o);if(a.size){var y,g=null===(y=(0,l.x)(d))||void 0===y?void 0:y.store;if(g){var m,b=(0,i.Z)(a);try{for(b.s();!(m=b.n()).done;){var w=(0,r.Z)(m.value,2),M=w[0],_=w[1];g.set(M,_,l.r.DEFAULTS)}}catch(k){b.e(k)}finally{b.f()}}}return d}}]),n}(e);return t=(0,l.e)([(0,l.n)("esri.core.Clonable")],t),t},h=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n)}(f(l.m));h=(0,l.e)([(0,l.n)("esri.core.Clonable")],h)},89794:function(e,t,n){n.d(t,{l:function(){return h}});var r=n(15671),i=n(43144),o=n(48200),a=n(71802),u=n(93661),s=n(48848);function l(e){return(0,a.a)((0,s.$)(e),0,255)}function c(e,t,n){return e=Number(e),isNaN(e)?n:e<t?t:e>n?n:e}var f=function(){function e(t){(0,r.Z)(this,e),this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}return(0,i.Z)(e,[{key:"isBright",get:function(){return.299*this.r+.587*this.g+.114*this.b>=127}},{key:"setColor",value:function(t){var n,r,i,o;return"string"==typeof t?e.fromString(t,this):Array.isArray(t)?e.fromArray(t,this):(this._set(null!==(n=t.r)&&void 0!==n?n:0,null!==(r=t.g)&&void 0!==r?r:0,null!==(i=t.b)&&void 0!==i?i:0,null!==(o=t.a)&&void 0!==o?o:1),t instanceof e||this._sanitize()),this}},{key:"toRgb",value:function(){return[this.r,this.g,this.b]}},{key:"toRgba",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toHex",value:function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return"#".concat(e.length<2?"0"+e:e).concat(t.length<2?"0"+t:t).concat(n.length<2?"0"+n:n)}},{key:"toCss",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.r+", "+this.g+", "+this.b;return e?"rgba(".concat(t,", ").concat(this.a,")"):"rgb(".concat(t,")")}},{key:"toString",value:function(){return this.toCss(!0)}},{key:"toJSON",value:function(){return this.toArray()}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.AlphaMode.ALWAYS,n=l(this.r),r=l(this.g),i=l(this.b);return t===e.AlphaMode.ALWAYS||1!==this.a?[n,r,i,l(255*this.a)]:[n,r,i]}},{key:"clone",value:function(){return new e(this.toRgba())}},{key:"hash",value:function(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}},{key:"equals",value:function(e){return(0,u.r)(e)&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}},{key:"_sanitize",value:function(){return this.r=Math.round(c(this.r,0,255)),this.g=Math.round(c(this.g,0,255)),this.b=Math.round(c(this.b,0,255)),this.a=c(this.a,0,1),this}},{key:"_set",value:function(e,t,n,r){this.r=e,this.g=t,this.b=n,this.a=r}}],[{key:"blendColors",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e;return i.r=Math.round(t.r+(n.r-t.r)*r),i.g=Math.round(t.g+(n.g-t.g)*r),i.b=Math.round(t.b+(n.b-t.b)*r),i.a=t.a+(n.a-t.a)*r,i._sanitize()}},{key:"fromRgb",value:function(t,n){var r=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(r){var i=r[2].split(/\s*,\s*/),a=r[1];if("rgb"===a&&3===i.length||"rgba"===a&&4===i.length){var u=i[0];if("%"===u.charAt(u.length-1)){var s=i.map((function(e){return 2.56*parseFloat(e)}));return 4===i.length&&(s[3]=parseFloat(i[3])),e.fromArray(s,n)}return e.fromArray(i.map((function(e){return parseFloat(e)})),n)}if("hsl"===a&&3===i.length||"hsla"===a&&4===i.length)return e.fromArray((0,o.o)(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100,parseFloat(i[3])),n)}return null}},{key:"fromHex",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;if(4!==t.length&&7!==t.length||"#"!==t[0])return null;var r=4===t.length?4:8,i=(1<<r)-1,o=Number("0x"+t.substr(1));return isNaN(o)?null:(["b","g","r"].forEach((function(e){var t=o&i;o>>=r,n[e]=4===r?17*t:t})),n.a=1,n)}},{key:"fromArray",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return n._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(n.a)&&(n.a=1),n._sanitize()}},{key:"fromString",value:function(t,n){var r=(0,o.r)(t)?(0,o.l)(t):null;return r&&e.fromArray(r,n)||e.fromRgb(t,n)||e.fromHex(t,n)}},{key:"fromJSON",value:function(t){return t&&new e([t[0],t[1],t[2],t[3]/255])}},{key:"toUnitRGB",value:function(e){return(0,u.r)(e)?[e.r/255,e.g/255,e.b/255]:null}},{key:"toUnitRGBA",value:function(e){return(0,u.r)(e)?[e.r/255,e.g/255,e.b/255,null!=e.a?e.a:1]:null}}]),e}();f.prototype.declaredClass="esri.Color",function(e){var t;(t=e.AlphaMode||(e.AlphaMode={}))[t.ALWAYS=0]="ALWAYS",t[t.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(f||(f={}));var h=f},64998:function(e,t,n){n.d(t,{g:function(){return w}});var r=n(1413),i=n(4942),o=n(15671),a=n(43144),u=n(97326),s=n(60136),l=n(29388),c=n(48848),f=n(74384),h=n(25577),p=n(37944),v=n(62610),d=n(40114),y=n(93661),g=n(56162);function m(e){if(!(0,y.r)(e))return null;var t={};for(var n in e){var r=e[n];r&&(t[n]=r.toJSON())}return 0!==Object.keys(t).length?t:null}var b=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;(0,o.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).isAggregate=!1,e.layer=null,e.popupTemplate=null,e.sourceLayer=null,Object.defineProperty((0,u.Z)(e),"uid",{value:(0,c.a4)(),configurable:!0}),e}return(0,a.Z)(n,[{key:"normalizeCtorArgs",value:function(e,t,n,r){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:n,popupTemplate:r}}},{key:"aggregateGeometries",set:function(e){var t=this._get("aggregateGeometries");JSON.stringify(t)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}},{key:"attributes",set:function(e){var t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}},{key:"geometry",set:function(e){var t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}},{key:"symbol",set:function(e){var t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}},{key:"visible",set:function(e){var t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}},{key:"getEffectivePopupTemplate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.popupTemplate)return this.popupTemplate;for(var t=0,n=[this.sourceLayer,this.layer];t<n.length;t++){var r=n[t];if(r){if("popupTemplate"in r&&r.popupTemplate)return r.popupTemplate;if(e&&"defaultPopupTemplate"in r&&(0,y.r)(r.defaultPopupTemplate))return r.defaultPopupTemplate}}return null}},{key:"getAttribute",value:function(e){var t;return null===(t=this.attributes)||void 0===t?void 0:t[e]}},{key:"setAttribute",value:function(e,t){if(this.attributes){var n=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",n,t,e)}else this.attributes=(0,i.Z)({},e,t),this._notifyLayer("attributes",void 0,t,e)}},{key:"getObjectId",value:function(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}},{key:"toJSON",value:function(){return{aggregateGeometries:m(this.aggregateGeometries),geometry:(0,y.r)(this.geometry)?this.geometry.toJSON():null,symbol:(0,y.r)(this.symbol)?this.symbol.toJSON():null,attributes:(0,r.Z)({},this.attributes),popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}},{key:"notifyGeometryChanged",value:function(){this._notifyLayer("geometry",this.geometry,this.geometry)}},{key:"notifyMeshTransformChanged",value:function(){(0,y.r)(this.geometry)&&"mesh"===this.geometry.type&&this._notifyLayer("transform",this.geometry.transform,this.geometry.transform)}},{key:"_notifyLayer",value:function(e,t,n,r){if(this.layer&&"graphicChanged"in this.layer){var i={graphic:this,property:e,oldValue:t,newValue:n};"attributes"===e&&(i.attributeName=r),this.layer.graphicChanged(i)}}}]),n}((0,v.i)(d.l));(0,c.e)([(0,c.y)({value:null,json:{read:function(e){if(!e)return null;var t={};for(var n in e){var r=(0,g.v)(e[n]);r&&(t[n]=r)}return 0!==Object.keys(t).length?t:null}}})],b.prototype,"aggregateGeometries",null),(0,c.e)([(0,c.y)({value:null})],b.prototype,"attributes",null),(0,c.e)([(0,c.y)({value:null,types:f.i,json:{read:g.v}})],b.prototype,"geometry",null),(0,c.e)([(0,c.y)({type:Boolean})],b.prototype,"isAggregate",void 0),(0,c.e)([(0,c.y)({clonable:"reference"})],b.prototype,"layer",void 0),(0,c.e)([(0,c.y)({type:h.k})],b.prototype,"popupTemplate",void 0),(0,c.e)([(0,c.y)({clonable:"reference"})],b.prototype,"sourceLayer",void 0),(0,c.e)([(0,c.y)({value:null,types:p.j})],b.prototype,"symbol",null),(0,c.e)([(0,c.y)({type:Boolean,value:!0})],b.prototype,"visible",null),b=(0,c.e)([(0,c.n)("esri.Graphic")],b),(b||(b={})).generateUID=c.a4;var w=b},82396:function(e,t,n){n.d(t,{v:function(){return _}});var r,i=n(1413),o=n(15671),a=n(43144),u=n(11752),s=n(61120),l=n(60136),c=n(29388),f=n(48848),h=n(93661),p=n(40558),v=n(40114),d=n(47855),y=n(82474),g=(0,p.o)()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),m=g.jsonValues.slice();(0,h.A)(m,"orthometric");var b=(0,p.o)()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"}),w=r=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).heightModel="gravity-related-height",r.heightUnit="meters",r.vertCRS=null,r}return(0,a.Z)(n,[{key:"writeHeightModel",value:function(e,t,n){return g.write(e,t,n)}},{key:"readHeightModel",value:function(e,t,n){return g.read(e)||(n&&n.messages&&n.messages.push(function(e,t){return new f.l("height-model:unsupported","Height model of value '".concat(e,"' is not supported"),t)}(e,{context:n})),null)}},{key:"readHeightUnit",value:function(e,t,n){return b.read(e)||(n&&n.messages&&n.messages.push(M(e,{context:n})),null)}},{key:"readHeightUnitService",value:function(e,t,n){return(0,d.G)(e)||b.read(e)||(n&&n.messages&&n.messages.push(M(e,{context:n})),null)}},{key:"readVertCRS",value:function(e,t){return t.vertCRS||t.ellipsoid||t.geoid}},{key:"clone",value:function(){return new r({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}},{key:"equals",value:function(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}},{key:"write",value:function(e,t){return t=(0,i.Z)({origin:"web-scene"},t),(0,u.Z)((0,s.Z)(n.prototype),"write",this).call(this,e,t)}}],[{key:"deriveUnitFromSR",value:function(e,t){var n=(0,d.W)(t);return new r({heightModel:e.heightModel,heightUnit:n,vertCRS:e.vertCRS})}},{key:"fromJSON",value:function(e){if(!e)return null;var t=new r;return t.read(e,{origin:"web-scene"}),t}}]),n}(v.l);function M(e,t){return new f.l("height-unit:unsupported","Height unit of value '".concat(e,"' is not supported"),t)}(0,f.e)([(0,f.y)({type:g.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:m,default:"ellipsoidal"}}}})],w.prototype,"heightModel",void 0),(0,f.e)([(0,y.r)("web-scene","heightModel")],w.prototype,"writeHeightModel",null),(0,f.e)([(0,y.o)(["web-scene","service"],"heightModel")],w.prototype,"readHeightModel",null),(0,f.e)([(0,f.y)({type:b.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:b.jsonValues,write:b.write}}}})],w.prototype,"heightUnit",void 0),(0,f.e)([(0,y.o)("web-scene","heightUnit")],w.prototype,"readHeightUnit",null),(0,f.e)([(0,y.o)("service","heightUnit")],w.prototype,"readHeightUnitService",null),(0,f.e)([(0,f.y)({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],w.prototype,"vertCRS",void 0),(0,f.e)([(0,y.o)("service","vertCRS",["vertCRS","ellipsoid","geoid"])],w.prototype,"readVertCRS",null);var _=w=r=(0,f.e)([(0,f.n)("esri.geometry.HeightModelInfo")],w)},21385:function(e,t,n){n.d(t,{a:function(){return g}});var r=n(74165),i=n(15861),o=n(15671),a=n(43144),u=n(60136),s=n(29388),l=n(48848),c=n(89794),f=n(40558),h=n(40114),p=(n(93661),n(82474)),v=new f.s({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"}),d=0,y=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).id="sym"+d++,r.type=null,r.color=new c.l([0,0,0,1]),r}return(0,a.Z)(n,[{key:"readColor",value:function(e){return e&&null!=e[0]?[e[0],e[1],e[2],e[3]/255]:e}},{key:"collectRequiredFields",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"hash",value:function(){return JSON.stringify(this.toJSON())}},{key:"clone",value:function(){}}]),n}(h.l);(0,l.e)([(0,l.y)({type:v.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:v.write}}})],y.prototype,"type",void 0),(0,l.e)([(0,l.y)({type:c.l,json:{write:{allowNull:!0}}})],y.prototype,"color",void 0),(0,l.e)([(0,p.o)("color")],y.prototype,"readColor",null);var g=y=(0,l.e)([(0,l.n)("esri.symbols.Symbol")],y)},89181:function(e,t,n){n.d(t,{T:function(){return w},g:function(){return y},n:function(){return v}});var r,i=n(15671),o=n(43144),a=n(60136),u=n(29388),s=n(48848),l=n(40114),c=n(93661),f=n(82474),h={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},p={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function v(e,t,n){var r=new Date(e.getTime());if(t&&n){var i=p[n],o=i.getter,a=i.setter,u=i.multiplier;if("months"===n){var s=function(e,t){var n=new Date(e,t+1,1);return n.setDate(0),n.getDate()}(r.getFullYear(),r.getMonth()+t);r.getDate()>s&&r.setDate(s)}r[a](r[o]()+t*u)}return r}function d(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return new Date}}function y(e,t,n){return 0===e?0:e*h[t]/h[n]}var g=r=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).end=null,r.start=null,r}return(0,o.Z)(n,[{key:"readEnd",value:function(e,t){return null!=t.end?new Date(t.end):null}},{key:"writeEnd",value:function(e,t){t.end=e?e.getTime():null}},{key:"isAllTime",get:function(){return this.equals(r.allTime)}},{key:"isEmpty",get:function(){return this.equals(r.empty)}},{key:"readStart",value:function(e,t){return null!=t.start?new Date(t.start):null}},{key:"writeStart",value:function(e,t){t.start=e?e.getTime():null}},{key:"clone",value:function(){return new r({end:this.end,start:this.start})}},{key:"equals",value:function(e){if(!e)return!1;var t=(0,c.r)(this.start)?this.start.getTime():this.start,n=(0,c.r)(this.end)?this.end.getTime():this.end,r=(0,c.r)(e.start)?e.start.getTime():e.start,i=(0,c.r)(e.end)?e.end.getTime():e.end;return t===r&&n===i}},{key:"expandTo",value:function(e){if(this.isEmpty||this.isAllTime)return this.clone();var t=(0,c.n)(this.start,(function(t){return d(t,e)})),n=(0,c.n)(this.end,(function(t){var n=d(t,e);return t.getTime()===n.getTime()?n:v(n,1,e)}));return new r({start:t,end:n})}},{key:"intersection",value:function(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return r.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();var t,n,i=(0,c.u)(this.start,-1/0,(function(e){return e.getTime()})),o=(0,c.u)(this.end,1/0,(function(e){return e.getTime()})),a=(0,c.u)(e.start,-1/0,(function(e){return e.getTime()})),u=(0,c.u)(e.end,1/0,(function(e){return e.getTime()}));if(a>=i&&a<=o?t=a:i>=a&&i<=u&&(t=i),o>=a&&o<=u?n=o:u>=i&&u<=o&&(n=u),null!=t&&null!=n&&!isNaN(t)&&!isNaN(n)){var s=new r;return s.start=t===-1/0?null:new Date(t),s.end=n===1/0?null:new Date(n),s}return r.empty}},{key:"offset",value:function(e,t){if(this.isEmpty||this.isAllTime)return this.clone();var n=new r,i=this.start,o=this.end;return(0,c.r)(i)&&(n.start=v(i,e,t)),(0,c.r)(o)&&(n.end=v(o,e,t)),n}},{key:"union",value:function(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return m.clone();var t=(0,c.r)(this.start)&&(0,c.r)(e.start)?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,n=(0,c.r)(this.end)&&(0,c.r)(e.end)?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new r({start:t,end:n})}}],[{key:"allTime",get:function(){return m}},{key:"empty",get:function(){return b}}]),n}(l.l);(0,s.e)([(0,s.y)({type:Date,json:{write:{allowNull:!0}}})],g.prototype,"end",void 0),(0,s.e)([(0,f.o)("end")],g.prototype,"readEnd",null),(0,s.e)([(0,f.r)("end")],g.prototype,"writeEnd",null),(0,s.e)([(0,s.y)({readOnly:!0,json:{read:!1}})],g.prototype,"isAllTime",null),(0,s.e)([(0,s.y)({readOnly:!0,json:{read:!1}})],g.prototype,"isEmpty",null),(0,s.e)([(0,s.y)({type:Date,json:{write:{allowNull:!0}}})],g.prototype,"start",void 0),(0,s.e)([(0,f.o)("start")],g.prototype,"readStart",null),(0,s.e)([(0,f.r)("start")],g.prototype,"writeStart",null);var m=new(g=r=(0,s.e)([(0,s.n)("esri.TimeExtent")],g)),b=new g({start:void 0,end:void 0}),w=g},87750:function(e,t,n){n.d(t,{A:function(){return y},B:function(){return g},M:function(){return p},a:function(){return O},b:function(){return h},c:function(){return m},d:function(){return Z},e:function(){return S},f:function(){return T},g:function(){return E},h:function(){return L},i:function(){return I},j:function(){return v},k:function(){return j},l:function(){return P},m:function(){return R},n:function(){return d},o:function(){return c},p:function(){return f},s:function(){return x},u:function(){return A},v:function(){return l}});var r=n(15671),i=n(43144),o=n(71802),a=n(64772),u=n(13239),s=n(91681);function l(e){return e?{origin:(0,o.t)(e.origin),vector:(0,o.t)(e.vector)}:{origin:(0,o.n)(),vector:(0,o.n)()}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l();return f(e.origin,e.vector,t)}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,o.r)(n.origin,e),(0,o.r)(n.vector,t),n}function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,o.r)(n.origin,e),(0,o.e)(n.vector,t,e),n}function p(e,t){var n=(0,o.e)(a.c.get(),t,e.origin),r=(0,o.P)(e.vector,n),i=(0,o.P)(e.vector,e.vector),u=(0,o.a)(r/i,0,1),s=(0,o.e)(a.c.get(),(0,o.g)(a.c.get(),e.vector,u),n);return(0,o.P)(s,s)}function v(e,t,n){return y(e,t,0,1,n)}function d(e,t,n){return(0,o.u)(n,e.origin,(0,o.g)(n,e.vector,t))}function y(e,t,n,r,i){var u=e.vector,s=e.origin,l=(0,o.e)(a.c.get(),t,s),c=(0,o.P)(u,l)/(0,o.v)(u);return(0,o.g)(i,u,(0,o.a)(c,n,r)),(0,o.u)(i,i,e.origin)}function g(e,t){if(b(e,function(e,t){var n=M.get();return n.origin=e,n.vector=t,n}(t.origin,t.direction),!1,w)){var n=w.tA,r=w.pB,i=w.distance2;if(n>=0&&n<=1)return i;if(n<0)return(0,o.p)(e.origin,r);if(n>1)return(0,o.p)((0,o.u)(a.c.get(),e.origin,e.vector),r)}return null}function m(e,t,n){return!!b(e,t,!0,w)&&((0,o.r)(n,w.pA),!0)}function b(e,t,n,r){var i=1e-6,u=e.origin,s=(0,o.u)(a.c.get(),u,e.vector),l=t.origin,c=(0,o.u)(a.c.get(),l,t.vector),f=a.c.get(),h=a.c.get();if(f[0]=u[0]-l[0],f[1]=u[1]-l[1],f[2]=u[2]-l[2],h[0]=c[0]-l[0],h[1]=c[1]-l[1],h[2]=c[2]-l[2],Math.abs(h[0])<i&&Math.abs(h[1])<i&&Math.abs(h[2])<i)return!1;var p=a.c.get();if(p[0]=s[0]-u[0],p[1]=s[1]-u[1],p[2]=s[2]-u[2],Math.abs(p[0])<i&&Math.abs(p[1])<i&&Math.abs(p[2])<i)return!1;var v=f[0]*h[0]+f[1]*h[1]+f[2]*h[2],d=h[0]*p[0]+h[1]*p[1]+h[2]*p[2],y=f[0]*p[0]+f[1]*p[1]+f[2]*p[2],g=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],m=(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*g-d*d;if(Math.abs(m)<i)return!1;var b=(v*d-y*g)/m,w=(v+d*b)/g;n&&(b=(0,o.a)(b,0,1),w=(0,o.a)(w,0,1));var M=a.c.get(),_=a.c.get();return M[0]=u[0]+b*p[0],M[1]=u[1]+b*p[1],M[2]=u[2]+b*p[2],_[0]=l[0]+w*h[0],_[1]=l[1]+w*h[1],_[2]=l[2]+w*h[2],r.tA=b,r.tB=w,r.pA=M,r.pB=_,r.distance2=(0,o.p)(M,_),!0}var w={tA:0,tB:0,pA:(0,o.n)(),pB:(0,o.n)(),distance2:0},M=new a.s((function(){return l()})),_=(0,s.n)(),k=function(){function e(t){(0,r.Z)(this,e),this.message=t}return(0,i.Z)(e,[{key:"toString",value:function(){return"AssertException: ".concat(this.message)}}]),e}();function S(e,t){if(!e)throw t=t||"assert",console.log(new Error(t).stack),new k(t)}function x(e,t){e||(t=t||"",console.warn("Verify failed: "+t+"\n"+new Error("verify").stack))}function Z(e,t,n,r){var i,o=(n[0]-e[0])/t[0],a=(r[0]-e[0])/t[0];o>a&&(i=o,o=a,a=i);var u=(n[1]-e[1])/t[1],s=(r[1]-e[1])/t[1];if(u>s&&(i=u,u=s,s=i),o>s||u>a)return!1;u>o&&(o=u),s<a&&(a=s);var l=(n[2]-e[2])/t[2],c=(r[2]-e[2])/t[2];return l>c&&(i=l,l=c,c=i),!(o>c||l>a)&&(c<a&&(a=c),!(a<0))}function A(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:(0,u.n)(),a=(r[i]-n[i])*(t[0]-e[0])-(r[0]-n[0])*(t[i]-e[i]),s=(r[0]-n[0])*(e[i]-n[i])-(r[i]-n[i])*(e[0]-n[0]);if(0===a)return!1;var l=s/a;return o[0]=e[0]+l*(t[0]-e[0]),o[1]=e[i]+l*(t[i]-e[i]),!0}function I(e,t,n,r,i){i||(i=e),_[0]=e[0],_[1]=e[1],_[2]=e[2],_[3]=1,(0,o.w)(_,_,t),i.length>2&&(i[2]=-_[2]),(0,o.w)(_,_,n),S(0!==_[3]),i[0]=_[0]/_[3],i[1]=_[1]/_[3],i[2]=_[2]/_[3],i[0]=(.5*i[0]+.5)*r[2]+r[0],i[1]=(.5*i[1]+.5)*r[3]+r[1]}function T(e,t){return Math.log(e)/Math.log(t)}function L(e,t,n,r){e[12]=t,e[13]=n,e[14]=r}function O(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]}function P(e,t,n){return 2*Math.atan(Math.sqrt(t*t+n*n)*Math.tan(.5*e)/t)}function R(e,t,n){return 2*Math.atan(Math.sqrt(t*t+n*n)*Math.tan(.5*e)/n)}function E(e,t,n){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+n*n))}function j(e,t,n){return 2*Math.atan(n*Math.tan(.5*e)/Math.sqrt(t*t+n*n))}},17332:function(e,t,n){var r;function i(e){return"global"===e?r.Global:r.Local}function o(e){return e===r.Global?"global":"local"}n.d(t,{a:function(){return o},l:function(){return r},o:function(){return i}}),function(e){e[e.Global=1]="Global",e[e.Local=2]="Local"}(r||(r={}))},85718:function(e,t,n){n.r(t);var r,i=n(37762),o=n(11752),a=n(61120),u=n(29439),s=n(74165),l=n(15861),c=n(1413),f=n(15671),h=n(43144),p=n(60136),v=n(29388),d=n(48848),y=n(40558),g=n(32161),m=n(17455),b=n(93314),w=n(93661),M=n(93116),_=n(16641),k=n(99795),S=n(65094),x=n(82474),Z=n(96485),A=n(40114),I=n(46817),T=n(82396),L=n(95249),O=n(70522),P=n(56162),R=n(21015),E=n(63638),j=n(17332),C=n(25747),U=n(79527),N=n(81556),V=n(37686),F=n(59389),q=n(50690),z=n(71802),D=n(45999),B=n(24623),G=n(47748),Y=n(85253),H=n(70288);n(89794),n(48200),n(20302),n(90316),n(37856),n(19891),n(62610),n(1500),n(74384),n(15751),n(47855),n(79557),n(75255),n(25456),n(65415),n(1685),n(46337),n(15436),n(37944),n(86086),n(59984),n(21385),n(93209),n(64998),n(25577),n(53586),n(60369),n(92072),n(26313),n(37077),n(49228),n(41723),n(64772),n(91681),n(43955),n(76291),n(13239),n(24093),n(6189),n(87750),n(20846),n(67430),n(87424),n(10464),n(42667),n(90682),n(8141),n(52113),n(62642),n(12953),n(89181),n(15529);function W(){return new d.s("webscene:failed-to-copy-embedded-resources","Copying of embedded resources is currently not supported")}function J(e){return new d.s("webscene:schema-validation","Failed to save webscene due to schema validation errors. See 'details.errors' for more detailed information",{errors:e})}var K=r=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;return(0,f.Z)(this,n),(r=t.call(this,e)).viewing=null,r}return(0,h.Z)(n,[{key:"clone",value:function(){return new r({viewing:this.viewing?this.viewing.clone():null})}}]),n}(A.l);(0,d.e)([(0,d.y)({type:E.i,json:{write:!0}})],K.prototype,"viewing",void 0);var X,$=K=r=(0,d.e)([(0,d.n)("esri.webscene.ApplicationProperties")],K),Q=X=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;return(0,f.Z)(this,n),(r=t.call(this,e)).environment=new C.j,r.spatialReference=null,r.viewpoint=null,r}return(0,h.Z)(n,[{key:"viewingMode",set:function(e){this._set("viewingMode",e)}},{key:"clone",value:function(){return new X({environment:this.environment.clone(),spatialReference:this.spatialReference?this.spatialReference.clone():null,viewingMode:this.viewingMode,viewpoint:this.viewpoint?this.viewpoint.clone():null})}}]),n}(A.l);(0,d.e)([(0,d.y)({type:C.j,json:{write:{isRequired:!0}}})],Q.prototype,"environment",void 0),(0,d.e)([(0,d.y)({type:x.k})],Q.prototype,"spatialReference",void 0),(0,d.e)([(0,d.y)({type:["local","global"]})],Q.prototype,"viewingMode",null),(0,d.e)([(0,d.y)({type:m.u,json:{write:{isRequired:!0}}})],Q.prototype,"viewpoint",void 0);var ee,te=Q=X=(0,d.e)([(0,d.n)("esri.webscene.InitialViewProperties")],Q),ne=ee=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(){var e;return(0,f.Z)(this,n),(e=t.apply(this,arguments)).text="",e}return(0,h.Z)(n,[{key:"clone",value:function(){return new ee({text:this.text})}}]),n}(A.l);(0,d.e)([(0,d.y)({type:String,json:{write:!0}})],ne.prototype,"text",void 0);var re,ie,oe=ne=ee=(0,d.e)([(0,d.n)("esri.webscene.support.Description")],ne),ae=re=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(){var e;return(0,f.Z)(this,n),(e=t.apply(this,arguments)).lighting=new C.p,e.weather=new C.a,e}return(0,h.Z)(n,[{key:"clone",value:function(){return new re({lighting:(0,w.y)(this.lighting),weather:(0,w.y)(this.weather)})}}]),n}(A.l);(0,d.e)([(0,d.y)({types:C.i,json:{write:!0}})],ae.prototype,"lighting",void 0),(0,d.e)([(0,d.y)({types:C.n,json:{write:!0}})],ae.prototype,"weather",void 0),ae=re=(0,d.e)([(0,d.n)("esri.webscene.Environment")],ae);var ue=ie=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(){var e;return(0,f.Z)(this,n),(e=t.apply(this,arguments)).opacity=null,e}return(0,h.Z)(n,[{key:"clone",value:function(){return new ie({opacity:this.opacity})}},{key:"cloneAndApplyTo",value:function(e){return null==this.opacity||((e=null!=e?e.clone():new g.a).opacity=this.opacity),e}}],[{key:"fromGround",value:function(e){return new ie({opacity:e.opacity})}}]),n}(A.l);(0,d.e)([(0,d.y)({type:Number,json:{type:d.T,read:{reader:Y.r,source:"transparency"},write:{writer:function(e,t){t.transparency=(0,Y.n)(e)},target:"transparency"}}})],ue.prototype,"opacity",void 0);var se,le,ce=ue=ie=(0,d.e)([(0,d.n)("esri.webscene.support.SlideGround")],ue),fe=se=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;return(0,f.Z)(this,n),(r=t.call(this,e)).id="",r.sublayerIds=null,r}return(0,h.Z)(n,[{key:"clone",value:function(){return new se({id:this.id,sublayerIds:(0,w.y)(this.sublayerIds)})}}]),n}(A.l);(0,d.e)([(0,d.y)({type:String,json:{write:!0}})],fe.prototype,"id",void 0),(0,d.e)([(0,d.y)({type:[d.T],json:{read:{source:"subLayerIds"},write:{target:"subLayerIds"}}})],fe.prototype,"sublayerIds",void 0),fe=se=(0,d.e)([(0,d.n)("esri.webscene.support.SlideVisibleLayer")],fe);var he=le=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(){var e;return(0,f.Z)(this,n),(e=t.apply(this,arguments)).text="",e}return(0,h.Z)(n,[{key:"clone",value:function(){return new le({text:this.text})}}]),n}(A.l);(0,d.e)([(0,d.y)({type:String,json:{write:{isRequired:!0}}})],he.prototype,"text",void 0);var pe=he=le=(0,d.e)([(0,d.n)("esri.webscene.support.Title")],he),ve=0,de=b.j.ofType(fe),ye=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;return(0,f.Z)(this,n),(r=t.call(this,e)).id=Date.now().toString(16)+"-slide-"+ve++,r.title=new pe,r.description=new oe,r.thumbnail=new E.p,r.viewpoint=null,r.basemap=null,r.ground=null,r.environment=new ae,r.visibleLayers=new de,r}return(0,h.Z)(n,[{key:"destroy",value:function(){this.visibleLayers.removeAll(),this.basemap=null,this.thumbnail&&this.thumbnail.destroy(),this.description=null,this.title=null,this.thumbnail=null}},{key:"castTitle",value:function(e){return"string"==typeof e?new pe({text:e}):(0,d.b)(pe,e)}},{key:"castDescription",value:function(e){return"string"==typeof e?new oe({text:e}):(0,d.b)(oe,e)}},{key:"castThumbnail",value:function(e){return"string"==typeof e?new E.p({url:e}):(0,d.b)(E.p,e)}},{key:"castBasemap",value:function(e){return(0,g.m)(e)}},{key:"visibleLayers",set:function(e){this._set("visibleLayers",(0,N.n)(e,this._get("visibleLayers"),de))}},{key:"castVisibleLayers",value:function(e){var t=this;return e&&"function"==typeof e.map?e.map((function(e){if("string"==typeof e)return{id:e};if(e instanceof D.b){var n=me(e);return{id:e.id,sublayerIds:n}}return e.id?{id:e.id,sublayerIds:e.sublayerIds}:(d.a.getLogger(t.declaredClass).warn('Invalid visible layer, expected { id }, Layer or "id"'),e)})):null}},{key:"clone",value:function(){return new this.constructor({id:this.id,title:this.title.clone(),thumbnail:this.thumbnail.clone(),description:this.description&&this.description.clone()||null,viewpoint:this.viewpoint&&this.viewpoint.clone()||null,basemap:this.basemap&&this.basemap.clone()||null,ground:this.ground&&this.ground.clone()||null,visibleLayers:this.visibleLayers.clone(),environment:this.environment&&this.environment.clone()||null})}},{key:"_updateVisibleLayersFrom",value:function(e){var t=this,n=[];return(0,d.E)(this._getLayers(e.map).map((function(t){return e.whenLayerView(t).then((function(e){if(e.visible){var r=me(t);n.push(new fe({id:e.layer.id,sublayerIds:r}))}}))})).toArray()).then((function(){t.visibleLayers.removeAll(),t.visibleLayers.addMany(n)}))}},{key:"updateFrom",value:function(e,t){var n=this;return t={screenshot:(0,c.Z)({format:"png",quality:80,width:120,height:75,disableDecorations:!0},t&&t.screenshot)},e.when((function(){return n.viewpoint=e.viewpoint.clone(),n.environment.lighting="virtual"===e.environment.lighting.type?C.b.prototype.clone.apply(e.environment.lighting):C.p.prototype.clone.apply(e.environment.lighting),n.environment.weather=e.environment.weather.clone(),n.basemap=e.map.basemap&&e.map.basemap.clone()||null,n.ground=e.map.ground?ce.fromGround(e.map.ground):null,n._updateVisibleLayersFrom(e)})).then((function(){return e.takeScreenshot(t.screenshot)})).then((function(e){return n.thumbnail=new E.p({url:e.dataUrl}),n}))}},{key:"applyTo",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){var r,i,o,a,u,f,h=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,w.r)(this._applyToController)&&this._applyToController.abort(),r=new AbortController,this._applyToController=r,i=(0,d.o)(n,(function(){return r.abort()})),o=t.resourceController.scheduler.registerTask(G.I.SLIDE),a=!1,n=(0,c.Z)((0,c.Z)({animate:!0},n),{},{signal:this._applyToController.signal}),u=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([o.schedule((function(){return a=h._setViewpointOfInterest(t,n)})),o.schedule((function(){return h._applyBasemap(t,n)}),n.signal)]);case 2:return e.next=4,Promise.all([o.schedule((function(){return h._applyLayerVisibility(t)}),n.signal),o.schedule((function(){return h._applyGround(t)}),n.signal),o.schedule((function(){return h._applyViewpoint(t,n)}),n.signal)]);case 4:return e.next=6,o.schedule((function(){return t.environment.weather=h.environment.weather.clone()}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=9,(0,F.b)(t.addUpdatingPromise(u()));case 9:if(f=e.sent,a&&(t.contentCamera=null),o.remove(),this._applyToController===r&&(this._applyToController=null),r=null,null!==i&&void 0!==i&&i.remove(),!1!==f.ok){e.next=12;break}throw f.error;case 12:return e.abrupt("return",this);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_applyBasemap",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.basemap){e.next=11;break}return e.prev=1,e.next=4,this.basemap.load(n);case 4:e.next=10;break;case 6:if(e.prev=6,e.t0=e.catch(1),!(0,d.j)(e.t0)){e.next=10;break}throw e.t0;case 10:t.map.basemap=(0,g.d)(this.basemap,t.map.basemap);case 11:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_applyGround",value:function(e){this.ground&&(e.map.ground=this.ground.cloneAndApplyTo(e.map.ground))}},{key:"_getLayers",value:function(e){var t=new b.j;return this._collectLayers(e,t),this._collectLayers(e.ground,t),t}},{key:"_collectLayers",value:function(e,t){var n=this;e.layers.forEach((function(e){(0,B.u)(e)&&(t.add(e),"layers"in e&&n._collectLayers(e,t))}))}},{key:"_applyLayerVisibility",value:function(e){var t=this;this.visibleLayers&&this._getLayers(e.map).forEach((function(e){var n=t.visibleLayers.find((function(t){return t.id===e.id}));e.visible=null!=n;var r=n&&n.sublayerIds,i=ge(e);r&&i&&i.forEach((function(e){return e.visible=r.includes(e.id)}))}))}},{key:"_setViewpointOfInterest",value:function(e,t){if(e.state.fixedContentCamera||!this.viewpoint||t.ignoreViewpoint||!t.useDestinationCamera)return!1;var n=(0,C.c)(e,this.viewpoint);return e.contentCamera=n,(0,w.r)(n)}},{key:"_applyViewpoint",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._applyCachedCameraTrackingEnabled(t),!this.viewpoint||n.ignoreViewpoint){e.next=9;break}if((0,w.r)(this.viewpoint.camera)&&(this.viewpoint.camera.fov=t.camera.fov),!n.animate||!this.get("environment.lighting.date")){e.next=3;break}return e.abrupt("return",this._animateToLighting(t,n));case 3:if(e.t0=n.animate,!e.t0){e.next=8;break}return t.environment.applyLighting(this.environment.lighting.clone()),e.next=8,t.goTo(this.viewpoint,n);case 8:t.viewpoint=this.viewpoint;case 9:t.environment.applyLighting(this.environment.lighting.clone());case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_animateToLighting",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){var r,i=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,"virtual"!==t.environment.lighting.type&&"virtual"!==this.environment.lighting.type&&("global"===t.viewingMode&&(r=this._animateLightingWithCamera(t,t.environment.lighting,this.environment.lighting)),t.environment.cachedCameraTrackingEnabled=t.environment.lighting.cameraTrackingEnabled,t.environment.lighting.cameraTrackingEnabled=!1),t.environment.lighting.directShadowsEnabled=this.environment.lighting.directShadowsEnabled,"virtual"===this.environment.lighting.type||"virtual"===t.environment.lighting.type?(t.environment.applyLighting(this.environment.lighting.clone()),"virtual"!==t.environment.lighting.type&&(t.environment.cachedCameraTrackingEnabled=t.environment.lighting.cameraTrackingEnabled,t.environment.lighting.cameraTrackingEnabled=!1)):null!=this.environment.lighting.displayUTCOffset&&(t.environment.lighting.displayUTCOffset=this.environment.lighting.displayUTCOffset),e.abrupt("return",t.goTo(this.viewpoint,n).then((function(){i._applyCachedCameraTrackingEnabled(t),t.environment.applyLighting(i.environment.lighting.clone())})).catch((function(e){throw(0,w.t)(t.animation)&&i._applyCachedCameraTrackingEnabled(t),e})).finally((function(){(0,w.f)(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_applyCachedCameraTrackingEnabled",value:function(e){(0,w.r)(e.environment.cachedCameraTrackingEnabled)&&(e.environment.lighting.cameraTrackingEnabled=e.environment.cachedCameraTrackingEnabled,e.environment.cachedCameraTrackingEnabled=null)}},{key:"_getTime",value:function(e){return[e.getTime(),3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds()]}},{key:"_setTime",value:function(e,t,n){return e.setTime(t),e.setUTCHours(n/3600),e.setUTCMinutes(n%3600/60),e.setUTCSeconds(n%3600%60),e}},{key:"_animateLightingWithCamera",value:function(e,t,n){var r=this,i=new Date(t.date.toString()),o=this._getTime(i),a=(0,u.Z)(o,2),s=a[0],l=a[1],c=this._getTime(n.date),f=(0,u.Z)(c,2),h=f[0],p=f[1],v=function(e,t){var n=t-e;return n>we&&(n-=be),n<-we&&(n+=be),n}(l,p),d=e.renderCoordsHelper,y=(0,z.n)();d.toRenderCoords(e.camera.position,y);var g=(0,z.n)(),m=(0,z.n)();(0,w.r)(this.viewpoint.camera)&&d.toRenderCoords(this.viewpoint.camera.position,g);var b=new Date;return(0,q.f)((function(){return e.camera}),(function(e){d.toRenderCoords(e.position,m);var n=(0,z.p)(y,m),i=(0,z.p)(g,m),o=0;n+i!==0&&(o=n/(n+i));var a=s+(h-s)*o,u=function(e,t){return(0,C.d)(e+t,be)}(l,v*o);t.date=r._setTime(b,a,u)}))}}],[{key:"createFrom",value:function(e,t){return(new this).updateFrom(e,t)}}]),n}(A.l);function ge(e){if("building-scene"===e.type||"map-image"===e.type)return e.allSublayers.toArray()}function me(e){var t=ge(e);if(t)return t.filter((function(e){return e.visible})).map((function(e){return e.id}))}(0,d.e)([(0,d.y)({type:String,json:{write:{isRequired:!0}}})],ye.prototype,"id",void 0),(0,d.e)([(0,d.y)({type:pe,json:{default:function(){return new pe({text:""})},write:{isRequired:!0}}})],ye.prototype,"title",void 0),(0,d.e)([(0,d.c)("title")],ye.prototype,"castTitle",null),(0,d.e)([(0,d.y)({type:oe,json:{write:{overridePolicy:function(e){return{enabled:!(!e||!e.text)}}}}})],ye.prototype,"description",void 0),(0,d.e)([(0,d.c)("description")],ye.prototype,"castDescription",null),(0,d.e)([(0,d.y)({type:E.p,json:{default:function(){return new E.p({url:""})},write:{isRequired:!0}}})],ye.prototype,"thumbnail",void 0),(0,d.e)([(0,d.c)("thumbnail")],ye.prototype,"castThumbnail",null),(0,d.e)([(0,d.y)({type:m.u,nonNullable:!0,json:{write:{isRequired:!0}}})],ye.prototype,"viewpoint",void 0),(0,d.e)([(0,d.y)({type:V.x,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],ye.prototype,"basemap",void 0),(0,d.e)([(0,d.c)("basemap")],ye.prototype,"castBasemap",null),(0,d.e)([(0,d.y)({type:ce,json:{write:!0}})],ye.prototype,"ground",void 0),(0,d.e)([(0,d.y)({type:de,json:{write:{isRequired:!0}}})],ye.prototype,"visibleLayers",null),(0,d.e)([(0,d.c)("visibleLayers")],ye.prototype,"castVisibleLayers",null),(0,d.e)([(0,d.y)({type:ae,json:{write:!0}})],ye.prototype,"environment",void 0),ye=(0,d.e)([(0,d.n)("esri.webscene.Slide")],ye);var be=86400,we=43200;var Me=ye,_e=b.j.ofType(Me),ke=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;return(0,f.Z)(this,n),(r=t.call(this,e)).slides=new _e,r}return(0,h.Z)(n,[{key:"destroy",value:function(){this.slides.forEach((function(e){return e.destroy()})),this.slides.removeAll()}},{key:"slides",set:function(e){e&&(e=e.filter((function(e){return!!e.viewpoint}))),this._set("slides",(0,N.n)(e,this._get("slides"),_e))}},{key:"clone",value:function(){return new this.constructor({slides:this.slides.clone()})}}]),n}(A.l);(0,d.e)([(0,d.y)({type:_e,nonNullable:!0,json:{write:!0}}),(0,d.c)(N.t)],ke.prototype,"slides",null);var Se,xe=ke=(0,d.e)([(0,d.n)("esri.webscene.Presentation")],ke),Ze=Se=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(e){return(0,f.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"clone",value:function(){return new Se({name:this.name,path:this.path,title:this.title})}}]),n}(A.l);(0,d.e)([(0,d.y)({type:String,json:{write:!0}})],Ze.prototype,"name",void 0),(0,d.e)([(0,d.y)({type:String,json:{write:!0}})],Ze.prototype,"path",void 0),(0,d.e)([(0,d.y)({type:String,json:{write:!0}})],Ze.prototype,"title",void 0);var Ae,Ie=Ze=Se=(0,d.e)([(0,d.n)("esri.webscene.TransportationNetwork")],Ze),Te=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(e,r){return(0,f.Z)(this,n),t.call(this,e,r,"webscene")}return(0,h.Z)(n,[{key:"supportsGround",get:function(){return this.since(1,8)}},{key:"supportsVisibleElevationLayersInSlides",get:function(){return this.lessThan(1,8)}}]),n}(H.r),Le=new Te(1,29),Oe="Web Scene",Pe="ViewingMode-Local",Re=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(e){var n;return(0,f.Z)(this,r),(n=t.call(this,e))._handles=new d.X,n.applicationProperties=null,n.clippingArea=null,n.clippingEnabled=!1,n.floorInfo=null,n.heightModelInfo=null,n.sourceVersion=null,n.transportationNetworks=null,n.presentation=new xe,n.initialViewProperties=new te,n.portalItem=null,n.resourceInfo=null,n._debouncedSaveOperations=(0,d.a1)(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,r,i){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===Ae.SAVE?3:e.t0===Ae.SAVE_AS?4:5;break;case 3:return e.abrupt("return",n._saveImpl(r));case 4:return e.abrupt("return",n._saveAsImpl(i,r));case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),n._resourceReferences={portalItem:null,paths:[]},n.authoringApp=null,n.authoringAppVersion=null,n._isAuthoringAppSetByUser=!1,n._isAuthoringAppVersionSetByUser=!1,n}return(0,h.Z)(r,[{key:"initialize",value:function(){var e=this;if(this.when().catch((function(t){d.a.getLogger(e.declaredClass).error("#load()","Failed to load web scene",t)})),this.resourceInfo){var t;try{t=this._validateJSON(this.resourceInfo)}catch(Te){return void this.addResolvingPromise(Promise.reject(Te))}this.read(t),this.addResolvingPromise(this._validateSpatialReference()),this.addResolvingPromise(this._validateHeightModelInfo())}this._handles.add(this.allLayers.on("change",(function(){return e._scheduleLayersIdGC()})))}},{key:"destroy",value:function(){this._unscheduleLayersIdGC(),this._handles.destroy(),this.presentation&&this.presentation.destroy();var e=this.portalItem;this.portalItem=null,null===e||void 0===e||e.destroy()}},{key:"writeClippingArea",value:function(e,t){t.clippingArea||(t.clippingArea={}),t.clippingArea.geometry=e.toJSON()}},{key:"readClippingEnabled",value:function(e,t){return!!t.clippingArea&&!!t.clippingArea.clip}},{key:"writeClippingEnabled",value:function(e,t){this.clippingArea&&(t.clippingArea||(t.clippingArea={}),t.clippingArea.clip=e)}},{key:"writeLayers",value:function(e,t,n,r){var i=this,o=(0,c.Z)((0,c.Z)({},r),{},{layerContainerType:"operational-layers"}),a=e.map((function(e){return i.verifyWriteLayer(e,r)?e.write({},o):null})).filter((function(e){return!!e}));t[n]=a.toArray()}},{key:"verifyWriteLayer",value:function(e,t){return"write"in e||(t&&t.messages&&t.messages.push(new d.s("layer:unsupported","Layers (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' cannot be persisted in web scenes"),{layer:e})),!1)}},{key:"readSourceVersion",value:function(e,t){var n=t.version.split("."),r=(0,u.Z)(n,2),i=r[0],o=r[1];return new Te(parseInt(i,10),parseInt(o,10))}},{key:"writeSourceVersion",value:function(e,t,n){t[n]="".concat(Le.major,".").concat(Le.minor)}},{key:"thumbnailUrl",get:function(){return this.portalItem&&this.portalItem.thumbnailUrl||null},set:function(e){e?this._override("thumbnailUrl",e):(this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))}},{key:"authoringApp",set:function(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}},{key:"writeAuthoringApp",value:function(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp="ArcGIS API for JavaScript"}},{key:"authoringAppVersion",set:function(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}},{key:"writeAuthoringAppVersion",value:function(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=y.a}},{key:"writeGround",value:function(e,t,n,r){t[n]=e?e.write({},r):{transparency:0,layers:[]}}},{key:"readInitialViewProperties",value:function(e,t){var n={};return t.initialState&&t.initialState.environment&&(n.environment=C.j.fromJSON(t.initialState.environment)),t.spatialReference?n.spatialReference=x.k.fromJSON(t.spatialReference):n.spatialReference=x.k.WebMercator,n.viewingMode=t.viewingMode||"global",t.initialState&&t.initialState.viewpoint&&(n.viewpoint=m.u.fromJSON(t.initialState.viewpoint)),new te(n)}},{key:"spatialReference",get:function(){var e,t;return null!==(e=null===(t=this.initialViewProperties)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:x.k.WebMercator}},{key:"viewingMode",get:function(){var e,t;return null!==(e=null===(t=this.initialViewProperties)||void 0===t?void 0:t.viewingMode)&&void 0!==e?e:"global"}},{key:"load",value:function(e){return this.addResolvingPromise(this._loadFromSource()),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return(0,_.n)(this,(function(t){var n=e.presentation&&e.presentation.slides;t(e.ground,e.basemap,e.layers,n&&n.map((function(e){return e.basemap})))}))}},{key:"read",value:function(e,t){var n=this;t=(0,c.Z)((0,c.Z)({},t),{},{origin:"web-scene"});var i=this._isAuthoringAppVersionSetByUser,u=this._isAuthoringAppSetByUser;if((0,A.d)(this,e,(function(t){return(0,o.Z)((0,a.Z)(r.prototype),"read",n).call(n,e,t)}),t),u||(this._isAuthoringAppSetByUser=!1),i||(this._isAuthoringAppVersionSetByUser=!1),e.baseMap&&Array.isArray(e.baseMap.elevationLayers)&&this.sourceVersion.supportsVisibleElevationLayersInSlides){var s=e.baseMap.elevationLayers.map((function(e){return{id:e.id}})),l=this.presentation.slides,f=s.filter((function(e){return!l.some((function(t){return function(e,t){return e.visibleLayers.some((function(e){return e.id===t}))}(t,e.id)}))}));l.forEach((function(e){e.visibleLayers.addMany(f)}))}}},{key:"_writeBasemapElevationLayers",value:function(e){var t=e.ground&&e.ground.layers;!e.baseMap&&t&&t.length&&(e.baseMap={title:"Basemap",baseMapLayers:[]}),e.baseMap&&(e.baseMap.elevationLayers=(0,w.y)(t))}},{key:"write",value:function(e,t){var n;if("loaded"!==this.loadStatus){var i=new d.s("webscene:not-loaded","Web scene must be loaded before it can be serialized");throw d.a.getLogger(this.declaredClass).error("#toJSON()","Web scene must be loaded before it can be serialized",this.loadError||this.loadStatus),i}this._runLayersIdGC();var u=!(null!==(n=t)&&void 0!==n&&n.messages);t=(0,c.Z)((0,c.Z)({messages:[]},t),{},{origin:"web-scene"});var s=(0,o.Z)((0,a.Z)(r.prototype),"write",this).call(this,e,t);if(u){var l=t.messages.filter((function(e){return"web-document-write:property-required"===e.name}));if(l.length){var f=new d.s("web-document:property-required","One or more properties that are required in the webscene JSON are missing, see details for the specific errors",{errors:l});throw d.a.getLogger(this.declaredClass).error("#toJSON()","One or more properties that are required in the webscene JSON are missing",l),f}}return this._writeBasemapElevationLayers(s),s}},{key:"save",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._debouncedSaveOperations(Ae.SAVE,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_saveImpl",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.portalItem,e.t0){e.next=5;break}return d.a.getLogger(this.declaredClass).error("save(): requires the .portalItem property to be set"),e.next=5,Promise.reject(new d.s("webscene:portal-item-not-set","Portal item to save to has not been set on the WebScene"));case 5:if(e.t1=this.portalItem.type!==Oe,!e.t1){e.next=9;break}return e.next=9,Promise.reject(new d.s("webscene:portal-item-wrong-type",'Portal item needs to have type "'.concat(Oe,'"')));case 9:return n=this._updateFromPromise,e.next=12,this._ensureLoadBeforeSave();case 12:return r=this._enableVerifyItemRelativeUrls({origin:"web-scene",url:this.portalItem.itemUrl&&(0,y.j)(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||M.j.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}}),i=this.write({},r),e.next=15,Promise.all(r.resources.pendingOperations);case 15:return e.next=17,this._verifySave(i,r,t);case 17:return this._updateTypeKeywords(this.portalItem),e.next=20,this.portalItem.update({data:i});case 20:return e.next=22,(0,U.a)(this._resourceReferences,r,null);case 22:if((0,Z.i)(r),e.t2=n,!e.t2){e.next=27;break}return e.next=27,n;case 27:return e.next=29,this._saveThumbnail();case 29:return e.abrupt("return",this.portalItem);case 30:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveAs",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._debouncedSaveOperations(Ae.SAVE_AS,n,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_saveAsImpl",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){var r,i,o,a,u,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=R.default.from(t),e.t0=r,e.t0){e.next=6;break}return d.a.getLogger(this.declaredClass).error("saveAs(portalItem): requires a portal item parameter"),e.next=6,Promise.reject(new d.s("webscene:portal-item-required","saveAs requires a portal item to save to"));case 6:return r.id&&((r=r.clone()).id=null),i=r.portal||M.j.getDefault(),e.next=10,this._ensureLoadBeforeSave();case 10:return r.type=Oe,r.portal=i,o=this._enableVerifyItemRelativeUrls({origin:"web-scene",url:null,messages:[],portal:i,portalItem:r,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}}),a=this.write({},o),e.next=15,Promise.all(o.resources.pendingOperations);case 15:return e.next=17,this._verifySaveAs(a,o,n);case 17:return u=this.thumbnailUrl,l=!this._isOverridden("thumbnailUrl"),this._updateTypeKeywords(r),e.next=21,i._signIn();case 21:return e.next=23,i.user.addItem({item:r,folder:n&&n.folder,data:a});case 23:return e.next=25,(0,U.a)(this._resourceReferences,o,null);case 25:return this.portalItem=r,k.S.prototype.read.call(this,{version:a.version,authoringApp:a.authoringApp,authoringAppVersion:a.authoringAppVersion},{name:"web-scene",ignoreDefaults:!0,url:r.itemUrl&&(0,y.j)(r.itemUrl)}),(0,Z.i)(o),u&&(this.thumbnailUrl=l?(0,y.S)(u,"w","8192"):u),o.portalItem=r,e.next=32,this._saveThumbnail();case 32:return e.abrupt("return",r);case 33:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_saveThumbnail",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._isOverridden("thumbnailUrl"),!e.t0){e.next=6;break}return e.next=4,this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl});case 4:this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_verifySave",value:function(e,t,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!(0,x.A)(this.spatialReference))return Promise.reject(new d.s("webscene:unsupported-spatial-reference","Webscenes using spatial reference systems from Mars or Moon can not be saved currently."));var a,u=t.messages.filter((function(e){return"error"===e.type})).map((function(e){return new d.s(e.name,e.message,e.details)}));t.blockedRelativeUrls&&(u=u.concat(t.blockedRelativeUrls.map((function(e){return new d.s("url:unsupported","Relative url '".concat(e,"' is not supported in Web Scene"))})))),r&&r.ignoreUnsupported&&(u=u.filter((function(e){return"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name&&"scenemodification:unsupported"!==e.name}))),(null===r||void 0===r?void 0:r.requiredPropertyChecksDisabled)&&(u=u.filter((function(e){return"web-document-write:property-required"!==e.name})));var s=r&&r.strictSchemaValidationEnabled;return a=s?Promise.all([n.e(2550),n.e(2942)]).then(n.bind(n,12942)).then((function(t){var n=t.validate(e);if(n.length>0){var r="webscene did not validate:\n".concat(n.join("\n"));d.a.getLogger(i.declaredClass).error("".concat(o?"saveAs":"save","(): ").concat(r))}return n.map((function(e){return new d.s("webscene:schema-validation",e)}))})).then((function(e){if(s&&e.length>0)throw J(e.concat(u));return u})):Promise.resolve(u),a.then((function(e){if(e.length>0)throw new d.s("webscene:save","Failed to save webscene due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:e})}))}},{key:"_verifySaveAs",value:function(e,t,n){return this.canNotSaveAs(t)?Promise.reject(W()):this._verifySave(e,t,n,!0)}},{key:"verifySaveAs",value:function(e){var t=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),n=this.write({},t);return this._verifySaveAs(n,t,e)}},{key:"canNotSaveAs",value:function(e){return e||(e=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),this.write({},e)),e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.length>0}},{key:"updateFrom",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n,r,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=this._updateFrom(t,n),this._updateFromPromise=r,e.next=5,r;case 5:this._updateFromPromise===r&&(this._updateFromPromise=null);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateFrom",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n,r,o,a,u,l=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},e.next=3,t.whenReady();case 3:if(!n.environmentExcluded&&t.environment&&(this.initialViewProperties.environment=C.j.prototype.clone.apply(t.environment)),!n.viewpointExcluded&&t.viewpoint&&(this.initialViewProperties.viewpoint=t.viewpoint.clone()),this.initialViewProperties.spatialReference=t.spatialReference.clone(),this.initialViewProperties.viewingMode=t.viewingMode,(0,w.r)(t.clippingArea)?t.clippingArea!==this.clippingArea&&(this.clippingArea=t.clippingArea.clone(),this.clippingEnabled=!0):this.clippingEnabled=!1,t.heightModelInfo&&(this.heightModelInfo=t.heightModelInfo.clone()),t.map!==this){e.next=12;break}r=(0,i.Z)(t.allLayerViews);try{for(r.s();!(o=r.n()).done;)a=o.value,(u="visible")in a&&u in a.layer&&a._isOverridden(u)&&(a.layer[u]=a[u])}catch(s){r.e(s)}finally{r.f()}case 12:if(e.t0=!1===n.thumbnailExcluded||null==n.thumbnailExcluded&&!n.viewpointExcluded,!e.t0){e.next=16;break}return e.next=16,this._updateFromThumbnail(t,n.thumbnailSize||void 0);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateFromThumbnail",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){var r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,E.a)(t,n),e.next=3,t.takeScreenshot({format:"jpg",width:r.width,height:r.height,disableDecorations:!0});case 3:i=e.sent,this.thumbnailUrl=i.dataUrl;case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_loadFromSource",value:function(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-scene"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):this._loadObjectsWithLayers()}},{key:"_readAndLoadFromJSON",value:function(e,t){var n=this._validateJSON(e);return this.read(n,t),this._loadFromJSON(n,t)}},{key:"_extractOperationalLayers",value:function(e){var t=this,n=[];if(!this.sourceVersion.supportsGround&&e.baseMap&&Array.isArray(e.baseMap.elevationLayers)){var r,o=(0,i.Z)(e.baseMap.elevationLayers);try{for(o.s();!(r=o.n()).done;){var a=r.value;n.push(a)}}catch(s){o.e(s)}finally{o.f()}}var u=[];return{operationalLayers:e.operationalLayers?e.operationalLayers.filter((function e(n){return n.layers&&(n.layers=n.layers.filter(e)),"ArcGISTiledElevationServiceLayer"!==n.layerType||(t.sourceVersion.supportsGround||u.push(n),!1)})):[],operationalElevationLayers:u,basemapElevationLayers:n}}},{key:"_loadFromJSON",value:function(e,t){var r=this,i=new b.j;return this._validateSpatialReference().then((function(){return r._validateHeightModelInfo()})).then((function(){return Promise.all([n.e(5224),n.e(6471),n.e(6082)]).then(n.bind(n,11318))})).then((function(n){var o=n.populateOperationalLayers,a=r._extractOperationalLayers(e),u=a.operationalLayers,s=a.operationalElevationLayers,l=a.basemapElevationLayers,f=[],h={context:(0,c.Z)((0,c.Z)({},t),{},{layerContainerType:"operational-layers"})};if(r.portalItem&&(h.context.portal=r.portalItem.portal||M.j.getDefault()),l.length>0){var p=(0,c.Z)((0,c.Z)({},h),{},{context:(0,c.Z)((0,c.Z)({},h.context),{},{layerContainerType:"ground"})});p.defaultLayerType="ArcGISTiledElevationServiceLayer",f.push(o(r.ground.layers,l,p))}if(s.length>0){var v=(0,c.Z)((0,c.Z)({},h),{},{context:(0,c.Z)((0,c.Z)({},h.context),{},{layerContainerType:"ground"})});v.defaultLayerType="ArcGISTiledElevationServiceLayer",f.push(o(i,s,v))}return u&&u.length>0&&f.push(o(r.layers,u,h)),(0,d.E)(f).then((function(){}))})).then((function(){return r._loadObjectsWithLayers()})).then((function(){r.ground.layers.addMany(i)}))}},{key:"_ensureLoadBeforeSave",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){var t,n,r,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.next=4,this._loadObjectsWithLayers();case 4:t=[],n=(0,i.Z)(this.allLayers.items);try{for(n.s();!(r=n.n()).done;)"beforeSave"in(o=r.value)&&"function"==typeof o.beforeSave&&(a=o.beforeSave())&&t.push(a)}catch(u){n.e(u)}finally{n.f()}return e.next=9,(0,d.E)(t);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_loadObjectsWithLayers",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.ground&&t.push(this.ground.load()),this.basemap&&t.push(this.basemap.load()),this.presentation.slides.forEach((function(e){e.basemap&&t.push(e.basemap.load())})),e.next=6,(0,d.E)(t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_loadFromItem",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load().catch((function(e){throw new d.s("webscene:load-portal-item","Failed to load portal item",{error:e})}));case 2:if("Web Scene"===t.type){e.next=4;break}throw new d.s("webscene:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Scene'",{type:t.type});case 4:return e.next=6,t.fetchData();case 6:return n=e.sent,this.resourceInfo=n,r={origin:"web-scene",url:(0,y.j)(t.itemUrl),portal:t.portal||M.j.getDefault(),portalItem:t,readResourcePaths:[]},e.next=11,this._readAndLoadFromJSON(n,r);case 11:this._resourceReferences={portalItem:t,paths:r.readResourcePaths};case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_validateSpatialReference",value:function(){var e,t=this.initialViewProperties,n=this._sceneSpatialReference;if("local"!==t.viewingMode){if(!(0,C.r)(n,j.l.Global))return Promise.reject(new d.s("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in global mode, only Web Mercator, WGS84 GCS or CGCS2000 are supported",{spatialReference:n,viewingMode:t.viewingMode}));e=function(e){return!e||(0,L.A)(e,n)}}else{if(!(0,C.r)(n,j.l.Local))return Promise.reject(new d.s("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in local mode, only projected coordinate systems are supported",{spatialReference:n,viewingMode:t.viewingMode}));e=function(e){return!e||e.equals(n)}}var r=function(e){return e&&((0,w.r)(e.camera)&&e.camera.position&&e.camera.position.spatialReference||(0,w.r)(e.targetGeometry)&&e.targetGeometry.spatialReference)},i=t.viewpoint,o=r(i);if(o&&!e(o))return Promise.reject(new d.s("webscene:incompatible-camera-spatial-reference","Camera spatial reference (${cameraSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{cameraSpatialReference:o,sceneSpatialReference:n,viewingMode:t.viewingMode}));var a=this.presentation.slides.find((function(t){return!e(r(t.viewpoint))}));if(a){var u=r(a.viewpoint);return Promise.reject(new d.s("webscene:incompatible-slide-spatial-reference","Slide spatial reference (${slideSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{slideSpatialReference:u,sceneSpatialReference:n,viewingMode:t.viewingMode}))}return Promise.resolve()}},{key:"_validateHeightModelInfo",value:function(){var e=this._sceneSpatialReference,t=(0,O.r)(this.heightModelInfo,e);return t?Promise.reject(t):Promise.resolve()}},{key:"_validateJSON",value:function(e){var t=Te.parse(e.version||"","webscene");return Le.validate(t),e.version="".concat(t.major,".").concat(t.minor),1===t.major&&t.minor<=2&&(e.spatialReference=x.k.WebMercator.toJSON()),e}},{key:"_updateTypeKeywords",value:function(e){"local"===this.initialViewProperties.viewingMode?e.typeKeywords?e.typeKeywords.includes(Pe)||e.typeKeywords.push(Pe):e.typeKeywords=[Pe]:"global"===this.initialViewProperties.viewingMode&&e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((function(e){return e!==Pe}))),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((function(e,t,n){return n.indexOf(e)===t})))}},{key:"_sceneSpatialReference",get:function(){return this.initialViewProperties.spatialReference||x.k.WebMercator}},{key:"_verifyItemRelativeRootPath",get:function(){return this.portalItem&&this.portalItem.itemUrl?(0,y.j)(this.portalItem.itemUrl).path:null}},{key:"_enableVerifyItemRelativeUrls",value:function(e){var t=this._verifyItemRelativeRootPath;return t&&(e.verifyItemRelativeUrls={rootPath:t,writtenUrls:[]}),e}},{key:"_unscheduleLayersIdGC",value:function(){this._layersIdGCTimeoutId&&(clearTimeout(this._layersIdGCTimeoutId),this._layersIdGCTimeoutId=0)}},{key:"_scheduleLayersIdGC",value:function(){var e=this;this._unscheduleLayersIdGC(),this._layersIdGCTimeoutId=setTimeout((function(){e._layersIdGCTimeoutId=0,e._runLayersIdGC()}),3e3)}},{key:"_runLayersIdGC",value:function(){var e=this;this._unscheduleLayersIdGC();var t=this.applicationProperties&&this.applicationProperties.viewing&&this.applicationProperties.viewing.search,n=function(t){return e.allLayers.some((function(e){return e.id===t}))};t&&t.layers&&(t.layers=t.layers.filter((function(e){return n(e.id)})));var r=this.presentation&&this.presentation.slides;r&&r.forEach((function(e){e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((function(e){return n(e.id)})))}))}}],[{key:"fromJSON",value:function(e){if(!e)throw new d.s("webscene:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:e})}}]),r}(M.m.LoadableMixin((0,S.m)((0,k.O)(g.L))));Re.version="".concat(Le.major,".").concat(Le.minor),(0,d.e)([(0,d.y)({type:$,json:{write:!0}})],Re.prototype,"applicationProperties",void 0),(0,d.e)([(0,d.y)({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Re.prototype,"basemap",void 0),(0,d.e)([(0,d.y)({type:I.w,json:{read:{source:"clippingArea.geometry",reader:P.v},write:{target:"clippingArea.geometry"}}})],Re.prototype,"clippingArea",void 0),(0,d.e)([(0,x.r)("clippingArea")],Re.prototype,"writeClippingArea",null),(0,d.e)([(0,d.y)({type:Boolean,json:{write:{target:"clippingArea.clip"}}})],Re.prototype,"clippingEnabled",void 0),(0,d.e)([(0,x.o)("clippingEnabled",["clippingArea"])],Re.prototype,"readClippingEnabled",null),(0,d.e)([(0,x.r)("clippingEnabled")],Re.prototype,"writeClippingEnabled",null),(0,d.e)([(0,d.y)({type:E.l,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],Re.prototype,"floorInfo",void 0),(0,d.e)([(0,d.y)({type:T.v,json:{write:!0}})],Re.prototype,"heightModelInfo",void 0),(0,d.e)([(0,d.y)({json:{write:{target:"operationalLayers",ignoreOrigin:!0}}})],Re.prototype,"layers",void 0),(0,d.e)([(0,x.r)("layers")],Re.prototype,"writeLayers",null),(0,d.e)([(0,d.y)({readOnly:!0,type:Te,json:{type:function(){for(var e=[],t=Le.major,n=8;n<=Le.minor;n++)e.push("".concat(t,".").concat(n));return e}(),write:{ignoreOrigin:!0,target:"version",isRequired:!0,overridePolicy:function(){return{enabled:!0,allowNull:!0,ignoreOrigin:!0}}}}})],Re.prototype,"sourceVersion",void 0),(0,d.e)([(0,x.o)("sourceVersion",["version"])],Re.prototype,"readSourceVersion",null),(0,d.e)([(0,x.r)("sourceVersion")],Re.prototype,"writeSourceVersion",null),(0,d.e)([(0,d.y)({json:{read:!1,write:!1}})],Re.prototype,"tables",void 0),(0,d.e)([(0,d.y)()],Re.prototype,"thumbnailUrl",null),(0,d.e)([(0,d.y)({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],Re.prototype,"authoringApp",null),(0,d.e)([(0,x.r)("authoringApp")],Re.prototype,"writeAuthoringApp",null),(0,d.e)([(0,d.y)({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],Re.prototype,"authoringAppVersion",null),(0,d.e)([(0,x.r)("authoringAppVersion")],Re.prototype,"writeAuthoringAppVersion",null),(0,d.e)([(0,d.y)({json:{write:{isRequired:!0,allowNull:!0,ignoreOrigin:!0,enabled:!0}}})],Re.prototype,"ground",void 0),(0,d.e)([(0,x.r)("ground")],Re.prototype,"writeGround",null),(0,d.e)([(0,d.y)({type:b.j.ofType(Ie),json:{write:!0}})],Re.prototype,"transportationNetworks",void 0),(0,d.e)([(0,d.y)({type:xe,nonNullable:!0,json:{write:{ignoreOrigin:!0,writer:function(e,t,n,r){if(e.slides&&e.slides.length>0){var i=(0,c.Z)((0,c.Z)({},r),{},{isPresentation:!0});t.presentation=e.write({},i)}}}}})],Re.prototype,"presentation",void 0),(0,d.e)([(0,d.y)({type:te,nonNullable:!0,json:{write:{target:"initialState",isRequired:!0,ignoreOrigin:!0},default:function(){return new te({viewingMode:"global",spatialReference:x.k.WebMercator})}}})],Re.prototype,"initialViewProperties",void 0),(0,d.e)([(0,x.o)("initialViewProperties",["initialState.environment","spatialReference","viewingMode","initialState.viewpoint"])],Re.prototype,"readInitialViewProperties",null),(0,d.e)([(0,d.y)({type:x.k,json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],Re.prototype,"spatialReference",null),(0,d.e)([(0,d.y)({type:["local","global"],json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],Re.prototype,"viewingMode",null),(0,d.e)([(0,d.y)({type:R.default})],Re.prototype,"portalItem",void 0),(0,d.e)([(0,d.y)()],Re.prototype,"resourceInfo",void 0),Re=(0,d.e)([(0,d.n)("esri.WebScene")],Re),function(e){e[e.SAVE=0]="SAVE",e[e.SAVE_AS=1]="SAVE_AS"}(Ae||(Ae={}));var Ee=Re;t.default=Ee},93209:function(e,t,n){n.d(t,{A:function(){return L},B:function(){return O},C:function(){return N},D:function(){return V},E:function(){return M},F:function(){return w},G:function(){return P},I:function(){return d},M:function(){return h},N:function(){return g},P:function(){return E},R:function(){return S},S:function(){return j},V:function(){return x},Y:function(){return Z},a:function(){return a},b:function(){return _},c:function(){return f},d:function(){return A},f:function(){return l},g:function(){return m},h:function(){return c},j:function(){return k},k:function(){return C},l:function(){return v},m:function(){return s},p:function(){return b},q:function(){return I},s:function(){return p},u:function(){return u},v:function(){return U},w:function(){return T},y:function(){return y}});var r=n(93661),i=n(46817),o=n(25456);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;return[e[0],e[1],e[2],e[3],e[4],e[5]]}function u(e,t,n,r,i,o){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:a();return u[0]=e,u[1]=t,u[2]=n,u[3]=r,u[4]=i,u[5]=o,u}function s(e,t){var n=isFinite(e[2])||isFinite(e[5]);return new i.w(n?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function l(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function c(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[2]),e[4]=Math.max(e[4],t[3])}function f(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function h(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length/3,i=e[0],o=e[1],a=e[2],u=e[3],s=e[4],l=e[5],c=0;c<r;c++)i=Math.min(i,t[n+3*c]),o=Math.min(o,t[n+3*c+1]),a=Math.min(a,t[n+3*c+2]),u=Math.max(u,t[n+3*c]),s=Math.max(s,t[n+3*c+1]),l=Math.max(l,t[n+3*c+2]);e[0]=i,e[1]=o,e[2]=a,e[3]=u,e[4]=s,e[5]=l}function p(e,t,n){var r=t.length,i=e[0],o=e[1],a=e[2],u=e[3],s=e[4],l=e[5];if(n)for(var c=0;c<r;c++){var f=t[c];i=Math.min(i,f[0]),o=Math.min(o,f[1]),a=Math.min(a,f[2]),u=Math.max(u,f[0]),s=Math.max(s,f[1]),l=Math.max(l,f[2])}else for(var h=0;h<r;h++){var p=t[h];i=Math.min(i,p[0]),o=Math.min(o,p[1]),u=Math.max(u,p[0]),s=Math.max(s,p[1])}e[0]=i,e[1]=o,e[2]=a,e[3]=u,e[4]=s,e[5]=l}function v(e){for(var t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0}function d(e){return e[0]>=e[3]?0:e[3]-e[0]}function y(e){return e[1]>=e[4]?0:e[4]-e[1]}function g(e){return e[2]>=e[5]?0:e[5]-e[2]}function m(e){var t=d(e),n=g(e),r=y(e);return Math.sqrt(t*t+n*n+r*r)}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=e[0]+d(e)/2,t[1]=e[1]+y(e)/2,t[2]=e[2]+g(e)/2,t}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=d(e),t[1]=y(e),t[2]=g(e),t}function M(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]}function _(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[3]<=e[3]&&t[4]<=e[4]&&t[5]<=e[5]}function k(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])}function S(e,t){return!!(0,r.t)(t)||k(e,t)}function x(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e;return i[0]=e[0]+t,i[1]=e[1]+n,i[2]=e[2]+r,i[3]=e[3]+t,i[4]=e[4]+n,i[5]=e[5]+r,i}function Z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=e[0]+d(e)/2,i=e[1]+y(e)/2,o=e[2]+g(e)/2;return n[0]=r+(e[0]-r)*t,n[1]=i+(e[1]-i)*t,n[2]=o+(e[2]-o)*t,n[3]=r+(e[3]-r)*t,n[4]=i+(e[4]-i)*t,n[5]=o+(e[5]-o)*t,n}function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return n[0]=t[0],n[1]=t[1],n[2]=t[2],n!==e&&(n[3]=e[3],n[4]=e[4],n[5]=e[5]),n}function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return n[3]=t[0],n[4]=t[1],n[5]=t[2],n!==e&&(n[0]=e[0],n[1]=e[1],n[2]=e[2]),e}function T(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function L(e){return e?T(e,N):a(N)}function O(e,t){return t||(t=(0,o.u)()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t}function P(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function R(e){return 6===e.length}function E(e){return 0===d(e)&&0===y(e)&&0===g(e)}function j(e,t,n){if((0,r.t)(e)||(0,r.t)(t))return e===t;if(!R(e)||!R(t))return!1;if(n){for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1}else for(var o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}function C(e,t,n,r,i,o){return u(e,t,n,r,i,o,F)}var U=[-1/0,-1/0,-1/0,1/0,1/0,1/0],N=[1/0,1/0,1/0,-1/0,-1/0,-1/0],V=[0,0,0,0,0,0],F=a()},25456:function(e,t,n){n.d(t,{D:function(){return O},E:function(){return Z},F:function(){return k},H:function(){return R},I:function(){return E},J:function(){return j},K:function(){return C},M:function(){return d},R:function(){return A},U:function(){return I},a:function(){return s},b:function(){return w},c:function(){return c},d:function(){return T},e:function(){return u},f:function(){return f},g:function(){return M},h:function(){return p},j:function(){return _},l:function(){return g},m:function(){return h},o:function(){return l},p:function(){return b},q:function(){return x},s:function(){return y},u:function(){return a},w:function(){return S},x:function(){return v},y:function(){return m},z:function(){return L}});var r=n(93661),i=n(71802),o=n(46817);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U;return[e[0],e[1],e[2],e[3]]}function u(e){return[e[0],e[1],e[2],e[3]]}function s(e,t){return e!==t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e}function l(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a();return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a();return t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax,t}function f(e,t){return new o.w({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}function h(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function p(e,t,n){if((0,r.t)(t))s(n,e);else if("length"in t)P(t)?(n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.max(e[3],t[3])):2!==t.length&&3!==t.length||(n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.max(e[2],t[0]),n[3]=Math.max(e[3],t[1]));else switch(t.type){case"extent":n[0]=Math.min(e[0],t.xmin),n[1]=Math.min(e[1],t.ymin),n[2]=Math.max(e[2],t.xmax),n[3]=Math.max(e[3],t.ymax);break;case"point":n[0]=Math.min(e[0],t.x),n[1]=Math.min(e[1],t.y),n[2]=Math.max(e[2],t.x),n[3]=Math.max(e[3],t.y)}}function v(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=t.length,i=e[0],o=e[1],a=e[2],u=e[3],s=0;s<r;s++){var l=t[s];i=Math.min(i,l[0]),o=Math.min(o,l[1]),a=Math.max(a,l[0]),u=Math.max(u,l[1])}return n[0]=i,n[1]=o,n[2]=a,n[3]=u,n}function d(e){for(var t=0;t<4;t++)if(!isFinite(e[t]))return!1;return!0}function y(e){return(0,r.t)(e)||e[0]>=e[2]?0:e[2]-e[0]}function g(e){return e[1]>=e[3]?0:e[3]-e[1]}function m(e){return y(e)*g(e)}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];return t[0]=(e[0]+e[2])/2,t[1]=(e[1]+e[3])/2,t}function w(e,t){return S(e,t[0],t[1])}function M(e,t){var n=t[3],r=.5*(e[0]+e[2]),i=Math.abs(t[0]-r),o=.5*(e[2]-e[0]);if(i>n+o)return!1;var a=.5*(e[1]+e[3]),u=.5*(e[3]-e[1]),s=Math.abs(t[1]-a);if(s>n+u)return!1;if(i<o||s<u)return!0;var l=i-o,c=s-u;return l*l+c*c<=n*n}function _(e,t,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=t.x,s=t.y,l=n.x,c=n.y,f=function(e,t){return(c-s)*e+(u-l)*t+(l*s-u*c)<0},h=f(r,a),p=f(o,a),v=f(o,i),d=f(r,i);return!(h===p&&p===v&&v===d&&d===h||u<r&&l<r||u>o&&l>o||s>a&&c>a||s<i&&c<i)}function k(e,t){return S(e,t.x,t.y)}function S(e,t,n){return t>=e[0]&&n>=e[1]&&t<=e[2]&&n<=e[3]}function x(e,t,n){return t[0]>=e[0]-n&&t[1]>=e[1]-n&&t[0]<=e[2]+n&&t[1]<=e[3]+n}function Z(e,t){return Math.max(t[0],e[0])<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])<=Math.min(t[3],e[3])}function A(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}function I(e,t,n){if((0,r.t)(t))return s(n,e);var o=t[0],a=t[1],u=t[2],l=t[3];return n[0]=(0,i.a)(e[0],o,u),n[1]=(0,i.a)(e[1],a,l),n[2]=(0,i.a)(e[2],o,u),n[3]=(0,i.a)(e[3],a,l),n}function T(e,t){var n=(e[0]+e[2])/2,r=(e[1]+e[3])/2,i=Math.max(Math.abs(t[0]-n)-y(e)/2,0),o=Math.max(Math.abs(t[1]-r)-g(e)/2,0);return Math.sqrt(i*i+o*o)}function L(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;return r[0]=e[0]+t,r[1]=e[1]+n,r[2]=e[2]+t,r[3]=e[3]+n,r}function O(e){return e?s(e,C):a(C)}function P(e){return null!=e&&4===e.length}function R(e){return!(0!==y(e)&&isFinite(e[0])||0!==g(e)&&isFinite(e[1]))}function E(e,t){return P(e)&&P(t)?e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]:e===t}var j=[-1/0,-1/0,1/0,1/0],C=[1/0,1/0,-1/0,-1/0],U=[0,0,0,0]},43955:function(e,t,n){function r(e){return 32+e.length}function i(e){return 16}function o(e){if(!e)return 0;var t=c;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];switch(typeof i){case"string":t+=r(i);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function a(e){if(!e)return 0;if(Array.isArray(e))return function(e){var t=e.length;if(0===t||"number"==typeof e[0])return 32+8*t;for(var n=f,r=0;r<t;r++)n+=u(e[r]);return n}(e);var t=c;for(var n in e)e.hasOwnProperty(n)&&(t+=u(e[n]));return t}function u(e){switch(typeof e){case"object":return a(e);case"string":return r(e);case"number":return 16;case"boolean":return 4;default:return 8}}function s(e,t){return f+e.length*t}n.d(t,{c:function(){return s},e:function(){return a},n:function(){return r},r:function(){return i},s:function(){return l},t:function(){return o}});var l,c=32,f=32;!function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(l||(l={}))},48200:function(e,t,n){n.d(t,{a:function(){return u},i:function(){return c},l:function(){return a},o:function(){return l},r:function(){return o}});var r=n(93433),i={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function o(e){return i[e]||i[e.toLowerCase()]}function a(e){var t;return null!==(t=i[e])&&void 0!==t?t:i[e.toLowerCase()]}function u(e){return(0,r.Z)(a(e))}function s(e,t,n){n<0&&++n,n>1&&--n;var r=6*n;return r<1?e+(t-e)*r:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=(e%360+360)%360/360,o=n<=.5?n*(t+1):n+t-n*t,a=2*n-o;return[Math.round(255*s(a,o,i+1/3)),Math.round(255*s(a,o,i)),Math.round(255*s(a,o,i-1/3)),r]}function c(e){var t=e.length>5,n=t?8:4,r=(1<<n)-1,i=t?1:17,o=t?9===e.length:5===e.length,a=Number("0x"+e.substr(1));if(isNaN(a))return null;var u,s=[0,0,0,1];return o&&(u=a&r,a>>=n,s[3]=i*u/255),u=a&r,a>>=n,s[2]=i*u,u=a&r,a>>=n,s[1]=i*u,u=a&r,a>>=n,s[0]=i*u,s}},8141:function(e,t,n){n.d(t,{r:function(){return u},t:function(){return a}});var r=n(93661),i=new Set;function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&i.has(t)||(n&&i.add(t),e.warn("\ud83d\uded1 DEPRECATED - ".concat(t)))}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((0,r.h)("esri-deprecation-warnings")){var i=n.moduleName;u(e,"Property: ".concat((i?i+"::":"")+t),n)}}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((0,r.h)("esri-deprecation-warnings")){var i=n.replacement,a=n.version,u=n.see,s=n.warnOnce,l=t;i&&(l+="\n\t\ud83d\udee0\ufe0f Replacement: ".concat(i)),a&&(l+="\n\t\u2699\ufe0f Version: ".concat(a)),u&&(l+="\n\t\ud83d\udd17 See ".concat(u," for more details.")),o(e,l,s)}}},10464:function(e,t,n){function r(e,t,n){for(var r=0;r<n;++r)t[2*r]=e[r],t[2*r+1]=e[r]-t[2*r]}function i(e,t){for(var n=e.length,r=0;r<n;++r)a[0]=e[r],t[r]=a[0];return t}function o(e,t){for(var n=e.length,r=0;r<n;++r)a[0]=e[r],a[1]=e[r]-a[0],t[r]=a[1];return t}n.d(t,{o:function(){return i},r:function(){return o},t:function(){return r}});var a=new Float32Array(2)},70522:function(e,t,n){n.d(t,{g:function(){return g},h:function(){return p},o:function(){return c},r:function(){return l}});var r,i,o=n(93661),a=n(48848),u=n(82396),s=n(1685);function l(e,t){if(!e)return null;if(!h(e))return new a.s("webscene:unsupported-height-model-info","The vertical coordinate system of the scene is not supported",{heightModelInfo:e});var n=e.heightUnit,r=u.v.deriveUnitFromSR(e,t).heightUnit;return n!==r?new a.s("webscene:incompatible-height-unit","The vertical units of the scene (".concat(n,") must match the horizontal units of the scene (").concat(r,")"),{verticalUnit:n,horizontalUnit:r}):null}function c(e,t,n){var i,o=p(e),s=t,l=f(o,s,n);if(o){var c=u.v.deriveUnitFromSR(o,e.spatialReference).heightUnit;if(!n&&c!==o.heightUnit){var h=new a.s("layerview:unmatched-height-unit","The vertical units of the layer must match the horizontal units (".concat(c,")"),{horizontalUnit:c});return new a.s("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:o,error:h})}}if(!("heightModelInfo"in(i=e)&&null!=i.heightModelInfo||null!=i.spatialReference)&&y(i)||l===r.Unsupported)return new a.s("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:o});switch(l){case r.Units:var v=(null===o||void 0===o?void 0:o.heightUnit)||"unknown",d=(null===s||void 0===s?void 0:s.heightUnit)||"unknown",g=new a.s("layerview:incompatible-height-unit","The vertical units of the layer (".concat(v,") must match the vertical units of the scene (").concat(d,")"),{layerUnit:v,sceneUnit:d});return new a.s("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:o,sceneHeightModelInfo:s,error:g});case r.HeightModel:var m=(null===o||void 0===o?void 0:o.heightModel)||"unknown",b=(null===s||void 0===s?void 0:s.heightModel)||"unknown",w=new a.s("layerview:incompatible-height-model","The height model of the layer (".concat(m,") must match the height model of the scene (").concat(b,")"),{layerHeightModel:m,sceneHeightModel:b});return new a.s("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:o,sceneHeightModelInfo:s,error:w});case r.CRS:var M=(null===o||void 0===o?void 0:o.vertCRS)||"unknown",_=(null===s||void 0===s?void 0:s.vertCRS)||"unknown",k=new a.s("layerview:incompatible-vertical-datum","The vertical datum of the layer (".concat(M,") must match the vertical datum of the scene (").concat(_,")"),{layerDatum:M,sceneDatum:_});return new a.s("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:o,sceneHeightModelInfo:s,error:k})}return null}function f(e,t,n){if(!h(e)||!h(t))return r.Unsupported;if(null==e||null==t)return r.Ok;if(!n&&e.heightUnit!==t.heightUnit)return r.Units;if(e.heightModel!==t.heightModel)return r.HeightModel;switch(e.heightModel){case"gravity-related-height":return r.Ok;case"ellipsoidal":return e.vertCRS===t.vertCRS?r.Ok:r.CRS;default:return r.Unsupported}}function h(e){return null==e||null!=e.heightModel&&null!=e.heightUnit}function p(e){var t,n=e.url?(0,s.m)(e.url):void 0;return null==(null===(t=e.spatialReference)||void 0===t?void 0:t.vcsWkid)&&(0,o.r)(n)&&"ImageServer"===n.serverType||!v(e)||!e.heightModelInfo?y(e)?u.v.deriveUnitFromSR(b,e.spatialReference):null:e.heightModelInfo}function v(e){return"heightModelInfo"in e}function d(e){if("unknown"===e.type||!("capabilities"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":return!0;default:return!1}}function y(e){return d(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):m(e)}function g(e){return null!=e.layers||m(e)||d(e)||v(e)}function m(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(i=r||(r={}))[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported";var b=new u.v({heightModel:"gravity-related-height"})},26313:function(e,t,n){n.d(t,{B:function(){return w},M:function(){return f},a:function(){return i},b:function(){return v},c:function(){return l},f:function(){return p},g:function(){return m},h:function(){return h},i:function(){return c},l:function(){return d},o:function(){return u},p:function(){return y},r:function(){return a},s:function(){return o},u:function(){return s},y:function(){return g}});var r=n(71802);function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function o(e,t,n,r,i,o,a,u,s,l){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=u,e[7]=s,e[8]=l,e}function a(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function u(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function s(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=c*a-u*l,h=-c*o+u*s,p=l*o-a*s,v=n*f+r*h+i*p;return v?(v=1/v,e[0]=f*v,e[1]=(-c*r+i*l)*v,e[2]=(u*r-i*a)*v,e[3]=h*v,e[4]=(c*n-i*s)*v,e[5]=(-u*n+i*o)*v,e[6]=p*v,e[7]=(-l*n+r*s)*v,e[8]=(a*n-r*o)*v,e):null}function l(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8];return e[0]=a*c-u*l,e[1]=i*l-r*c,e[2]=r*u-i*a,e[3]=u*s-o*c,e[4]=n*c-i*s,e[5]=i*o-n*u,e[6]=o*l-a*s,e[7]=r*s-n*l,e[8]=n*a-r*o,e}function c(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=n[0],p=n[1],v=n[2],d=n[3],y=n[4],g=n[5],m=n[6],b=n[7],w=n[8];return e[0]=h*r+p*a+v*l,e[1]=h*i+p*u+v*c,e[2]=h*o+p*s+v*f,e[3]=d*r+y*a+g*l,e[4]=d*i+y*u+g*c,e[5]=d*o+y*s+g*f,e[6]=m*r+b*a+w*l,e[7]=m*i+b*u+w*c,e[8]=m*o+b*s+w*f,e}function f(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=n[0],p=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=u,e[5]=s,e[6]=h*r+p*a+l,e[7]=h*i+p*u+c,e[8]=h*o+p*s+f,e}function h(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=Math.sin(n),p=Math.cos(n);return e[0]=p*r+h*a,e[1]=p*i+h*u,e[2]=p*o+h*s,e[3]=p*a-h*r,e[4]=p*u-h*i,e[5]=p*s-h*o,e[6]=l,e[7]=c,e[8]=f,e}function p(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=o*t[6],e[7]=o*t[7],e[8]=o*t[8],e}function v(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e}function d(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function y(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,u=r+r,s=i+i,l=n*a,c=r*a,f=r*u,h=i*a,p=i*u,v=i*s,d=o*a,y=o*u,g=o*s;return e[0]=1-f-v,e[3]=c-g,e[6]=h+y,e[1]=c+g,e[4]=1-l-v,e[7]=p-d,e[2]=h-y,e[5]=p+d,e[8]=1-l-f,e}function g(e,t){var n=t[0],r=t[1],i=t[2],o=t[4],a=t[5],u=t[6],s=t[8],l=t[9],c=t[10],f=c*a-u*l,h=-c*o+u*s,p=l*o-a*s,v=n*f+r*h+i*p;if(!v)return null;var d=1/v;return e[0]=f*d,e[1]=(-c*r+i*l)*d,e[2]=(u*r-i*a)*d,e[3]=h*d,e[4]=(c*n-i*s)*d,e[5]=(-u*n+i*o)*d,e[6]=p*d,e[7]=(-l*n+r*s)*d,e[8]=(a*n-r*o)*d,e}function m(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],p=t[11],v=t[12],d=t[13],y=t[14],g=t[15],m=n*u-r*a,b=n*s-i*a,w=n*l-o*a,M=r*s-i*u,_=r*l-o*u,k=i*l-o*s,S=c*d-f*v,x=c*y-h*v,Z=c*g-p*v,A=f*y-h*d,I=f*g-p*d,T=h*g-p*y,L=m*T-b*I+w*A+M*Z-_*x+k*S;return L?(L=1/L,e[0]=(u*T-s*I+l*A)*L,e[1]=(s*Z-a*T-l*x)*L,e[2]=(a*I-u*Z+l*S)*L,e[3]=(i*I-r*T-o*A)*L,e[4]=(n*T-i*Z+o*x)*L,e[5]=(r*Z-n*I-o*S)*L,e[6]=(d*k-y*_+g*M)*L,e[7]=(y*w-v*k-g*b)*L,e[8]=(v*_-d*w+g*m)*L,e):null}function b(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function w(e){var t=(0,r.d)(),n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8];return Math.abs(1-(n*n+a*a+l*l))<=t&&Math.abs(1-(i*i+u*u+c*c))<=t&&Math.abs(1-(o*o+s*s+f*f))<=t}var M=c,_=b;Object.freeze(Object.defineProperty({__proto__:null,fromMat4:i,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},set:o,identity:a,transpose:u,invert:s,adjoint:l,determinant:function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],u=e[6],s=e[7],l=e[8];return t*(l*o-a*s)+n*(-l*i+a*u)+r*(s*i-o*u)},multiply:c,translate:f,rotate:h,scale:p,scaleByVec2:v,fromTranslation:d,fromRotation:function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromMat2d:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},fromQuat:y,normalFromMat4Legacy:g,normalFromMat4:m,projection:function(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},subtract:b,multiplyScalar:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},multiplyScalarAndAdd:function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},equals:function(e,t){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=t[0],p=t[1],v=t[2],d=t[3],y=t[4],g=t[5],m=t[6],b=t[7],w=t[8],M=(0,r.d)();return Math.abs(n-h)<=M*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-p)<=M*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-v)<=M*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-d)<=M*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(u-y)<=M*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(s-g)<=M*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(l-m)<=M*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(c-b)<=M*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(f-w)<=M*Math.max(1,Math.abs(f),Math.abs(w))},isOrthoNormal:w,mul:M,sub:_},Symbol.toStringTag,{value:"Module"}))},37077:function(e,t,n){function r(){return[1,0,0,0,1,0,0,0,1]}function i(e,t){return new Float64Array(e,t,9)}n.d(t,{e:function(){return r},n:function(){return i}}),Object.freeze(Object.defineProperty({__proto__:null,create:r,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},fromValues:function(e,t,n,r,i,o,a,u,s){return[e,t,n,r,i,o,a,u,s]},createView:i},Symbol.toStringTag,{value:"Module"}))},49228:function(e,t,n){function r(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function o(e,t,n,r,i,o,a,u,s,l,c,f,h,p,v,d){return[e,t,n,r,i,o,a,u,s,l,c,f,h,p,v,d]}function a(e,t){return new Float64Array(e,t,16)}n.d(t,{e:function(){return r},n:function(){return a},o:function(){return u},r:function(){return i},t:function(){return o}});var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,create:r,clone:i,fromValues:o,createView:a,IDENTITY:u},Symbol.toStringTag,{value:"Module"}))},24093:function(e,t,n){n.d(t,{A:function(){return s},D:function(){return I},E:function(){return u},F:function(){return l},G:function(){return T},H:function(){return L},K:function(){return O},L:function(){return w},O:function(){return _},P:function(){return M},R:function(){return P},T:function(){return c},U:function(){return Z},V:function(){return k},Y:function(){return E},_:function(){return f},b:function(){return p},j:function(){return h},p:function(){return a},q:function(){return S},x:function(){return x},z:function(){return A}});var r=n(71802),i=n(93661),o=n(64772);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U;return[e[0],e[1],e[2],e[3]]}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:U[3];return l(e,t,n,r,o.r.get())}function s(e,t){return l(t[0],t[1],t[2],t[3],e)}function l(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a();return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function c(e,t,n){return(0,r.r)(n,e),n[3]=t,n}function f(e,t,n){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=-(n[0]*e[0]+n[1]*e[1]+n[2]*e[2]),n}function h(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a(),i=n[0]-t[0],o=n[1]-t[1],u=n[2]-t[2],s=e[0]-t[0],l=e[1]-t[1],c=e[2]-t[2],f=o*c-u*l,h=u*s-i*c,p=i*l-o*s,v=f*f+h*h+p*p,d=Math.abs(v-1)>1e-5&&v>1e-12?1/Math.sqrt(v):1;return r[0]=f*d,r[1]=h*d,r[2]=p*d,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function p(e,t,n,i,o){if(e.count<3)return!1;e.getVec(n,d);for(var a=i,u=!1;a<e.count-1&&!u;)e.getVec(a,y),a++,u=!(0,r.F)(d,y);if(!u)return!1;for(a=Math.max(a,o),u=!1;a<e.count&&!u;)e.getVec(a,g),a++,(0,r.e)(m,d,y),(0,r.z)(m,m),(0,r.e)(b,y,g),(0,r.z)(b,b),u=!(0,r.F)(d,g)&&!(0,r.F)(y,g)&&Math.abs((0,r.P)(m,b))<v;return u?(h(d,y,g,t),!0):(0!==n||1!==i||2!==o)&&p(e,t,0,1,2)}var v=.99619469809,d=(0,r.n)(),y=(0,r.n)(),g=(0,r.n)(),m=(0,r.n)(),b=(0,r.n)();function w(e,t,n){return t!==e&&s(e,t),e[3]=-(0,r.P)(e,n),e}function M(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function _(e,t,n,i){return(0,r._)(g,t,e),f(n,g,i)}function k(e,t,n,i){return R(e,t,(0,r.e)(o.c.get(),n,t),N,i)}function S(e,t,n){return!!(0,i.r)(t)&&R(e,t.origin,t.direction,V,n)}function x(e,t,n){return R(e,t.origin,t.vector,j.NONE,n)}function Z(e,t,n){return R(e,t.origin,t.vector,j.CLAMP,n)}function A(e,t){return P(e,t)>=0}function I(e,t){var n=(0,r.P)(e,t.ray.direction),i=-P(e,t.ray.origin);if(i<0&&n>=0)return!1;if(n>-1e-6&&n<1e-6)return i>0;if((i<0||n<0)&&!(i<0&&n<0))return!0;var o=i/n;return n>0?o<t.c1&&(t.c1=o):o>t.c0&&(t.c0=o),t.c0<=t.c1}function T(e,t){var n=(0,r.P)(e,t.ray.direction),i=-P(e,t.ray.origin);if(n>-1e-6&&n<1e-6)return i>0;var o=i/n;return n>0?o<t.c1&&(t.c1=o):o>t.c0&&(t.c0=o),t.c0<=t.c1}function L(e,t,n){var i=(0,r.g)(o.c.get(),e,-e[3]),a=O(e,(0,r.e)(o.c.get(),t,i),o.c.get());return(0,r.u)(n,a,i),n}function O(e,t,n){var i=(0,r.g)(o.c.get(),e,(0,r.P)(e,t));return(0,r.e)(n,t,i),n}function P(e,t){return(0,r.P)(e,t)+e[3]}function R(e,t,n,i,o){var a=(0,r.P)(e,n);if(0===a)return!1;var u=-((0,r.P)(e,t)+e[3])/a;return i&j.CLAMP&&(u=(0,r.a)(u,0,1)),!(!(i&j.INFINITE_MIN)&&u<0||!(i&j.INFINITE_MAX)&&u>1)&&((0,r.u)(o,t,(0,r.g)(o,n,u)),!0)}function E(e){return e}var j,C,U=[0,0,1,0];(C=j||(j={}))[C.NONE=0]="NONE",C[C.CLAMP=1]="CLAMP",C[C.INFINITE_MIN=4]="INFINITE_MIN",C[C.INFINITE_MAX=8]="INFINITE_MAX";var N=j.INFINITE_MIN|j.INFINITE_MAX,V=j.INFINITE_MAX},67430:function(e,t,n){n.d(t,{B:function(){return p},K:function(){return x},Q:function(){return A},S:function(){return c},k:function(){return h},v:function(){return a},x:function(){return u},y:function(){return s}});var r=n(37077),i=n(76291),o=n(71802);function a(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function u(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>(0,o.d)()?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function s(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=n[0],s=n[1],l=n[2],c=n[3];return e[0]=r*c+a*u+i*l-o*s,e[1]=i*c+a*s+o*u-r*l,e[2]=o*c+a*l+r*s-i*u,e[3]=a*c-r*u-i*s-o*l,e}function l(e,t,n,r){var i,a,u,s,l,c=t[0],f=t[1],h=t[2],p=t[3],v=n[0],d=n[1],y=n[2],g=n[3];return(a=c*v+f*d+h*y+p*g)<0&&(a=-a,v=-v,d=-d,y=-y,g=-g),1-a>(0,o.d)()?(i=Math.acos(a),u=Math.sin(i),s=Math.sin((1-r)*i)/u,l=Math.sin(r*i)/u):(s=1-r,l=r),e[0]=s*c+l*v,e[1]=s*f+l*d,e[2]=s*h+l*y,e[3]=s*p+l*g,e}function c(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function f(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*o+a]-t[3*a+o])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e}function h(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var o=Math.sin(t),a=Math.cos(t),u=Math.sin(n),s=Math.cos(n),l=Math.sin(r),c=Math.cos(r);return e[0]=o*s*c-a*u*l,e[1]=a*u*c+o*s*l,e[2]=a*s*l-o*u*c,e[3]=a*s*c+o*u*l,e}var p=o.B,v=o.C,d=o.D,y=s,g=o.G,m=o.I,b=o.j,w=o.J,M=w,_=o.K,k=_,S=o.M,x=o.Q,Z=o.R;function A(e,t,n){var r=(0,o.P)(t,n);return r<-.999999?((0,o._)(I,T,t),(0,o.Y)(I)<1e-6&&(0,o._)(I,L,t),(0,o.z)(I,I),a(e,I,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):((0,o._)(I,t,n),e[0]=I[0],e[1]=I[1],e[2]=I[2],e[3]=1+r,S(e,e))}var I=(0,o.n)(),T=(0,o.c)(1,0,0),L=(0,o.c)(0,1,0);var O=(0,i.e)(),P=(0,i.e)();var R=(0,r.e)();Object.freeze(Object.defineProperty({__proto__:null,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},setAxisAngle:a,getAxisAngle:u,multiply:s,rotateX:function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s+a*u,e[1]=i*s+o*u,e[2]=o*s-i*u,e[3]=a*s-r*u,e},rotateY:function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s-o*u,e[1]=i*s+a*u,e[2]=o*s+r*u,e[3]=a*s-i*u,e},rotateZ:function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),s=Math.cos(n);return e[0]=r*s+i*u,e[1]=i*s-r*u,e[2]=o*s+a*u,e[3]=a*s-o*u,e},calculateW:function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},slerp:l,random:function(e){var t=o.h,n=t(),r=t(),i=t(),a=Math.sqrt(1-n),u=Math.sqrt(n);return e[0]=a*Math.sin(2*Math.PI*r),e[1]=a*Math.cos(2*Math.PI*r),e[2]=u*Math.sin(2*Math.PI*i),e[3]=u*Math.cos(2*Math.PI*i),e},invert:function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,u=a?1/a:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-i*u,e[3]=o*u,e},conjugate:c,fromMat3:f,fromEuler:h,str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},copy:p,set:v,add:d,mul:y,scale:g,dot:m,lerp:b,length:w,len:M,squaredLength:_,sqrLen:k,normalize:S,exactEquals:x,equals:Z,rotationTo:A,sqlerp:function(e,t,n,r,i,o){return l(O,t,i,o),l(P,n,r,o),l(e,O,P,2*o*(1-o)),e},setAxes:function(e,t,n,r){var i=R;return i[0]=n[0],i[3]=n[1],i[6]=n[2],i[1]=r[0],i[4]=r[1],i[7]=r[2],i[2]=-t[0],i[5]=-t[1],i[8]=-t[2],S(e,f(e,i))}},Symbol.toStringTag,{value:"Module"}))},76291:function(e,t,n){function r(){return[0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3]]}function o(e,t){return new Float64Array(e,t,4)}n.d(t,{e:function(){return r},n:function(){return o},o:function(){return a},r:function(){return i}});var a=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,create:r,clone:i,fromValues:function(e,t,n,r){return[e,t,n,r]},createView:o,IDENTITY:a},Symbol.toStringTag,{value:"Module"}))},50690:function(e,t,n){n.d(t,{P:function(){return h},U:function(){return p},a:function(){return s},f:function(){return a},h:function(){return v},j:function(){return l},l:function(){return o},w:function(){return d}});var r=n(48848),i=n(93661);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u(e,t,n,c)}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u(e,t,n,f)}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,a=null,u=n.once?function(e,n){o(e)&&((0,i.f)(a),t(e,n))}:function(e,n){o(e)&&t(e,n)};if(a=(0,r.P)(e,u,n.sync,n.equals),n.initial){var s=e();u(s,s)}return a}function s(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=null,s=null,l=null;function c(){var e;u&&s&&(s.remove(),null!==(e=a.onListenerRemove)&&void 0!==e&&e.call(a,u),u=null,s=null)}function f(e){a.once&&a.once&&(0,i.f)(l),n(e)}var h=o(e,(function(e,n){var i;c(),(0,r.B)(e)&&(u=e,s=(0,r.C)(e,t,f),null===(i=a.onListenerAdd)||void 0===i||i.call(a,e))}),{sync:a.sync,initial:!0});return l=(0,r.D)((function(){h.remove(),c()}))}function l(e,t){return function(e,t,n){if((0,r.p)(n))return Promise.reject((0,r.d)());var o=e();if(null!==t&&void 0!==t&&t(o))return Promise.resolve(o);var a=null;function s(){a=(0,i.f)(a)}return new Promise((function(i,o){a=(0,r.F)([(0,r.v)(n,(function(){s(),o((0,r.d)())})),u(e,(function(e){s(),i(e)}),{sync:!1,once:!0},null!==t&&void 0!==t?t:c)])}))}(e,f,t)}function c(e){return!0}function f(e){return!!e}function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!1,i=o(e,(function(e,n){r||t(e,n)}),n);return{remove:function(){i.remove()},pause:function(){r=!0},resume:function(){r=!1}}}var p={sync:!0},v={initial:!0},d={sync:!0,initial:!0}},90682:function(e,t,n){n.r(t),n.d(t,{addOrUpdateResource:function(){return f},contentToBlob:function(){return b},fetchResources:function(){return l},getSiblingOfSameType:function(){return M},getSiblingOfSameTypeI:function(){return _},removeAllResources:function(){return d},removeResource:function(){return p},splitPrefixFileNameAndExtension:function(){return m}});var r=n(74165),i=n(29439),o=n(15861),a=n(40558),u=n(48848),s=n(93661);function l(e){return c.apply(this,arguments)}function c(){return c=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i,o,u,l,c,f,h,p,v,d,y,g=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.length>1&&void 0!==g[1]?g[1]:{},i=g.length>2?g[2]:void 0,e.next=4,t.load(i);case 4:return o=(0,a.G)(t.itemUrl,"resources"),u=n.start,l=void 0===u?1:u,c=n.num,f=void 0===c?10:c,h=n.sortOrder,p=void 0===h?"asc":h,v=n.sortField,d={query:{start:l,num:f,sortOrder:p,sortField:void 0===v?"created":v,token:t.apiKey},signal:(0,s.q)(i,"signal")},e.next=16,t.portal._request(o,d);case 16:return y=e.sent,e.abrupt("return",{total:y.total,nextStart:y.nextStart,resources:y.resources.map((function(e){var n=e.created,r=e.size,i=e.resource;return{created:new Date(n),size:r,resource:t.resourceFromPath(i)}}))});case 18:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function f(e,t,n,r){return h.apply(this,arguments)}function h(){return h=(0,o.Z)((0,r.Z)().mark((function e(t,n,o,l){var c,f,h,p,v,d,y,m;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.hasPath()){e.next=2;break}throw new u.s("portal-item-resource-".concat(n,":invalid-path"),"Resource does not have a valid path");case 2:return c=t.portalItem,e.next=5,c.load(l);case 5:return f=(0,a.G)(c.userItemUrl,"add"===n?"addResources":"updateResources"),h=g(t.path),p=(0,i.Z)(h,2),v=p[0],d=p[1],e.next=12,b(o);case 12:return y=e.sent,m=new FormData,v&&"."!==v&&m.append("resourcesPrefix",v),(0,s.r)(l)&&l.compress&&m.append("compress","true"),m.append("fileName",d),m.append("file",y,d),m.append("f","json"),(0,s.r)(l)&&l.access&&m.append("access",l.access),e.next=22,c.portal._request(f,{method:"post",body:m,signal:(0,s.q)(l,"signal")});case 22:return e.abrupt("return",t);case 23:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function p(e,t,n){return v.apply(this,arguments)}function v(){return(v=(0,o.Z)((0,r.Z)().mark((function e(t,n,i){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.hasPath()){e.next=2;break}throw new u.s("portal-item-resources-remove:invalid-path","Resource does not have a valid path");case 2:return e.next=4,t.load(i);case 4:return o=(0,a.G)(t.userItemUrl,"removeResources"),e.next=7,t.portal._request(o,{method:"post",query:{resource:n.path},signal:(0,s.q)(i,"signal")});case 7:n.portalItem=null;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,t){return y.apply(this,arguments)}function y(){return(y=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load(n);case 2:return i=(0,a.G)(t.userItemUrl,"removeResources"),e.abrupt("return",t.portal._request(i,{method:"post",query:{deleteAll:!0},signal:(0,s.q)(n,"signal")}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){var t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function m(e){var t=function(e){var t=(0,a.k)(e);return(0,s.t)(t)?[e,""]:[e.slice(0,e.length-t.length-1),".".concat(t)]}(e),n=(0,i.Z)(t,2),r=n[0],o=n[1],u=g(r),l=(0,i.Z)(u,2);return[l[0],l[1],o]}function b(e){return w.apply(this,arguments)}function w(){return(w=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof Blob)){e.next=2;break}return e.abrupt("return",t);case 2:return e.next=4,(0,a.U)(t.url,{responseType:"blob"});case 4:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t){if(!e.hasPath())return null;var n=m(e.path),r=(0,i.Z)(n,3),o=r[0],u=r[2];return e.portalItem.resourceFromPath((0,a.G)(o,t+u))}function _(e,t){if(!e.hasPath())return null;var n=m(e.path),r=(0,i.Z)(n,3),o=r[0],u=r[2];return e.portalItem.resourceFromPath((0,a.G)(o,t+u))}},79527:function(e,t,n){n.d(t,{a:function(){return h}});var r=n(1413),i=n(74165),o=n(37762),a=n(15861),u=n(59389),s=n(48848),l=n(93661),c=n(42667),f=n(90682);function h(e,t,n){return p.apply(this,arguments)}function p(){return p=(0,a.Z)((0,i.Z)().mark((function e(t,n,r){var a,u,l,h,p,d,g,m,b,w,M,_,k,S,x,Z,A;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&n.resources){e.next=2;break}return e.abrupt("return");case 2:a=n.portalItem===t.portalItem?new Set(t.paths):new Set,t.paths.length=0,t.portalItem=n.portalItem,u=new Set(n.resources.toKeep.map((function(e){return e.resource.path}))),l=new Set,h=[],u.forEach((function(e){a.delete(e),t.paths.push(e)})),p=(0,o.Z)(n.resources.toUpdate);try{for(p.s();!(d=p.n()).done;)g=d.value,a.delete(g.resource.path),u.has(g.resource.path)||l.has(g.resource.path)?(m=g.resource,b=g.content,w=g.finish,M=g.error,_=(0,f.getSiblingOfSameTypeI)(m,(0,c.n)()),t.paths.push(_.path),h.push(v({resource:_,content:b,compress:g.compress,finish:w,error:M},r))):(t.paths.push(g.resource.path),h.push(y(g,r)),l.add(g.resource.path))}catch(i){p.e(i)}finally{p.f()}k=(0,o.Z)(n.resources.toAdd);try{for(k.s();!(S=k.n()).done;)x=S.value,h.push(v(x,r)),t.paths.push(x.resource.path)}catch(i){k.e(i)}finally{k.f()}if(a.forEach((function(e){var t=n.portalItem.resourceFromPath(e);h.push(t.portalItem.removeResource(t).catch((function(){})))})),0!==h.length){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,(0,s.E)(h);case 14:if(Z=e.sent,(0,s.f)(r),A=Z.filter((function(e){return"error"in e})).map((function(e){return e.error})),!(A.length>0)){e.next=19;break}throw new s.s("save:resources","Failed to save one or more resources",{errors:A});case 19:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function v(e,t){return d.apply(this,arguments)}function d(){return(d=(0,a.Z)((0,i.Z)().mark((function e(t,n){var o,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,r.Z)((0,r.Z)({},(0,l.r)(n)?n:{}),{},{compress:t.compress}),e.next=3,(0,u.b)(t.resource.portalItem.addResource(t.resource,t.content,o));case 3:if(!0===(a=e.sent).ok){e.next=6;break}throw t.error&&t.error(a.error),a.error;case 6:t.finish&&t.finish(t.resource);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t){return g.apply(this,arguments)}function g(){return(g=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.b)(t.resource.update(t.content,n));case 2:if(!0===(r=e.sent).ok){e.next=5;break}throw t.error(r.error),r.error;case 5:t.finish(t.resource);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},77956:function(e,t,n){n.d(t,{c:function(){return u},d:function(){return v},e:function(){return o},i:function(){return s},l:function(){return p},o:function(){return a},p:function(){return h},s:function(){return l},u:function(){return i},x:function(){return c},y:function(){return f}});var r=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;function i(e){return e?e/72*96:0}function o(e){return e?72*e/96:0}function a(e){if("string"==typeof e){var t=e.match(r);if(t){var n=Number(t[1]),i=t[3]&&t[3].toLowerCase(),a="-"===e.charAt(0),u="px"===i?o(n):n;return a?-u:u}return console.warn("screenUtils.toPt: input not recognized!"),null}return e}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:e,y:t}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[e,t]}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[e,t]}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return[e,t,n]}function f(e){return e}function h(e){return e}function p(e){return e}function v(e,t){return t?(t[0]=e.x,t[1]=e.y,t.length>2&&(t[2]=0),t):[e.x,e.y]}},64772:function(e,t,n){n.d(t,{$:function(){return ue},C:function(){return D},E:function(){return H},F:function(){return Q},N:function(){return ie},O:function(){return B},R:function(){return V},T:function(){return G},V:function(){return K},W:function(){return ae},Y:function(){return X},_:function(){return F},a:function(){return _},b:function(){return O},c:function(){return w},d:function(){return S},e:function(){return j},f:function(){return E},g:function(){return Y},h:function(){return T},i:function(){return C},j:function(){return Z},k:function(){return I},n:function(){return P},o:function(){return k},p:function(){return A},q:function(){return q},r:function(){return M},s:function(){return d},t:function(){return b},v:function(){return L},w:function(){return z},z:function(){return W}});var r=n(15671),i=n(43144),o=n(93661),a=n(48848),u=n(71802),s=n(79557),l=n(91681),c=n(43955),f=n(37077),h=n(49228),p=n(76291),v=n(13239),d=function(){function e(t){(0,r.Z)(this,e),this._allocator=t,this._items=[],this._itemsPtr=0,this._grow()}return(0,i.Z)(e,[{key:"get",value:function(){var e=this;return 0===this._itemsPtr&&(0,a.a5)((function(){return e._reset()})),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}},{key:"_reset",value:function(){var e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*y);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}},{key:"_grow",value:function(){for(var e=0;e<Math.max(8,Math.min(this._items.length,y));e++)this._items.push(this._allocator())}}]),e}(),y=1024,g=function(){function e(t,n,i){(0,r.Z)(this,e),this._itemByteSize=t,this._itemCreate=n,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(i/this._itemByteSize)}return(0,i.Z)(e,[{key:"get",value:function(){var e=this;0===this._itemsPtr&&(0,a.a5)((function(){return e._reset()}));for(var t=Math.floor(this._itemsPtr/this._itemsPerBuffer);this._buffers.length<=t;){for(var n=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize),r=0;r<this._itemsPerBuffer;++r)this._items.push(this._itemCreate(n,r*this._itemByteSize));this._buffers.push(n)}return this._items[this._itemsPtr++]}},{key:"_reset",value:function(){for(var e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}},{key:"test",get:function(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}}],[{key:"createVec2f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;return new e(16,v.o,t)}},{key:"createVec3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;return new e(24,u.y,t)}},{key:"createVec4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;return new e(32,l.u,t)}},{key:"createMat3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;return new e(72,f.n,t)}},{key:"createMat4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;return new e(128,h.n,t)}},{key:"createQuatf64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;return new e(32,p.n,t)}}]),e}(),m=4*c.s.KILOBYTES,b=g.createVec2f64(),w=g.createVec3f64(),M=g.createVec4f64();g.createMat3f64();var _=g.createMat4f64(),k=g.createQuatf64();function S(e){return e?x((0,u.t)(e.origin),(0,u.t)(e.direction)):x((0,u.n)(),(0,u.n)())}function x(e,t){return{origin:e,direction:t}}function Z(e,t){return(0,o.k)(e.origin,t.origin)&&(0,o.k)(e.direction,t.direction)}function A(e,t){var n=R.get();return n.origin=e,n.direction=t,n}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S();return L(e.origin,e.direction,t)}function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S();return(0,u.r)(n.origin,e),(0,u.e)(n.direction,t,e),n}function L(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S();return(0,u.r)(n.origin,e),(0,u.r)(n.direction,t),n}function O(e,t){var n=(0,u._)(w.get(),(0,u.z)(w.get(),e.direction),(0,u.e)(w.get(),t,e.origin));return(0,u.P)(n,n)}var P,R=new d((function(){return S()}));function E(e,t){return(0,u.P)(e,t)/(0,u.s)(e)}function j(e,t){var n=(0,u.P)(e,t)/((0,u.s)(e)*(0,u.s)(t));return-(0,u.i)(n)}function C(e,t,n){(0,u.z)(U,e),(0,u.z)(N,t);var r=(0,u.P)(U,N),i=(0,u.i)(r),o=(0,u._)(U,U,N);return(0,u.P)(o,n)<0?2*Math.PI-i:i}!function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(P||(P={}));var U=(0,u.n)(),N=(0,u.n)();function V(){return(0,l.n)()}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V();return(0,u.B)(t,e)}function q(e,t){return(0,l.r)(e[0],e[1],e[2],t)}function z(e){return e}function D(e){e[0]=e[1]=e[2]=e[3]=0}function B(e,t){return e[0]=e[1]=e[2]=0,e[3]=t,e}function G(e){return e[3]}function Y(e){return e}function H(e,t,n,r){return(0,l.r)(e,t,n,r)}function W(e,t,n){if((0,o.t)(t))return!1;var r=t.origin,i=t.direction,a=J;a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2];var u=i[0]*i[0]+i[1]*i[1]+i[2]*i[2];if(0===u)return!1;var s=2*(i[0]*a[0]+i[1]*a[1]+i[2]*a[2]),l=s*s-4*u*(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]-e[3]*e[3]);if(l<0)return!1;var c=Math.sqrt(l),f=(-s-c)/(2*u),h=(-s+c)/(2*u);return(f<0||h<f&&h>0)&&(f=h),!(f<0)&&(n&&(n[0]=r[0]+i[0]*f,n[1]=r[1]+i[1]*f,n[2]=r[2]+i[2]*f),!0)}var J=(0,u.n)();function K(e,t){return W(e,t,null)}function X(e,t,n){var r=w.get(),i=_.get();(0,u._)(r,t.origin,t.direction);var o=G(e);(0,u._)(n,r,t.origin),(0,u.g)(n,n,1/(0,u.s)(n)*o);var a=ee(e,t.origin),l=j(t.origin,n);return(0,s.g)(i,l+a,r),(0,u.O)(n,n,i),n}function $(e,t,n){var r=(0,u.e)(w.get(),t,e),i=(0,u.g)(w.get(),r,e[3]/(0,u.s)(r));return(0,u.u)(n,i,e)}function Q(e,t){var n=(0,u.e)(w.get(),t,e),r=(0,u.v)(n),i=e[3]*e[3];return Math.sqrt(Math.abs(r-i))}function ee(e,t){var n=(0,u.e)(w.get(),t,e),r=(0,u.s)(n),i=G(e),o=i+Math.abs(i-r);return(0,u.i)(i/o)}var te=(0,u.n)();function ne(e,t,n,r){var i=(0,u.e)(te,t,e);switch(n){case P.X:var o=(0,u.L)(i,te)[2];return(0,u.o)(r,-Math.sin(o),Math.cos(o),0);case P.Y:var a=(0,u.L)(i,te),s=a[1],l=a[2],c=Math.sin(s);return(0,u.o)(r,-c*Math.cos(l),-c*Math.sin(l),Math.cos(s));case P.Z:return(0,u.z)(r,i);default:return}}function re(e,t){var n=(0,u.e)(oe,t,e);return(0,u.s)(n)-e[3]}function ie(e,t){var n=(0,u.p)(e,t),r=G(e);return n<=r*r}var oe=(0,u.n)(),ae=V(),ue=Object.freeze(Object.defineProperty({__proto__:null,create:V,copy:F,fromCenterAndRadius:q,wrap:z,clear:D,fromRadius:B,getRadius:G,getCenter:Y,fromValues:H,elevate:function(e,t,n){return e!==n&&(0,u.r)(n,e),n[3]=e[3]+t,n},setExtent:function(e,t,n){return a.a.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),e===n?n:F(e,n)},intersectRay:W,intersectsRay:K,intersectRayClosestSilhouette:function(e,t,n){if(W(e,t,n))return n;var r=X(e,t,w.get());return(0,u.u)(n,t.origin,(0,u.g)(w.get(),t.direction,(0,u.x)(t.origin,r)/(0,u.s)(t.direction))),n},closestPointOnSilhouette:X,closestPoint:function(e,t,n){return W(e,t,n)?n:(function(e,t,n){var r=(0,u.P)(e.direction,(0,u.e)(n,t,e.origin));(0,u.u)(n,e.origin,(0,u.g)(n,e.direction,r))}(t,e,n),$(e,n,n))},projectPoint:$,distanceToSilhouette:Q,angleToSilhouette:ee,axisAt:ne,altitudeAt:re,setAltitudeAt:function(e,t,n,r){var i=re(e,t),o=ne(e,t,P.Z,oe),a=(0,u.g)(oe,o,n-i);return(0,u.u)(r,t,a)},containsPoint:ie,tmpSphere:ae},Symbol.toStringTag,{value:"Module"}))},20846:function(e,t,n){n.d(t,{L:function(){return L},V:function(){return I},a:function(){return j},c:function(){return R},f:function(){return E},j:function(){return O},l:function(){return C},p:function(){return U},u:function(){return g},y:function(){return Z}});var r=n(15671),i=n(43144),o=n(93661),a=n(26313),u=n(37077),s=n(79557),l=n(49228),c=n(67430),f=n(76291),h=n(71802),p=n(87424),v=n(64772),d=n(87750),y=n(10464),g=function(){function e(){(0,r.Z)(this,e),this._transform=(0,l.e)(),this._transformInverse=new m({value:this._transform},s.h,l.e),this._transformInverseTranspose=new m(this._transformInverse,s.o,l.e),this._transformTranspose=new m({value:this._transform},s.o,l.e),this._transformInverseRotation=new m({value:this._transform},a.y,u.e)}return(0,i.Z)(e,[{key:"_invalidateLazyTransforms",value:function(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}},{key:"transform",get:function(){return this._transform}},{key:"inverse",get:function(){return this._transformInverse.value}},{key:"inverseTranspose",get:function(){return this._transformInverseTranspose.value}},{key:"inverseRotation",get:function(){return this._transformInverseRotation.value}},{key:"transpose",get:function(){return this._transformTranspose.value}},{key:"setTransformMatrix",value:function(e){(0,s.n)(this._transform,e)}},{key:"multiplyTransform",value:function(e){(0,s.u)(this._transform,this._transform,e)}},{key:"set",value:function(e){(0,s.n)(this._transform,e),this._invalidateLazyTransforms()}},{key:"setAndInvalidateLazyTransforms",value:function(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this._invalidateLazyTransforms()}}]),e}(),m=function(){function e(t,n,i){(0,r.Z)(this,e),this._original=t,this._update=n,this._dirty=!0,this._transform=i()}return(0,i.Z)(e,[{key:"invalidate",value:function(){this._dirty=!0}},{key:"value",get:function(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}}]),e}(),b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,r.Z)(this,e),this.offset=t,this.tmpVertex=(0,h.n)()}return(0,i.Z)(e,[{key:"applyToVertex",value:function(e,t,n){var r=e+this.localOrigin[0],i=t+this.localOrigin[1],o=n+this.localOrigin[2],a=this.offset/Math.sqrt(r*r+i*i+o*o);return this.tmpVertex[0]=e+r*a,this.tmpVertex[1]=t+i*a,this.tmpVertex[2]=n+o*a,this.tmpVertex}},{key:"applyToAabb",value:function(e){for(var t=this,n=0;n<3;++n)w[n]=e[0+n]+this.localOrigin[n],M[n]=e[3+n]+this.localOrigin[n],_[n]=w[n];for(var r=this.applyToVertex(w[0],w[1],w[2]),i=0;i<3;++i)e[i]=r[i],e[i+3]=r[i];for(var o=function(n){for(var r=t.applyToVertex(n[0],n[1],n[2]),i=0;i<3;++i)e[i+0]=Math.min(e[i+0],r[i]),e[i+3]=Math.max(e[i+3],r[i])},a=1;a<8;++a){for(var u=0;u<3;++u)_[u]=0==(a&1<<u)?w[u]:M[u];o(_)}for(var s=0,l=0;l<3;++l)w[l]*M[l]<0&&(s|=1<<l);if(0!==s&&7!==s)for(var c=0;c<8;++c)if(0==(s&c)){for(var f=0;f<3;++f)s[f]?_[f]=0:_[f]=0!=(c&1<<f)?w[f]:M[f];o(_)}for(var h=0;h<3;++h)e[h+0]-=this.localOrigin[h],e[h+3]-=this.localOrigin[h];return e}}]),e}(),w=(0,h.n)(),M=(0,h.n)(),_=(0,h.n)(),k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,r.Z)(this,e),this.componentLocalOriginLength=0,this._tmpVertex=(0,h.n)(),this._mbs=(0,v.R)(),this._obb={center:(0,h.n)(),halfSize:(0,p.n)(),quaternion:null},this._totalOffset=0,this._offset=0,this._resetOffset(t)}return(0,i.Z)(e,[{key:"_resetOffset",value:function(e){this._offset=e,this._totalOffset=e}},{key:"offset",get:function(){return this._offset},set:function(e){this._resetOffset(e)}},{key:"componentOffset",set:function(e){this._totalOffset=this._offset+e}},{key:"localOrigin",set:function(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}},{key:"applyToVertex",value:function(e,t,n){var r=e,i=t,o=n+this.componentLocalOriginLength,a=this._totalOffset/Math.sqrt(r*r+i*i+o*o);return this._tmpVertex[0]=e+r*a,this._tmpVertex[1]=t+i*a,this._tmpVertex[2]=n+o*a,this._tmpVertex}},{key:"applyToAabb",value:function(e){var t=e[0],n=e[1],r=e[2]+this.componentLocalOriginLength,i=e[3],o=e[4],a=e[5]+this.componentLocalOriginLength,u=t*i<0?0:Math.min(Math.abs(t),Math.abs(i)),s=n*o<0?0:Math.min(Math.abs(n),Math.abs(o)),l=r*a<0?0:Math.min(Math.abs(r),Math.abs(a)),c=Math.sqrt(u*u+s*s+l*l);if(c<this._totalOffset)return e[0]-=t<0?this._totalOffset:0,e[1]-=n<0?this._totalOffset:0,e[2]-=r<0?this._totalOffset:0,e[3]+=i>0?this._totalOffset:0,e[4]+=o>0?this._totalOffset:0,e[5]+=a>0?this._totalOffset:0,e;var f=Math.max(Math.abs(t),Math.abs(i)),h=Math.max(Math.abs(n),Math.abs(o)),p=Math.max(Math.abs(r),Math.abs(a)),v=Math.sqrt(f*f+h*h+p*p),d=this._totalOffset/v,y=this._totalOffset/c;return e[0]+=t*(t>0?d:y),e[1]+=n*(n>0?d:y),e[2]+=r*(r>0?d:y),e[3]+=i*(i<0?d:y),e[4]+=o*(o<0?d:y),e[5]+=a*(a<0?d:y),e}},{key:"applyToMbs",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),n=this._totalOffset/t;return this._mbs[0]=e[0]+e[0]*n,this._mbs[1]=e[1]+e[1]*n,this._mbs[2]=e[2]+e[2]*n,this._mbs[3]=e[3]+e[3]*this._totalOffset/t,this._mbs}},{key:"applyToObb",value:function(e){var t=e.center,n=this._totalOffset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this._obb.center[0]=t[0]+t[0]*n,this._obb.center[1]=t[1]+t[1]*n,this._obb.center[2]=t[2]+t[2]*n,(0,h.E)(this._obb.halfSize,e.halfSize,e.quaternion),(0,h.u)(this._obb.halfSize,this._obb.halfSize,e.center);var r=this._totalOffset/Math.sqrt(this._obb.halfSize[0]*this._obb.halfSize[0]+this._obb.halfSize[1]*this._obb.halfSize[1]+this._obb.halfSize[2]*this._obb.halfSize[2]);return this._obb.halfSize[0]+=this._obb.halfSize[0]*r,this._obb.halfSize[1]+=this._obb.halfSize[1]*r,this._obb.halfSize[2]+=this._obb.halfSize[2]*r,(0,h.e)(this._obb.halfSize,this._obb.halfSize,e.center),(0,c.S)(P,e.quaternion),(0,h.E)(this._obb.halfSize,this._obb.halfSize,P),this._obb.halfSize[0]*=this._obb.halfSize[0]<0?-1:1,this._obb.halfSize[1]*=this._obb.halfSize[1]<0?-1:1,this._obb.halfSize[2]*=this._obb.halfSize[2]<0?-1:1,this._obb.quaternion=e.quaternion,this._obb}}]),e}(),S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,r.Z)(this,e),this.offset=t,this.sphere=(0,v.R)(),this.tmpVertex=(0,h.n)()}return(0,i.Z)(e,[{key:"applyToVertex",value:function(e,t,n){var r=this.objectTransform.transform,i=r[0]*e+r[4]*t+r[8]*n+r[12],o=r[1]*e+r[5]*t+r[9]*n+r[13],a=r[2]*e+r[6]*t+r[10]*n+r[14],u=this.offset/Math.sqrt(i*i+o*o+a*a);i+=i*u,o+=o*u,a+=a*u;var s=this.objectTransform.inverse;return this.tmpVertex[0]=s[0]*i+s[4]*o+s[8]*a+s[12],this.tmpVertex[1]=s[1]*i+s[5]*o+s[9]*a+s[13],this.tmpVertex[2]=s[2]*i+s[6]*o+s[10]*a+s[14],this.tmpVertex}},{key:"applyToMinMax",value:function(e,t){var n=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*n,e[1]+=e[1]*n,e[2]+=e[2]*n;var r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*r,t[1]+=t[1]*r,t[2]+=t[2]*r}},{key:"applyToAabb",value:function(e){var t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;var n=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*n,e[4]+=e[4]*n,e[5]+=e[5]*n,e}},{key:"applyToBoundingSphere",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),n=this.offset/t;return this.sphere[0]=e[0]+e[0]*n,this.sphere[1]=e[1]+e[1]*n,this.sphere[2]=e[2]+e[2]*n,this.sphere[3]=e[3]+e[3]*this.offset/t,this.sphere}}]),e}(),x=new S;function Z(e){return(0,o.r)(e)?(x.offset=e,x):null}var A=new k;function I(e){return(0,o.r)(e)?(A.offset=e,A):null}var T=new b;function L(e){return(0,o.r)(e)?(T.offset=e,T):null}var O="terrain",P=(0,f.e)();function R(e,t){return(0,o.t)(e)&&(e=[]),e.push(t),e}function E(e,t){if((0,o.t)(e))return null;var n=e.filter((function(e){return e!==t}));return 0===n.length?null:n}function j(e){return!!(0,o.r)(e)&&!e.visible}function C(e,t,n){var r=e.origin.vec3;(0,d.h)(F,-r[0],-r[1],-r[2]),(0,o.r)(e.transformation)?(0,s.u)(t,F,e.transformation):(0,s.n)(t,F),(0,s.h)(n,t),(0,s.o)(n,n)}function U(e,t,n,r,i){N[0]=e.get(t,0),N[1]=e.get(t,1),N[2]=e.get(t,2),(0,y.t)(N,V,3),n.set(i,0,V[0]),r.set(i,0,V[1]),n.set(i,1,V[2]),r.set(i,1,V[3]),n.set(i,2,V[4]),r.set(i,2,V[5])}var N=new Float64Array(3),V=new Float32Array(6),F=(0,l.e)()},42667:function(e,t,n){n.d(t,{n:function(){return i}});var r="randomUUID"in crypto;function i(){if(r)return crypto.randomUUID();var e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;var t=function(t){return e[t].toString(16).padStart(4,"0")};return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}},13239:function(e,t,n){function r(){return[0,0]}function i(e){return[e[0],e[1]]}function o(e,t){return[e,t]}function a(e){for(var t=[0,0],n=Math.min(2,e.length),r=0;r<n;++r)t[r]=e[r];return t}function u(e,t){return new Float64Array(e,t,2)}function s(){return[0,0]}function l(){return o(1,1)}function c(){return o(1,0)}function f(){return o(0,1)}n.d(t,{e:function(){return a},f:function(){return h},i:function(){return p},n:function(){return r},o:function(){return u},r:function(){return o},t:function(){return i}});var h=[0,0],p=l(),v=c(),d=f();Object.freeze(Object.defineProperty({__proto__:null,create:r,clone:i,fromValues:o,fromArray:a,createView:u,zeros:s,ones:l,unitX:c,unitY:f,ZEROS:h,ONES:p,UNIT_X:v,UNIT_Y:d},Symbol.toStringTag,{value:"Module"}))},87424:function(e,t,n){function r(){return new Float32Array(3)}function i(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function o(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}function a(e,t){return new Float32Array(e,t,3)}function u(){return r()}function s(){return o(1,1,1)}function l(){return o(1,0,0)}function c(){return o(0,1,0)}function f(){return o(0,0,1)}n.d(t,{a:function(){return u},e:function(){return a},n:function(){return r},r:function(){return o},t:function(){return i}});var h=u(),p=s(),v=l(),d=c(),y=f();Object.freeze(Object.defineProperty({__proto__:null,create:r,clone:i,fromValues:o,createView:a,zeros:u,ones:s,unitX:l,unitY:c,unitZ:f,ZEROS:h,ONES:p,UNIT_X:v,UNIT_Y:d,UNIT_Z:y},Symbol.toStringTag,{value:"Module"}))},91681:function(e,t,n){function r(){return[0,0,0,0]}function i(e){return[e[0],e[1],e[2],e[3]]}function o(e,t,n,r){return[e,t,n,r]}function a(e){for(var t=[0,0,0,0],n=Math.min(4,e.length),r=0;r<n;++r)t[r]=e[r];return t}function u(e,t){return new Float64Array(e,t,4)}function s(){return[0,0,0,0]}function l(){return o(1,1,1,1)}function c(){return o(1,0,0,0)}function f(){return o(0,1,0,0)}function h(){return o(0,0,1,0)}function p(){return o(0,0,0,1)}n.d(t,{_:function(){return d},e:function(){return a},l:function(){return v},n:function(){return r},r:function(){return o},t:function(){return i},u:function(){return u}});var v=[0,0,0,0],d=l(),y=c(),g=f(),m=h(),b=p();Object.freeze(Object.defineProperty({__proto__:null,create:r,clone:i,fromValues:o,fromArray:a,createView:u,zeros:s,ones:l,unitX:c,unitY:f,unitZ:h,unitW:p,ZEROS:v,ONES:d,UNIT_X:y,UNIT_Y:g,UNIT_Z:m,UNIT_W:b},Symbol.toStringTag,{value:"Module"}))}}]);
//# sourceMappingURL=330.cd492906.chunk.js.map