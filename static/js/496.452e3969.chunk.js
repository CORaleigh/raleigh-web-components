"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[496],{630:function(e,t,i){i.d(t,{a:function(){return v},c:function(){return c},d:function(){return f}});var n=i(15671),r=i(43144),a=i(60136),l=i(29388),o=i(48848),s=i(93661),u=i(50690),c=function(e){(0,a.Z)(i,e);var t=(0,l.Z)(i);function i(){var e;return(0,n.Z)(this,i),(e=t.apply(this,arguments)).updating=!1,e._handleId=0,e._handles=new o.X,e._scheduleHandleId=0,e._pendingPromises=new Set,e}return(0,r.Z)(i,[{key:"destroy",value:function(){this.removeAll(),this._handles.destroy()}},{key:"add",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._installWatch(e,t,i,u.l)}},{key:"addWhen",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._installWatch(e,t,i,u.f)}},{key:"addOnCollectionChange",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.initial,a=void 0!==r&&r,l=n.final,o=void 0!==l&&l,s=++this._handleId;return this._handles.add([(0,u.a)(e,"after-changes",this._createSyncUpdatingCallback(),u.U),(0,u.a)(e,"change",t,{onListenerAdd:a?function(e){return t({added:e.toArray(),removed:[]})}:void 0,onListenerRemove:o?function(e){return t({added:[],removed:e.toArray()})}:void 0})],s),{remove:function(){return i._handles.remove(s)}}}},{key:"addPromise",value:function(e){var t=this;if((0,s.t)(e))return e;var i=++this._handleId;this._handles.add({remove:function(){t._pendingPromises.delete(e)&&(0!==t._pendingPromises.size||t._handles.has(h)||t._set("updating",!1))}},i),this._pendingPromises.add(e),this._set("updating",!0);var n=function(){return t._handles.remove(i)};return e.then(n,n),e}},{key:"removeAll",value:function(){this._pendingPromises.clear(),this._handles.removeAll(),this._set("updating",!1)}},{key:"_installWatch",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,a=++this._handleId;n.sync||this._installSyncUpdatingWatch(e,a);var l=r(e,t,n);return this._handles.add(l,a),{remove:function(){return i._handles.remove(a)}}}},{key:"_installSyncUpdatingWatch",value:function(e,t){var i=this._createSyncUpdatingCallback(),n=(0,u.l)(e,i,{sync:!0,equals:function(){return!1}});return this._handles.add(n,t),n}},{key:"_createSyncUpdatingCallback",value:function(){var e=this;return function(){e._handles.remove(h),++e._scheduleHandleId;var t=e._scheduleHandleId;e._get("updating")||e._set("updating",!0),e._handles.add((0,o.k)((function(){t===e._scheduleHandleId&&(e._set("updating",e._pendingPromises.size>0),e._handles.remove(h))})),h)}}}]),i}(o.m);(0,o.e)([(0,o.y)({readOnly:!0})],c.prototype,"updating",void 0),c=(0,o.e)([(0,o.n)("esri.core.support.WatchUpdatingTracking")],c);var h=-42,v=function(e){var t=function(e){(0,a.Z)(i,e);var t=(0,l.Z)(i);function i(){return(0,n.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"destroy",value:function(){var e,t;this.destroyed||(null!==(e=this._get("handles"))&&void 0!==e&&e.destroy(),null===(t=this._get("updatingHandles"))||void 0===t||t.destroy())}},{key:"handles",get:function(){return this._get("handles")||new o.X}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new c}}]),i}(e);return(0,o.e)([(0,o.y)({readOnly:!0})],t.prototype,"handles",null),(0,o.e)([(0,o.y)({readOnly:!0})],t.prototype,"updatingHandles",null),t=(0,o.e)([(0,o.n)("esri.core.HandleOwner")],t),t},f=function(e){(0,a.Z)(i,e);var t=(0,l.Z)(i);function i(){return(0,n.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i)}(v(o.m));f=(0,o.e)([(0,o.n)("esri.core.HandleOwner")],f)},3356:function(e,t,i){i.d(t,{j:function(){return k},p:function(){return w}});var n,r=i(1413),a=i(15671),l=i(43144),o=i(60136),s=i(29388),u=i(48848),c=i(40558),h=i(40114),v=i(93661),f=i(47855),p=i(82474),d=i(25456),y=i(36040),m=n=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).cols=null,n.level=0,n.levelValue=null,n.origin=null,n.resolution=0,n.rows=null,n.scale=0,n}return(0,l.Z)(i,[{key:"clone",value:function(){return new n({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}}]),i}(h.l);(0,u.e)([(0,u.y)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],m.prototype,"cols",void 0),(0,u.e)([(0,u.y)({type:u.T,json:{write:!0}})],m.prototype,"level",void 0),(0,u.e)([(0,u.y)({type:String,json:{write:!0}})],m.prototype,"levelValue",void 0),(0,u.e)([(0,u.y)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],m.prototype,"origin",void 0),(0,u.e)([(0,u.y)({type:Number,json:{write:!0}})],m.prototype,"resolution",void 0),(0,u.e)([(0,u.y)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],m.prototype,"rows",void 0),(0,u.e)([(0,u.y)({type:Number,json:{write:!0}})],m.prototype,"scale",void 0);var g,w=m=n=(0,u.e)([(0,u.n)("esri.layers.support.LOD")],m),_=new c.s({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"}),b=g=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).dpi=96,n.format=null,n.origin=null,n.minScale=0,n.maxScale=0,n.size=null,n.spatialReference=null,n}return(0,l.Z)(i,[{key:"isWrappable",get:function(){var e=this.spatialReference,t=this.origin;if(e&&t){var i=(0,p.a)(e);return e.isWrappable&&!!i&&Math.abs(i.origin[0]-t.x)<=i.dx}return!1}},{key:"readOrigin",value:function(e,t){return p.w.fromJSON((0,r.Z)({spatialReference:t.spatialReference},e))}},{key:"lods",set:function(e){var t=0,i=0,n=[],r=this._levelToLOD={};e&&(t=-1/0,i=1/0,e.forEach((function(e){n.push(e.scale),t=e.scale>t?e.scale:t,i=e.scale<i?e.scale:i,r[e.level]=e}))),this._set("scales",n),this._set("minScale",t),this._set("maxScale",i),this._set("lods",e),this._initializeUpsampleLevels()}},{key:"readSize",value:function(e,t){return[t.cols,t.rows]}},{key:"writeSize",value:function(e,t){t.cols=e[0],t.rows=e[1]}},{key:"zoomToScale",value:function(e){var t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];var i=Math.floor(e),n=i+1;return t[i]/Math.pow(t[i]/t[n],e-i)}},{key:"scaleToZoom",value:function(e){for(var t=this.scales,i=t.length-1,n=0;n<i;n++){var r=t[n],a=t[n+1];if(r<=e)return n;if(a===e)return n+1;if(r>e&&a<e)return n+Math.log(r/e)/Math.log(r/a)}return n}},{key:"snapScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,i=this.scaleToZoom(e);return i%Math.floor(i)>=t?this.zoomToScale(Math.ceil(i)):this.zoomToScale(Math.floor(i))}},{key:"tileAt",value:function(e,t,i,n){var r,a,l=this.lodAt(e);if(!l)return null;if("number"==typeof t)r=t,a=i;else if((0,p.E)(t.spatialReference,this.spatialReference))r=t.x,a=t.y,n=i;else{var o=(0,p.M)(t,this.spatialReference);if((0,v.t)(o))return null;r=o.x,a=o.y,n=i}var s=l.resolution*this.size[0],u=l.resolution*this.size[1];return n||(n=new y.t(null,0,0,0,(0,d.u)())),n.level=e,n.row=Math.floor((this.origin.y-a)/u+.001),n.col=Math.floor((r-this.origin.x)/s+.001),this.updateTileInfo(n),n}},{key:"updateTileInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.ExtrapolateOptions.NONE,i=this.lodAt(e.level);if(!i&&t===g.ExtrapolateOptions.POWER_OF_TWO){var n=this.lods[this.lods.length-1];n.level<e.level&&(i=n)}if(i){var r=e.level-i.level,a=i.resolution*this.size[0]/Math.pow(2,r),l=i.resolution*this.size[1]/Math.pow(2,r);e.id="".concat(e.level,"/").concat(e.row,"/").concat(e.col),e.extent||(e.extent=(0,d.u)()),e.extent[0]=this.origin.x+e.col*a,e.extent[1]=this.origin.y-(e.row+1)*l,e.extent[2]=e.extent[0]+a,e.extent[3]=e.extent[1]+l}}},{key:"upsampleTile",value:function(e){var t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}},{key:"getTileBounds",value:function(e,t){var i=this.lodAt(t.level);if(null==i)return null;var n=i.resolution,r=n*this.size[0],a=n*this.size[1];return e[0]=this.origin.x+t.col*r,e[1]=this.origin.y-(t.row+1)*a,e[2]=e[0]+r,e[3]=e[1]+a,e}},{key:"lodAt",value:function(e){var t,i;return null!==(t=null===(i=this._levelToLOD)||void 0===i?void 0:i[e])&&void 0!==t?t:null}},{key:"clone",value:function(){return g.fromJSON(this.write({}))}},{key:"getOrCreateCompatible",value:function(e,t){if(256===this.size[0]&&256===this.size[1])return 256===e?this:null;for(var i=[],n=this.lods.length,r=0;r<n;r++){var a=this.lods[r],l=a.resolution*t;i.push(new w({level:a.level,scale:a.scale,resolution:l}))}return new g({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}},{key:"_initializeUpsampleLevels",value:function(){var e=this.lods;this._upsampleLevels=[];for(var t=null,i=0;i<e.length;i++){var n=e[i];this._upsampleLevels[n.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/n.resolution:0},t=n}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resolutionFactor,i=void 0===t?1:t,n=e.scales,r=e.size,a=void 0===r?256:r,l=e.spatialReference,o=void 0===l?p.k.WebMercator:l,s=e.numLODs,u=void 0===s?24:s;if(!(0,p.I)(o)){var c=[];if(n)for(var h=0;h<n.length;h++){var v=n[h];c.push({level:h,scale:v,resolution:v})}else for(var d=5e-4,y=u-1;y>=0;y--)c.unshift({level:y,scale:d,resolution:d}),d*=2;return new g({dpi:96,lods:c,origin:new p.w(0,0,o),size:[a,a],spatialReference:o})}var m=(0,p.a)(o),w=e.origin?new p.w({x:e.origin.x,y:e.origin.y,spatialReference:o}):new p.w(m?{x:m.origin[0],y:m.origin[1],spatialReference:o}:{x:0,y:0,spatialReference:o}),_=96,b=1/(39.37*(0,f.$)(o)*_),k=[];if(n)for(var S=0;S<n.length;S++){var O=n[S],z=O*b;k.push({level:S,scale:O,resolution:z})}else{var T=(0,p.h)(o)?512/a*591657527.5917094:256/a*591657527.591555,Z=Math.ceil(u/i);k.push({level:0,scale:T,resolution:T*b});for(var A=1;A<Z;A++){var x=T/Math.pow(2,i),L=x*b;k.push({level:A,scale:x,resolution:L}),T=x}}return new g({dpi:_,lods:k,origin:w,size:[a,a],spatialReference:o})}}]),i}(h.l);(0,u.e)([(0,u.y)({type:Number,json:{write:!0}})],b.prototype,"compressionQuality",void 0),(0,u.e)([(0,u.y)({type:Number,json:{write:!0}})],b.prototype,"dpi",void 0),(0,u.e)([(0,u.y)({type:String,json:{read:_.read,write:_.write,origins:{"web-scene":{read:!1,write:!1}}}})],b.prototype,"format",void 0),(0,u.e)([(0,u.y)({readOnly:!0})],b.prototype,"isWrappable",null),(0,u.e)([(0,u.y)({type:p.w,json:{write:!0}})],b.prototype,"origin",void 0),(0,u.e)([(0,p.o)("origin")],b.prototype,"readOrigin",null),(0,u.e)([(0,u.y)({type:[w],value:null,json:{write:!0}})],b.prototype,"lods",null),(0,u.e)([(0,u.y)({readOnly:!0})],b.prototype,"minScale",void 0),(0,u.e)([(0,u.y)({readOnly:!0})],b.prototype,"maxScale",void 0),(0,u.e)([(0,u.y)({readOnly:!0})],b.prototype,"scales",void 0),(0,u.e)([(0,u.y)({cast:function(e){return Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]}})],b.prototype,"size",void 0),(0,u.e)([(0,p.o)("size",["rows","cols"])],b.prototype,"readSize",null),(0,u.e)([(0,p.r)("size",{cols:{type:u.T},rows:{type:u.T}})],b.prototype,"writeSize",null),(0,u.e)([(0,u.y)({type:p.k,json:{write:!0}})],b.prototype,"spatialReference",void 0),function(e){var t;(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO"}((b=g=(0,u.e)([(0,u.n)("esri.layers.support.TileInfo")],b))||(b={}));var k=b},36040:function(e,t,i){i.d(t,{t:function(){return a}});var n=i(43144),r=i(15671),a=(0,n.Z)((function e(t,i,n,a,l){(0,r.Z)(this,e),this.id=t,this.level=i,this.row=n,this.col=a,this.extent=l}))},30496:function(e,t,i){i.d(t,{n:function(){return _},r:function(){return w},z:function(){return O}});var n=i(74165),r=i(15861),a=i(60136),l=i(29388),o=i(15671),s=i(43144),u=i(1413),c=i(3356),h=i(48848),v=i(40558),f=i(43955),p=i(630),d=i(39926),y=i(50690),m=i(93661),g=i(36040),w={type:c.j,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:_}}}}};function _(e,t,i,n){if(!e)return null;var r=t.minScale,a=t.maxScale,l=t.minLOD,o=t.maxLOD;if(null!=l&&null!=o)return n&&n.ignoreMinMaxLOD?c.j.fromJSON(e):c.j.fromJSON((0,u.Z)((0,u.Z)({},e),{},{lods:e.lods.filter((function(e){var t=e.level;return null!=t&&t>=l&&t<=o}))}));if(0!==r&&0!==a){var s=function(e){return Math.round(1e4*e)/1e4},h=r?s(r):1/0,v=a?s(a):-1/0;return c.j.fromJSON((0,u.Z)((0,u.Z)({},e),{},{lods:e.lods.filter((function(e){var t=s(e.scale);return t<=h&&t>=v}))}))}return c.j.fromJSON(e)}var b,k=function(){function e(){(0,o.Z)(this,e),this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}return(0,s.Z)(e,[{key:"getAvailability",value:function(e,t){if("unknown"!==this._allAvailability)return this._allAvailability;var i=(e-this.location.top)*this.location.width+(t-this.location.left),n=i%8,r=i>>3,a=this._tileAvailabilityBitSet;return r<0||r>a.length?"unknown":a[r]&1<<n?"available":"unavailable"}},{key:"_updateFromData",value:function(e){for(var t=this.location.width,i=this.location.height,n=!0,r=!0,a=Math.ceil(t*i/8),l=new Uint8Array(a),o=0,s=0;s<e.length;s++){var u=s%8;e[s]?(r=!1,l[o]|=1<<u):n=!1,7===u&&++o}r?this._allAvailability="unavailable":n?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=l,this.byteSize+=l.length)}}],[{key:"fromDefinition",value:function(t,i){var n=t.service.request||v.U,r=t.row,a=t.col,l=t.width,o=t.height,s={query:{f:"json"}};return i=i?(0,u.Z)((0,u.Z)({},s),i):s,n(function(e){var t;if("vector-tile"===e.service.type)t="".concat(e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height);else{var i=e.service.tileServers;t="".concat(i&&i.length?i[e.row%i.length]:e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var n=e.service.query;return n&&(t="".concat(t,"?").concat(n)),t}(t),i).then((function(e){return e.data})).catch((function(e){if(e&&e.details&&422===e.details.httpStatus)return{location:{top:r,left:a,width:l,height:o},valid:!0,data:(0,m.a0)(l*o,0)};throw e})).then((function(t){if(t.location&&(t.location.top!==r||t.location.left!==a||t.location.width!==l||t.location.height!==o))throw new h.s("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:r,left:a,width:l,height:o}});return e.fromJSON(t)}))}},{key:"fromJSON",value:function(t){e._validateJSON(t);var i=new e;return i.location=Object.freeze((0,m.y)(t.location)),i._updateFromData(t.data),Object.freeze(i)}},{key:"_validateJSON",value:function(e){if(!e||!e.location)throw new h.s("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new h.s("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new h.s("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new h.s("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new h.s("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}]),e}();function S(e){return"".concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var O=b=function(e){(0,a.Z)(i,e);var t=(0,l.Z)(i);function i(e){var n;return(0,o.Z)(this,i),(n=t.call(this,e))._pendingTilemapRequests={},n._availableLevels={},n.levels=5,n.cacheByteSize=2*f.s.MEGABYTES,n.request=v.U,n._prefetchingEnabled=!0,n}return(0,s.Z)(i,[{key:"initialize",value:function(){var e=this;this._tilemapCache=new d.e(this.cacheByteSize),this.addHandles([(0,y.l)((function(){var t=e.layer;return[null===t||void 0===t?void 0:t.parsedUrl,null===t||void 0===t?void 0:t.tileServers,null===t||void 0===t?void 0:t.apiKey,null===t||void 0===t?void 0:t.customParameters]}),(function(){return e._initializeTilemapDefinition()})),(0,y.l)((function(){var t,i;return null===(t=e.layer)||void 0===t||null===(i=t.tileInfo)||void 0===i?void 0:i.lods}),(function(t){return e._initializeAvailableLevels(t)}),y.w)]),this._initializeTilemapDefinition()}},{key:"castLevels",value:function(e){return e<=2?(h.a.getLogger(this.declaredClass).error("Minimum levels for Tilemap is 3, but got ",e),3):e}},{key:"size",get:function(){return 1<<this.levels}},{key:"fetchTilemap",value:function(e,t,i,n){var r=this;if(!this._availableLevels[e])return Promise.reject(new h.s("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")));var a=this._tmpTilemapDefinition,l=this._tilemapFromCache(e,t,i,a);if(l)return Promise.resolve(l);var o=n&&n.signal;return n=(0,u.Z)((0,u.Z)({},n),{},{signal:null}),new Promise((function(e,t){(0,h.v)(o,(function(){return t((0,h.d)())}));var i=S(a),l=r._pendingTilemapRequests[i];if(!l){l=k.fromDefinition(a,n).then((function(e){return r._tilemapCache.put(i,e,e.byteSize),e}));var s=function(){return delete r._pendingTilemapRequests[i]};r._pendingTilemapRequests[i]=l,l.then(s,s)}l.then(e,t)}))}},{key:"getAvailability",value:function(e,t,i){if(!this._availableLevels[e])return"unavailable";var n=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return n?n.getAvailability(t,i):"unknown"}},{key:"fetchAvailability",value:function(e,t,i,n){return this._availableLevels[e]?this.fetchTilemap(e,t,i,n).catch((function(e){return e})).then((function(n){if(n instanceof k){var r=n.getAvailability(t,i);if("unavailable"===r)throw new h.s("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i});return r}if((0,h.j)(n))throw n;return"unknown"})):Promise.reject(new h.s("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")))}},{key:"fetchAvailabilityUpsample",value:function(e,t,i,n,r){var a=this;n.level=e,n.row=t,n.col=i;var l=this.layer.tileInfo;l.updateTileInfo(n);var o=this.fetchAvailability(e,t,i,r).catch((function(e){if((0,h.j)(e))throw e;if(l.upsampleTile(n))return a.fetchAvailabilityUpsample(n.level,n.row,n.col,n);throw e}));return this._fetchAvailabilityUpsamplePrefetch(n.id,e,t,i,r,o),o}},{key:"_fetchAvailabilityUpsamplePrefetch",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,i,r,a,l,o){var s,c,v,f,p,d,y,m,w,_=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._prefetchingEnabled){e.next=2;break}return e.abrupt("return");case 2:if(s="prefetch-".concat(t),!this.handles.has(s)){e.next=5;break}return e.abrupt("return");case 5:return c=new AbortController,o.then((function(){return c.abort()}),(function(){return c.abort()})),v=!1,f={remove:function(){v||(v=!0,c.abort())}},this.handles.add(f,s),e.next=12,(0,h.ay)(10,c.signal).catch((function(){}));case 12:if(v||(v=!0,this.handles.remove(s)),!(0,h.p)(c)){e.next=15;break}return e.abrupt("return");case 15:for(p=new g.t(t,i,r,a),d=(0,u.Z)((0,u.Z)({},l),{},{signal:c.signal}),y=this.layer.tileInfo,m=function(e){var t=_.fetchAvailability(p.level,p.row,p.col,d);b._prefetches.push(t);var i=function(){b._prefetches.removeUnordered(t)};t.then(i,i)},w=0;b._prefetches.length<b._maxPrefetch&&y.upsampleTile(p);++w)m();case 18:case"end":return e.stop()}}),e,this)})));return function(t,i,n,r,a,l){return e.apply(this,arguments)}}()},{key:"_initializeTilemapDefinition",value:function(){var e;if(this.layer.parsedUrl){var t=this.layer,i=t.parsedUrl,n=t.apiKey,r=t.customParameters;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:i.path,query:(0,v.i)((0,u.Z)((0,u.Z)((0,u.Z)({},i.query),r),{},{token:null!==n&&void 0!==n?n:null===(e=i.query)||void 0===e?void 0:e.token})),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}}},{key:"_tilemapFromCache",value:function(e,t,i,n){n.level=e,n.row=t-t%this.size,n.col=i-i%this.size;var r=S(n);return this._tilemapCache.get(r)}},{key:"_initializeAvailableLevels",value:function(e){var t=this;this._availableLevels={},e&&e.forEach((function(e){return t._availableLevels[e.level]=!0}))}},{key:"test",get:function(){var e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:function(t,i,n){return!!e._tilemapFromCache(t,i,n,e._tmpTilemapDefinition)}}}}]),i}((0,p.a)(h.m));O._maxPrefetch=4,O._prefetches=new h.a6({initialSize:b._maxPrefetch}),(0,h.e)([(0,h.y)({constructOnly:!0,type:Number})],O.prototype,"levels",void 0),(0,h.e)([(0,h.c)("levels")],O.prototype,"castLevels",null),(0,h.e)([(0,h.y)({readOnly:!0,type:Number})],O.prototype,"size",null),(0,h.e)([(0,h.y)({constructOnly:!0,type:Number})],O.prototype,"cacheByteSize",void 0),(0,h.e)([(0,h.y)({constructOnly:!0})],O.prototype,"layer",void 0),(0,h.e)([(0,h.y)({constructOnly:!0})],O.prototype,"request",void 0),O=b=(0,h.e)([(0,h.n)("esri.layers.support.TilemapCache")],O)},43955:function(e,t,i){function n(e){return 32+e.length}function r(e){return 16}function a(e){if(!e)return 0;var t=c;for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];switch(typeof r){case"string":t+=n(r);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function l(e){if(!e)return 0;if(Array.isArray(e))return function(e){var t=e.length;if(0===t||"number"==typeof e[0])return 32+8*t;for(var i=h,n=0;n<t;n++)i+=o(e[n]);return i}(e);var t=c;for(var i in e)e.hasOwnProperty(i)&&(t+=o(e[i]));return t}function o(e){switch(typeof e){case"object":return l(e);case"string":return n(e);case"number":return 16;case"boolean":return 4;default:return 8}}function s(e,t){return h+e.length*t}i.d(t,{c:function(){return s},e:function(){return l},n:function(){return n},r:function(){return r},s:function(){return u},t:function(){return a}});var u,c=32,h=32;!function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(u||(u={}))}}]);
//# sourceMappingURL=496.452e3969.chunk.js.map