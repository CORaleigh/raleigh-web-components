"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[2850],{8049:function(t,e,r){r.d(e,{p:function(){return u}});var n=r(15671),a=r(43144),i=r(60136),o=r(29388),l=r(50165),s=r(80933),u=function(t){var e=function(t){(0,i.Z)(r,t);var e=(0,o.Z)(r);function r(){return(0,n.Z)(this,r),e.apply(this,arguments)}return(0,a.Z)(r,[{key:"title",get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var t=(0,s.m)(this.url);if((0,l.r)(t)&&t.title)return t.title}return this._get("title")||""},set:function(t){this._set("title",t)}},{key:"url",set:function(t){this._set("url",(0,s.S)(t,l.s.getLogger(this.declaredClass)))}}]),r}(t);return(0,l.e)([(0,l.d)()],e.prototype,"title",null),(0,l.e)([(0,l.d)({type:String})],e.prototype,"url",null),e=(0,l.e)([(0,l.n)("esri.layers.mixins.ArcGISService")],e)}},28003:function(t,e,r){r.d(e,{b:function(){return k}});var n=r(74165),a=r(15671),i=r(43144),o=r(60136),l=r(29388),s=r(15861),u=r(50165),p=(r(33530),r(13994)),c=r(40133),d=r(17493),f=r(78330),y=r(96263),h=r(77322),v=u.s.getLogger("esri.layers.support.fromPortalItem");function m(){return m=(0,s.Z)((0,n.Z)().mark((function t(e){var a,i,o,l,s;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="portalItem"in e?e:{portalItem:e},t.next=3,Promise.all([r.e(1340),r.e(8643),r.e(1056),r.e(4314),r.e(5487)]).then(r.bind(r,4314));case 3:return i=t.sent,t.prev=4,t.next=7,i.fromItem(a);case 7:return t.abrupt("return",t.sent);case 10:throw t.prev=10,t.t0=t.catch(4),o=a&&a.portalItem,l=o&&o.id||"unset",s=o&&o.portal&&o.portal.url||u.f.portalUrl,v.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+s+"', id: '"+l+"')",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[4,10]])}))),m.apply(this,arguments)}var b=0,g=function(t){(0,o.Z)(c,t);var e=(0,l.Z)(c);function c(){var t;return(0,a.Z)(this,c),(t=e.apply(this,arguments)).attributionDataUrl=null,t.fullExtent=new y.M(-180,-90,180,90,h.k.WGS84),t.id=Date.now().toString(16)+"-layer-"+b++,t.legendEnabled=!0,t.listMode="show",t.opacity=1,t.parent=null,t.popupEnabled=!0,t.attributionVisible=!0,t.spatialReference=h.k.WGS84,t.title=null,t.type=null,t.url=null,t.visible=!0,t}return(0,i.Z)(c,[{key:"initialize",value:function(){var t=this;this.when().catch((function(e){var r,n;(0,u.I)(e)||u.s.getLogger(t.declaredClass).error("#load()","Failed to load layer (title: '".concat(null!==(r=t.title)&&void 0!==r?r:"no title","', id: '").concat(null!==(n=t.id)&&void 0!==n?n:"no id","')"),{error:e})}))}},{key:"destroy",value:function(){if(this.parent){var t=this,e=this.parent;"layers"in e&&e.layers.includes(t)?e.layers.remove(t):"tables"in e&&e.tables.includes(t)?e.tables.remove(t):"baseLayers"in e&&e.baseLayers.includes(t)?e.baseLayers.remove(t):"baseLayers"in e&&e.referenceLayers.includes(t)&&e.referenceLayers.remove(t)}}},{key:"hasAttributionData",get:function(){return null!=this.attributionDataUrl}},{key:"parsedUrl",get:function(){var t=this.url;return t?(0,p.j)(t):null}},{key:"fetchAttributionData",value:function(){var t=(0,s.Z)((0,n.Z)().mark((function t(){var e;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.attributionDataUrl,!this.hasAttributionData||!e){t.next=5;break}return t.next=4,(0,p.U)(e,{query:{f:"json"},responseType:"json"});case 4:return t.abrupt("return",t.sent.data);case 5:throw new u.a("layer:no-attribution-data","Layer does not have attribution data");case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}],[{key:"fromArcGISServerUrl",value:function(){var t=(0,s.Z)((0,n.Z)().mark((function t(e){var a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="string"==typeof e?{url:e}:e,t.next=3,Promise.all([r.e(1056),r.e(4574)]).then(r.bind(r,4574));case 3:return t.abrupt("return",t.sent.fromUrl(a));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"fromPortalItem",value:function(t){return function(t){return m.apply(this,arguments)}(t)}}]),c}(c.n.EventedMixin((0,d.s)(f.m)));(0,u.e)([(0,u.d)({type:String})],g.prototype,"attributionDataUrl",void 0),(0,u.e)([(0,u.d)({type:y.M})],g.prototype,"fullExtent",void 0),(0,u.e)([(0,u.d)({readOnly:!0})],g.prototype,"hasAttributionData",null),(0,u.e)([(0,u.d)({type:String,clonable:!1})],g.prototype,"id",void 0),(0,u.e)([(0,u.d)({type:Boolean,nonNullable:!0})],g.prototype,"legendEnabled",void 0),(0,u.e)([(0,u.d)({type:["show","hide","hide-children"]})],g.prototype,"listMode",void 0),(0,u.e)([(0,u.d)({type:Number,range:{min:0,max:1},nonNullable:!0})],g.prototype,"opacity",void 0),(0,u.e)([(0,u.d)({clonable:!1})],g.prototype,"parent",void 0),(0,u.e)([(0,u.d)({readOnly:!0})],g.prototype,"parsedUrl",null),(0,u.e)([(0,u.d)({type:Boolean})],g.prototype,"popupEnabled",void 0),(0,u.e)([(0,u.d)({type:Boolean})],g.prototype,"attributionVisible",void 0),(0,u.e)([(0,u.d)({type:h.k})],g.prototype,"spatialReference",void 0),(0,u.e)([(0,u.d)({type:String})],g.prototype,"title",void 0),(0,u.e)([(0,u.d)({readOnly:!0,json:{read:!1}})],g.prototype,"type",void 0),(0,u.e)([(0,u.d)()],g.prototype,"url",void 0),(0,u.e)([(0,u.d)({type:Boolean,nonNullable:!0})],g.prototype,"visible",void 0);var k=g=(0,u.e)([(0,u.n)("esri.layers.Layer")],g)},41524:function(t,e,r){r.d(e,{v:function(){return g}});var n=r(1413),a=r(74165),i=r(15861),o=r(15671),l=r(43144),s=r(11752),u=r(61120),p=r(60136),c=r(29388),d=r(50165),f=r(13994),y=r(5233),h=r(77322),v=r(78330),m=r(68668),b=d.s.getLogger("esri.layers.mixins.PortalLayer"),g=function(t){var e=function(t){(0,p.Z)(h,t);var e=(0,c.Z)(h);function h(){var t;return(0,o.Z)(this,h),(t=e.apply(this,arguments)).resourceReferences={portalItem:null,paths:[]},t.userHasEditingPrivileges=!0,t}return(0,l.Z)(h,[{key:"destroy",value:function(){var t;null!==(t=this.portalItem)&&void 0!==t&&t.destroy(),this.portalItem=null}},{key:"portalItem",set:function(t){t!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",t))}},{key:"readPortalItem",value:function(t,e,r){if(e.itemId)return new m.default({id:e.itemId,portal:r&&r.portal})}},{key:"writePortalItem",value:function(t,e){t&&t.id&&(e.itemId=t.id)}},{key:"loadFromPortal",value:function(){var t=(0,i.Z)((0,a.Z)().mark((function t(e,n){var i;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.portalItem||!this.portalItem.id){t.next=14;break}return t.prev=1,t.next=4,Promise.all([r.e(1056),r.e(4368)]).then(r.bind(r,84368)).then((function(t){return t.l}));case 4:return i=t.sent,(0,d.W)(n),t.next=8,i.load({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData},n);case 8:return t.abrupt("return",t.sent);case 11:throw t.prev=11,t.t0=t.catch(1),(0,d.I)(t.t0)||b.warn("Failed to load layer (".concat(this.title,", ").concat(this.id,") portal item (").concat(this.portalItem.id,")\n  ").concat(t.t0)),t.t0;case 14:case"end":return t.stop()}}),t,this,[[1,11]])})));return function(e,r){return t.apply(this,arguments)}}()},{key:"finishLoadEditablePortalLayer",value:function(){var t=(0,i.Z)((0,a.Z)().mark((function t(e){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this,t.next=3,this._fetchUserHasEditingPrivileges(e).catch((function(t){return(0,d._)(t),!0}));case 3:t.t1=t.sent,t.t0._set.call(t.t0,"userHasEditingPrivileges",t.t1);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_fetchUserHasEditingPrivileges",value:function(){var t=(0,i.Z)((0,a.Z)().mark((function t(e){var r,n;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.url?null===f.a||void 0===f.a?void 0:f.a.findCredential(this.url):null){t.next=3;break}return t.abrupt("return",!0);case 3:if(k.credential!==r){t.next=7;break}t.t0=k.user,t.next=10;break;case 7:return t.next=9,this._fetchEditingUser(e);case 9:t.t0=t.sent;case 10:return n=t.t0,t.abrupt("return",(k.credential=r,k.user=n,(0,d.t)(n)||null==n.privileges||n.privileges.includes("features:user:edit")));case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_fetchEditingUser",value:function(){var t=(0,i.Z)((0,a.Z)().mark((function t(e){var r,n,i,o,l,s,u,p,c;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=null===(r=this.portalItem)||void 0===r||null===(n=r.portal)||void 0===n?void 0:n.user)){t.next=3;break}return t.abrupt("return",i);case 3:if(null!==(o=f.a.findServerInfo(this.url))&&void 0!==o&&o.owningSystemUrl){t.next=6;break}return t.abrupt("return",null);case 6:if(l="".concat(o.owningSystemUrl,"/sharing/rest"),!(s=v.B.getDefault())||!s.loaded||(0,f.F)(s.restUrl)!==(0,f.F)(l)){t.next=9;break}return t.abrupt("return",s.user);case 9:return u="".concat(l,"/community/self"),p=(0,d.r)(e)?e.signal:null,t.next=13,(0,y.a)((0,f.U)(u,{authMode:"no-prompt",query:{f:"json"},signal:p}));case 13:return c=t.sent,t.abrupt("return",c.ok?v.p.fromJSON(c.value.data):null);case 15:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"read",value:function(t,e){e&&(e.layer=this),(0,s.Z)((0,u.Z)(h.prototype),"read",this).call(this,t,e)}},{key:"write",value:function(t,e){var r=e&&e.portal,a=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||v.B.getDefault());return r&&a&&!(0,f.N)(a.restUrl,r.restUrl)?(e.messages&&e.messages.push(new d.a("layer:cross-portal","The layer '".concat(this.title," (").concat(this.id,")' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer"),{layer:this})),null):(0,s.Z)((0,u.Z)(h.prototype),"write",this).call(this,t,(0,n.Z)((0,n.Z)({},e),{},{layer:this}))}}]),h}(t);return(0,d.e)([(0,d.d)({type:m.default})],e.prototype,"portalItem",null),(0,d.e)([(0,h.o)("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),(0,d.e)([(0,h.r)("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),(0,d.e)([(0,d.d)({clonable:!1})],e.prototype,"resourceReferences",void 0),(0,d.e)([(0,d.d)({readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),e=(0,d.e)([(0,d.n)("esri.layers.mixins.PortalLayer")],e),e},k={credential:null,user:null}}}]);
//# sourceMappingURL=2850.33bddcc7.chunk.js.map