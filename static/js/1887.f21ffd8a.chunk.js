"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[1887],{21887:function(e,t,r){r.d(t,{c:function(){return lr},f:function(){return gr},i:function(){return wr},l:function(){return or},m:function(){return hr}});var n=r(37762),o=r(93433),i=r(29439),a=r(1413),s=r(43144),u=r(15671),l=r(60136),c=r(29388),p=r(48848),f=r(93661),v=r(40114),y=r(85045),h=r(20302),m=r(40558),d=r(44954),g=r(82474),w=r(71147),x=(r(74384),r(46817)),A=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).raster=void 0,e}return(0,s.Z)(r)}(v.l);(0,p.e)([(0,p.y)({json:{write:!0}})],A.prototype,"raster",void 0);var Z,k=A=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],A),N=Z=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,[{key:"clone",value:function(){return new Z({raster:this.raster})}}]),r}(k),F=N=Z=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],N),b=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionArguments=null,e.readingBufferSize=0,e}return(0,s.Z)(r,[{key:"bind",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this._getRasterValues(),n=0;n<r.length;n++){var o=r[n];if(o&&"object"==typeof o&&"bind"in o&&(!o.rasterInfo||t)){var i=o.bind(e,t);if(!i.success)return i}}return!this.rasterInfo||t?(this.sourceRasterInfos=this._getSourceRasterInfos(e),this._bindSourceRasters()):{success:!0}}},{key:"process",value:function(e){var t=this,r=this._getRasterValues().map((function(r){return t._readRasterValue(r,e)}));return this._processPixels((0,a.Z)((0,a.Z)({},e),{},{pixelBlocks:r}))}},{key:"getPrimaryRasters",value:function(){var e=[],t=[];return this._getPrimaryRasters(this,e,t),{rasters:e,rasterIds:t}}},{key:"_getOutputPixelType",value:function(e){var t;return"unknown"===this.outputPixelType?e:null!==(t=this.outputPixelType)&&void 0!==t?t:e}},{key:"_getRasterValues",value:function(){var e=this,t=this.rasterArgumentNames;return"rasters"===t[0]&&Array.isArray(this.functionArguments.rasters)?this.functionArguments.rasters:t.map((function(t){return e.functionArguments[t]}))}},{key:"_getSourceRasterInfos",value:function(e){var t=this._getRasterValues(),r=e.rasterInfos,n=e.rasterIds;return t.map((function(e){return e&&"object"==typeof e&&"bind"in e&&e.rasterInfo?e.rasterInfo:"string"==typeof e&&n.includes(e)?r[n.indexOf(e)]:r[0]}))}},{key:"_getPrimaryRasterId",value:function(e){return null===e||void 0===e?void 0:e.url}},{key:"_getPrimaryRasters",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=0;n<e.sourceRasters.length;n++){var o=e.sourceRasters[n];if("number"!=typeof o)if("bind"in o)this._getPrimaryRasters(o,t,r);else{var i=o,a=this._getPrimaryRasterId(i);if(null==a)continue;r.includes(a)||(this.mainPrimaryRasterId===a?(t.unshift(i),r.unshift(a)):(t.push(i),r.push(a)))}}}},{key:"_readRasterValue",value:function(e,t){var r=t.primaryPixelBlocks;if((0,f.t)(e)||"$$"===e){var n=r[0];return(0,f.t)(n)?null:n.clone()}if("string"==typeof e){var o=t.primaryRasterIds.indexOf(e);return-1===o?null:r[o]}if("number"==typeof e){var i=r[0];if((0,f.t)(i))return null;var a=new Float32Array(i.width*i.height);a.fill(e);var s=i.clone();return s.pixels=s.pixels.map((function(){return a})),s}return e.process(t)}}]),r}(v.l);(0,p.e)([(0,p.y)({json:{write:!0}})],b.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],b.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],b.prototype,"rasterArgumentNames",void 0),(0,p.e)([(0,p.y)({json:{write:!0}}),(0,p.c)((function(e){return null===e||void 0===e?void 0:e.toLowerCase()}))],b.prototype,"outputPixelType",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],b.prototype,"mainPrimaryRasterId",void 0),(0,p.e)([(0,p.y)()],b.prototype,"sourceRasters",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],b.prototype,"sourceRasterInfos",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],b.prototype,"rasterInfo",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],b.prototype,"readingBufferSize",void 0);var S=b=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.BaseRasterFunction")],b),T=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="Aspect",e.functionArguments=null,e.rasterArgumentNames=["raster"],e.isGCS=!1,e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e=this.sourceRasterInfos[0];this.isGCS=e.spatialReference.isGeographic,this.outputPixelType=this._getOutputPixelType("f32");var t=e.clone();return t.pixelType=this.outputPixelType,t.statistics=null,t.histograms=null,this.rasterInfo=t,{success:!0}}},{key:"_processPixels",value:function(e){var t,r=null===(t=e.pixelBlocks)||void 0===t?void 0:t[0];if((0,f.t)(r))return null;var n=e.extent,o=n?{x:n.width/r.width,y:n.height/r.height}:{x:1,y:1};return(0,y.o)(r,{resolution:o})}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],T.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:F,json:{write:!0,name:"rasterFunctionArguments"}})],T.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],T.prototype,"rasterArgumentNames",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],T.prototype,"isGCS",void 0);var R=T=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.AspectFunction")],T),I=new Set(["+","-","*","/","(",")"]);function B(e,t,r,n){if("number"==typeof r&&"number"==typeof n)return r+n;var o;if("number"==typeof r){o=n.length;var i=r;(r=new Float32Array(o)).fill(i)}else if(o=r.length,n.constructor===Number){var a=n;(n=new Float32Array(o)).fill(a)}var s=new Float32Array(o);switch(t){case"+":for(var u=0;u<o;u++)(null==e||e[u])&&(s[u]=r[u]+n[u]);break;case"-":for(var l=0;l<o;l++)(null==e||e[l])&&(s[l]=r[l]-n[l]);break;case"*":for(var c=0;c<o;c++)(null==e||e[c])&&(s[c]=r[c]*n[c]);break;case"/":for(var p=0;p<o;p++)(null==e||e[p])&&n[p]&&(s[p]=r[p]/n[p]);break;case"(":case")":throw"encountered error with custom band index equation"}return s}function P(e,t){e.splice(t,1);var r=0,n=0;do{r=0,n=0;for(var o=0;o<e.length;o++)if("("===e[o])r=o;else if(")"===e[o]){n=o;break}n===r+1&&e.splice(r,2)}while(n===r+1);return e}function M(e){if(1===e.length)return{opIndex:0,numIndex:0};for(var t=0,r=0,n=0;n<e.length;n++)if("("===e[n])t=n;else if(")"===e[n]){r=n;break}for(var o=0===r?e:e.slice(t+1,r),i=-1,a=0;a<o.length;a++)if("*"===o[a]||"/"===o[a]){i=a;break}if(i>-1)r>0&&(i+=t+1);else{for(var s=0;s<o.length;s++)if("+"===o[s]||"-"===o[s]){i=s;break}r>0&&(i+=t+1)}for(var u=0,l=0;l<i;l++)"("===e[l]&&u++;return{opIndex:i,numIndex:i-u}}function j(e,t,r){var n,o=function(e,t){(e=e.replace(/ /g,"")).startsWith("-")&&(e="0"+e),e.startsWith("+")&&(e=e.slice(1,e.length));for(var r=e.split(""),n=[],o=[],i="",a=0;a<r.length;a++){var s=r[a];if(I.has(s))""!==i&&o.push(parseFloat(i)),n.push(s),i="";else{if("b"===s.toLowerCase()){a++,i=s.concat(r[a]),o.push(t[parseInt(i[1],10)-1]),i="";continue}i=i.concat(s),a===r.length-1&&o.push(parseFloat(i))}}return{ops:n,nums:o}}(r,t),i=o.ops,a=o.nums;if(0===i.length){var s=1===a.length?a[0]:t[0];if(s instanceof Float32Array)return[s];var u=new Float32Array(t[0].length);return"number"==typeof s?u.fill(s):u.set(s),[u]}for(;i.length>0;){var l=M(i),c=l.numIndex,p=l.opIndex;if(n=B(e,i[p],a[c],a[c+1]),1===i.length)break;i=P(i,p),a.splice(c,2,n)}return[n]}var D,C=new m.s({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function E(e,t){var r;if(!(0,d.r)(e))return e;var n,o=t.equation,a=t.method,s=t.bandIndexes.map((function(e){return e-1})),u=e.pixels,l=e.mask;switch(a){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":n=_(l,u[s[0]],u[s[1]]);break;case"ndwi":n=_(l,u[s[1]],u[s[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":n=function(e,t,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==e||e[i]){var a=t[i],s=r[i];s&&(o[i]=a/s)}return[o]}(l,u[s[0]],u[s[1]]);break;case"ci-g":case"ci-re":n=function(e,t,r){for(var n=t.length,o=new Float32Array(n),i=0;i<n;i++)if(null==e||e[i]){var a=t[i],s=r[i];s&&(o[i]=a/s-1)}return[o]}(l,u[s[0]],u[s[1]]);break;case"savi":n=function(e,t,r,n){for(var o=r.length,i=new Float32Array(o),a=0;a<o;a++)if(null==e||e[a]){var s=r[a],u=t[a],l=u+s+n;l&&(i[a]=(u-s)/l*(1+n))}return[i]}(l,u[s[0]],u[s[1]],s[2]+1);break;case"tsavi":n=function(e,t,r,n,o,i){for(var a=r.length,s=new Float32Array(a),u=-o*n+i*(1+n*n),l=0;l<a;l++)if(null==e||e[l]){var c=r[l],p=t[l],f=o*p+c+u;f&&(s[l]=n*(p-n*c-o)/f)}return[s]}(l,u[s[0]],u[s[1]],s[2]+1,s[3]+1,s[4]+1);break;case"msavi":n=function(e,t,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==e||e[i]){var a=r[i],s=t[i];o[i]=.5*(2*(s+1)-Math.sqrt(Math.pow(2*s+1,2)-8*(s-a)))}return[o]}(l,u[s[0]],u[s[1]]);break;case"gemi":n=function(e,t,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==e||e[i]){var a=r[i],s=t[i];if(1!==a){var u=(2*(s*s-a*a)+1.5*s+.5*a)/(s+a+.5);o[i]=u*(1-.25*u)-(a-.125)/(1-a)}}return[o]}(l,u[s[0]],u[s[1]]);break;case"pvi":n=function(e,t,r,n,o){for(var i=r.length,a=new Float32Array(i),s=Math.sqrt(1+n*n),u=0;u<i;u++)if(null==e||e[u]){var l=r[u],c=t[u];a[u]=(c-n*l-o)/s}return[a]}(l,u[s[0]],u[s[1]],s[2]+1,s[3]+1);break;case"gvitm":n=function(e,t){for(var r=(0,i.Z)(t,6),n=r[0],o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],c=n.length,p=new Float32Array(c),f=0;f<c;f++)(null==e||e[f])&&(p[f]=-.2848*n[f]-.2435*o[f]-.5436*a[f]+.7243*s[f]+.084*u[f]-1.18*l[f]);return[p]}(l,[u[s[0]],u[s[1]],u[s[2]],u[s[3]],u[s[4]],u[s[5]]]);break;case"sultan":n=function(e,t){for(var r=(0,i.Z)(t,6),n=r[0],o=r[2],a=r[3],s=r[4],u=r[5],l=n.length,c=new Float32Array(l),p=new Float32Array(l),f=new Float32Array(l),v=0;v<l;v++)(null==e||e[v])&&(c[v]=u[v]?s[v]/u[v]*100:0,p[v]=n[v]?s[v]/n[v]*100:0,f[v]=a[v]?o[v]/a[v]*(s[v]/a[v])*100:0);return[c,p,f]}(l,[u[s[0]],u[s[1]],u[s[2]],u[s[3]],u[s[4]],u[s[5]]]);break;case"vari":n=function(e,t){for(var r=(0,i.Z)(t,3),n=r[0],o=r[1],a=r[2],s=n.length,u=new Float32Array(s),l=0;l<s;l++)if(null==e||e[l])for(l=0;l<s;l++){var c=n[l],p=o[l],f=p+c-a[l];f&&(u[l]=(p-c)/f)}return[u]}(l,[u[s[0]],u[s[1]],u[s[2]]]);break;case"mtvi2":n=function(e,t){for(var r=(0,i.Z)(t,3),n=r[0],o=r[1],a=r[2],s=n.length,u=new Float32Array(s),l=0;l<s;l++)if(null==e||e[l])for(l=0;l<s;l++){var c=n[l],p=o[l],f=a[l],v=Math.sqrt(Math.pow(2*c+1,2)-6*c-5*Math.sqrt(p)-.5);u[l]=1.5*(1.2*(c-f)-2.5*(p-f))*v}return[u]}(l,[u[s[0]],u[s[1]],u[s[2]]]);break;case"rtvi-core":n=function(e,t){for(var r=(0,i.Z)(t,3),n=r[0],o=r[1],a=r[2],s=n.length,u=new Float32Array(s),l=0;l<s;l++)if(null==e||e[l])for(l=0;l<s;l++){var c=n[l],p=o[l],f=a[l];u[l]=100*(c-p)-10*(c-f)}return[u]}(l,[u[s[0]],u[s[1]],u[s[2]]]);break;case"evi":n=function(e,t){for(var r=(0,i.Z)(t,3),n=r[0],o=r[1],a=r[2],s=n.length,u=new Float32Array(s),l=0;l<s;l++)if(null==e||e[l])for(l=0;l<s;l++){var c=n[l],p=o[l],f=c+6*p-7.5*a[l]+1;f&&(u[l]=2.5*(c-p)/f)}return[u]}(l,[u[s[0]],u[s[1]],u[s[2]]]);break;case"wndwi":n=function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=(0,i.Z)(t,3),o=n[0],a=n[1],s=n[2],u=a.length,l=new Float32Array(u),c=0;c<u;c++)if(null==e||e[c])for(c=0;c<u;c++){var p=o[c],f=a[c],v=s[c],y=p+r*f+(1-r)*v;y&&(l[c]=(p-r*f-(1-r)*v)/y)}return[l]}(l,[u[s[0]],u[s[1]],u[s[2]]],null!==(r=s[3])&&void 0!==r?r:.5);break;case"bai":n=function(e,t,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==e||e[i])for(i=0;i<n;i++){var a=Math.pow(.1-t[i],2)+Math.pow(.06-r[i],2);a&&(o[i]=1/a)}return[o]}(l,u[s[0]],u[s[1]]);break;case"custom":n=j(l,u,o);break;default:return e}var c=(0,f.r)(l)?new Uint8Array(l.length):null;(0,f.r)(l)&&(0,f.r)(c)&&c.set(l);var p=new d.g({width:e.width,height:e.height,pixelType:"f32",pixels:n,mask:c});return p.updateStatistics(),p}function _(e,t,r){for(var n=r.length,o=new Float32Array(n),i=0;i<n;i++)if(null==e||e[i]){var a=t[i],s=r[i],u=a+s;u&&(o[i]=(a-s)/u)}return[o]}var O=D=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).method="custom",e}return(0,s.Z)(r,[{key:"clone",value:function(){return new D({method:this.method,bandIndexes:this.bandIndexes,raster:(0,f.y)(this.raster)})}}]),r}(k);(0,p.e)([(0,p.y)({json:{type:String,write:!0}})],O.prototype,"bandIndexes",void 0),(0,p.e)([(0,h.r)(C)],O.prototype,"method",void 0);var G=O=D=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],O),L=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="BandArithmetic",e.functionArguments=null,e.rasterArgumentNames=["raster"],e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){this.outputPixelType=this._getOutputPixelType("f32");var e=this.sourceRasterInfos[0],t=e.clone();return t.pixelType=this.outputPixelType,t.statistics=null,t.histograms=null,t.bandCount="sultan"===this.functionArguments.method?e.bandCount:1,this.rasterInfo=t,{success:!0}}},{key:"_processPixels",value:function(e){var t,r=null===(t=e.pixelBlocks)||void 0===t?void 0:t[0];if((0,f.t)(r))return r;var n=this.functionArguments,o=n.method,i=n.bandIndexes,a=i.split(" ").map((function(e){return parseFloat(e)}));return E(r,{method:o,bandIndexes:a,equation:i})}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],L.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:G,json:{write:!0,name:"rasterFunctionArguments"}})],L.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],L.prototype,"rasterArgumentNames",void 0);var V,z=L=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.BandArithmeticFunction")],L),q=V=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,[{key:"readColorRamp",value:function(e){return(0,w.p)(e)}},{key:"clone",value:function(){var e;return new V({colormap:(0,f.y)(this.colormap),colormapName:this.colormapName,colorRamp:null===(e=this.colorRamp)||void 0===e?void 0:e.clone(),colorRampName:this.colorRampName})}}]),r}(k);(0,p.e)([(0,p.y)({type:[[Number]],json:{write:!0}})],q.prototype,"colormap",void 0),(0,p.e)([(0,p.y)({type:String,json:{write:!0}})],q.prototype,"colormapName",void 0),(0,p.e)([(0,p.y)({types:w.m,json:{write:!0}})],q.prototype,"colorRamp",void 0),(0,p.e)([(0,g.o)("colorRamp")],q.prototype,"readColorRamp",null),(0,p.e)([(0,p.y)({type:String,json:{write:!0}})],q.prototype,"colorRampName",void 0);var H=q=V=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],q),U=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="Colormap",e.functionArguments=null,e.rasterArgumentNames=["raster"],e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e,t,r=this.sourceRasterInfos[0];if(r.bandCount>1)return{success:!1,error:"colormap-function: source data must be single band"};var n=this.functionArguments,o=n.colormap,i=n.colorRamp;if(null!==(e=o)&&void 0!==e&&e.length||i&&(o=(0,y.c)(i,256,!0)),null===(t=o)||void 0===t||!t.length)return{success:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");var a=r.clone();return a.pixelType=this.outputPixelType,a.colormap=o,this.rasterInfo=a,{success:!0}}},{key:"_processPixels",value:function(e){var t;return null===(t=e.pixelBlocks)||void 0===t?void 0:t[0]}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],U.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],U.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],U.prototype,"rasterArgumentNames",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],U.prototype,"indexedColormap",void 0);var X,W=U=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.ColormapFunction")],U),J=X=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,[{key:"writeRasters",value:function(e,t){t.rasters=e.map((function(e){return"number"==typeof e||"string"==typeof e?e:e.toJSON()}))}},{key:"clone",value:function(){return new X({rasters:(0,f.y)(this.rasters)})}}]),r}(k);(0,p.e)([(0,p.y)({json:{write:!0}})],J.prototype,"rasters",void 0),(0,p.e)([(0,g.r)("rasters")],J.prototype,"writeRasters",null);var Y=J=X=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],J),K=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="CompositeBand",e.functionArguments=null,e.rasterArgumentNames=["rasters"],e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e=this.sourceRasterInfos,t=e[0];this.outputPixelType=this._getOutputPixelType(t.pixelType);var r=t.clone();if(r.attributeTable=null,r.colormap=null,r.pixelType=this.outputPixelType,r.bandCount=e.map((function(e){return e.bandCount})).reduce((function(e,t){return e+t})),e.every((function(e){var t=e.statistics;return(0,f.r)(t)&&t.length}))){var n=[];e.forEach((function(e){var t=e.statistics;return(0,f.r)(t)&&n.push.apply(n,(0,o.Z)(t))})),r.statistics=n}if(e.every((function(e){var t=e.histograms;return(0,f.r)(t)&&t.length}))){var i=[];e.forEach((function(e){var t=e.histograms;return(0,f.r)(t)&&i.push.apply(i,(0,o.Z)(t))})),r.histograms=i}return this.rasterInfo=r,{success:!0}}},{key:"_processPixels",value:function(e){var t=e.pixelBlocks;if(!t)return null;var r=null===t||void 0===t?void 0:t[0];return(0,f.t)(r)?null:(0,d.h)(t)}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],K.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:Y,json:{write:!0,name:"rasterFunctionArguments"}})],K.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],K.prototype,"rasterArgumentNames",void 0);var $,Q=K=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.CompositeBandFunction")],K);!function(e){e[e.UserDefined=-1]="UserDefined",e[e.LineDetectionHorizontal=0]="LineDetectionHorizontal",e[e.LineDetectionVertical=1]="LineDetectionVertical",e[e.LineDetectionLeftDiagonal=2]="LineDetectionLeftDiagonal",e[e.LineDetectionRightDiagonal=3]="LineDetectionRightDiagonal",e[e.GradientNorth=4]="GradientNorth",e[e.GradientWest=5]="GradientWest",e[e.GradientEast=6]="GradientEast",e[e.GradientSouth=7]="GradientSouth",e[e.GradientNorthEast=8]="GradientNorthEast",e[e.GradientNorthWest=9]="GradientNorthWest",e[e.SmoothArithmeticMean=10]="SmoothArithmeticMean",e[e.Smoothing3x3=11]="Smoothing3x3",e[e.Smoothing5x5=12]="Smoothing5x5",e[e.Sharpening3x3=13]="Sharpening3x3",e[e.Sharpening5x5=14]="Sharpening5x5",e[e.Laplacian3x3=15]="Laplacian3x3",e[e.Laplacian5x5=16]="Laplacian5x5",e[e.SobelHorizontal=17]="SobelHorizontal",e[e.SobelVertical=18]="SobelVertical",e[e.Sharpen=19]="Sharpen",e[e.Sharpen2=20]="Sharpen2",e[e.PointSpread=21]="PointSpread",e[e.None=255]="None"}($||($={}));var ee,te=new Map;function re(e,t,r,n,o,i,a){for(var s=new Float32Array(t*r),u=i.length,l=a?0:n,c=a?n:0,p=a?1:t,f=l;f<r-l;f++)for(var v=f*t,y=c;y<t-c;y++)if(!o||o[v+y]){for(var h=0,m=0;m<u;m++)h+=e[v+y+(m-n)*p]*i[m];s[v+y]=h}return s}function ne(e,t,r,n,o,i,a){for(var s=new Float32Array(t*r),u=Math.floor(n/2),l=Math.floor(o/2),c=u;c<r-u;c++)for(var p=c*t,f=l;f<t-l;f++)if(!i||i[p+f]){for(var v=0,y=0;y<n;y++)for(var h=0;h<o;h++)v+=e[p+f+(y-u)*t+h-l]*a[y*o+h];s[p+f]=v}return s}function oe(e,t,r,n,o){for(var i=Math.floor(n/2),a=0;a<i;a++)for(var s=0;s<t;s++)e[a*t+s]=e[(o-1-a)*t+s],e[(r-1-a)*t+s]=e[(r-o+a)*t+s];for(var u=Math.floor(o/2),l=0;l<r;l++)for(var c=l*t,p=0;p<u;p++)e[c+p]=e[c+o-1-p],e[c+t-p-1]=e[c+t+p-o]}function ie(e,t){var r=function(e){for(var t=Math.sqrt(e.length),r=e.slice(0,t),n=[1],o=1;o<t;o++){for(var i=null,a=0;a<t;a++){var s=e[a+o*t],u=e[a];if(null==i)if(0===u){if(s)return{separable:!1,row:null,col:null}}else i=s/u;else if(s/u!==i)return{separable:!1,row:null,col:null}}if(null==i)return{separable:!1,row:null,col:null};n.push(i)}return{separable:!0,row:r,col:n}}(t.kernel),n=!1!==t.mirrorEdges,o=r.separable?function(e,t,r){for(var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=e.pixels,i=e.width,a=e.height,s=e.pixelType,u=e.mask,l=o.length,c=[],p=t.length,f=r.length,v=Math.floor(p/2),y=Math.floor(f/2),h=0;h<l;h++){var m=re(o[h],i,a,v,u,t,!0);m=re(m,i,a,y,u,r,!1),n&&oe(m,i,a,p,f),c.push(m)}return new d.g({width:i,height:a,pixelType:s,pixels:c,mask:u})}(e,r.row,r.col,n):function(e,t){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e.pixels,o=e.width,i=e.height,a=e.pixelType,s=e.mask,u=n.length,l=[],c=t.kernel,p=t.rows,f=t.cols,v=0;v<u;v++){var y=ne(n[v],o,i,p,f,s,c);r&&oe(y,o,i,p,f),l.push(y)}return new d.g({width:o,height:i,pixelType:a,pixels:l,mask:s})}(e,t,n),i=t.outputPixelType;return i&&o.clamp(i),o}te.set($.None,[0,0,0,0,1,0,0,0,0]),te.set($.LineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),te.set($.LineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),te.set($.LineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),te.set($.LineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),te.set($.GradientNorth,[-1,-2,-1,0,0,0,1,2,1]),te.set($.GradientWest,[-1,0,1,-2,0,2,-1,0,1]),te.set($.GradientEast,[1,0,-1,2,0,-2,1,0,-1]),te.set($.GradientSouth,[1,2,1,0,0,0,-1,-2,-1]),te.set($.GradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),te.set($.GradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),te.set($.SmoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),te.set($.Smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),te.set($.Smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),te.set($.Sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),te.set($.Sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),te.set($.Laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),te.set($.Laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),te.set($.SobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),te.set($.SobelVertical,[-1,0,1,-2,0,2,-1,0,1]),te.set($.Sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),te.set($.Sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),te.set($.PointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);var ae=ee=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).rows=3,e.cols=3,e.kernel=[0,0,0,0,1,0,0,0,0],e}return(0,s.Z)(r,[{key:"kernelType",set:function(e){this._set("kernelType",e);var t=te.get(e);if(t&&e!==$.UserDefined&&e!==$.None){var r=Math.sqrt(t.length);this._set("kernel",t),this._set("cols",r),this._set("rows",r)}}},{key:"clone",value:function(){return new ee({cols:this.cols,rows:this.rows,kernel:(0,o.Z)(this.kernel),kernelType:this.kernelType,raster:(0,f.y)(this.raster)})}}]),r}(k);(0,p.e)([(0,p.y)({json:{type:Number,write:!0}})],ae.prototype,"rows",void 0),(0,p.e)([(0,p.y)({json:{type:Number,write:!0}})],ae.prototype,"cols",void 0),(0,p.e)([(0,p.y)({json:{name:"type",type:Number,write:!0}})],ae.prototype,"kernelType",null),(0,p.e)([(0,p.y)({json:{type:[Number],write:!0}})],ae.prototype,"kernel",void 0);var se=ae=ee=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],ae),ue=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="Convolution",e.rasterArgumentNames=["raster"],e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e=this.functionArguments,t=e.kernelType,r=e.rows,n=e.cols,o=e.kernel;if(!te.has(t))return{success:!1,error:"convolution-function: the specified kernel type is not supported ".concat(t)};if(t!==$.None&&r*n!==o.length)return{success:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var i=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(i.pixelType);var a=i.clone();a.pixelType=this.outputPixelType;var s=[$.None,$.Sharpen,$.Sharpen2,$.Sharpening3x3,$.Sharpening5x5];return"u8"===this.outputPixelType||s.includes(t)||(a.statistics=null,a.histograms=null),this.rasterInfo=a,{success:!0}}},{key:"_processPixels",value:function(e){var t,r=null===(t=e.pixelBlocks)||void 0===t?void 0:t[0];if((0,f.t)(r)||this.functionArguments.kernelType===$.None)return r;var n=this.functionArguments,o=n.kernel,i=n.rows,a=n.cols,s=o.reduce((function(e,t){return e+t}));return 0!==s&&1!==s&&(o=o.map((function(e){return e/s}))),ie(r,{kernel:o,rows:i,cols:a,outputPixelType:this.outputPixelType})}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],ue.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:se,json:{write:!0,name:"rasterFunctionArguments"}})],ue.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],ue.prototype,"rasterArgumentNames",void 0);var le,ce=ue=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.ConvolutionFunction")],ue),pe=le=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).bandIDs=[],e.missingBandAction=d.o.bestMatch,e}return(0,s.Z)(r,[{key:"clone",value:function(){return new le({bandIDs:(0,o.Z)(this.bandIDs),missingBandAction:this.missingBandAction})}}]),r}(k);(0,p.e)([(0,p.y)({json:{write:!0}})],pe.prototype,"bandIDs",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],pe.prototype,"missingBandAction",void 0);var fe=pe=le=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],pe),ve=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="ExtractBand",e.functionArguments=null,e.rasterArgumentNames=["raster"],e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e=this.sourceRasterInfos[0],t=e.bandCount,r=this.functionArguments,n=r.bandIDs;if(r.missingBandAction===d.o.fail&&n.some((function(e){return e<0||e>=t})))return{success:!1,error:"extract-band-function: invalid bandIDs"};this.outputPixelType=this._getOutputPixelType("f32");var o=e.clone();o.pixelType=this.outputPixelType;var i=o.statistics,a=o.histograms;return(0,f.r)(i)&&i.length&&(o.statistics=n.map((function(e){return i[e]||i[i.length-1]}))),(0,f.r)(a)&&a.length&&(o.histograms=n.map((function(e){return a[e]||a[a.length-1]}))),this.rasterInfo=o,{success:!0}}},{key:"_processPixels",value:function(e){var t,r=null===(t=e.pixelBlocks)||void 0===t?void 0:t[0];if((0,f.t)(r))return null;var n=r.pixels.length,o=this.functionArguments.bandIDs.map((function(e){return e>=n?n-1:e}));return r.extractBands(o)}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],ve.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:fe,json:{write:!0,name:"rasterFunctionArguments"}})],ve.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],ve.prototype,"rasterArgumentNames",void 0);var ye,he=ve=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.ExtractBandFunction")],ve),me=ye=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).rasters=[],e.processAsMultiband=!1,e}return(0,s.Z)(r,[{key:"writeRasters",value:function(e,t){t.rasters=e.map((function(e){return"number"==typeof e||"string"==typeof e?e:e.toJSON()}))}},{key:"clone",value:function(){return new ye({method:this.operation,processAsMultiband:this.processAsMultiband,rasters:(0,f.y)(this.rasters)})}}]),r}(k);(0,p.e)([(0,p.y)({json:{write:!0}})],me.prototype,"operation",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],me.prototype,"rasters",void 0),(0,p.e)([(0,g.r)("rasters")],me.prototype,"writeRasters",null),(0,p.e)([(0,p.y)({json:{write:!0}})],me.prototype,"processAsMultiband",void 0);var de,ge=me=ye=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.LocalFunctionArguments")],me);function we(e){var t=e.map((function(e){return e.mask})).filter((function(e){return(0,f.r)(e)}));if(0===t.length)return null;var r=t[0].length,n=new Uint8Array(r);if(1===t.length)return n.set(t[0]),n;for(var o,i=t[0],a=1;a<t.length;a++){o=t[a];for(var s=0;s<r;s++)n[s]=i[s]|o[s];i=o}return n}function xe(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]+a[l]);return u}function Ae(e,t,r){var n=(0,i.Z)(e,1)[0],o=n.length,a=d.g.createEmptyBand("f32",o);return a.set(n),a}function Ze(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]-a[l]);return u}function ke(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]*a[l]);return u}function Ne(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=0===a[l]?0:o[l]/a[l]);return u}function Fe(e,t,r){return Ne(e,t,"f32")}function be(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=0===a[l]?0:Math.floor(o[l]/a[l]));return u}function Se(e,t,r,n){for(var o=(0,i.Z)(e,1)[0],a=o.length,s=d.g.createEmptyBand(r,a),u=0;u<a;u++)t&&!t[u]||(s[u]=n(o[u]));return s}function Te(e,t,r,n){for(var o=(0,i.Z)(e,2),a=o[0],s=o[1],u=a.length,l=d.g.createEmptyBand(r,u),c=0;c<u;c++)t&&!t[c]||(l[c]=n(a[c],s[c]));return l}function Re(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]&a[l]);return u}function Ie(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]<<a[l]);return u}function Be(e,t,r){for(var n=(0,i.Z)(e,1)[0],o=n.length,a=d.g.createEmptyBand(r,o),s=0;s<o;s++)t&&!t[s]||(a[s]=~n[s]);return a}function Pe(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]|a[l]);return u}function Me(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]>>a[l]);return u}function je(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]^a[l]);return u}function De(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]&&a[l]?1:0);return u}function Ce(e,t,r){for(var n=(0,i.Z)(e,1)[0],o=n.length,a=d.g.createEmptyBand(r,o),s=0;s<o;s++)t&&!t[s]||(a[s]=n[s]?0:1);return a}function Ee(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]||a[l]?1:0);return u}function _e(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=(o[l]?1:0)^(a[l]?1:0));return u}function Oe(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]===a[l]?1:0);return u}function Ge(e,t,r,n){for(var o=(0,i.Z)(e,1)[0],a=o.length,s=d.g.createEmptyBand(r,a),u=0;u<a;u++)t&&!t[u]||(s[u]=Math.pow(n,o[u]));return s}function Le(e,t,r){return Ge(e,t,r,10)}function Ve(e,t,r){return Ge(e,t,r,2)}function ze(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]>a[l]?1:0);return u}function qe(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]>=a[l]?1:0);return u}function He(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]<a[l]?1:0);return u}function Ue(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]<=a[l]?1:0);return u}function Xe(e,t,r){var n=(0,i.Z)(e,1)[0].length,o=d.g.createEmptyBand(r,n);if(!t)return o;for(var a=0;a<n;a++)o[a]=t[a]?0:1;return o}function We(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]%a[l]);return u}function Je(e,t,r){for(var n=(0,i.Z)(e,1)[0],o=n.length,a=d.g.createEmptyBand(r,o),s=0;s<o;s++)t&&!t[s]||(a[s]=-n[s]);return a}function Ye(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=0;l<s;l++)t&&!t[l]||(u[l]=o[l]===a[l]?0:1);return u}function Ke(e,t,r){for(var n=(0,i.Z)(e,2),o=n[0],a=n[1],s=o.length,u=d.g.createEmptyBand(r,s),l=new Uint8Array(s),c=0;c<s;c++)null!=t&&!t[c]||0!==o[c]||(u[c]=a[c],l[c]=255);return{band:u,mask:l}}function $e(e,t,r){for(var n=(0,i.Z)(e,3),o=n[0],a=n[1],s=n[2],u=o.length,l=d.g.createEmptyBand(r,u),c=0;c<u;c++)t&&!t[c]||(l[c]=o[c]?a[c]:s[c]);return l}function Qe(e,t,r){var n=e.length;if(n<2)return e[0];var o=(0,i.Z)(e,1)[0],a=o.length,s=d.g.createEmptyBand(r,a);s.set(o);for(var u=0;u<a;u++)if(!t||t[u])for(var l=1;l<n;l++){var c=e[l];s[u]<c[u]&&(s[u]=c[u])}return s}function et(e,t,r){var n=e.length;if(n<2)return e[0];var o=(0,i.Z)(e,1)[0],a=o.length,s=d.g.createEmptyBand(r,a);s.set(o);for(var u=0;u<a;u++)if(!t||t[u])for(var l=1;l<n;l++){var c=e[l];s[u]>c[u]&&(s[u]=c[u])}return s}function tt(e,t,r){var n=e.length;if(n<2)return e[0];var o=(0,i.Z)(e,1)[0],a=o.length,s=d.g.createEmptyBand(r,a);s.set(o);for(var u=0;u<a;u++)if(!t||t[u]){for(var l=s[u],c=1;c<n;c++){var p=e[c];s[u]<p[u]&&(s[u]=p[u]),l>p[u]&&(l=p[u])}s[u]-=l}return s}function rt(e,t,r){var n=e.length;if(n<2)return e[0];var o=(0,i.Z)(e,1)[0],a=o.length,s=d.g.createEmptyBand(r,a);s.set(o);for(var u=0;u<a;u++)if(!t||t[u]){for(var l=1;l<n;l++){var c=e[l];s[u]+=c[u]}s[u]/=n}return s}function nt(e,t,r){var n=e.length;if(n<2)return e[0];var o=(0,i.Z)(e,1)[0],a=o.length,s=d.g.createEmptyBand(r,a);s.set(o);for(var u=0;u<a;u++)if(!t||t[u])for(var l=1;l<n;l++){var c=e[l];s[u]+=c[u]}return s}function ot(e,t,r){var n=e.length;if(n<2)return e[0];for(var o=(0,i.Z)(e,1)[0].length,a=d.g.createEmptyBand(r,o),s=0;s<o;s++)if(!t||t[s]){for(var u=new Float32Array(n),l=0,c=0;c<n;c++){var p=e[c];l+=p[s],u[c]=p[s]}l/=n;for(var f=0,v=0;v<n;v++)f+=(u[v]-l)*u[v]-l;a[s]=Math.sqrt(f/n-1)}return a}function it(e,t,r){var n=e.length;if(n<2)return e[0];for(var o=Math.floor(n/2),a=(0,i.Z)(e,1)[0].length,s=d.g.createEmptyBand(r,a),u=new Float32Array(n),l=0;l<a;l++)if(!t||t[l]){for(var c=0;c<n;c++)u[c]=e[c][l];u.sort(),s[l]=u[o]}return s}function at(e,t,r){var o=e.length;if(o<2)return e[0];for(var a=(0,i.Z)(e,1)[0].length,s=d.g.createEmptyBand(r,a),u=new Map,l=0;l<a;l++)if(!t||t[l]){var c=void 0;u.clear();for(var p=0;p<o;p++)c=e[p][l],u.set(c,u.has(c)?u.get(c)+1:1);var f,v=0,y=0,h=(0,n.Z)(u.keys());try{for(h.s();!(f=h.n()).done;){var m=f.value;(v=u.get(m))>y&&(y=v,c=m)}}catch(g){h.e(g)}finally{h.f()}s[l]=c}return s}function st(e,t,r){var o=e.length;if(o<2)return e[0];for(var a=(0,i.Z)(e,1)[0].length,s=d.g.createEmptyBand(r,a),u=new Map,l=0;l<a;l++)if(!t||t[l]){var c=void 0;u.clear();for(var p=0;p<o;p++)c=e[p][l],u.set(c,u.has(c)?u.get(c)+1:1);var f,v=0,y=e.length,h=(0,n.Z)(u.keys());try{for(h.s();!(f=h.n()).done;){var m=f.value;(v=u.get(m))<y&&(y=v,c=m)}}catch(g){h.e(g)}finally{h.f()}s[l]=c}return s}function ut(e,t,r){var n=e.length;if(n<2)return e[0];for(var o=(0,i.Z)(e,1)[0].length,a=d.g.createEmptyBand(r,o),s=new Set,u=0;u<o;u++)if(!t||t[u]){var l=void 0;s.clear();for(var c=0;c<n;c++)l=e[c][u],s.add(l);a[u]=s.size}return a}function lt(e,t,r){return at(e,null,r)}function ct(e,t,r){return st(e,null,r)}function pt(e,t,r){return ut(e,null,r)}function ft(e,t,r){return Qe(e,null,r)}function vt(e,t,r){return et(e,null,r)}function yt(e,t,r){return ot(e,null,r)}function ht(e,t,r){return nt(e,null,r)}function mt(e,t,r){return rt(e,null,r)}function dt(e,t,r){return it(e,null,r)}function gt(e,t,r){return tt(e,null,r)}!function(e){e[e.Plus=1]="Plus",e[e.Minus=2]="Minus",e[e.Times=3]="Times",e[e.SquareRoot=4]="SquareRoot",e[e.Power=5]="Power",e[e.ACos=6]="ACos",e[e.ASin=7]="ASin",e[e.ATan=8]="ATan",e[e.ATanH=9]="ATanH",e[e.Abs=10]="Abs",e[e.BitwiseAnd=11]="BitwiseAnd",e[e.BitwiseLeftShift=12]="BitwiseLeftShift",e[e.BitwiseNot=13]="BitwiseNot",e[e.BitwiseOr=14]="BitwiseOr",e[e.BitwiseRightShift=15]="BitwiseRightShift",e[e.BitwiseXOr=16]="BitwiseXOr",e[e.BooleanAnd=17]="BooleanAnd",e[e.BooleanNot=18]="BooleanNot",e[e.BooleanOr=19]="BooleanOr",e[e.BooleanXOr=20]="BooleanXOr",e[e.Cos=21]="Cos",e[e.CosH=22]="CosH",e[e.Divide=23]="Divide",e[e.EqualTo=24]="EqualTo",e[e.Exp=25]="Exp",e[e.Exp10=26]="Exp10",e[e.Exp2=27]="Exp2",e[e.GreaterThan=28]="GreaterThan",e[e.GreaterThanEqual=29]="GreaterThanEqual",e[e.Int=30]="Int",e[e.IsNull=31]="IsNull",e[e.Float=32]="Float",e[e.LessThan=33]="LessThan",e[e.LessThanEqual=34]="LessThanEqual",e[e.Ln=35]="Ln",e[e.Log10=36]="Log10",e[e.Log2=37]="Log2",e[e.Majority=38]="Majority",e[e.Max=39]="Max",e[e.Mean=40]="Mean",e[e.Med=41]="Med",e[e.Min=42]="Min",e[e.Minority=43]="Minority",e[e.Mod=44]="Mod",e[e.Negate=45]="Negate",e[e.NotEqual=46]="NotEqual",e[e.Range=47]="Range",e[e.RoundDown=48]="RoundDown",e[e.RoundUp=49]="RoundUp",e[e.SetNull=50]="SetNull",e[e.Sin=51]="Sin",e[e.SinH=52]="SinH",e[e.Square=53]="Square",e[e.Std=54]="Std",e[e.Sum=55]="Sum",e[e.Tan=56]="Tan",e[e.TanH=57]="TanH",e[e.Variety=58]="Variety",e[e.ACosH=59]="ACosH",e[e.ASinH=60]="ASinH",e[e.ATan2=61]="ATan2",e[e.FloatDivide=64]="FloatDivide",e[e.FloorDivide=65]="FloorDivide",e[e.MajorityIgnoreNoData=66]="MajorityIgnoreNoData",e[e.MaxIgnoreNoData=67]="MaxIgnoreNoData",e[e.MeanIgnoreNoData=68]="MeanIgnoreNoData",e[e.MedIgnoreNoData=69]="MedIgnoreNoData",e[e.MinIgnoreNoData=70]="MinIgnoreNoData",e[e.MinorityIgnoreNoData=71]="MinorityIgnoreNoData",e[e.RangeIgnoreNoData=72]="RangeIgnoreNoData",e[e.StdIgnoreNoData=73]="StdIgnoreNoData",e[e.SumIgnoreNoData=74]="SumIgnoreNoData",e[e.VarietyIgnoreNoData=75]="VarietyIgnoreNoData",e[e.Con=76]="Con"}(de||(de={}));var wt=new Map,xt=new Map,At=new Map;function Zt(){wt.size||(wt.set(4,Math.sqrt),wt.set(6,Math.acos),wt.set(7,Math.asin),wt.set(8,Math.atan),wt.set(9,Math.atanh),wt.set(10,Math.abs),wt.set(21,Math.cos),wt.set(22,Math.cosh),wt.set(25,Math.exp),wt.set(30,Math.floor),wt.set(35,Math.log),wt.set(36,Math.log10),wt.set(37,Math.log2),wt.set(48,Math.floor),wt.set(49,Math.ceil),wt.set(51,Math.sin),wt.set(52,Math.sinh),wt.set(56,Math.tan),wt.set(57,Math.tanh),wt.set(59,Math.acosh),wt.set(60,Math.asinh),wt.set(65,Math.floor),xt.set(5,Math.pow),xt.set(61,Math.atan2),At.set(1,xe),At.set(2,Ze),At.set(3,ke),At.set(11,Re),At.set(12,Ie),At.set(12,Ie),At.set(13,Be),At.set(14,Pe),At.set(15,Me),At.set(16,je),At.set(17,De),At.set(18,Ce),At.set(19,Ee),At.set(20,_e),At.set(23,Ne),At.set(24,Oe),At.set(26,Le),At.set(27,Ve),At.set(28,ze),At.set(29,qe),At.set(31,Xe),At.set(32,Ae),At.set(33,He),At.set(34,Ue),At.set(44,We),At.set(45,Je),At.set(46,Ye),At.set(64,Fe),At.set(65,be),At.set(76,$e),At.set(38,at),At.set(39,Qe),At.set(40,rt),At.set(41,it),At.set(42,et),At.set(43,st),At.set(47,tt),At.set(54,ot),At.set(55,nt),At.set(58,ut),At.set(66,lt),At.set(67,ft),At.set(68,mt),At.set(69,dt),At.set(70,vt),At.set(71,ct),At.set(72,gt),At.set(73,yt),At.set(74,ht),At.set(75,pt))}var kt=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="Local",e.functionArguments=null,e.rasterArgumentNames=["rasters"],e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e=this.sourceRasterInfos,t=e[0],r=t.bandCount,n=this.functionArguments.processAsMultiband;if(n&&e.some((function(e){return e.bandCount!==r})))return{success:!1,error:"local-function: input rasters do not have same band count"};this.outputPixelType=this._getOutputPixelType("f32");var o=t.clone();return o.pixelType=this.outputPixelType,o.statistics=null,o.histograms=null,n||(o.bandCount=1),this.rasterInfo=o,{success:!0}}},{key:"_processPixels",value:function(e){var t,r=e.pixelBlocks;return(0,f.t)(r)||r.some((function(e){return(0,f.t)(e)}))?null:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Zt();for(var n,o=(0,f.e)(we(e)),i=r.processAsMultiband,a=r.outputPixelType,s=void 0===a?"f32":a,u=i?e[0].pixels.length:1,l=[],c=function(r){var i=e.map((function(e){return e.pixels[r]})),a=void 0;if(t===de.SetNull){var u=Ke(i,o,s);a=u.band,n=u.mask}else At.has(t)?a=At.get(t)(i,o,s):wt.has(t)?a=Se(i,o,s,wt.get(t)):xt.has(t)&&(a=Te(i,o,s,xt.get(t)));if(null==a)return{v:null};l.push(a)},p=0;p<u;p++){var v=c(p);if("object"===typeof v)return v.v}n||t===de.IsNull||(n=o);var y=e[0];return new d.g({width:y.width,height:y.height,pixelType:s,mask:n,pixels:l})}(r,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:null!==(t=this.outputPixelType)&&void 0!==t?t:void 0})}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],kt.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:ge,json:{write:!0,name:"rasterFunctionArguments"}})],kt.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],kt.prototype,"rasterArgumentNames",void 0);var Nt,Ft=kt=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.LocalFunction")],kt),bt=Nt=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).includedRanges=null,e.noDataValues=null,e.noDataInterpretation=d.i.matchAny,e}return(0,s.Z)(r,[{key:"clone",value:function(){var e,t,r,n;return new Nt({includedRanges:null!==(e=null===(t=this.includedRanges)||void 0===t?void 0:t.slice())&&void 0!==e?e:[],noDataValues:null!==(r=null===(n=this.noDataValues)||void 0===n?void 0:n.slice())&&void 0!==r?r:[],noDataInterpretation:this.noDataInterpretation})}}]),r}(k);(0,p.e)([(0,p.y)({json:{write:!0}})],bt.prototype,"includedRanges",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],bt.prototype,"noDataValues",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],bt.prototype,"noDataInterpretation",void 0);var St=bt=Nt=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.MaskFunctionArguments")],bt),Tt=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="Mask",e.functionArguments=null,e.rasterArgumentNames=["raster"],e.lookup=null,e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e=this.sourceRasterInfos[0].clone(),t=e.pixelType;this.outputPixelType=this._getOutputPixelType(t),e.pixelType=this.outputPixelType,this.rasterInfo=e;var r=this.functionArguments,n=r.includedRanges,o=r.noDataValues;return null!==n&&void 0!==n&&n.length||null!==o&&void 0!==o&&o.length?(this.lookup=(0,d.k)(t,this.functionArguments.includedRanges,this.functionArguments.noDataValues),{success:!0}):{success:!1,error:"missing includedRanges or noDataValues argument"}}},{key:"_processPixels",value:function(e){var t,r=null===(t=e.pixelBlocks)||void 0===t?void 0:t[0];if((0,f.t)(r))return null;var n=this.outputPixelType,o=this.lookup,i=this.functionArguments,a=i.includedRanges,s=i.noDataValues,u=i.noDataInterpretation===d.i.matchAll;return(0,d.y)(r,{includedRanges:a,noDataValues:s,outputPixelType:n,matchAll:u,lookup:o})}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],Tt.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:St,json:{write:!0,name:"rasterFunctionArguments"}})],Tt.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],Tt.prototype,"rasterArgumentNames",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],Tt.prototype,"lookup",void 0);var Rt,It=Tt=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.MaskFunction")],Tt),Bt=Rt=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).visibleBandID=0,e.infraredBandID=1,e.scaled=!0,e}return(0,s.Z)(r,[{key:"clone",value:function(){var e=this.visibleBandID,t=this.infraredBandID,r=this.scaled;return new Rt({visibleBandID:e,infraredBandID:t,scaled:r})}}]),r}(k);(0,p.e)([(0,p.y)({json:{write:!0}})],Bt.prototype,"visibleBandID",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],Bt.prototype,"infraredBandID",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],Bt.prototype,"scaled",void 0);var Pt=Bt=Rt=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],Bt),Mt=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="NDVI",e.functionArguments=null,e.rasterArgumentNames=["raster"],e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e=this.functionArguments.scaled;this.outputPixelType=this._getOutputPixelType(e?"u8":"f32");var t=this.sourceRasterInfos[0].clone();t.pixelType=this.outputPixelType,t.colormap=null,t.histograms=null;var r=e?[0,200,100,10]:[-1,1,0,.1],n=(0,i.Z)(r,4),o=n[0],a=n[1],s=n[2],u=n[3];return t.statistics=[{min:o,max:a,avg:s,stddev:u}],this.rasterInfo=t,{success:!0}}},{key:"_processPixels",value:function(e){var t,r=null===(t=e.pixelBlocks)||void 0===t?void 0:t[0];if((0,f.t)(r))return null;var n=this.functionArguments;return function(e,t,r,n){for(var o=e.mask,i=e.pixels,a=e.width,s=e.height,u=i[r],l=i[t],c=l.length,p=n?new Uint8Array(c):new Float32Array(c),f=n?100:1,v=n?100:0,y=0;y<c;y++)if(null==o||o[y]){var h=u[y],m=l[y],g=h+m;g&&(p[y]=(h-m)/g*f+v)}var w=new d.g({width:a,height:s,mask:o,pixelType:n?"u8":"f32",pixels:[p]});return w.updateStatistics(),w}(r,n.visibleBandID,n.infraredBandID,n.scaled)}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],Mt.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:Pt,json:{write:!0,name:"rasterFunctionArguments"}})],Mt.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],Mt.prototype,"rasterArgumentNames",void 0);var jt,Dt=Mt=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.NDVIFunction")],Mt),Ct=jt=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).inputRanges=null,e.outputValues=null,e.noDataRanges=null,e.allowUnmatched=!1,e}return(0,s.Z)(r,[{key:"clone",value:function(){return new jt({inputRanges:(0,o.Z)(this.inputRanges),outputValues:(0,o.Z)(this.outputValues),noDataRanges:(0,o.Z)(this.noDataRanges),allowUnmatched:this.allowUnmatched})}}]),r}(k);(0,p.e)([(0,p.y)({json:{write:!0}})],Ct.prototype,"inputRanges",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],Ct.prototype,"outputValues",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],Ct.prototype,"noDataRanges",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],Ct.prototype,"allowUnmatched",void 0);var Et=Ct=jt=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.RemapFunctionArguments")],Ct),_t=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="Remap",e.functionArguments=null,e.rasterArgumentNames=["raster"],e.lookup=null,e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e=this.sourceRasterInfos[0].clone(),t=e.pixelType;this.outputPixelType=this._getOutputPixelType(t),e.pixelType=this.outputPixelType,e.colormap=null,e.histograms=null;var r=e.statistics,n=this.functionArguments,o=n.allowUnmatched,i=n.outputValues;if((0,f.r)(r)&&r.length&&!o){for(var s=i[0],u=s,l=0;l<i.length;l++)s=s>i[l]?i[l]:s,u=u>i[l]?u:i[l];for(var c=0;c<r.length;c++)r[c]=(0,a.Z)((0,a.Z)({},r[c]),{},{min:s,max:u})}return this.rasterInfo=e,this.lookup=o?null:(0,d.w)(t,this.functionArguments.inputRanges,i),{success:!0}}},{key:"_processPixels",value:function(e){var t,r=null===(t=e.pixelBlocks)||void 0===t?void 0:t[0];if((0,f.t)(r))return null;var n=this.lookup,o=this.outputPixelType;if(n)return(0,d.c)(r,{lut:[n.lut],offset:n.offset,outputPixelType:o});var i=this.functionArguments,a=i.inputRanges,s=i.outputValues,u=i.noDataRanges,l=i.allowUnmatched;return(0,d.x)(r,{inputRanges:a,outputValues:s,noDataRanges:u,allowUnmatched:l,outputPixelType:o})}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],_t.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:Et,json:{write:!0,name:"rasterFunctionArguments"}})],_t.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],_t.prototype,"rasterArgumentNames",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],_t.prototype,"lookup",void 0);var Ot,Gt=_t=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.RemapFunction")],_t),Lt=new m.s({0:"degree",1:"percent-rise",2:"adjusted"},{useNumericKeys:!0}),Vt=Ot=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).slopeType="degree",e.zFactor=1,e.pixelSizePower=.664,e.pixelSizeFactor=.024,e}return(0,s.Z)(r,[{key:"clone",value:function(){return new Ot({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,raster:this.raster})}}]),r}(k);(0,p.e)([(0,h.r)(Lt)],Vt.prototype,"slopeType",void 0),(0,p.e)([(0,p.y)({type:Number,json:{write:!0}})],Vt.prototype,"zFactor",void 0),(0,p.e)([(0,p.y)({type:Number,json:{name:"psPower",write:!0}})],Vt.prototype,"pixelSizePower",void 0),(0,p.e)([(0,p.y)({type:Number,json:{name:"psFactor",write:!0}})],Vt.prototype,"pixelSizeFactor",void 0);var zt=Vt=Ot=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],Vt),qt=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="Slope",e.functionArguments=null,e.rasterArgumentNames=["raster"],e.isGCS=!1,e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){this.outputPixelType=this._getOutputPixelType("f32");var e=this.sourceRasterInfos[0].clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,this.rasterInfo=e,this.isGCS=e.spatialReference.isGeographic,{success:!0}}},{key:"_processPixels",value:function(e){var t,r=null===(t=e.pixelBlocks)||void 0===t?void 0:t[0];if((0,f.t)(r))return null;var n=this.functionArguments,o=n.zFactor,i=n.slopeType,a=n.pixelSizePower,s=n.pixelSizeFactor,u=this.isGCS,l=e.extent,c=l?{x:l.width/r.width,y:l.height/r.height}:{x:1,y:1};return(0,y.a)(r,{zFactor:o,slopeType:i,pixelSizePower:a,pixelSizeFactor:s,isGCS:u,resolution:c})}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],qt.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:zt,json:{write:!0,name:"rasterFunctionArguments"}})],qt.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],qt.prototype,"rasterArgumentNames",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],qt.prototype,"isGCS",void 0);var Ht,Ut=qt=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.SlopeFunction")],qt),Xt=Ht=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).statistics=null,e.histograms=null,e}return(0,s.Z)(r,[{key:"clone",value:function(){return new Ht({statistics:(0,f.y)(this.statistics),histograms:(0,f.y)(this.histograms)})}}]),r}(k);(0,p.e)([(0,p.y)({json:{write:!0}})],Xt.prototype,"statistics",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],Xt.prototype,"histograms",void 0);var Wt=Xt=Ht=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.StatisticsHistogramsFunctionArguments")],Xt),Jt=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="StatisticsHistograms",e.functionArguments=null,e.rasterArgumentNames=["raster"],e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){var e=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");var t=e.clone(),r=this.functionArguments,n=r.statistics,o=r.histograms;return t.histograms=o,n&&(t.statistics=n.map((function(e){var t=(0,i.Z)(e,4);return{min:t[0],max:t[1],avg:t[2],stddev:t[3]}}))),this.rasterInfo=t,{success:!0}}},{key:"_processPixels",value:function(e){var t;return null===(t=e.pixelBlocks)||void 0===t?void 0:t[0]}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],Jt.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:Wt,json:{write:!0,name:"rasterFunctionArguments"}})],Jt.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],Jt.prototype,"rasterArgumentNames",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],Jt.prototype,"indexedColormap",void 0);var Yt,Kt=Jt=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.StatisticsHistogramsFunction")],Jt),$t=new m.s({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",7:"sigmoid"},{useNumericKeys:!0}),Qt=Yt=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).computeGamma=!1,e.dynamicRangeAdjustment=!1,e.gamma=[],e.histograms=null,e.statistics=null,e.stretchType="none",e.useGamma=!1,e}return(0,s.Z)(r,[{key:"writeStatistics",value:function(e,t,r){var n;(null===(n=e)||void 0===n?void 0:n.length)&&(Array.isArray(e[0])||(e=e.map((function(e){return[e.min,e.max,e.avg,e.stddev]}))),t[r]=e)}},{key:"clone",value:function(){return new Yt({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:(0,f.y)(this.statistics),gamma:(0,f.y)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:(0,f.y)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}}]),r}(k);(0,p.e)([(0,p.y)({type:Boolean,json:{write:!0}})],Qt.prototype,"computeGamma",void 0),(0,p.e)([(0,p.y)({type:Boolean,json:{name:"dra",write:!0}})],Qt.prototype,"dynamicRangeAdjustment",void 0),(0,p.e)([(0,p.y)({type:[Number],json:{write:!0}})],Qt.prototype,"gamma",void 0),(0,p.e)([(0,p.y)()],Qt.prototype,"histograms",void 0),(0,p.e)([(0,p.y)({type:Number,json:{write:!0}})],Qt.prototype,"maxPercent",void 0),(0,p.e)([(0,p.y)({type:Number,json:{write:!0}})],Qt.prototype,"minPercent",void 0),(0,p.e)([(0,p.y)({type:Number,json:{write:!0}})],Qt.prototype,"numberOfStandardDeviations",void 0),(0,p.e)([(0,p.y)({type:Number,json:{name:"max",write:!0}})],Qt.prototype,"outputMax",void 0),(0,p.e)([(0,p.y)({type:Number,json:{name:"min",write:!0}})],Qt.prototype,"outputMin",void 0),(0,p.e)([(0,p.y)({type:Number,json:{write:!0}})],Qt.prototype,"sigmoidStrengthLevel",void 0),(0,p.e)([(0,p.y)({json:{type:[[Number]],write:!0}})],Qt.prototype,"statistics",void 0),(0,p.e)([(0,g.r)("statistics")],Qt.prototype,"writeStatistics",null),(0,p.e)([(0,h.r)($t)],Qt.prototype,"stretchType",void 0),(0,p.e)([(0,p.y)({type:Boolean,json:{write:!0}})],Qt.prototype,"useGamma",void 0);var er=Qt=Yt=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.StretchFunctionArguments")],Qt),tr=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).functionName="Stretch",e.functionArguments=null,e.rasterArgumentNames=["raster"],e.lookup=null,e.cutOffs=null,e}return(0,s.Z)(r,[{key:"_bindSourceRasters",value:function(){this.lookup=null,this.cutOffs=null;var e=this.sourceRasterInfos[0],t=e.pixelType,r=this.functionArguments,n=r.dynamicRangeAdjustment,o=r.gamma,i=r.useGamma;if(!n&&["u8","u16","s8","s16"].includes(t)){var s=(0,y.x)(r.toJSON(),{rasterInfo:e});this.lookup=(0,y.u)((0,a.Z)((0,a.Z)({pixelType:t},s),{},{gamma:i?o:null}))}else n&&(this.cutOffs=(0,y.x)(r.toJSON(),{rasterInfo:e}));this.outputPixelType=this._getOutputPixelType(t);var u=e.clone();return u.pixelType=this.outputPixelType,u.statistics=null,u.histograms=null,"u8"===this.outputPixelType&&(u.keyProperties.DataType="processed"),this.rasterInfo=u,{success:!0}}},{key:"_processPixels",value:function(e){var t,r=null===(t=e.pixelBlocks)||void 0===t?void 0:t[0];if((0,f.t)(r))return r;var n=this.lookup;if(n)return(0,d.c)(r,(0,a.Z)((0,a.Z)({},n),{},{outputPixelType:this.rasterInfo.pixelType}));var o=this.functionArguments,i=this.cutOffs||(0,y.x)(o.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:r}),s=o.useGamma?o.gamma:null;return(0,y.d)(r,(0,a.Z)((0,a.Z)({},i),{},{gamma:s,outputPixelType:this.outputPixelType}))}}]),r}(S);(0,p.e)([(0,p.y)({json:{write:!0,name:"rasterFunction"}})],tr.prototype,"functionName",void 0),(0,p.e)([(0,p.y)({type:er,json:{write:!0,name:"rasterFunctionArguments"}})],tr.prototype,"functionArguments",void 0),(0,p.e)([(0,p.y)()],tr.prototype,"rasterArgumentNames",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],tr.prototype,"lookup",void 0),(0,p.e)([(0,p.y)({json:{write:!0}})],tr.prototype,"cutOffs",void 0);var rr=tr=(0,p.e)([(0,p.n)("esri.layers.support.rasterFunctions.StretchFunction")],tr),nr=new Map;function or(e,t){if("rasterFunction"in e)return ir(e,null!==t&&void 0!==t?t:{});throw new p.s("raster-function-helper","unsupported raster function json.")}function ir(e,t){var r,n=e.rasterFunction,o=e.rasterFunctionArguments,i=null===(r=e.outputPixelType)||void 0===r?void 0:r.toLowerCase();if(null==n||!nr.has(n))throw new p.s("raster-function-helper","unsupported raster function: ".concat(n));for(var s=nr.get(n),u=("function"==typeof s.ctor?s.ctor:s.ctor.default).fromJSON((0,a.Z)((0,a.Z)({},e),{},{outputPixelType:i})),l=u.rasterArgumentNames,c=[],f=function(e,t){return"rasters"===t[0]&&Array.isArray(e.rasters)?e.rasters:t.map((function(t){return e[t]}))}(o,l),v="rasters"===l[0],y=[],h=0;h<f.length;h++){var m,d=f[h],g=void 0;null==d||"string"==typeof d&&d.startsWith("$")?c.push(null===t||void 0===t?void 0:t.raster):"string"==typeof d?t[d]&&c.push(t[d]):"number"!=typeof d&&"rasterFunction"in d&&(g=ir(d,t),v||(u.functionArguments[l[h]]=g),c.push(g)),v&&y.push(null!==(m=g)&&void 0!==m?m:d)}if(v&&(u.functionArguments.rasters=y),t){var w;u.sourceRasters=c;var x=null===(w=t.raster)||void 0===w?void 0:w.url;x&&(u.mainPrimaryRasterId=x)}return u}nr.set("Aspect",{desc:"Aspect Function",ctor:R,rasterArgumentNames:["raster"]}),nr.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:z,rasterArgumentNames:["raster"]}),nr.set("Colormap",{desc:"Colormap Function",ctor:W,rasterArgumentNames:["raster"]}),nr.set("CompositeBand",{desc:"CompositeBand Function",ctor:Q,rasterArgumentNames:["rasters"]}),nr.set("Convolution",{desc:"Convolution Function",ctor:ce,rasterArgumentNames:["raster"]}),nr.set("ExtractBand",{desc:"ExtractBand Function",ctor:he,rasterArgumentNames:["raster"]}),nr.set("Local",{desc:"Local Function",ctor:Ft,rasterArgumentNames:["rasters"]}),nr.set("Mask",{desc:"Mask Function",ctor:It,rasterArgumentNames:["raster"]}),nr.set("NDVI",{desc:"NDVI Function",ctor:Dt,rasterArgumentNames:["raster"]}),nr.set("Remap",{desc:"Remap Function",ctor:Gt,rasterArgumentNames:["raster"]}),nr.set("Slope",{desc:"Slope Function",ctor:Ut,rasterArgumentNames:["raster"]}),nr.set("StatisticsHistograms",{desc:"Statistics Histograms Function",ctor:Kt,rasterArgumentNames:["raster"]}),nr.set("Stretch",{desc:"Stretch Function",ctor:rr,rasterArgumentNames:["raster"]});var ar=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,[{key:"affectsPixelSize",get:function(){return!1}},{key:"forwardTransform",value:function(e){return e}},{key:"inverseTransform",value:function(e){return e}}]),r}(v.l);(0,p.e)([(0,p.y)()],ar.prototype,"affectsPixelSize",null),(0,p.e)([(0,p.y)({json:{write:!0}})],ar.prototype,"spatialReference",void 0);var sr=ar=(0,p.e)([(0,p.n)("esri.layers.support.rasterTransforms.BaseRasterTransform")],ar),ur=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).type="gcs-shift",e.tolerance=1e-8,e}return(0,s.Z)(r,[{key:"forwardTransform",value:function(e){return"point"===(e=e.clone()).type?(e.x>180+this.tolerance&&(e.x-=360),e):(e.xmin>=180-this.tolerance?(e.xmax-=360,e.xmin-=360):e.xmax>180+this.tolerance&&(e.xmin=-180,e.xmax=180),e)}},{key:"inverseTransform",value:function(e){return"point"===(e=e.clone()).type?(e.x<-this.tolerance&&(e.x+=360),e):(e.xmin<-this.tolerance&&(e.xmin+=360,e.xmax+=360),e)}}]),r}(sr);(0,p.e)([(0,h.r)({GCSShiftXform:"gcs-shift"})],ur.prototype,"type",void 0),(0,p.e)([(0,p.y)()],ur.prototype,"tolerance",void 0);var lr=ur=(0,p.e)([(0,p.n)("esri.layers.support.rasterTransforms.GCSShiftTransform")],ur),cr=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).type="identity",e}return(0,s.Z)(r)}(sr);(0,p.e)([(0,h.r)({IdentityXform:"identity"})],cr.prototype,"type",void 0);var pr=cr=(0,p.e)([(0,p.n)("esri.layers.support.rasterTransforms.IdentityTransform")],cr);function fr(e,t,r){var n=t.x,o=t.y;if(r<2)return{x:e[0]+n*e[2]+o*e[4],y:e[1]+n*e[3]+o*e[5]};if(2===r){var i=n*n,a=o*o,s=n*o;return{x:e[0]+n*e[2]+o*e[4]+i*e[6]+s*e[8]+a*e[10],y:e[1]+n*e[3]+o*e[5]+i*e[7]+s*e[9]+a*e[11]}}var u=n*n,l=o*o,c=n*o,p=u*n,f=u*o,v=n*l,y=o*l;return{x:e[0]+n*e[2]+o*e[4]+u*e[6]+c*e[8]+l*e[10]+p*e[12]+f*e[14]+v*e[16]+y*e[18],y:e[1]+n*e[3]+o*e[5]+u*e[7]+c*e[9]+l*e[11]+p*e[13]+f*e[15]+v*e[17]+y*e[19]}}function vr(e,t,r){var n=t.xmin,o=t.ymin,i=t.xmax,a=t.ymax,s=t.spatialReference,u=[];if(r<2)u.push({x:n,y:a}),u.push({x:i,y:a}),u.push({x:n,y:o}),u.push({x:i,y:o});else{for(var l=10,c=0;c<l;c++)u.push({x:n,y:o+(a-o)*c/(l-1)}),u.push({x:i,y:o+(a-o)*c/(l-1)});l=8;for(var p=1;p<=l;p++)u.push({x:n+(i-n)*p/l,y:o}),u.push({x:n+(i-n)*p/l,y:a})}u=u.map((function(t){return fr(e,t,r)}));var f=u.map((function(e){return e.x})),v=u.map((function(e){return e.y}));return new x.w({xmin:Math.min.apply(null,f),xmax:Math.max.apply(null,f),ymin:Math.min.apply(null,v),ymax:Math.max.apply(null,v),spatialReference:s})}var yr=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).polynomialOrder=1,e.type="polynomial",e}return(0,s.Z)(r,[{key:"readForwardCoefficients",value:function(e,t){var r=t.coeffX,n=t.coeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var o=[],i=0;i<r.length;i++)o.push(r[i]),o.push(n[i]);return o}},{key:"writeForwardCoefficients",value:function(e,t,r){for(var n=[],o=[],i=0;i<(null===e||void 0===e?void 0:e.length);i++)i%2==0?n.push(e[i]):o.push(e[i]);t.coeffX=n,t.coeffY=o}},{key:"inverseCoefficients",get:function(){var e=this._get("inverseCoefficients"),t=this._get("forwardCoefficients");return!e&&t&&this.polynomialOrder<2&&(e=function(e){var t=(0,i.Z)(e,6),r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=o*u-s*a,c=s*a-o*u;return[(s*n-r*u)/l,(o*n-r*a)/c,u/l,a/c,-s/l,-o/c]}(t)),e},set:function(e){this._set("inverseCoefficients",e)}},{key:"readInverseCoefficients",value:function(e,t){var r=t.inverseCoeffX,n=t.inverseCoeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var o=[],i=0;i<r.length;i++)o.push(r[i]),o.push(n[i]);return o}},{key:"writeInverseCoefficients",value:function(e,t,r){for(var n=[],o=[],i=0;i<(null===e||void 0===e?void 0:e.length);i++)i%2==0?n.push(e[i]):o.push(e[i]);t.inverseCoeffX=n,t.inverseCoeffY=o}},{key:"affectsPixelSize",get:function(){return this.polynomialOrder>0}},{key:"forwardTransform",value:function(e){if("point"===e.type){var t=fr(this.forwardCoefficients,e,this.polynomialOrder);return new g.w({x:t.x,y:t.y,spatialReference:e.spatialReference})}return vr(this.forwardCoefficients,e,this.polynomialOrder)}},{key:"inverseTransform",value:function(e){if("point"===e.type){var t=fr(this.inverseCoefficients,e,this.polynomialOrder);return new g.w({x:t.x,y:t.y,spatialReference:e.spatialReference})}return vr(this.inverseCoefficients,e,this.polynomialOrder)}}]),r}(sr);(0,p.e)([(0,p.y)({json:{write:!0}})],yr.prototype,"polynomialOrder",void 0),(0,p.e)([(0,p.y)()],yr.prototype,"forwardCoefficients",void 0),(0,p.e)([(0,g.o)("forwardCoefficients",["coeffX","coeffY"])],yr.prototype,"readForwardCoefficients",null),(0,p.e)([(0,g.r)("forwardCoefficients")],yr.prototype,"writeForwardCoefficients",null),(0,p.e)([(0,p.y)({json:{write:!0}})],yr.prototype,"inverseCoefficients",null),(0,p.e)([(0,g.o)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],yr.prototype,"readInverseCoefficients",null),(0,p.e)([(0,g.r)("inverseCoefficients")],yr.prototype,"writeInverseCoefficients",null),(0,p.e)([(0,p.y)()],yr.prototype,"affectsPixelSize",null),(0,p.e)([(0,h.r)({PolynomialXform:"polynomial"})],yr.prototype,"type",void 0);var hr=yr=(0,p.e)([(0,p.n)("esri.layers.support.rasterTransforms.PolynomialTransform")],yr),mr={GCSShiftXform:lr,IdentityXform:pr,PolynomialXform:hr},dr=Object.keys(mr);function gr(e){var t=null===e||void 0===e?void 0:e.type;return!e||dr.includes(t)}function wr(e){if(!(null===e||void 0===e?void 0:e.type))return null;var t=mr[null===e||void 0===e?void 0:e.type];if(t){var r=new t;return r.read(e),r}return null}}}]);
//# sourceMappingURL=1887.f21ffd8a.chunk.js.map