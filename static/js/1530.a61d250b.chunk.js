"use strict";(self.webpackChunkraleighnc_web_component=self.webpackChunkraleighnc_web_component||[]).push([[1530,8999],{28681:function(e,t,n){n.d(t,{i:function(){return l}});var r=n(15671),i=n(43144),a=n(60136),o=n(29388),s=n(23132);n(75610);var l=function(e){var t=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"apiKey",get:function(){var e;return this._isOverridden("apiKey")?this._get("apiKey"):"portalItem"in this?null===(e=this.portalItem)||void 0===e?void 0:e.apiKey:null},set:function(e){null!=e?this._override("apiKey",e):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}}]),n}(e);return(0,s.e)([(0,s.d)({type:String})],t.prototype,"apiKey",null),t=(0,s.e)([(0,s.n)("esri.layers.mixins.APIKeyMixin")],t)}},55269:function(e,t,n){n.d(t,{i:function(){return o},o:function(){return l},r:function(){return u},s:function(){return c}});var r=n(15671),i=n(43144),a=n(2760),o=function(){function e(t,n){(0,r.Z)(this,e),this.min=t,this.max=n,this.range=n-t}return(0,i.Z)(e,[{key:"ndiff",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.ceil((e-t)/this.range)*this.range+t}},{key:"_normalize",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(n-=r)<e?n+=this.ndiff(e-n):n>t&&(n-=this.ndiff(n-t)),i&&n===t&&(n=e),n+r}},{key:"normalize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._normalize(this.min,this.max,e,t,n)}},{key:"clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,a.o)(e-t,this.min,this.max)+t}},{key:"monotonic",value:function(e,t,n){return e<t?t:t+this.ndiff(e-t,n)}},{key:"minimalMonotonic",value:function(e,t,n){return this._normalize(e,e+this.range,t,n)}},{key:"center",value:function(e,t,n){return t=this.monotonic(e,t,n),this.normalize((e+t)/2,n)}},{key:"diff",value:function(e,t,n){return this.monotonic(e,t,n)-e}},{key:"shortestSignedDiff",value:function(e,t){e=this.normalize(e);var n=(t=this.normalize(t))-e,r=t<e?this.minimalMonotonic(e,t)-e:t-this.minimalMonotonic(t,e);return Math.abs(n)<Math.abs(r)?n:r}},{key:"contains",value:function(e,t,n){return t=this.minimalMonotonic(e,t),(n=this.minimalMonotonic(e,n))>e&&n<t}}]),e}();function s(e){for(var t in e){var n=e[t];n instanceof Function&&(e[t]=n.bind(e))}return e}var l=s(new o(0,2*Math.PI)),u=s(new o(-Math.PI,Math.PI)),c=s(new o(0,360))},72692:function(e,t,n){n.r(t),n.d(t,{D:function(){return D},E:function(){return Yr},F:function(){return Hr},J:function(){return Rr},e:function(){return sr},i:function(){return Nr},j:function(){return K},l:function(){return U},x:function(){return W},y:function(){return B}});var r=n(97326),i=n(37762),a=n(29439),o=n(4942),s=n(74165),l=n(15671),u=n(43144),c=n(60136),d=n(29388),f=n(93433),p=n(1413),h=n(15861),v=n(23132),m=n(49580),y=n(36551),g=n(77389),b=n(75610),_=n(84538),w=n(48561),I=(n(55269),n(2760)),k=n(44455),M=n(41742),x=n(83822),A=n(80175),F=n(32568),Z=n(10590),C=n(50526),T=n(51451),E=n(33703),L=n(19948),S=n(97033),R=n(79042),N=n(57714),O=n(34860),P=(n(30709),n(61495),n(80262),n(36460),n(1241),n(15181),n(15612),n(91204),n(43920)),z=n(16485),j=n(74575),V=n(77470);function q(e,t,n){return e.units[t][n]}function U(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,M.m)(t,{minimumFractionDigits:r,maximumFractionDigits:r})," ").concat(q(e,n,i))}function D(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,k.b)(t,n);return U(e,(0,k.N)(t,n,a),a,r,i)}function W(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,k.J)(t,n);return U(e,(0,k.N)(t,n,a),a,r,i)}function B(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,k.K)(t,n);return U(e,(0,k.N)(t,n,a),a,r,i)}function K(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,k.A)(t,n);return U(e,(0,k.N)(t,n,a),a,r,i)}var $=["B","kB","MB","GB","TB"];var G=v.s.getLogger("esri.widgets.Feature.support.featureUtils"),Y=/href=(""|'')/gi,H=/(\{([^\{\r\n]+)\})/g,Q=/\'/g,X=/^\s*expression\//i,J=/(\n)/gi,ee=/[\u00A0-\u9999<>\&]/gim,te=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,ne=/^(?:mailto:|tel:)/,re="relationships/",ie=(0,M.S)("short-date-short-time");function ae(e){if(!(0,b.t)(e))return e.get("sourceLayer")||e.get("layer")}function oe(e,t){return se.apply(this,arguments)}function se(){return se=(0,h.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","function"==typeof t?t.call(null,n):t);case 1:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}function le(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!ne.test(e.trim().toLowerCase())}function ue(e){return!!e&&X.test(e)}function ce(e,t){var n=function(e,t){if(!ue(t)||!e)return null;var n,r=t.replace(X,"").toLowerCase();return e.some((function(e){return e.name.toLowerCase()===r&&(n=e,!0)})),n}(t,null===e||void 0===e?void 0:e.fieldName);return n?n.title||null:e?e.label||e.fieldName:null}function de(e,t){var n=fe(t,e);return n?n.name:e}function fe(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function pe(e){return"".concat(e).trim()}function he(e){var t=e.attributes,n=e.globalAttributes,r=e.layer,i=e.text,a=e.expressionAttributes,o=e.fieldInfoMap;return i?ve({formattedAttributes:n,template:be(i,(0,p.Z)((0,p.Z)((0,p.Z)({},n),a),t),r),fieldInfoMap:o}):""}function ve(e){var t=e.formattedAttributes,n=e.template,r=e.fieldInfoMap;return pe(function(e){return e.replace(Y,"")}((0,v.r)((0,v.r)(n,(function(e){return function(e,t){var n=t.get(e.toLowerCase());return"{".concat(n&&n.fieldName||e,"}")}(e,r)})),t)))}function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t[e];if("string"==typeof r){var i="%27",a=(n?encodeURIComponent(r):r).replace(Q,i);t[e]=a}}function ye(e,t,n){var r=(t=pe(t))&&"{"!==t[0];return(0,v.r)(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,p.Z)({},e);return Object.keys(n).forEach((function(e){return me(e,n,t)})),n}(n,r))}function ge(e,t){return e.replace(H,(function(e,n,r){var i=fe(t,r);return i?"{".concat(i.name,"}"):n}))}function be(e,t,n){var r=ge(e,n);return r?r.replace(te,(function(e,n,r){return ye(e,n||r,t)})):r}function _e(e){return!(null===e||void 0===e||!e.layer)}function we(e,t){var n,r=t.fieldInfos,i=t.fieldName,a=null===(n=Ie(r,i))||void 0===n?void 0:n.clone(),o=t.preventPlacesFormatting,s=t.layer,l=fe(s,i);if(a&&"date"===(null===l||void 0===l?void 0:l.type)){var u=a.format||new T.u;u.dateFormat=u.dateFormat||"short-date-short-time",u.dateTimeFormatOptions=!_e(s)&&function(e){return"feature"===(null===e||void 0===e?void 0:e.type)}(s)&&s.datesInUnknownTimezone||_e(s)&&function(e){return"map-image"===(null===e||void 0===e?void 0:e.type)}(s.layer)&&s.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,a.format=u}var c=a&&a.format;return"string"==typeof e&&(0,C.d)(i)&&c?c.formatRasterPixelValue(e):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){var n=Number(e);if(!isNaN(n))return n}return e}(e,c))||null==e||null==c?xe(e):o?(0,M.m)(e,(0,p.Z)((0,p.Z)({},(0,M.u)(c)),{},{minimumFractionDigits:0,maximumFractionDigits:20})):c.format(e)}function Ie(e,t){if(e&&e.length&&t){var n,r=t.toLowerCase();return e.some((function(e){return!(!e.fieldName||e.fieldName.toLowerCase()!==r)&&(n=e,!0)})),n}}function ke(e){var t=[];if(!e)return t;var n=e.fieldInfos,r=e.content;return n&&t.push.apply(t,(0,f.Z)(n)),r&&Array.isArray(r)?(r.forEach((function(e){if("fields"===e.type){var n=e&&e.fieldInfos;n&&t.push.apply(t,(0,f.Z)(n))}})),t):t}function Me(e){return e.replace(ee,(function(e){return"&#".concat(e.charCodeAt(0),";")}))}function xe(e){return"string"==typeof e?e.replace(J,'<br class="esri-text-new-line" />'):e}function Ae(e){var t=e.value,n=e.fieldName,r=e.fieldInfos,i=e.fieldInfoMap,a=e.layer,o=e.graphic;if(null==t)return"";var s=function(e){var t=e.fieldName,n=e.value,r=e.graphic,i=e.layer;if(Re(t))return null;if(!i||"function"!=typeof i.getFieldDomain)return null;var a=i.getFieldDomain(t,{feature:r});return a&&"coded-value"===a.type?a.getName(n):null}({fieldName:n,value:t,graphic:o,layer:a});if(s)return s;var l=function(e){var t=e.fieldName,n=e.graphic,r=e.layer;if(Re(t))return null;if(!r||"function"!=typeof r.getFeatureType)return null;var i=r.typeIdField;if(!i||t!==i)return null;var a=r.getFeatureType(n);return a?a.name:null}({fieldName:n,graphic:o,layer:a});if(l)return l;if(i.get(n.toLowerCase()))return we(t,{fieldInfos:r||Array.from(i.values()),fieldName:n,layer:a});var u=a&&a.fieldsIndex;return u&&u.isDateField(n)?(0,M.L)(t,ie):xe(t)}function Fe(e){var t=e.fieldInfos,n=e.attributes,r=e.layer,i=e.graphic,a=e.fieldInfoMap,o=e.relatedInfos,s={};return null!==o&&void 0!==o&&o.forEach((function(e){return function(e){var t=e.attributes,n=e.relatedInfo,r=e.fieldInfoMap,i=e.fieldInfos,a=e.layer;t&&n&&(n.relatedFeatures&&n.relatedFeatures&&n.relatedFeatures.forEach((function(e){return Ne({attributes:t,graphic:e,relatedInfo:n,fieldInfoMap:r,fieldInfos:i,layer:a})})),n.relatedStatsFeatures&&n.relatedStatsFeatures&&n.relatedStatsFeatures.forEach((function(e){return Ne({attributes:t,graphic:e,relatedInfo:n,fieldInfoMap:r,fieldInfos:i,layer:a})})))}({attributes:s,relatedInfo:e,fieldInfoMap:a,fieldInfos:t,layer:r})})),Object.keys(n).forEach((function(e){var o=n[e];s[e]=Ae({fieldName:e,fieldInfos:t,fieldInfoMap:a,layer:r,value:o,graphic:i})})),s}function Ze(e,t){return Ce.apply(this,arguments)}function Ce(){return Ce=(0,h.Z)((0,s.Z)().mark((function e(t,n){var r,i,a,o,l,u,c,d,f,p,h,v;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.layer,o=t.graphic,l=t.outFields,u=t.objectIds,c=t.returnGeometry,d=t.spatialReference,"number"==typeof(f=u[0])||"string"==typeof f){e.next=4;break}return"Could not query required fields for the specified feature. The feature's ID is invalid.",p={layer:a,graphic:o,objectId:f,requiredFields:l},e.abrupt("return",(G.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",p),null));case 4:if(null!==(r=a.capabilities)&&void 0!==r&&null!==(i=r.operations)&&void 0!==i&&i.supportsQuery){e.next=7;break}return"The specified layer cannot be queried. The following fields will not be available.",h={layer:a,graphic:o,requiredFields:l,returnGeometry:c},e.abrupt("return",(G.warn("The specified layer cannot be queried. The following fields will not be available.",h),null));case 7:return(v=a.createQuery()).objectIds=u,v.outFields=null!==l&&void 0!==l&&l.length?l:[a.objectIdField],v.returnGeometry=!!c,v.returnZ=!!c,v.returnM=!!c,v.outSpatialReference=d,e.next=11,a.queryFeatures(v,n);case 11:return e.abrupt("return",e.sent.features[0]);case 12:case"end":return e.stop()}}),e)}))),Ce.apply(this,arguments)}function Te(e){return Ee.apply(this,arguments)}function Ee(){return Ee=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.expressionInfos)&&void 0!==n&&n.length){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,(0,C.a)();case 4:return r=e.sent,i=r.arcadeUtils.hasGeometryFunctions,e.abrupt("return",i(t));case 7:case"end":return e.stop()}}),e)}))),Ee.apply(this,arguments)}function Le(e,t){return Se.apply(this,arguments)}function Se(){return Se=(0,h.Z)((0,s.Z)().mark((function e(t,n){var r,i,a,o,l,u,c,d,f,h,v;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.graphic,i=t.popupTemplate,a=t.layer,o=t.spatialReference,a&&i){e.next=3;break}return e.abrupt("return");case 3:if(e.t0="function"==typeof a.load,!e.t0){e.next=7;break}return e.next=7,a.load(n);case 7:if(r.attributes){e.next=9;break}return e.abrupt("return");case 9:if(null!=(l=r.attributes[a.objectIdField])){e.next=12;break}return e.abrupt("return");case 12:return u=[l],e.next=15,i.getRequiredFields(a.fieldsIndex);case 15:if(c=e.sent,d=(0,C.e)(c,r),f=d?[]:c,e.t1=i.returnGeometry,e.t1){e.next=23;break}return e.next=22,Te(i);case 22:e.t1=e.sent;case 23:if(h=e.t1,!d||h){e.next=26;break}return e.abrupt("return");case 26:return e.next=28,Ze({layer:a,graphic:r,outFields:f,objectIds:u,returnGeometry:h,spatialReference:o},n);case 28:(v=e.sent)&&(v.geometry&&(r.geometry=v.geometry),v.attributes&&(r.attributes=(0,p.Z)((0,p.Z)({},r.attributes),v.attributes)));case 30:case"end":return e.stop()}}),e)}))),Se.apply(this,arguments)}function Re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(re)}function Ne(e){var t=e.attributes,n=e.graphic,r=e.relatedInfo,i=e.fieldInfos,a=e.fieldInfoMap,o=e.layer;t&&n&&r&&Object.keys(n.attributes).forEach((function(e){var s=function(e){return e?"".concat(re).concat(e.layerId,"/").concat(e.fieldName):""}({layerId:r.relation.id.toString(),fieldName:e}),l=n.attributes[e];t[s]=Ae({fieldName:s,fieldInfos:i,fieldInfoMap:a,layer:o,value:l,graphic:n})}))}var Oe=function(e){if(!e)return!1;var t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},Pe=function(e){var t,n,r=e.layer,i=e.method,a=e.query,o=e.definitionExpression;if(null!==(t=r.capabilities)&&void 0!==t&&null!==(n=t.query)&&void 0!==n&&n.supportsCacheHint&&"attachments"!==i){var s=(0,b.r)(a.where)&&a.where,l=(0,b.r)(a.geometry)&&a.geometry;Oe(o)||Oe(s)||"extent"===(null===l||void 0===l?void 0:l.type)||"tile"===a.resultType||(a.cacheHint=!0)}},ze={editing:!1,operations:{add:!0,update:!0,delete:!0}},je=A.j.ofType(F.l),Ve=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e))._getAttachmentsPromise=null,r._attachmentLayer=null,r.abilities=(0,p.Z)({},ze),r.activeAttachmentInfo=null,r.attachmentInfos=new je,r.graphic=null,r.mode="view",r.own((0,y.l)((function(){return r.graphic}),(function(){return r._graphicChanged()}),y.h)),r}return(0,u.Z)(n,[{key:"destroy",value:function(){this._attachmentLayer=null,this.graphic=null}},{key:"castAbilities",value:function(e){return(0,p.Z)((0,p.Z)({},ze),e)}},{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}},{key:"getAttachments",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(){var t,n,r,i,a,o,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._attachmentLayer,n=this.attachmentInfos,t&&"function"==typeof t.queryAttachments){e.next=3;break}throw new v.a("invalid-layer","getAttachments(): A valid layer is required.");case 3:return r=this._getFeatureId(),i=new Z.c({objectIds:[r],returnMetadata:!0}),a=[],o=t.queryAttachments(i).then((function(e){return e[r]||a})).catch((function(){return a})),this._getAttachmentsPromise=o,this.notifyChange("state"),e.next=7,o;case 7:return l=e.sent,e.abrupt("return",(n.removeAll(),l.length&&n.addMany(l),this._getAttachmentsPromise=null,this.notifyChange("state"),l));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addAttachment",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l,u=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._attachmentLayer,r=this.attachmentInfos,i=this.graphic,a=this.abilities,t){e.next=3;break}throw new v.a("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});case 3:if(a.operations.add){e.next=5;break}throw new v.a("invalid-abilities","addAttachment(): add abilities are required.");case 5:if(n&&"function"==typeof n.addAttachment){e.next=7;break}throw new v.a("invalid-layer","addAttachment(): A valid layer is required.");case 7:return o=n.addAttachment(i,t).then((function(e){return u._queryAttachment(e.objectId)})),e.next=10,o;case 10:return l=e.sent,e.abrupt("return",(r.add(l),l));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteAttachment",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._attachmentLayer,r=this.attachmentInfos,i=this.graphic,a=this.abilities,t){e.next=3;break}throw new v.a("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});case 3:if(a.operations.delete){e.next=5;break}throw new v.a("invalid-abilities","deleteAttachment(): delete abilities are required.");case 5:if(n&&"function"==typeof n.deleteAttachments){e.next=7;break}throw new v.a("invalid-layer","deleteAttachment(): A valid layer is required.");case 7:return o=n.deleteAttachments(i,[t.id]).then((function(){return t})),e.next=10,o;case 10:return l=e.sent,e.abrupt("return",(r.remove(l),l));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l,u,c,d=this,f=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:this.activeAttachmentInfo,r=this._attachmentLayer,i=this.attachmentInfos,a=this.graphic,o=this.abilities,t){e.next=4;break}throw new v.a("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});case 4:if(n){e.next=6;break}throw new v.a("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:n});case 6:if(o.operations.update){e.next=8;break}throw new v.a("invalid-abilities","updateAttachment(): Update abilities are required.");case 8:if(l=i.findIndex((function(e){return e===n})),r&&"function"==typeof r.updateAttachment){e.next=11;break}throw new v.a("invalid-layer","updateAttachment(): A valid layer is required.");case 11:return u=r.updateAttachment(a,n.id,t).then((function(e){return d._queryAttachment(e.objectId)})),e.next=14,u;case 14:return c=e.sent,e.abrupt("return",(i.splice(l,1,c),c));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_queryAttachment",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new v.a("invalid-attachment-id","Could not query attachment.");case 2:return n=this._attachmentLayer,r=this._getFeatureId(),i=new Z.c({objectIds:[r],attachmentsWhere:"AttachmentId=".concat(t),returnMetadata:!0}),e.abrupt("return",n.queryAttachments(i).then((function(e){return e[r][0]})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getFeatureId",value:function(){var e=this._attachmentLayer,t=this.graphic;if(!e||!t)return null;var n=e.objectIdField,r=t.attributes;return r&&r[n]}},{key:"_graphicChanged",value:function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((function(){})))}},{key:"_setAttachmentLayer",value:function(){var e=ae(this.graphic);this._attachmentLayer=e?"scene"===e.type&&(0,b.r)(e.associatedLayer)?e.associatedLayer:e:null}}]),n}(v.y);(0,v.e)([(0,v.d)()],Ve.prototype,"abilities",void 0),(0,v.e)([(0,v.q)("abilities")],Ve.prototype,"castAbilities",null),(0,v.e)([(0,v.d)()],Ve.prototype,"activeAttachmentInfo",void 0),(0,v.e)([(0,v.d)({readOnly:!0,type:je})],Ve.prototype,"attachmentInfos",void 0),(0,v.e)([(0,v.d)({type:x.g})],Ve.prototype,"graphic",void 0),(0,v.e)([(0,v.d)()],Ve.prototype,"mode",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Ve.prototype,"state",null),(0,v.e)([(0,v.d)({readOnly:!0})],Ve.prototype,"supportsResizeAttachments",null);var qe=Ve=(0,v.e)([(0,v.n)("esri.widgets.Attachments.AttachmentsViewModel")],Ve);var Ue={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},De="esri-attachments",We="esri-attachments__loader-container",Be="esri-attachments__loader",Ke="esri-attachments__container",$e="esri-attachments__container--list",Ge="esri-attachments__container--preview",Ye="esri-attachments__actions",He="esri-attachments__delete-button",Qe="esri-attachments__add-attachment-button",Xe="esri-attachments__error-message",Je="esri-attachments__items",et="esri-attachments__item",tt="esri-attachments__item-button",nt="esri-attachments__item-mask",rt="esri-attachments__item-mask--icon",it="esri-attachments__image",at="esri-attachments__image--resizable",ot="esri-attachments__label",st="esri-attachments__filename",lt="esri-attachments__item-chevron-icon",ut="esri-attachments__item-link",ct="esri-attachments__item-link-overlay",dt="esri-attachments__item-link-overlay-icon",ft="esri-attachments__item-add-icon",pt="esri-attachments__form-node",ht="esri-attachments__file-fieldset",vt="esri-attachments__file-label",mt="esri-attachments__file-name",yt="esri-attachments__file-input",gt="esri-attachments__metadata",bt="esri-attachments__metadata-fieldset",_t="esri-attachments__progress-bar",wt="esri-widget",It="esri-button",kt="esri-button--disabled",Mt="esri-button--secondary",xt="esri-button--tertiary",At="esri-button--third",Ft="esri-button--small",Zt="esri-button--half",Ct="esri-widget__content--empty",Tt="esri-icon-right",Et="esri-icon-left",Lt="esri-icon-plus",St=window.CSS,Rt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r)).abilities=null,i.displayType="auto",i.graphic=null,i.label=void 0,i.messages=null,i.messagesUnits=null,i.selectedFile=null,i.submitting=!1,i.viewModel=new qe,i.visibleElements=(0,p.Z)({},Ue),i._supportsImageOrientation=St&&St.supports&&St.supports("image-orientation","from-image"),i._addAttachmentForm=null,i._updateAttachmentForm=null,i}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this.own([(0,y.a)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.attachmentInfos}),"change",(function(){return e.scheduleRender()})),(0,y.l)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.mode}),(function(){return e._modeChanged()}),y.h)])}},{key:"effectiveDisplayType",get:function(){var e=this.displayType;return e&&"auto"!==e?e:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"castVisibleElements",value:function(e){return(0,p.Z)((0,p.Z)({},Ue),e)}},{key:"addAttachment",value:function(){var e=this,t=this._addAttachmentForm,n=this.viewModel;return this._set("submitting",!0),this._set("error",null),n.addAttachment(t).then((function(t){return e._set("submitting",!1),e._set("error",null),n.mode="view",t})).catch((function(t){throw e._set("submitting",!1),e._set("error",new v.a("attachments:add-attachment",e.messages.addErrorMessage,t)),t}))}},{key:"deleteAttachment",value:function(e){var t=this,n=this.viewModel;return this._set("submitting",!0),this._set("error",null),n.deleteAttachment(e).then((function(e){return t._set("submitting",!1),t._set("error",null),n.mode="view",e})).catch((function(e){throw t._set("submitting",!1),t._set("error",new v.a("attachments:delete-attachment",t.messages.deleteErrorMessage,e)),e}))}},{key:"updateAttachment",value:function(){var e=this,t=this.viewModel,n=this._updateAttachmentForm;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(n).then((function(n){return e._set("submitting",!1),e._set("error",null),t.mode="view",n})).catch((function(t){throw e._set("submitting",!1),e._set("error",new v.a("attachments:update-attachment",e.messages.updateErrorMessage,t)),t}))}},{key:"render",value:function(){var e=this.submitting,t=this.viewModel.state;return(0,_.n)("div",{class:this.classes(De,wt)},e?this.renderProgressBar():null,"loading"===t?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}},{key:"renderErrorMessage",value:function(){var e=this.error,t=this.visibleElements;return e&&t.errorMessage?(0,_.n)("div",{key:"error-message",class:Xe},e.message):null}},{key:"renderAttachments",value:function(){var e=this.viewModel,t=e.mode,n=e.activeAttachmentInfo;return"add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(n):this.renderAttachmentContainer()}},{key:"renderLoading",value:function(){return(0,_.n)("div",{class:We,key:"loader"},(0,_.n)("div",{class:Be}))}},{key:"renderProgressBar",value:function(){return this.visibleElements.progressBar?(0,_.n)("div",{class:_t,key:"progress-bar"}):null}},{key:"renderAddForm",value:function(){var e=this.submitting,t=this.selectedFile,n=e||!t,r=this.visibleElements.cancelAddButton?(0,_.n)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(It,xt,Ft,Zt,e&&kt)},this.messages.cancel):null,i=this.visibleElements.addSubmitButton?(0,_.n)("button",{type:"submit",disabled:n,class:this.classes(It,Mt,Ft,Zt,(0,o.Z)({},kt,n))},this.messages.add):null,a=t?(0,_.n)("span",{key:"file-name",class:mt},t.name):null,s=(0,_.n)("form",{bind:this,afterCreate:_.v,afterRemoved:_.h,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},(0,_.n)("fieldset",{class:ht},a,(0,_.n)("label",{class:this.classes(vt,It,Mt)},t?this.messages.changeFile:this.messages.selectFile,(0,_.n)("input",{class:yt,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),i,r);return(0,_.n)("div",{key:"add-form-container",class:pt},s)}},{key:"renderDetailsForm",value:function(e){var t=this,n=this.visibleElements,r=this.viewModel,i=this.selectedFile,a=this.submitting,s=e.contentType,l=e.size,u=e.url,c=r.abilities,d=a||!i,f=c.editing&&c.operations.delete&&n.deleteButton?(0,_.n)("button",{key:"delete-button",type:"button",disabled:a,bind:this,onclick:function(n){return t._submitDeleteAttachment(n,e)},class:this.classes(It,Ft,xt,He,(0,o.Z)({},kt,a))},this.messages.delete):null,p=c.editing&&c.operations.update&&n.updateButton?(0,_.n)("button",{disabled:d,key:"update-button",type:"submit",class:this.classes(It,Ft,At,(0,o.Z)({},kt,d))},this.messages.update):null,h=this.visibleElements.cancelUpdateButton?(0,_.n)("button",{disabled:a,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(It,Ft,xt,At,(0,o.Z)({},kt,a))},this.messages.cancel):null,m=i?(0,_.n)("span",{key:"file-name",class:mt},i.name):null,y=c.editing&&c.operations.update?(0,_.n)("fieldset",{key:"file",class:ht},m,(0,_.n)("label",{class:this.classes(vt,It,Mt)},this.messages.changeFile,(0,_.n)("input",{class:yt,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,g=(0,_.n)("fieldset",{key:"size",class:bt},(0,_.n)("label",null,function(e,t){var n=0===t?0:Math.floor(Math.log(t)/Math.log(w.o.KILOBYTES));n=(0,I.o)(n,0,$.length-1);var r=(0,M.m)(t/Math.pow(w.o.KILOBYTES,n),{maximumFractionDigits:2});return(0,v.r)(e.units.bytes[$[n]],{fileSize:r})}(this.messagesUnits,l))),b=(0,_.n)("fieldset",{key:"content-type",class:bt},(0,_.n)("label",null,s)),k=(0,_.n)("form",{bind:this,afterCreate:_.v,afterRemoved:_.h,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},(0,_.n)("div",{class:gt},g,b),y,(0,_.n)("div",{class:Ye},f,h,p));return(0,_.n)("div",{key:"edit-form-container",class:pt},(0,_.n)("a",{class:ut,href:u,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:e,size:400}),(0,_.n)("div",{class:ct},(0,_.n)("span",{class:dt},(0,_.n)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},(0,_.n)("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),(0,_.n)("path",{fill:"none",d:"M0 0h32v32H0z"}))))),k)}},{key:"renderImageMask",value:function(e){var t=e.attachmentInfo,n=e.size,r=this.viewModel.supportsResizeAttachments,i=t.contentType,a=t.name,s=t.url,l=r&&function(e){var t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}(i),u=this._getCSSTransform(t,l),c=u?{transform:u,"image-orientation":"none"}:{},d=s.includes("?")?"&":"?",f=l?"".concat(s).concat(d,"w=").concat(n):function(e){var t=(0,E.a)("esri/themes/base/images/files/");return e?"text/plain"===e?"".concat(t,"text-32.svg"):"application/pdf"===e?"".concat(t,"pdf-32.svg"):"text/csv"===e?"".concat(t,"csv-32.svg"):"application/gpx+xml"===e?"".concat(t,"gpx-32.svg"):"application/x-dwf"===e?"".concat(t,"cad-32.svg"):"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?"".concat(t,"code-32.svg"):"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?"".concat(t,"zip-32.svg"):e.includes("image/")?"".concat(t,"image-32.svg"):e.includes("audio/")?"".concat(t,"sound-32.svg"):e.includes("video/")?"".concat(t,"video-32.svg"):e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?"".concat(t,"excel-32.svg"):e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?"".concat(t,"word-32.svg"):e.includes("powerpoint")||e.includes("presentationml")?"".concat(t,"report-32.svg"):"".concat(t,"generic-32.svg"):"".concat(t,"generic-32.svg")}(i),p=(0,o.Z)({},rt,!l),h=(0,o.Z)({},at,r);return(0,_.n)("div",{class:this.classes(p,nt)},(0,_.n)("img",{styles:c,alt:a,src:f,class:this.classes(h,it)}))}},{key:"renderAttachmentInfo",value:function(e){var t=this,n=e.attachmentInfo,r=e.displayType,i=this.viewModel.abilities,a=n.name,o=n.url,s=this.renderImageMask({attachmentInfo:n,size:"list"===r?48:400}),l=i.editing?(0,_.n)("span",{"aria-hidden":"true",class:this.classes(lt,(0,_.f)(this.container)?Et:Tt)}):null,u=[s,(0,_.n)("label",{class:ot},(0,_.n)("span",{class:st},a||this.messages.noTitle),l)],c=i.editing?(0,_.n)("button",{key:"details-button",bind:this,class:tt,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":n.id,onclick:function(){return t._startEditAttachment(n)},type:"button"},u):(0,_.n)("a",{key:"details-link",class:tt,href:o,target:"_blank"},u);return(0,_.n)("li",{class:et,key:n},c)}},{key:"renderAttachmentContainer",value:function(){var e,t=this,n=this.effectiveDisplayType,r=this.viewModel,i=this.visibleElements,a=r.attachmentInfos,s=r.abilities,l=a&&a.length,u=(e={},(0,o.Z)(e,$e,"preview"!==n),(0,o.Z)(e,Ge,"preview"===n),e),c=s.editing&&s.operations.add&&i.addButton?(0,_.n)("button",{bind:this,onclick:function(){return t._startAddAttachment()},class:this.classes(It,xt,Qe),type:"button"},(0,_.n)("span",{"aria-hidden":"true",class:this.classes(ft,Lt)}),this.messages.add):null,d=l?(0,_.n)("ul",{class:Je},a.toArray().map((function(e){return t.renderAttachmentInfo({attachmentInfo:e,displayType:n})}))):(0,_.n)("div",{class:Ct},this.messages.noAttachments);return(0,_.n)("div",{key:"attachments-container",class:this.classes(Ke,u)},d,c)}},{key:"_modeChanged",value:function(){this._set("error",null),this._set("selectedFile",null)}},{key:"_handleFileInputChange",value:function(e){var t=e.target,n=t&&t.files&&t.files.item(0);this._set("selectedFile",n)}},{key:"_submitDeleteAttachment",value:function(e,t){e.preventDefault(),this.deleteAttachment(t)}},{key:"_submitAddAttachment",value:function(e){e.preventDefault(),this.addAttachment()}},{key:"_submitUpdateAttachment",value:function(e){e.preventDefault(),this.updateAttachment()}},{key:"_startEditAttachment",value:function(e){var t=this.viewModel;t.activeAttachmentInfo=e,t.mode="edit"}},{key:"_startAddAttachment",value:function(){this.viewModel.mode="add"}},{key:"_cancelForm",value:function(e){e.preventDefault(),this.viewModel.mode="view"}},{key:"_getCSSTransform",value:function(e,t){var n=e.orientationInfo;return!this._supportsImageOrientation&&t&&n?[n.rotation?"rotate(".concat(n.rotation,"deg)"):"",n.mirrored?"scaleX(-1)":""].join(" "):""}}]),n}(_.O);(0,v.e)([(0,g.o)("viewModel.abilities")],Rt.prototype,"abilities",void 0),(0,v.e)([(0,v.d)()],Rt.prototype,"displayType",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Rt.prototype,"effectiveDisplayType",null),(0,v.e)([(0,g.o)("viewModel.graphic")],Rt.prototype,"graphic",void 0),(0,v.e)([(0,v.d)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Rt.prototype,"label",void 0),(0,v.e)([(0,v.d)(),(0,_.e)("esri/widgets/Attachments/t9n/Attachments")],Rt.prototype,"messages",void 0),(0,v.e)([(0,v.d)(),(0,_.e)("esri/core/t9n/Units")],Rt.prototype,"messagesUnits",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Rt.prototype,"selectedFile",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Rt.prototype,"submitting",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Rt.prototype,"error",void 0),(0,v.e)([(0,v.d)({type:qe})],Rt.prototype,"viewModel",void 0),(0,v.e)([(0,v.d)()],Rt.prototype,"visibleElements",void 0),(0,v.e)([(0,v.q)("visibleElements")],Rt.prototype,"castVisibleElements",null);var Nt=Rt=(0,v.e)([(0,v.n)("esri.widgets.Attachments")],Rt),Ot=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e)).description=null,r.title=null,r}return(0,u.Z)(n)}(qe);(0,v.e)([(0,v.d)()],Ot.prototype,"description",void 0),(0,v.e)([(0,v.d)()],Ot.prototype,"title",void 0);var Pt=Ot=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],Ot),zt="esri-feature-element-info",jt="esri-feature-element-info__title",Vt="esri-feature-element-info__description",qt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r)).description=null,i.headingLevel=2,i.title=null,i}return(0,u.Z)(n,[{key:"render",value:function(){return(0,_.n)("div",{class:zt},this.renderTitle(),this.renderDescription())}},{key:"renderTitle",value:function(){var e=this.title;return e?(0,_.n)(L.n,{level:this.headingLevel,class:jt},e):null}},{key:"renderDescription",value:function(){var e=this.description;return e?(0,_.n)("div",{key:"description",class:Vt},e):null}}]),n}(_.O);(0,v.e)([(0,v.d)()],qt.prototype,"description",void 0),(0,v.e)([(0,v.d)()],qt.prototype,"headingLevel",void 0),(0,v.e)([(0,v.d)()],qt.prototype,"title",void 0);var Ut=qt=(0,v.e)([(0,v.n)("esri.widgets.Feature.support.FeatureElementInfo")],qt),Dt="esri-feature-attachments",Wt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r))._featureElementInfo=null,i.attachmentsWidget=new Nt,i.description=null,i.displayType=null,i.graphic=null,i.headingLevel=2,i.title=null,i.viewModel=new Pt,i}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new Ut,this.own([(0,y.l)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(n=e.viewModel)||void 0===n?void 0:n.title,e.headingLevel]}),(function(){return e._setupFeatureElementInfo()}),y.h),(0,y.l)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.graphic}),(function(t){return e.attachmentsWidget.graphic=t}),y.h)])}},{key:"destroy",value:function(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}},{key:"render",value:function(){var e,t=this.attachmentsWidget;return(0,_.n)("div",{class:Dt},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),null===t||void 0===t?void 0:t.render())}},{key:"_setupFeatureElementInfo",value:function(){var e=this.description,t=this.title,n=this.headingLevel;this._featureElementInfo.set({description:e,title:t,headingLevel:n})}}]),n}(_.O);(0,v.e)([(0,v.d)({readOnly:!0})],Wt.prototype,"attachmentsWidget",void 0),(0,v.e)([(0,g.o)("viewModel.description")],Wt.prototype,"description",void 0),(0,v.e)([(0,g.o)("attachmentsWidget.displayType")],Wt.prototype,"displayType",void 0),(0,v.e)([(0,g.o)("viewModel.graphic")],Wt.prototype,"graphic",void 0),(0,v.e)([(0,v.d)()],Wt.prototype,"headingLevel",void 0),(0,v.e)([(0,g.o)("viewModel.title")],Wt.prototype,"title",void 0),(0,v.e)([(0,v.d)({type:Pt})],Wt.prototype,"viewModel",void 0);var Bt=Wt=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureAttachments")],Wt),Kt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e))._loadingPromise=null,r.created=null,r.creator=null,r.destroyer=null,r.graphic=null,r.handles.add((0,y.l)((function(){return r.creator}),(function(e){r._destroyContent(),r._createContent(e)}),y.h)),r}return(0,u.Z)(n,[{key:"destroy",value:function(){this._destroyContent()}},{key:"state",get:function(){return this._loadingPromise?"loading":"ready"}},{key:"_destroyContent",value:function(){var e=this.created,t=this.graphic,n=this.destroyer;e&&(oe(n,{graphic:t}).catch((function(){return null})),this._set("created",null))}},{key:"_createContent",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.graphic,r=oe(t,{graphic:n}).catch((function(){return null})),this._loadingPromise=r,this.notifyChange("state"),e.next=4,r;case 4:i=e.sent,r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",i));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}((0,S.a)(v.y));(0,v.e)([(0,v.d)({readOnly:!0})],Kt.prototype,"created",void 0),(0,v.e)([(0,v.d)()],Kt.prototype,"creator",void 0),(0,v.e)([(0,v.d)()],Kt.prototype,"destroyer",void 0),(0,v.e)([(0,v.d)({type:x.g})],Kt.prototype,"graphic",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Kt.prototype,"state",null);var $t=Kt=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],Kt),Gt="esri-feature-content",Yt="esri-feature-content__loader-container",Ht="esri-feature-content__loader",Qt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r)).creator=null,i.graphic=null,i.viewModel=null,i._addTargetToAnchors=function(e){Array.from(e.querySelectorAll("a")).forEach((function(e){le(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))},i}return(0,u.Z)(n,[{key:"renderLoading",value:function(){return(0,_.n)("div",{class:Yt,key:"loader"},(0,_.n)("div",{class:Ht}))}},{key:"renderCreated",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.created;return t?t instanceof HTMLElement?(0,_.n)("div",{key:t,bind:t,afterCreate:this._attachToNode}):(0,R.e)(t)?(0,_.n)("div",{key:t},!t.destroyed&&t.render()):(0,_.n)("div",{key:t,innerHTML:t,afterCreate:this._addTargetToAnchors}):null}},{key:"render",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.state;return(0,_.n)("div",{class:Gt},"loading"===t?this.renderLoading():this.renderCreated())}},{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),n}(_.O);(0,v.e)([(0,g.o)("viewModel.creator")],Qt.prototype,"creator",void 0),(0,v.e)([(0,g.o)("viewModel.graphic")],Qt.prototype,"graphic",void 0),(0,v.e)([(0,v.d)({type:$t})],Qt.prototype,"viewModel",void 0);var Xt=Qt=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureContent")],Qt),Jt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e)).attributes=null,r.expressionInfos=null,r.description=null,r.fieldInfos=null,r.title=null,r}return(0,u.Z)(n,[{key:"formattedFieldInfos",get:function(){var e=this.expressionInfos,t=this.fieldInfos,n=[];return null!==t&&void 0!==t&&t.forEach((function(t){if(!t.hasOwnProperty("visible")||t.visible){var r=t.clone();r.label=ce(r,e),n.push(r)}})),n}}]),n}(v.y);(0,v.e)([(0,v.d)()],Jt.prototype,"attributes",void 0),(0,v.e)([(0,v.d)({type:[T.d]})],Jt.prototype,"expressionInfos",void 0),(0,v.e)([(0,v.d)()],Jt.prototype,"description",void 0),(0,v.e)([(0,v.d)({type:[T.a]})],Jt.prototype,"fieldInfos",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Jt.prototype,"formattedFieldInfos",null),(0,v.e)([(0,v.d)()],Jt.prototype,"title",void 0);var en=Jt=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],Jt),tn=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function nn(e,t){if("string"!=typeof t||!t)return t;var n=function(e){var t=null;return tn.some((function(n){return n.pattern.test(e)&&(t=n),!!t})),t}(t);if(!n)return t;var r=t.match(n.pattern),i=r&&r[2],a=(0,v.r)((0,v.r)(n.label,{messages:e,hierPart:i}),{appName:n.appName}),o=n.target?' target="'.concat(n.target,'"'):"",s="_blank"===n.target?' rel="noreferrer"':"";return t.replace(n.pattern,"<a".concat(o,' href="$1"').concat(s,">").concat(a,"</a>"))}var rn="esri-feature-fields",an="esri-feature-fields__field-header",on="esri-feature-fields__field-data",sn="esri-feature-fields__field-data--date",ln="esri-widget__table",un=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r))._featureElementInfo=null,i.attributes=null,i.description=null,i.expressionInfos=null,i.fieldInfos=null,i.title=null,i.viewModel=new en,i.messages=null,i.messagesURIUtils=null,i}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new Ut,this.own((0,y.l)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(n=e.viewModel)||void 0===n?void 0:n.title]}),(function(){return e._setupFeatureElementInfo()}),y.h))}},{key:"destroy",value:function(){this._featureElementInfo.destroy()}},{key:"renderFieldInfo",value:function(e,t){var n=this.viewModel.attributes,r=e.fieldName,i=e.label||r,a=n?null==n[r]?"":n[r]:"",s=!(!e.format||!e.format.dateFormat),l="number"!=typeof a||s?nn(this.messagesURIUtils,a):this._forceLTR(a),u=(0,o.Z)({},sn,s);return(0,_.n)("tr",{key:"fields-element-info-row-".concat(r,"-").concat(t)},(0,_.n)("th",{key:"fields-element-info-row-header-".concat(r,"-").concat(t),class:an,innerHTML:i}),(0,_.n)("td",{key:"fields-element-info-row-data-".concat(r,"-").concat(t),class:this.classes(on,u),innerHTML:l}))}},{key:"renderFields",value:function(){var e=this,t=this.viewModel.formattedFieldInfos;return null!==t&&void 0!==t&&t.length?(0,_.n)("table",{class:ln,summary:this.messages.fieldsSummary},(0,_.n)("tbody",null,t.map((function(t,n){return e.renderFieldInfo(t,n)})))):null}},{key:"render",value:function(){var e;return(0,_.n)("div",{class:rn},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderFields())}},{key:"_setupFeatureElementInfo",value:function(){var e=this.description,t=this.title;this._featureElementInfo.set({description:e,title:t})}},{key:"_forceLTR",value:function(e){return"&lrm;".concat(e)}}]),n}(_.O);(0,v.e)([(0,g.o)("viewModel.attributes")],un.prototype,"attributes",void 0),(0,v.e)([(0,g.o)("viewModel.description")],un.prototype,"description",void 0),(0,v.e)([(0,g.o)("viewModel.expressionInfos")],un.prototype,"expressionInfos",void 0),(0,v.e)([(0,g.o)("viewModel.fieldInfos")],un.prototype,"fieldInfos",void 0),(0,v.e)([(0,g.o)("viewModel.title")],un.prototype,"title",void 0),(0,v.e)([(0,v.d)({type:en})],un.prototype,"viewModel",void 0),(0,v.e)([(0,v.d)(),(0,_.e)("esri/widgets/Feature/t9n/Feature")],un.prototype,"messages",void 0),(0,v.e)([(0,v.d)(),(0,_.e)("esri/widgets/support/t9n/uriUtils")],un.prototype,"messagesURIUtils",void 0);var cn=un=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureFields")],un),dn=v.s.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),fn=new Map;function pn(e){if(!Re(e))return null;var t=e.split("/").slice(1),n=(0,a.Z)(t,2);return{layerId:n[0],fieldName:n[1]}}function hn(e){var t,n=e.originRelationship,r=e.relationships,i=e.layerId;return r&&r.some((function(e){return"".concat(e.relatedTableId)===i&&e.id===n.id&&(t=e),!!t})),t}function vn(e,t){var n=t.toLowerCase();for(var r in e)if(r.toLowerCase()===n)return e[r];return null}function mn(e,t){var n=function(e,t){if(!t.relationships)return null;var n=null;return t.relationships.some((function(t){return t.id===parseInt(e,10)&&(n=t,!0)})),n}(e,t);if(n)return{url:"".concat(t.url,"/").concat(n.relatedTableId),sourceSpatialReference:t.spatialReference,relation:n,relatedFields:[],outStatistics:[]}}function yn(e,t){if(t&&e){var n=e.features,r=e.statsFeatures,i=n&&n.value;t.relatedFeatures=i?i.features:[];var a=r&&r.value;t.relatedStatsFeatures=a?a.features:[]}}function gn(e,t,n,r){var i=new Z.d;return i.outFields=["*"],i.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),i.objectIds=[e.attributes[n.objectIdField]],n.queryRelatedFeatures(i,r)}function bn(e,t,n){for(var r=0,i=[];r<t.length;)i.push("".concat(e," IN (").concat(t.slice(r,n+r),")")),r+=n;return i.join(" OR ")}function _n(){return _n=(0,h.Z)((0,s.Z)().mark((function e(t,n,r,i){var a,o,l,u,c,d,f,p,h,m,y,g,b,_,w,I,k,M,x;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.layerId.toString(),o=n.layerInfo,l=n.relation,u=n.relatedFields,c=n.outStatistics,d=n.url,f=n.sourceSpatialReference,!(p=hn({originRelationship:l,relationships:o.relationships,layerId:a})).relationshipTableId||!p.keyFieldInRelationshipTable){e.next=14;break}return e.next=4,gn(t,p,r,i);case 4:if(e.t0=t.attributes[r.objectIdField],h=e.sent[e.t0]){e.next=8;break}return e.abrupt("return",null);case 8:if(m=h.features.map((function(e){return e.attributes[o.objectIdField]})),!((null===c||void 0===c?void 0:c.length)>0&&o.supportsStatistics)){e.next=14;break}return(y=new O.b).where=bn(o.objectIdField,m,1e3),y.outFields=u,y.outStatistics=c,y.sourceSpatialReference=f,g={features:Promise.resolve(h),statsFeatures:(0,F.s)(d,y)},e.abrupt("return",(0,v.E)(g));case 14:if(!(b=null===p||void 0===p?void 0:p.keyField)){e.next=18;break}return _=(0,C.B)(kn(o.fields,b)),w=vn(t.attributes,l.keyField),I=_?"".concat(b,"=").concat(w):"".concat(b,"='").concat(w,"'"),k=(0,F.s)(d,new O.b({where:I,outFields:n.relatedFields,sourceSpatialReference:f}),i),M=n.outStatistics&&n.outStatistics.length>0&&o.supportsStatistics?(0,F.s)(d,new O.b({where:I,outFields:n.relatedFields,outStatistics:n.outStatistics,sourceSpatialReference:f}),i):null,x={features:k},e.abrupt("return",(M&&(x.statsFeatures=M),(0,v.E)(x)));case 18:return e.abrupt("return",null);case 19:case"end":return e.stop()}}),e)}))),_n.apply(this,arguments)}function wn(e,t){var n=e.relatedInfos,r=e.layer,i={};return n.forEach((function(e,n){var a=e.relation;if(!a){var o=new v.a("relation-required","A relation is required on a layer to retrieve related records.");throw dn.error(o),o}var s=a.relatedTableId;if("number"!=typeof s){var l=new v.a("A related table ID is required on a layer to retrieve related records.");throw dn.error(l),l}var u="".concat(r.url,"/").concat(s),c=fn.get(u),d=c||function(e,t){return(0,N.U)(e,{query:{f:"json"},signal:t&&t.signal})}(u,t);c||fn.set(u,d),i[n]=d})),(0,v.E)(i)}function In(e,t){var n=e.graphic,r=e.relatedInfos,i=e.layer,a={};return r.forEach((function(e,r){e.layerInfo&&(a[r]=function(e,t,n,r){return _n.apply(this,arguments)}(n,e,i,t))})),(0,v.E)(a)}function kn(e,t){if(null!=e){t=t.toLowerCase();var n,r=(0,i.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a&&a.name.toLowerCase()===t)return a}}catch(o){r.e(o)}finally{r.f()}}return null}var Mn={chartAnimation:!0},xn=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e)).abilities=(0,p.Z)({},Mn),r.activeMediaInfoIndex=0,r.attributes=null,r.description=null,r.fieldInfoMap=null,r.formattedAttributes=null,r.expressionAttributes=null,r.layer=null,r.mediaInfos=null,r.popupTemplate=null,r.relatedInfos=null,r.title=null,r}return(0,u.Z)(n,[{key:"castAbilities",value:function(e){return(0,p.Z)((0,p.Z)({},Mn),e)}},{key:"activeMediaInfo",get:function(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}},{key:"formattedMediaInfos",get:function(){return this._formatMediaInfos()||[]}},{key:"formattedMediaInfoCount",get:function(){return this.formattedMediaInfos.length}},{key:"setActiveMedia",value:function(e){this._setContentElementMedia(e)}},{key:"next",value:function(){this._pageContentElementMedia(1)}},{key:"previous",value:function(){this._pageContentElementMedia(-1)}},{key:"_setContentElementMedia",value:function(e){var t=this.formattedMediaInfoCount,n=(e+t)%t;this.activeMediaInfoIndex=n}},{key:"_pageContentElementMedia",value:function(e){var t=this.activeMediaInfoIndex+e;this._setContentElementMedia(t)}},{key:"_formatMediaInfos",value:function(){var e=this,t=this.attributes,n=this.mediaInfos,r=this.formattedAttributes,i=this.expressionAttributes,a=this.fieldInfoMap,o=this.layer;return null===n||void 0===n?void 0:n.map((function(n){var s=null===n||void 0===n?void 0:n.clone();if(!s)return null;if(s.title=he({attributes:t,fieldInfoMap:a,globalAttributes:r,expressionAttributes:i,layer:o,text:s.title}),s.caption=he({attributes:t,fieldInfoMap:a,globalAttributes:r,expressionAttributes:i,layer:o,text:s.caption}),s.altText=he({attributes:t,fieldInfoMap:a,globalAttributes:r,expressionAttributes:i,layer:o,text:s.altText}),"image"===s.type){var l=s.value;return e._setImageValue({value:l,formattedAttributes:r,layer:o}),s.value.sourceURL?s:void 0}if("pie-chart"===s.type||"line-chart"===s.type||"column-chart"===s.type||"bar-chart"===s.type){var u=s.value;return e._setChartValue({value:u,chartType:s.type,attributes:t,formattedAttributes:r,layer:o}),s}return null})).filter(Boolean)}},{key:"_setImageValue",value:function(e){var t=this.fieldInfoMap,n=e.value,r=e.formattedAttributes,i=e.layer,a=n.linkURL,o=n.sourceURL;if(o){var s=ge(o,i);n.sourceURL=ve({formattedAttributes:r,template:s,fieldInfoMap:t})}if(a){var l=ge(a,i);n.linkURL=ve({formattedAttributes:r,template:l,fieldInfoMap:t})}}},{key:"_setChartValue",value:function(e){var t=this,n=e.value,r=e.attributes,i=e.formattedAttributes,a=e.chartType,o=e.layer,s=this.popupTemplate,l=this.relatedInfos,u=n.fields,c=n.normalizeField;if(n.fields=function(e,t){return e&&e.map((function(e){return de(e,t)}))}(u,o),c&&(n.normalizeField=de(c,o)),u.some((function(e){return!!(null!=i[e]||Re(e)&&l.size)}))){var d=null===s||void 0===s?void 0:s.fieldInfos;u.forEach((function(e){if(Re(e))n.series=[].concat((0,f.Z)(n.series),(0,f.Z)(t._getRelatedChartInfos({fieldInfos:d,fieldName:e,formattedAttributes:i,chartType:a,value:n})));else{var o=t._getChartOption({value:n,attributes:r,chartType:a,formattedAttributes:i,fieldName:e,fieldInfos:d});n.series.push(o)}}))}}},{key:"_getRelatedChartInfos",value:function(e){var t,n=this,r=e.fieldInfos,i=e.fieldName,a=e.formattedAttributes,o=e.chartType,s=e.value,l=[],u=pn(i),c=u.layerId,d=u.fieldName,f=null===(t=this.relatedInfos)||void 0===t?void 0:t.get(c.toString());if(!f)return l;var p=f.relatedFeatures,h=f.relation;if(!h||!p)return l;var v=h.cardinality;return p.forEach((function(e){var t=e.attributes;t&&Object.keys(t).forEach((function(e){e===d&&l.push(n._getChartOption({value:s,attributes:t,formattedAttributes:a,fieldName:i,chartType:o,relatedFieldName:e,fieldInfos:r}))}))})),"one-to-many"===v||"many-to-many"===v?l:[l[0]]}},{key:"_getTooltip",value:function(e){var t=e.label,n=e.value;return"pie-chart"===e.chartType?"".concat(t):"".concat(t,": ").concat(n)}},{key:"_getChartOption",value:function(e){var t,n=e.value,r=e.attributes,i=e.formattedAttributes,a=e.fieldName,o=e.relatedFieldName,s=e.fieldInfos,l=e.chartType,u=this.layer,c=this.fieldInfoMap,d=n.normalizeField,f=n.tooltipField,p=d?Re(d)?r[pn(d).fieldName]:r[d]:null,h=o&&void 0!==r[o]?r[o]:void 0!==r[a]?r[a]:i[a],v=new T.e({fieldName:a,value:void 0===h?null:h&&p?h/p:h});if(Re(a)){var m,y,g,b,_,w=c.get(a.toLowerCase()),I=c.get(f.toLowerCase()),k=null!==(m=null===w||void 0===w?void 0:w.fieldName)&&void 0!==m?m:a,M=null!==(y=null!==(g=null!==(b=i[null!==(_=null===I||void 0===I?void 0:I.fieldName)&&void 0!==_?_:f])&&void 0!==b?b:null===w||void 0===w?void 0:w.label)&&void 0!==g?g:null===w||void 0===w?void 0:w.fieldName)&&void 0!==y?y:o,x=i[k];return v.tooltip=this._getTooltip({label:M,value:x,chartType:l}),v}var A=Ie(s,a),F=de(a,u),Z=f&&void 0!==i[f]?i[f]:ce(A||new T.a({fieldName:F}),null===(t=this.popupTemplate)||void 0===t?void 0:t.expressionInfos),C=i[F];return v.tooltip=this._getTooltip({label:Z,value:C,chartType:l}),v}}]),n}(v.y);(0,v.e)([(0,v.d)()],xn.prototype,"abilities",void 0),(0,v.e)([(0,v.q)("abilities")],xn.prototype,"castAbilities",null),(0,v.e)([(0,v.d)()],xn.prototype,"activeMediaInfoIndex",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],xn.prototype,"activeMediaInfo",null),(0,v.e)([(0,v.d)()],xn.prototype,"attributes",void 0),(0,v.e)([(0,v.d)()],xn.prototype,"description",void 0),(0,v.e)([(0,v.d)()],xn.prototype,"fieldInfoMap",void 0),(0,v.e)([(0,v.d)()],xn.prototype,"formattedAttributes",void 0),(0,v.e)([(0,v.d)()],xn.prototype,"expressionAttributes",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],xn.prototype,"formattedMediaInfos",null),(0,v.e)([(0,v.d)()],xn.prototype,"layer",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],xn.prototype,"formattedMediaInfoCount",null),(0,v.e)([(0,v.d)()],xn.prototype,"mediaInfos",void 0),(0,v.e)([(0,v.d)()],xn.prototype,"popupTemplate",void 0),(0,v.e)([(0,v.d)()],xn.prototype,"relatedInfos",void 0),(0,v.e)([(0,v.d)()],xn.prototype,"title",void 0);var An,Fn,Zn=xn=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],xn),Cn=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],Tn=[{name:"default",colors:[].concat(Cn.slice(30,39),Cn.slice(28,30).reverse())},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}],En="en-us",Ln=new Map([["ar",function(){return n.e(5211).then(n.bind(n,55211)).then((function(e){return e.a}))}],["bg-bg",function(){return n.e(3879).then(n.bind(n,63879)).then((function(e){return e.b}))}],["bs-ba",function(){return n.e(4446).then(n.bind(n,44446)).then((function(e){return e.b}))}],["ca-es",function(){return n.e(8948).then(n.bind(n,98948)).then((function(e){return e.c}))}],["cs-cz",function(){return n.e(3467).then(n.bind(n,33467)).then((function(e){return e.c}))}],["da-dk",function(){return n.e(2155).then(n.bind(n,92155)).then((function(e){return e.d}))}],["de-de",function(){return n.e(2610).then(n.bind(n,52610)).then((function(e){return e.d}))}],["de-ch",function(){return n.e(7977).then(n.bind(n,47977)).then((function(e){return e.d}))}],["el-gr",function(){return n.e(9369).then(n.bind(n,19369)).then((function(e){return e.e}))}],["en-us",function(){return n.e(8437).then(n.bind(n,18437)).then((function(e){return e.e}))}],["en-ca",function(){return n.e(2944).then(n.bind(n,32944)).then((function(e){return e.e}))}],["es-es",function(){return n.e(9094).then(n.bind(n,19094)).then((function(e){return e.e}))}],["et-ee",function(){return n.e(5412).then(n.bind(n,3120)).then((function(e){return e.e}))}],["fi-fi",function(){return n.e(3485).then(n.bind(n,23485)).then((function(e){return e.f}))}],["fr-fr",function(){return n.e(4728).then(n.bind(n,4728)).then((function(e){return e.f}))}],["he-il",function(){return n.e(1443).then(n.bind(n,91443)).then((function(e){return e.h}))}],["hr-hr",function(){return n.e(4299).then(n.bind(n,84299)).then((function(e){return e.h}))}],["hu-hu",function(){return n.e(7082).then(n.bind(n,17082)).then((function(e){return e.h}))}],["id-id",function(){return n.e(4695).then(n.bind(n,94695)).then((function(e){return e.i}))}],["it-it",function(){return n.e(2176).then(n.bind(n,12176)).then((function(e){return e.i}))}],["ja-jp",function(){return n.e(7624).then(n.bind(n,47624)).then((function(e){return e.j}))}],["ko-kr",function(){return n.e(4742).then(n.bind(n,4742)).then((function(e){return e.k}))}],["lt-lt",function(){return n.e(7987).then(n.bind(n,97987)).then((function(e){return e.l}))}],["lv-lv",function(){return n.e(9956).then(n.bind(n,59956)).then((function(e){return e.l}))}],["nb-no",function(){return n.e(1271).then(n.bind(n,11271)).then((function(e){return e.n}))}],["nl-nl",function(){return n.e(3064).then(n.bind(n,53064)).then((function(e){return e.n}))}],["pl-pl",function(){return n.e(4389).then(n.bind(n,14389)).then((function(e){return e.p}))}],["pt-br",function(){return n.e(1357).then(n.bind(n,41357)).then((function(e){return e.p}))}],["pt-pt",function(){return n.e(1011).then(n.bind(n,1011)).then((function(e){return e.p}))}],["ro-ro",function(){return n.e(5202).then(n.bind(n,75202)).then((function(e){return e.r}))}],["ru-ru",function(){return n.e(2980).then(n.bind(n,32980)).then((function(e){return e.r}))}],["sk-sk",function(){return n.e(8785).then(n.bind(n,68785)).then((function(e){return e.s}))}],["sl-sl",function(){return n.e(3771).then(n.bind(n,23771)).then((function(e){return e.s}))}],["sr-rs",function(){return n.e(5446).then(n.bind(n,15446)).then((function(e){return e.s}))}],["sv-se",function(){return n.e(6347).then(n.bind(n,86347)).then((function(e){return e.s}))}],["th-th",function(){return n.e(7961).then(n.bind(n,67961)).then((function(e){return e.t}))}],["tr-tr",function(){return n.e(5131).then(n.bind(n,15131)).then((function(e){return e.t}))}],["uk-ua",function(){return n.e(2101).then(n.bind(n,22101)).then((function(e){return e.u}))}],["vi-vn",function(){return n.e(8865).then(n.bind(n,68865)).then((function(e){return e.v}))}],["zh-cn",function(){return n.e(6106).then(n.bind(n,56106)).then((function(e){return e.z}))}],["zh-hk",function(){return n.e(5597).then(n.bind(n,95597)).then((function(e){return e.z}))}],["zh-tw",function(){return n.e(5597).then(n.bind(n,95597)).then((function(e){return e.z}))}]]);function Sn(e){return e?Ln.has(e.toLowerCase())?e.toLowerCase():function(e){var t,n=e.split("-")[0].toLowerCase(),r=null,a=(0,i.Z)(Ln.keys());try{for(a.s();!(t=a.n()).done;){var o=t.value;if(o.startsWith(n)){r=o;break}}}catch(s){a.e(s)}finally{a.f()}return r}(e)||En:En}function Rn(){return Nn.apply(this,arguments)}function Nn(){return Nn=(0,h.Z)((0,s.Z)().mark((function e(){var t,r,i,o,l,u=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Sn(t=u.length>0&&void 0!==u[0]?u[0]:(0,P.l)()),!An||t!==Fn){e.next=3;break}return e.abrupt("return",An);case 3:return An=n.e(696).then(n.bind(n,50696)).then((function(e){return e.i})),Fn=t,e.prev=4,e.next=7,Promise.all([An,Ln.get(Fn)()]);case 7:r=e.sent,i=(0,a.Z)(r,2),o=i[0],l=i[1],Fn===t&&(o.am4core.options.defaultLocale=l.default),o.am4core.options.suppressWarnings=!0,o.am4core.options.autoDispose=!0,e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(4),e.abrupt("return",(An=null,Fn=null,null));case 17:return e.abrupt("return",An);case 18:case"end":return e.stop()}}),e,null,[[4,14]])}))),Nn.apply(this,arguments)}var On="esri-feature-media",Pn="esri-feature-media__container",zn="esri-feature-media__item-container",jn="esri-feature-media__item",Vn="esri-feature-media__item-title",qn="esri-feature-media__item-caption",Un="esri-feature-media__previous",Dn="esri-feature-media__previous-icon",Wn="esri-feature-media__previous-icon--rtl",Bn="esri-feature-media__next",Kn="esri-feature-media__next-icon",$n="esri-feature-media__next-icon--rtl",Gn="esri-feature-media__chart",Yn="esri-feature-media__button",Hn="esri-feature-media__icon",Qn="esri-icon-left-triangle-arrow",Xn="esri-icon-right-triangle-arrow",Jn=.05,er=.95,tr="color",nr="tooltip",rr="value",ir="default-line-value",ar=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,i){var a;return(0,l.Z)(this,n),(a=t.call(this,e,i))._refreshTimer=null,a._refreshIntervalInfo=null,a._featureElementInfo=null,a.attributes=null,a.activeMediaInfoIndex=null,a.description=null,a.fieldInfoMap=null,a.layer=null,a.mediaInfos=null,a.popupTemplate=null,a.relatedInfos=null,a.title=null,a.viewModel=new Zn,a.messages=null,a._getChartDependencies=function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,i,o,l,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rn();case 2:if(n=e.sent,i=(0,r.Z)(a),o=i.destroyed,l=i.viewModel,!o&&l&&t){e.next=8;break}return e.abrupt("return");case 8:return u=l.activeMediaInfo,e.next=11,a._getRendererColors(n);case 11:c=e.sent,a._renderChart({chartDiv:t,mediaInfo:u,chartsModule:n,colorMap:c});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new Ut,this.own([(0,y.l)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.activeMediaInfo,null===(n=e.viewModel)||void 0===n?void 0:n.activeMediaInfoIndex]}),(function(){return e._setupMediaRefreshTimer()}),y.h),(0,y.l)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(n=e.viewModel)||void 0===n?void 0:n.title]}),(function(){return e._setupFeatureElementInfo()}),y.h)])}},{key:"destroy",value:function(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}},{key:"render",value:function(){var e;return(0,_.n)("div",{bind:this,class:On,onkeyup:this._handleMediaKeyup},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderMedia())}},{key:"renderMedia",value:function(){return this.viewModel.formattedMediaInfoCount?(0,_.n)("div",{key:"media-element-container",class:Pn},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}},{key:"renderImageMediaInfo",value:function(e){var t=this._refreshIntervalInfo,n=this.viewModel,r=n.activeMediaInfoIndex,i=n.formattedMediaInfoCount,a=e.value,o=e.refreshInterval,s=e.altText,l=e.title,u=e.type,c=a.sourceURL,d=a.linkURL,f=le(d)?"_blank":"_self",p="_blank"===f?"noreferrer":"",h=o?t:null,v=h?h.timestamp:0,m=h?h.sourceURL:c,y=(0,_.n)("img",{alt:s||l,key:"media-".concat(u,"-").concat(r,"-").concat(i,"-").concat(v),src:m});return(d?(0,_.n)("a",{title:l,href:d,rel:p,target:f},y):null)||y}},{key:"renderChartMediaInfo",value:function(e){var t=this.viewModel,n=t.activeMediaInfoIndex,r=t.formattedMediaInfoCount;return(0,_.n)("div",{key:"media-".concat(e.type,"-").concat(n,"-").concat(r),bind:this,class:Gn,afterCreate:this._getChartDependencies})}},{key:"renderMediaInfoType",value:function(){var e=this.viewModel.activeMediaInfo;return e?"image"===e.type?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}},{key:"renderMediaInfo",value:function(){var e=this.viewModel.activeMediaInfo;if(!e)return null;var t=e.title?(0,_.n)("div",{key:"media-title",class:Vn,innerHTML:e.title}):null,n=e.caption?(0,_.n)("div",{key:"media-caption",class:qn,innerHTML:e.caption}):null;return(0,_.n)("div",{key:"media-container",class:zn},(0,_.n)("div",{key:"media-item-container",class:jn},this.renderMediaInfoType()),t,n)}},{key:"renderMediaPageButton",value:function(e){if(this.viewModel.formattedMediaInfoCount<2)return null;var t="previous"===e,n=t?this.messages.previous:this.messages.next,r=t?this.classes(Yn,Un):this.classes(Yn,Bn),i=t?this.classes(Hn,Dn,Qn):this.classes(Hn,Kn,Xn),a=t?this.classes(Hn,Wn,Xn):this.classes(Hn,$n,Qn),o=t?"media-previous":"media-next",s=t?this._previous:this._next;return(0,_.n)("button",{type:"button",key:o,title:n,"aria-label":n,tabIndex:0,class:r,bind:this,onclick:s},(0,_.n)("span",{"aria-hidden":"true",class:i}),(0,_.n)("span",{"aria-hidden":"true",class:a}))}},{key:"_setupFeatureElementInfo",value:function(){var e=this.description,t=this.title;this._featureElementInfo.set({description:e,title:t})}},{key:"_next",value:function(){this.viewModel.next()}},{key:"_previous",value:function(){this.viewModel.previous()}},{key:"_getRendererColors",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.am4core,i=null===(n=this.viewModel)||void 0===n?void 0:n.layer,a=new Map,i){e.next=3;break}return e.abrupt("return",a);case 3:return e.next=5,(0,L.h)(i.renderer);case 5:return(o=e.sent).delete(null),e.abrupt("return",Array.from(o.values()).every((function(e){return 1===(null===e||void 0===e?void 0:e.length)}))?(a.set(ir,r.color({r:50,g:50,b:50,a:1})),Array.from(o.keys()).forEach((function(e){e&&a.set(e,r.color(o.get(e)[0].toCss(!0)))})),a):a);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_handleMediaKeyup",value:function(e){var t=(0,v.i)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}},{key:"_renderChart",value:function(e){var t=this.viewModel.abilities,n=e.chartsModule,r=e.chartDiv,i=e.mediaInfo,a=e.colorMap,s=i.value,l=i.type,u=n.am4core,c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=Tn.find((function(e){return e.name===t}));return n?n.colors.map((function(t){return e.color(t)})):null}(u);(0,L.r)()&&u.useTheme(n.am4themes_dark);var d=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!d.matches?u.useTheme(n.am4themes_animated):u.unuseTheme(n.am4themes_animated),u.useTheme((function(e){e instanceof u.ColorSet&&c&&(e.list=c)}));var f="pie-chart"===l?this._createPieChart(e):this._createXYChart(e);r.setAttribute("aria-label",i.altText||i.title),f.data=s.series.map((function(e){var t;return t={},(0,o.Z)(t,nr,e.tooltip),(0,o.Z)(t,rr,e.value),(0,o.Z)(t,tr,a.get(e.fieldName)),t})).filter((function(e){return"pie-chart"!==l||e.value>0}))}},{key:"_customizeChartTooltip",value:function(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}},{key:"_createPieChart",value:function(e){var t=e.chartDiv,n=e.chartsModule,r=n.am4core,i=n.am4charts,a=r.create(t,i.PieChart);a.rtl=(0,_.f)(this.container);var o=a.series.push(new i.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value=rr,o.dataFields.category=nr,this._customizeChartTooltip(o.tooltip,r),o.slices.template.tooltipText=a.rtl?"{category}: %{value.percent.formatNumber('#.0')}":"{category}: {value.percent.formatNumber('#.0')}%",o.slices.template.propertyFields.fill=tr,o.slices.template.propertyFields.stroke=tr,a}},{key:"_getMinSeriesValue",value:function(e){var t=0;return e.forEach((function(e){return t=Math.min(e.value,t)})),t}},{key:"_createColumnChart",value:function(e,t){var n=t.chartsModule,r=t.mediaInfo.value,i=n.am4core,a=n.am4charts,o=e.xAxes.push(new a.CategoryAxis);o.dataFields.category=nr,o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,i),o.tooltip.events.on("sizechanged",(function(){o.tooltip.dy=-o.tooltip.contentHeight}));var s=e.yAxes.push(new a.ValueAxis),l=s.renderer.labels.template;s.renderer.minLabelPosition=Jn,s.renderer.maxLabelPosition=er,s.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(s.tooltip,i),l.wrap=!0;var u=e.series.push(new a.ColumnSeries);u.dataFields.valueY=rr,u.dataFields.categoryX=nr,u.columns.template.propertyFields.fill=tr,u.columns.template.propertyFields.stroke=tr,e.cursor=new a.XYCursor,r.series.length>15&&(e.scrollbarX=new i.Scrollbar)}},{key:"_createBarChart",value:function(e,t){var n=t.chartsModule,r=t.mediaInfo.value,i=n.am4core,a=n.am4charts,o=e.yAxes.push(new a.CategoryAxis);o.dataFields.category=nr,o.renderer.inversed=!0,o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,i),o.tooltip.events.on("sizechanged",(function(){o.tooltip.dx=o.tooltip.contentWidth}));var s=e.xAxes.push(new a.ValueAxis),l=s.renderer.labels.template;s.renderer.minLabelPosition=Jn,s.renderer.maxLabelPosition=er,s.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(s.tooltip,i),l.wrap=!0;var u=e.series.push(new a.ColumnSeries);u.dataFields.valueX=rr,u.dataFields.categoryY=nr,u.columns.template.propertyFields.fill=tr,u.columns.template.propertyFields.stroke=tr,e.cursor=new a.XYCursor,r.series.length>15&&(e.scrollbarY=new i.Scrollbar)}},{key:"_createLineChart",value:function(e,t){var n=t.chartsModule,r=t.mediaInfo,i=t.colorMap,a=r.value,o=n.am4core,s=n.am4charts,l=e.xAxes.push(new s.CategoryAxis);l.dataFields.category=nr,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,o),l.tooltip.events.on("sizechanged",(function(){l.tooltip.dy=-l.tooltip.contentHeight}));var u=e.yAxes.push(new s.ValueAxis),c=u.renderer.labels.template;u.renderer.minLabelPosition=Jn,u.renderer.maxLabelPosition=er,u.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(u.tooltip,o),c.wrap=!0;var d=e.series.push(new s.LineSeries);d.dataFields.categoryX=nr,d.dataFields.valueY=rr,d.strokeWidth=1;var f=i.get(ir);f&&(d.stroke=f);var p=d.bullets.push(new s.CircleBullet);p.propertyFields.fill=tr,p.propertyFields.stroke=tr,e.cursor=new s.XYCursor,a.series.length>15&&(e.scrollbarX=new o.Scrollbar)}},{key:"_createXYChart",value:function(e){var t=e.chartDiv,n=e.chartsModule,r=e.mediaInfo.type,i=n.am4core,a=n.am4charts,o=i.create(t,a.XYChart);return o.rtl=(0,_.f)(this.container),"column-chart"===r&&this._createColumnChart(o,e),"bar-chart"===r&&this._createBarChart(o,e),"line-chart"===r&&this._createLineChart(o,e),o}},{key:"_clearMediaRefreshTimer",value:function(){var e=this._refreshTimer;e&&(clearTimeout(e),this._refreshTimer=null)}},{key:"_updateMediaInfoTimestamp",value:function(e){var t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}},{key:"_setupMediaRefreshTimer",value:function(){this._clearMediaRefreshTimer();var e=this.viewModel.activeMediaInfo;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}},{key:"_setRefreshTimeout",value:function(e){var t=this,n=e.refreshInterval,r=e.value;if(n){var i=6e4*n;this._updateMediaInfoTimestamp(r.sourceURL);var a=setInterval((function(){t._updateMediaInfoTimestamp(r.sourceURL)}),i);this._refreshTimer=a}}},{key:"_getImageSource",value:function(e,t){var n=e.includes("?")?"&":"?",r=e.split("#"),i=(0,a.Z)(r,2),o=i[0],s=i[1],l=void 0===s?"":s;return"".concat(o).concat(n,"timestamp=").concat(t).concat(l?"#":"").concat(l)}}]),n}(_.O);(0,v.e)([(0,g.o)("viewModel.attributes")],ar.prototype,"attributes",void 0),(0,v.e)([(0,g.o)("viewModel.activeMediaInfoIndex")],ar.prototype,"activeMediaInfoIndex",void 0),(0,v.e)([(0,g.o)("viewModel.description")],ar.prototype,"description",void 0),(0,v.e)([(0,g.o)("viewModel.fieldInfoMap")],ar.prototype,"fieldInfoMap",void 0),(0,v.e)([(0,g.o)("viewModel.layer")],ar.prototype,"layer",void 0),(0,v.e)([(0,g.o)("viewModel.mediaInfos")],ar.prototype,"mediaInfos",void 0),(0,v.e)([(0,g.o)("viewModel.popupTemplate")],ar.prototype,"popupTemplate",void 0),(0,v.e)([(0,g.o)("viewModel.relatedInfos")],ar.prototype,"relatedInfos",void 0),(0,v.e)([(0,g.o)("viewModel.title")],ar.prototype,"title",void 0),(0,v.e)([(0,v.d)({type:Zn})],ar.prototype,"viewModel",void 0),(0,v.e)([(0,v.d)(),(0,_.e)("esri/widgets/Feature/t9n/Feature")],ar.prototype,"messages",void 0);var or=ar=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureMedia")],ar);function sr(e,t,n,r){var i=null,a=1e3;"number"==typeof t?(a=t,r=n):(i=null!==t&&void 0!==t?t:null,a=n);var o,s=0,l=function(){s=0,e.apply(r,o)},u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i&&i.apply(r,t),o=t,a?s||(s=setTimeout(l,a)):l()};return u.remove=function(){s&&(clearTimeout(s),s=0)},u.forceUpdate=function(){s&&(clearTimeout(s),l())},u.hasPendingUpdates=function(){return!!s},u}var lr=["$datastore","$map","$layer","$aggregatedfeatures"],ur=v.s.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function cr(e){return"string"==typeof e?xe(Me(e)):Array.isArray(e)?function(e){return'<ul class="esri-widget__list">'.concat(e.map((function(e){return"<li>".concat("string"==typeof e?xe(Me(e)):e,"</li>")})).join(""),"</ul>")}(e):"esri.arcade.Dictionary"===(null===e||void 0===e?void 0:e.declaredClass)?function(e){return'<table class="esri-widget__table">'.concat(e.keys().map((function(t){var n=e.field(t);return"<tr><th>".concat(t,"</th><td>").concat("string"==typeof n?xe(Me(n)):n,"</td></tr>")})).join(""),"</table>")}(e):e}function dr(e){var t=e.aggregatedFeatures,n=e.arcadeUtils,r=e.featureSetVars,i=e.context,a=e.viewInfo,o=e.map,s=e.graphic,l=e.interceptor;r.forEach((function(e){var r=e.toLowerCase(),u={map:o,spatialReference:a.sr,interceptor:l};if("$map"===r&&(i.vars[r]=n.convertMapToFeatureSetCollection(u)),"$layer"===r&&(i.vars[r]=n.convertFeatureLayerToFeatureSet({layer:s.sourceLayer,spatialReference:a.sr,interceptor:l})),"$datastore"===r&&(i.vars[r]=n.convertServiceUrlToWorkspace({url:s.sourceLayer.url,spatialReference:a.sr,interceptor:l})),"$aggregatedfeatures"===r){var c=s.layer,d=c.fields,f=c.objectIdField,h=c.geometryType,v=c.spatialReference,m=c.displayField,y=new j.K((0,p.Z)((0,p.Z)({fields:d,objectIdField:f,geometryType:h,spatialReference:v,displayField:m},"feature"===c.type?{templates:c.templates,typeIdField:c.typeIdField,types:c.types}:null),{},{source:t}));i.vars[r]=n.convertFeatureLayerToFeatureSet({layer:y,spatialReference:a.sr,interceptor:l})}}))}function fr(){return n.e(8969).then(n.bind(n,28969)).then((function(e){return e.t}))}function pr(e){return hr.apply(this,arguments)}function hr(){return hr=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.graphic,r=t.view,i=n.isAggregate,a=n.layer,i&&a&&"2d"===(null===r||void 0===r?void 0:r.type)){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,r.whenLayerView(a);case 6:if((o=e.sent).createQuery&&o.queryFeatures){e.next=9;break}return e.abrupt("return",[]);case 9:return(l=o.createQuery()).aggregateIds=[n.getObjectId()],e.next=13,o.queryFeatures(l);case 13:return u=e.sent,c=u.features,e.abrupt("return",c);case 16:case"end":return e.stop()}}),e)}))),hr.apply(this,arguments)}function vr(e){return mr.apply(this,arguments)}function mr(){return mr=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,o,l,u,c,d,f,p,h,v,m,y,g;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.expressionInfo,r=t.arcadeUtils,i=t.interceptor,o=t.spatialReference,l=t.map,u=t.graphic,c=t.view,n&&n.expression){e.next=3;break}return e.abrupt("return",null);case 3:return d=r.createSyntaxTree(n.expression),f=lr.filter((function(e){return r.hasVariable(d,e)})),e.next=7,Promise.all([pr({graphic:u,view:c}),r.loadScriptDependencies(d,!0,f)]);case 7:return p=e.sent,h=(0,a.Z)(p,1),v=h[0],m=r.getViewInfo({spatialReference:o}),(y=r.createExecContext(u,m)).interceptor=i,y.useAsync=!0,dr({aggregatedFeatures:v,arcadeUtils:r,featureSetVars:f,context:y,viewInfo:m,map:l,graphic:u,interceptor:i}),g=r.createFunction(d,y),e.abrupt("return",r.executeAsyncFunction(g,y).catch((function(e){return ur.error("arcade-execution-error",{error:e,graphic:u,expressionInfo:n})})));case 15:case"end":return e.stop()}}),e)}))),mr.apply(this,arguments)}function yr(e){return gr.apply(this,arguments)}function gr(){return gr=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,a,o,l,u,c,d,f,p,h,m,y,g;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.expressionInfos,r=t.spatialReference,a=t.graphic,o=t.interceptor,l=t.map,u=t.view,n&&n.length){e.next=3;break}return e.abrupt("return",{});case 3:return e.next=5,fr();case 5:c=e.sent,d={},f=(0,i.Z)(n);try{for(f.s();!(p=f.n()).done;)h=p.value,d["expression/".concat(h.name)]=vr({expressionInfo:h,arcadeUtils:c,interceptor:o,spatialReference:r,map:l,graphic:a,view:u})}catch(s){f.e(s)}finally{f.f()}return e.next=11,(0,v.E)(d);case 11:for(g in m=e.sent,y={},m)y[g]=cr(m[g].value);return e.abrupt("return",y);case 15:case"end":return e.stop()}}),e)}))),gr.apply(this,arguments)}var br=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var i;return(0,l.Z)(this,n),(i=t.call(this,e))._abortController=null,i.expressionInfo=null,i.graphic=null,i.contentElement=null,i.contentElementViewModel=null,i.interceptor=null,i.view=null,i._cancelQuery=function(){var e=(0,r.Z)(i)._abortController;e&&e.abort(),i._abortController=null},i._createVM=function(){var e,t,n=null===(e=i.contentElement)||void 0===e?void 0:e.type;null===(t=i.contentElementViewModel)||void 0===t||t.destroy();var r="fields"===n?new en:"media"===n?new Zn:"text"===n?new $t:null;i._set("contentElementViewModel",r)},i._compile=(0,h.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i._cancelQuery(),t=new AbortController,i._abortController=t,e.next=5,i._compileExpression();case 5:i._abortController===t&&(i._abortController=null);case 6:case"end":return e.stop()}}),e)}))),i._compileThrottled=sr(i._compile,1,(0,r.Z)(i)),i._compileExpression=(0,h.Z)((0,s.Z)().mark((function e(){var t,n,a,o,l,u,c,d,f,p,h,v,m;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,r.Z)(i),n=t.expressionInfo,a=t.graphic,o=t.interceptor,l=t.spatialReference,u=t.map,c=t.view,d=t._abortController,n&&a&&l&&u){e.next=3;break}return e.abrupt("return",void i._set("contentElement",null));case 3:return e.next=5,fr();case 5:if(f=e.sent,d===i._abortController){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,vr({arcadeUtils:f,expressionInfo:n,graphic:a,interceptor:o,map:u,spatialReference:l,view:c});case 10:if((p=e.sent)&&"esri.arcade.Dictionary"===p.declaredClass){e.next=13;break}return e.abrupt("return",void i._set("contentElement",null));case 13:return e.next=15,(0,z.M)(p,d.signal);case 15:h=e.sent,v=null===h||void 0===h?void 0:h.type,m="media"===v?T.I.fromJSON(h):"text"===v?T.f.fromJSON(h):"fields"===v?T.b.fromJSON(h):null,i._set("contentElement",m);case 19:case"end":return e.stop()}}),e)}))),i.handles.add([(0,y.l)((function(){return[i.expressionInfo,i.graphic,i.map,i.spatialReference,i.view]}),(function(){return i._compileThrottled()}),y.h),(0,y.l)((function(){return[i.contentElement]}),(function(){return i._createVM()}),y.h)]),i}return(0,u.Z)(n,[{key:"destroy",value:function(){var e;this._cancelQuery(),null!==(e=this.contentElementViewModel)&&void 0!==e&&e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}},{key:"spatialReference",get:function(){var e;return(null===(e=this.view)||void 0===e?void 0:e.spatialReference)||null},set:function(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}},{key:"state",get:function(){var e=this._abortController,t=this.contentElement,n=this.contentElementViewModel;return e?"loading":t||n?"ready":"disabled"}},{key:"map",get:function(){var e;return(null===(e=this.view)||void 0===e?void 0:e.map)||null},set:function(e){void 0!==e?this._override("map",e):this._clearOverride("map")}}]),n}((0,S.a)(v.y));(0,v.e)([(0,v.d)()],br.prototype,"_abortController",void 0),(0,v.e)([(0,v.d)({type:T.g})],br.prototype,"expressionInfo",void 0),(0,v.e)([(0,v.d)({type:x.g})],br.prototype,"graphic",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],br.prototype,"contentElement",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],br.prototype,"contentElementViewModel",void 0),(0,v.e)([(0,v.d)()],br.prototype,"interceptor",void 0),(0,v.e)([(0,v.d)()],br.prototype,"spatialReference",null),(0,v.e)([(0,v.d)({readOnly:!0})],br.prototype,"state",null),(0,v.e)([(0,v.d)()],br.prototype,"map",null),(0,v.e)([(0,v.d)()],br.prototype,"view",void 0);var _r=br=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],br),wr="esri-icon-loading-indicator esri-rotating",Ir="esri-feature-expression",kr="esri-feature__loading-container",Mr="esri-feature__loading-spinner",xr=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this,e,r)).viewModel=new _r,i}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this.own((0,y.l)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentElementViewModel}),(function(){return e._setupExpressionWidget()}),y.h))}},{key:"destroy",value:function(){this._destroyContentWidget()}},{key:"renderLoading",value:function(){return(0,_.n)("div",{key:"loading-container",class:kr},(0,_.n)("span",{class:this.classes(wr,Mr)}))}},{key:"render",value:function(){var e,t=this.viewModel.state;return(0,_.n)("div",{class:Ir},"loading"===t?this.renderLoading():"disabled"===t?null:null===(e=this._contentWidget)||void 0===e?void 0:e.render())}},{key:"_destroyContentWidget",value:function(){var e=this._contentWidget;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}},{key:"_setupExpressionWidget",value:function(){var e=this.viewModel,t=e.contentElementViewModel,n=e.contentElement,r=null===n||void 0===n?void 0:n.type;this._destroyContentWidget();var i=t?"fields"===r?new cn({viewModel:t}):"media"===r?new or({viewModel:t}):"text"===r?new Xt({viewModel:t}):null:null;this._contentWidget=i,this.scheduleRender()}}]),n}(_.O);(0,v.e)([(0,v.d)({type:_r})],xr.prototype,"viewModel",void 0);var Ar,Fr=xr=(0,v.e)([(0,v.n)("esri.widgets.Feature.FeatureExpression")],xr),Zr=(0,u.Z)((function e(t,n){(0,l.Z)(this,e),this.preLayerQueryCallback=t,this.preRequestCallback=n,this.preLayerQueryCallback||(this.preLayerQueryCallback=function(e){}),this.preRequestCallback||(this.preLayerQueryCallback=function(e){})})),Cr="content-view-models",Tr="esri.widgets.FeatureViewModel",Er=v.s.getLogger(Tr),Lr={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0},Sr=Ar=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var i;return(0,l.Z)(this,n),(i=t.call(this,e))._handles=new V.u,i._error=null,i._featureAbortController=null,i.graphicChangedThrottled=sr(i._graphicChanged,1,(0,r.Z)(i)),i._expressionAttributes=null,i._graphicExpressionAttributes=null,i.abilities=(0,p.Z)({},Lr),i.content=null,i.contentViewModels=[],i.defaultPopupTemplateEnabled=!1,i.formattedAttributes=null,i.lastEditInfo=null,i.relatedInfos=new Map,i.title="",i.view=null,i._isAllowedContentType=function(e){var t=(0,r.Z)(i).abilities;return"attachments"===e.type&&t.attachmentsContent||"custom"===e.type&&t.customContent||"fields"===e.type&&t.fieldsContent||"media"===e.type&&t.mediaContent||"text"===e.type&&t.textContent||"expression"===e.type&&t.expressionContent},i._handles.add((0,y.l)((function(){return[i.graphic,i._effectivePopupTemplate,i.abilities]}),(function(){return i.graphicChangedThrottled()}),y.h)),i}return(0,u.Z)(n,[{key:"destroy",value:function(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}},{key:"_effectivePopupTemplate",get:function(){return(0,b.r)(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}},{key:"_fieldInfoMap",get:function(){return function(e,t){var n=new Map;return e&&e.forEach((function(e){var r=de(e.fieldName,t);e.fieldName=r,n.set(r.toLowerCase(),e)})),n}(ke(this._effectivePopupTemplate),this._sourceLayer)}},{key:"_sourceLayer",get:function(){return ae(this.graphic)}},{key:"castAbilities",value:function(e){return(0,p.Z)((0,p.Z)({},Lr),e)}},{key:"state",get:function(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}},{key:"graphic",set:function(e){this._set("graphic",e?e.clone():null)}},{key:"spatialReference",get:function(){return this.get("view.spatialReference")||null},set:function(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}},{key:"map",get:function(){return this.get("view.map")||null},set:function(e){void 0!==e?this._override("map",e):this._clearOverride("map")}},{key:"waitingForContent",get:function(){return!!this._featureAbortController}},{key:"setActiveMedia",value:function(e,t){var n=this.contentViewModels[e];n instanceof Zn&&n.setActiveMedia(t)}},{key:"nextMedia",value:function(e){var t=this.contentViewModels[e];t instanceof Zn&&t.next()}},{key:"previousMedia",value:function(e){var t=this.contentViewModels[e];t instanceof Zn&&t.previous()}},{key:"_clear",value:function(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}},{key:"_graphicChanged",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cancelFeatureQuery(),this._error=null,this._clear(),t=this.graphic){e.next=4;break}return e.abrupt("return");case 4:return n=new AbortController,this._featureAbortController=n,e.prev=6,e.next=9,this._queryFeature({signal:n.signal});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),(0,v.u)(e.t0)||(this._error=e.t0,Er.error("error","The popupTemplate could not be displayed for this feature.",{error:e.t0,graphic:t,popupTemplate:this._effectivePopupTemplate}));case 14:this._featureAbortController===n&&(this._featureAbortController=null);case 15:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"_cancelFeatureQuery",value:function(){var e=this._featureAbortController;e&&e.abort(),this._featureAbortController=null}},{key:"_compileContentElement",value:function(e,t){return"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):"expression"===e.type?this._compileExpression(e,t):void 0}},{key:"_compileContent",value:function(e){var t=this;if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map((function(e,n){return t._compileContentElement(e,n)})):"string"==typeof e?this._compileText(new T.f({text:e}),0).text:e}},{key:"_destroyContentViewModels",value:function(){var e;null!==(e=this._handles)&&void 0!==e&&e.remove(Cr),this.contentViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("contentViewModels",[])}},{key:"_setExpressionContentVM",value:function(e,t){var n=this.formattedAttributes,r=e.contentElement,i=e.contentElementViewModel,a=null===r||void 0===r?void 0:r.type;i&&a&&("fields"===a&&(this._createFieldsFormattedAttributes({contentElement:r,contentElementIndex:t,formattedAttributes:n}),i.set(this._createFieldsVMParams(r,t))),"media"===a&&(this._createMediaFormattedAttributes({contentElement:r,contentElementIndex:t,formattedAttributes:n}),i.set(this._createMediaVMParams(r,t))),"text"===a&&i.set(this._createTextVMParams(r)))}},{key:"_compileExpression",value:function(e,t){var n=this,r=e.expressionInfo,i=this.graphic,a=this.map,o=this.spatialReference,s=this.view,l=new _r({expressionInfo:r,graphic:i,interceptor:Ar.interceptor,map:a,spatialReference:o,view:s});return this.contentViewModels[t]=l,this._handles.add((0,y.l)((function(){return l.contentElementViewModel}),(function(){return n._setExpressionContentVM(l,t)}),y.h),Cr),e}},{key:"_compileAttachments",value:function(e,t){var n=this.graphic,r=e.description,i=e.title;return this.contentViewModels[t]=new Pt((0,p.Z)({graphic:n},this._compileTitleAndDesc({title:i,description:r}))),e}},{key:"_compileCustom",value:function(e,t){var n=this.graphic,r=e.creator,i=e.destroyer;return this.contentViewModels[t]=new $t({graphic:n,creator:r,destroyer:i}),e}},{key:"_compileTitleAndDesc",value:function(e){var t=e.title,n=e.description,r=this._fieldInfoMap,i=this._sourceLayer,a=this.graphic,o=this.formattedAttributes,s=this._expressionAttributes,l=a.attributes,u=o.global;return{title:he({attributes:l,fieldInfoMap:r,globalAttributes:u,expressionAttributes:s,layer:i,text:t}),description:he({attributes:l,fieldInfoMap:r,globalAttributes:u,expressionAttributes:s,layer:i,text:n})}}},{key:"_createFieldsVMParams",value:function(e,t){var n,r=this._effectivePopupTemplate,i=this.formattedAttributes,a=(0,p.Z)((0,p.Z)({},i.global),i.content[t]),o=null===(n=(null===e||void 0===e?void 0:e.fieldInfos)||(null===r||void 0===r?void 0:r.fieldInfos))||void 0===n?void 0:n.filter((function(e){var t=e.fieldName;return ue(t)||Re(t)||a.hasOwnProperty(t)})),s=null===r||void 0===r?void 0:r.expressionInfos,l=e.description,u=e.title;return(0,p.Z)({attributes:a,expressionInfos:s,fieldInfos:o},this._compileTitleAndDesc({title:u,description:l}))}},{key:"_compileFields",value:function(e,t){var n=e.clone(),r=new en(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=r,n.fieldInfos=r.formattedFieldInfos.slice(0),n}},{key:"_createMediaVMParams",value:function(e,t){var n=this.abilities,r=this.graphic,i=this._fieldInfoMap,a=this.formattedAttributes,o=this._effectivePopupTemplate,s=this.relatedInfos,l=this._sourceLayer,u=this._expressionAttributes,c=r.attributes,d=e.description,f=e.mediaInfos,h=e.title;return(0,p.Z)({abilities:{chartAnimation:n.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:c,layer:l,fieldInfoMap:i,formattedAttributes:(0,p.Z)((0,p.Z)({},a.global),a.content[t]),expressionAttributes:u,mediaInfos:f,popupTemplate:o,relatedInfos:s},this._compileTitleAndDesc({title:h,description:d}))}},{key:"_compileMedia",value:function(e,t){var n=e.clone(),r=new Zn(this._createMediaVMParams(e,t));return n.mediaInfos=r.formattedMediaInfos.slice(0),this.contentViewModels[t]=r,n}},{key:"_createTextVMParams",value:function(e){var t=this.graphic,n=this._fieldInfoMap,r=this._sourceLayer,i=this._expressionAttributes;if(e&&e.text){var a=t.attributes,o=this.formattedAttributes.global;e.text=he({attributes:a,fieldInfoMap:n,globalAttributes:o,expressionAttributes:i,layer:r,text:e.text})}return{graphic:t,creator:e.text}}},{key:"_compileText",value:function(e,t){var n=e.clone();return this.contentViewModels[t]=new $t(this._createTextVMParams(n)),n}},{key:"_compileLastEditInfo",value:function(){var e=this._effectivePopupTemplate,t=this._sourceLayer,n=this.graphic;if(e){var r=e.lastEditInfoEnabled,i=null===t||void 0===t?void 0:t.editFieldsInfo;return r&&i?function(e,t){var n=e.creatorField,r=e.creationDateField,i=e.editorField,a=e.editDateField;if(t){var o=t[a];if("number"==typeof o){var s=t[i];return{type:"edit",date:(0,M.L)(o,ie),user:s}}var l=t[r];if("number"==typeof l){var u=t[n];return{type:"create",date:(0,M.L)(l,ie),user:u}}return null}}(i,n.attributes):void 0}}},{key:"_compileTitle",value:function(e){var t=this._fieldInfoMap,n=this._sourceLayer,r=this.graphic,i=this._expressionAttributes;return he({attributes:r.attributes,fieldInfoMap:t,globalAttributes:this.formattedAttributes.global,expressionAttributes:i,layer:n,text:e})}},{key:"_getTitle",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._effectivePopupTemplate,n=this.graphic,r=null===t||void 0===t?void 0:t.title,e.abrupt("return",oe(r,{graphic:n}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getContent",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._effectivePopupTemplate,n=this.graphic,r=null===t||void 0===t?void 0:t.content,e.abrupt("return",oe(r,{graphic:n}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryFeature",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t){var n,r,i,a,o,l,u,c,d,f,h,m;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._featureAbortController,r=this._sourceLayer,i=this.graphic,a=this._effectivePopupTemplate,o=this.spatialReference,l=this.map,u=this.view,e.next=9,(0,v.E)({content:this._getContent(),title:this._getTitle()});case 9:if(c=e.sent,d=c.content.value,f=c.title.value,n===this._featureAbortController&&i){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,Le({graphic:i,popupTemplate:a,layer:r,spatialReference:o},t);case 16:return e.next=18,(0,v.E)({checkForRelatedFeatures:this._checkForRelatedFeatures(t),expressionAttributes:yr({expressionInfos:null===a||void 0===a?void 0:a.expressionInfos,spatialReference:o,graphic:i,map:l,interceptor:Ar.interceptor,view:u})});case 18:h=e.sent,m=h.expressionAttributes.value,n===this._featureAbortController&&i&&(this._expressionAttributes=m,this._graphicExpressionAttributes=(0,p.Z)((0,p.Z)({},i.attributes),m),this._set("formattedAttributes",this._createFormattedAttributes(d)),this._set("title",this._compileTitle(f)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(d)||null));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createMediaFormattedAttributes",value:function(e){var t=e.contentElement,n=e.contentElementIndex,r=e.formattedAttributes,i=this._effectivePopupTemplate,a=this.graphic,o=this.relatedInfos,s=this._sourceLayer,l=this._fieldInfoMap,u=this._graphicExpressionAttributes;r.content[n]=Fe({fieldInfos:null===i||void 0===i?void 0:i.fieldInfos,graphic:a,attributes:(0,p.Z)((0,p.Z)({},u),t.attributes),layer:s,fieldInfoMap:l,relatedInfos:o})}},{key:"_createFieldsFormattedAttributes",value:function(e){var t=e.contentElement,n=e.contentElementIndex,r=e.formattedAttributes;if(t.fieldInfos){var i=this.graphic,a=this.relatedInfos,o=this._sourceLayer,s=this._fieldInfoMap,l=this._graphicExpressionAttributes;r.content[n]=Fe({fieldInfos:t.fieldInfos,graphic:i,attributes:(0,p.Z)((0,p.Z)({},l),t.attributes),layer:o,fieldInfoMap:s,relatedInfos:a})}}},{key:"_createFormattedAttributes",value:function(e){var t=this,n=this._effectivePopupTemplate,r=this.graphic,i=this.relatedInfos,a=this._sourceLayer,o=this._fieldInfoMap,s=this._graphicExpressionAttributes,l={global:Fe({fieldInfos:null===n||void 0===n?void 0:n.fieldInfos,graphic:r,attributes:s,layer:a,fieldInfoMap:o,relatedInfos:i}),content:[]};return Array.isArray(e)&&e.forEach((function(e,n){"fields"===e.type&&t._createFieldsFormattedAttributes({contentElement:e,contentElementIndex:n,formattedAttributes:l}),"media"===e.type&&t._createMediaFormattedAttributes({contentElement:e,contentElementIndex:n,formattedAttributes:l})})),l}},{key:"_checkForRelatedFeatures",value:function(e){var t=this.graphic,n=this._effectivePopupTemplate;return this._queryRelatedInfos(t,ke(n),e)}},{key:"_queryRelatedInfos",value:function(){var e=(0,h.Z)((0,s.Z)().mark((function e(t,n,r){var i,a,o,l,u,c,d=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.relatedInfos,a=this._sourceLayer,i.clear(),!(0,b.r)(a.associatedLayer)){e.next=8;break}return e.next=5,a.associatedLayer.load(r);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=a;case 9:if(o=e.t0){e.next=12;break}return e.abrupt("return");case 12:if(l=n.filter((function(e){return e&&Re(e.fieldName)})),l&&l.length){e.next=15;break}return e.abrupt("return");case 15:return n.forEach((function(e){return d._configureRelatedInfo(e,o)})),e.next=18,wn({relatedInfos:i,layer:o},r);case 18:return u=e.sent,Object.keys(u).forEach((function(e){var t,n=i.get(e.toString()),r=null===(t=u[e])||void 0===t?void 0:t.value;n&&r&&(n.layerInfo=r.data)})),e.next=22,In({graphic:t,relatedInfos:i,layer:o},r);case 22:c=e.sent,Object.keys(c).forEach((function(e){var t;yn(null===(t=c[e])||void 0===t?void 0:t.value,i.get(e.toString()))}));case 24:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_configureRelatedInfo",value:function(e,t){var n=this.relatedInfos,r=pn(e.fieldName);if(r){var i=r.layerId,a=r.fieldName;if(i){var o=n.get(i.toString())||mn(i,t);o&&(function(e){var t=e.relatedInfo,n=e.fieldName,r=e.fieldInfo;if(t.relatedFields.push(n),r.statisticType){var i=new O.m({statisticType:r.statisticType,onStatisticField:n,outStatisticFieldName:n});t.outStatistics.push(i)}}({relatedInfo:o,fieldName:a,fieldInfo:e}),this.relatedInfos.set(i,o))}}}}]),n}(v.y);Sr.interceptor=new Zr((function(e){var t=e.query,n=e.layer,r=e.method;Pe({layer:n,method:r,query:t,definitionExpression:"".concat(n.definitionExpression," ").concat(n.serviceDefinitionExpression)})}),(function(e){var t=e.queryPayload,n=e.layer,r=e.method;Pe({layer:n,method:r,query:t,definitionExpression:"".concat(n.definitionExpression," ").concat(n.serviceDefinitionExpression)})})),(0,v.e)([(0,v.d)()],Sr.prototype,"_error",void 0),(0,v.e)([(0,v.d)()],Sr.prototype,"_featureAbortController",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"_effectivePopupTemplate",null),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"_fieldInfoMap",null),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"_sourceLayer",null),(0,v.e)([(0,v.d)()],Sr.prototype,"abilities",void 0),(0,v.e)([(0,v.q)("abilities")],Sr.prototype,"castAbilities",null),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"content",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"contentViewModels",void 0),(0,v.e)([(0,v.d)({type:Boolean})],Sr.prototype,"defaultPopupTemplateEnabled",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"state",null),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"formattedAttributes",void 0),(0,v.e)([(0,v.d)({type:x.g,value:null})],Sr.prototype,"graphic",null),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"lastEditInfo",void 0),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"relatedInfos",void 0),(0,v.e)([(0,v.d)()],Sr.prototype,"spatialReference",null),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"title",void 0),(0,v.e)([(0,v.d)()],Sr.prototype,"map",null),(0,v.e)([(0,v.d)({readOnly:!0})],Sr.prototype,"waitingForContent",null),(0,v.e)([(0,v.d)()],Sr.prototype,"view",void 0);var Rr=Sr=Ar=(0,v.e)([(0,v.n)(Tr)],Sr),Nr=function(e){var t=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;return(0,l.Z)(this,n),(e=t.apply(this,arguments)).renderNodeContent=function(t){return(0,R.e)(t)&&!t.destroyed?(0,_.n)("div",{key:t},t.render()):t instanceof HTMLElement?(0,_.n)("div",{key:t,bind:t,afterCreate:e._attachToNode}):(0,R.t)(t)?(0,_.n)("div",{key:t,bind:t.domNode,afterCreate:e._attachToNode}):null},e}return(0,u.Z)(n,[{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),n}(e);return t=(0,v.e)([(0,v.n)("esri.widgets.Feature.ContentMixin")],t)},Or="esri-icon-loading-indicator esri-rotating",Pr="esri-widget",zr="esri-feature",jr="esri-feature__size-container",Vr="esri-feature__title",qr="esri-feature__main-container",Ur="esri-feature__content-element",Dr="esri-feature__text",Wr="esri-feature__last-edited-info",Br="esri-feature__loading-container",Kr="esri-feature__loading-spinner",$r={title:!0,content:!0,lastEditedInfo:!0},Gr=function(e){(0,c.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;return(0,l.Z)(this,r),(i=t.call(this,e,n))._contentWidgets=[],i.graphic=null,i.defaultPopupTemplateEnabled=!1,i.headingLevel=2,i.label=void 0,i.messages=null,i.messagesCommon=null,i.messagesURIUtils=null,i.spatialReference=null,i.title=null,i.visibleElements=(0,p.Z)({},$r),i.map=null,i.view=null,i.viewModel=new Rr,i}return(0,u.Z)(r,[{key:"initialize",value:function(){var e=this;this.own((0,y.l)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentViewModels}),(function(){return e._setupContentWidgets()}),y.h))}},{key:"loadDependencies",value:function(){return n.e(3858).then(n.bind(n,73858))}},{key:"destroy",value:function(){this._destroyContentWidgets()}},{key:"castVisibleElements",value:function(e){return(0,p.Z)((0,p.Z)({},$r),e)}},{key:"render",value:function(){var e=this.viewModel.state,t=(0,_.n)("div",{class:jr,key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return(0,_.n)("div",{class:this.classes(zr,Pr)},t)}},{key:"setActiveMedia",value:function(e,t){this.viewModel.setActiveMedia(e,t)}},{key:"nextMedia",value:function(e){this.viewModel.nextMedia(e)}},{key:"previousMedia",value:function(e){this.viewModel.previousMedia(e)}},{key:"renderError",value:function(){var e=this.messagesCommon,t=this.messages,n=this.visibleElements;return(0,_.n)("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},n.title?(0,_.n)("div",{key:"error-title",slot:"title"},e.errorMessage):null,(0,_.n)("div",{key:"error-message",slot:"message"},t.loadingError))}},{key:"renderLoading",value:function(){return(0,_.n)("div",{key:"loading-container",class:Br},(0,_.n)("span",{class:this.classes(Or,Kr)}))}},{key:"renderContentContainer",value:function(){return this.visibleElements.content?(0,_.n)("div",{class:qr},[this.renderContent(),this.renderLastEditInfo()]):null}},{key:"renderTitle",value:function(){var e=this.visibleElements,t=this.title;return e.title?(0,_.n)(L.n,{level:this.headingLevel,class:Vr,innerHTML:t}):null}},{key:"renderContent",value:function(){var e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?(0,_.n)("div",{key:"".concat(t,"-content-elements")},e.map(this.renderContentElement,this)):null;if("string"==typeof e){var n=this._contentWidgets[0];return!n||n.destroyed?null:(0,_.n)("div",{key:"".concat(t,"-content")},n.render())}return this.renderNodeContent(e)}},{key:"renderContentElement",value:function(e,t){var n=this.visibleElements;if("boolean"!=typeof n.content&&!n.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);case"expression":return this.renderExpression(t);default:return null}}},{key:"renderAttachments",value:function(e){var t=this._contentWidgets[e];if(!t||t.destroyed)return null;var n=t.viewModel,r=n.state,i=n.attachmentInfos;return"loading"===r||i.length>0?(0,_.n)("div",{key:this._buildKey("attachments-element",e),class:this.classes(Ur)},t.render()):null}},{key:"renderExpression",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,_.n)("div",{key:this._buildKey("expression-element",e),class:Ur},t.render())}},{key:"renderCustom",value:function(e,t){var n=e.creator,r=this._contentWidgets[t];return!r||r.destroyed?null:n?(0,_.n)("div",{key:this._buildKey("custom-element",t),class:Ur},r.render()):null}},{key:"renderFields",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,_.n)("div",{key:this._buildKey("fields-element",e),class:Ur},t.render())}},{key:"renderMedia",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,_.n)("div",{key:this._buildKey("media-element",e),class:Ur},t.render())}},{key:"renderLastEditInfo",value:function(){var e=this.visibleElements,t=this.messages,n=this.viewModel.lastEditInfo;if(!n||!e.lastEditedInfo)return null;var r=n.date,i=n.user,a="edit"===n.type?i?t.lastEditedByUser:t.lastEdited:i?t.lastCreatedByUser:t.lastCreated,o=(0,m.s)(a,{date:r,user:i});return(0,_.n)("div",{key:"edit-info-element",class:this.classes(Wr,Ur)},o)}},{key:"renderText",value:function(e,t){var n=e.text,r=this._contentWidgets[t];return!r||r.destroyed?null:n?(0,_.n)("div",{key:this._buildKey("text-element",t),class:this.classes(Ur,Dr)},r.render()):null}},{key:"_buildKey",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"".concat(e,"__").concat(this.get("viewModel.graphic.uid")||"0","-").concat(n.join("-"))}},{key:"_destroyContentWidget",value:function(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}},{key:"_destroyContentWidgets",value:function(){var e=this;this._contentWidgets.forEach((function(t){return e._destroyContentWidget(t)})),this._contentWidgets=[]}},{key:"_setupContentWidgets",value:function(){var e=this;this._destroyContentWidgets();var t=this.headingLevel,n=this.visibleElements,r=this.get("viewModel.content"),i=this.viewModel.contentViewModels;if(Array.isArray(r))r.forEach((function(r,a){"attachments"===r.type&&(e._contentWidgets[a]=new Bt({displayType:r.displayType,headingLevel:n.title?t+1:t,viewModel:i[a]})),"fields"===r.type&&(e._contentWidgets[a]=new cn({viewModel:i[a]})),"media"===r.type&&(e._contentWidgets[a]=new or({viewModel:i[a]})),"text"===r.type&&(e._contentWidgets[a]=new Xt({viewModel:i[a]})),"custom"===r.type&&(e._contentWidgets[a]=new Xt({viewModel:i[a]})),"expression"===r.type&&(e._contentWidgets[a]=new Fr({viewModel:i[a]}))}),this);else{var a=i[0];a&&!a.destroyed&&(this._contentWidgets[0]=new Xt({viewModel:a}))}this.scheduleRender()}}]),r}(Nr(_.O));(0,v.e)([(0,g.o)("viewModel.graphic")],Gr.prototype,"graphic",void 0),(0,v.e)([(0,g.o)("viewModel.defaultPopupTemplateEnabled")],Gr.prototype,"defaultPopupTemplateEnabled",void 0),(0,v.e)([(0,v.d)()],Gr.prototype,"headingLevel",void 0),(0,v.e)([(0,v.d)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Gr.prototype,"label",void 0),(0,v.e)([(0,v.d)(),(0,_.e)("esri/widgets/Feature/t9n/Feature")],Gr.prototype,"messages",void 0),(0,v.e)([(0,v.d)(),(0,_.e)("esri/t9n/common")],Gr.prototype,"messagesCommon",void 0),(0,v.e)([(0,v.d)(),(0,_.e)("esri/widgets/support/t9n/uriUtils")],Gr.prototype,"messagesURIUtils",void 0),(0,v.e)([(0,g.o)("viewModel.spatialReference")],Gr.prototype,"spatialReference",void 0),(0,v.e)([(0,g.o)("viewModel.title")],Gr.prototype,"title",void 0),(0,v.e)([(0,v.d)()],Gr.prototype,"visibleElements",void 0),(0,v.e)([(0,v.q)("visibleElements")],Gr.prototype,"castVisibleElements",null),(0,v.e)([(0,g.o)("viewModel.map")],Gr.prototype,"map",void 0),(0,v.e)([(0,g.o)("viewModel.view")],Gr.prototype,"view",void 0),(0,v.e)([(0,v.d)({type:Rr})],Gr.prototype,"viewModel",void 0);var Yr=Gr=(0,v.e)([(0,v.n)("esri.widgets.Feature")],Gr),Hr=Object.freeze({__proto__:null,default:Yr})},50905:function(e,t,n){n.d(t,{n:function(){return m},p:function(){return h}});var r=n(43144),i=n(15671),a=n(60136),o=n(29388),s=n(23132),l=n(2157),u=n(70441),c=(n(75610),n(30709)),d=n(43124),f=new(n(57714).s)({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"}),p=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).name=null,r.description=null,r.drawingTool=null,r.prototype=null,r.thumbnail=null,r}return(0,r.Z)(n)}((0,l.l)(u.l));(0,s.e)([(0,s.d)({json:{write:!0}})],p.prototype,"name",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],p.prototype,"description",void 0),(0,s.e)([(0,s.d)({json:{read:f.read,write:f.write}})],p.prototype,"drawingTool",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],p.prototype,"prototype",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],p.prototype,"thumbnail",void 0);var h=p=(0,s.e)([(0,s.n)("esri.layers.support.FeatureTemplate")],p),v=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).id=null,r.name=null,r.domains=null,r.templates=null,r}return(0,r.Z)(n,[{key:"readDomains",value:function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t[i]=(0,d.t)(e[i])}return t}},{key:"writeDomains",value:function(e,t){for(var n={},r=0,i=Object.keys(e);r<i.length;r++){var a,o=i[r];e[o]&&(n[o]=null===(a=e[o])||void 0===a?void 0:a.toJSON())}t.domains=n}}]),n}((0,l.l)(u.l));(0,s.e)([(0,s.d)({json:{write:!0}})],v.prototype,"id",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],v.prototype,"name",void 0),(0,s.e)([(0,s.d)({json:{write:!0}})],v.prototype,"domains",void 0),(0,s.e)([(0,c.o)("domains")],v.prototype,"readDomains",null),(0,s.e)([(0,c.r)("domains")],v.prototype,"writeDomains",null),(0,s.e)([(0,s.d)({type:[h],json:{write:!0}})],v.prototype,"templates",void 0);var m=v=(0,s.e)([(0,s.n)("esri.layers.support.FeatureType")],v)},77196:function(e,t,n){n.d(t,{o:function(){return d},s:function(){return c}});var r=n(43144),i=n(15671),a=n(97326),o=n(60136),s=n(29388),l=n(23132),u=0,c=function(e){var t=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,i.Z)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object.defineProperty((0,a.Z)(e),"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+u++}),e}return(0,r.Z)(n)}(e);return t=(0,l.e)([(0,l.n)("esri.core.Identifiable")],t)},d=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n)}(c(function(){return(0,r.Z)((function e(){(0,i.Z)(this,e)}))}()));d=(0,l.e)([(0,l.n)("esri.core.Identifiable")],d)},70516:function(e,t,n){n.d(t,{p:function(){return f}});var r,i=n(15671),a=n(43144),o=n(60136),s=n(29388),l=n(23132),u=n(80175),c=n(70441),d=(n(75610),r=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).floorField=null,r.viewAllMode=!1,r.viewAllLevelIds=new u.j,r}return(0,a.Z)(n,[{key:"clone",value:function(){return new r({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}}]),n}(c.l));(0,l.e)([(0,l.d)({type:String,json:{write:!0}})],d.prototype,"floorField",void 0),(0,l.e)([(0,l.d)({json:{read:!1,write:!1}})],d.prototype,"viewAllMode",void 0),(0,l.e)([(0,l.d)({json:{read:!1,write:!1}})],d.prototype,"viewAllLevelIds",void 0);var f=d=r=(0,l.e)([(0,l.n)("esri.layers.support.LayerFloorInfo")],d)},97866:function(e,t,n){n.d(t,{I:function(){return w},L:function(){return b},S:function(){return g},b:function(){return _},d:function(){return f},g:function(){return y},h:function(){return v},j:function(){return I},m:function(){return p},w:function(){return h},y:function(){return m}});var r=n(29439),i=n(75610),a=n(57714),o=n(96349),s={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},l=Object.values(s),u=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),c=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),d=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function f(e){return!!u.test(e)}function p(e){if((0,i.t)(e))return null;var t=(0,a.j)(e),n=t.path.match(u)||t.path.match(c);if(!n)return null;var o=(0,r.Z)(n,5),l=o[1],d=o[2],f=o[3],p=o[4],h=d.indexOf("/");return{title:v(-1!==h?d.slice(h+1):d),serverType:s[f.toLowerCase()],sublayer:null!=p&&""!==p?parseInt(p,10):null,url:{path:l}}}function h(e){var t=(0,a.j)(e).path.match(d);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function v(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function m(e,t){var n=[];if(e){var r=p(e);(0,i.r)(r)&&r.title&&n.push(r.title)}if(t){var a=v(t);n.push(a)}if(2===n.length){if(n[0].toLowerCase().includes(n[1].toLowerCase()))return n[0];if(n[1].toLowerCase().includes(n[0].toLowerCase()))return n[1]}return n.join(" - ")}function y(e){if(!e)return!1;var t=(e=e.toLowerCase()).includes(".arcgis.com/"),n=e.includes("//services")||e.includes("//tiles")||e.includes("//features");return t&&n}function g(e,t){return e?(0,a.C)((0,a.A)(e,t)):e}function b(e){var t=e.url;if(!t)return{url:t};t=(0,a.A)(t,e.logger);var n,r=(0,a.j)(t),o=p(r.path);if((0,i.r)(o))null!=o.sublayer&&null==e.layer.layerId&&(n=o.sublayer),t=o.url.path;else if(e.nonStandardUrlAllowed){var s=h(r.path);(0,i.r)(s)&&(t=s.serviceUrl,n=s.sublayerId)}return{url:(0,a.C)(t),layerId:n}}function _(e,t,n,r,i){(0,o.p)(t,r,"url",i),r.url&&null!=e.layerId&&(r.url=(0,a.G)(r.url,n,e.layerId.toString()))}function w(e){if(!e)return!1;var t=e.toLowerCase(),n=t.includes("/services/"),r=t.includes("/mapserver/wmsserver"),i=t.includes("/imageserver/wmsserver"),a=t.includes("/wmsserver");return n&&(r||i||a)}function I(e){if(!e)return!1;var t=new a.y((0,a.Q)(e)).authority.toLowerCase();return"server.arcgisonline.com"===t||"services.arcgisonline.com"===t}},48561:function(e,t,n){function r(e){return 32+e.length}function i(){return 16}function a(e){if(!e)return 0;var t=32;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];switch(typeof i){case"string":t+=r(i);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function o(e,t){return 32+e.length*t}var s;n.d(t,{e:function(){return o},n:function(){return r},o:function(){return s},r:function(){return a},t:function(){return i}}),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(s||(s={}))},50338:function(e,t,n){n.d(t,{S:function(){return s},e:function(){return r},i:function(){return i},l:function(){return a},o:function(){return o},r:function(){return u},s:function(){return c},t:function(){return l},y:function(){return d}});var r=[252,146,31,255],i=[153,153,153,255],a={type:"esriSMS",style:"esriSMSCircle",size:6,color:r,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},o={type:"esriSLS",style:"esriSLSSolid",width:.75,color:r},s={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},l={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},u={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},c={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},d={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},32568:function(e,t,n){n.d(t,{a:function(){return k},l:function(){return _},s:function(){return w}});var r,i=n(1413),a=n(74165),o=n(15861),s=n(15671),l=n(43144),u=n(60136),c=n(29388),d=n(23132),f=n(70441),p=(n(75610),n(69202)),h=n(27597),v=n(15612),m=n(34860);function y(e){var t=e.exifInfo,n=e.exifName,r=e.tagName;if(!t||!n||!r)return null;var i=t.find((function(e){return e.name===n}));return i?function(e){var t=e.tagName,n=e.tags;if(!n||!t)return null;var r=n.find((function(e){return e.name===t}));return r&&r.value||null}({tagName:r,tags:i.tags}):null}var g={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}},b=r=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).contentType=null,r.exifInfo=null,r.id=null,r.globalId=null,r.keywords=null,r.name=null,r.parentGlobalId=null,r.parentObjectId=null,r.size=null,r.url=null,r}return(0,l.Z)(n,[{key:"orientationInfo",get:function(){var e=y({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return g[e]||null}},{key:"clone",value:function(){return new r({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}}]),n}(f.l);(0,d.e)([(0,d.d)({type:String})],b.prototype,"contentType",void 0),(0,d.e)([(0,d.d)()],b.prototype,"exifInfo",void 0),(0,d.e)([(0,d.d)({readOnly:!0})],b.prototype,"orientationInfo",null),(0,d.e)([(0,d.d)({type:d.S})],b.prototype,"id",void 0),(0,d.e)([(0,d.d)({type:String})],b.prototype,"globalId",void 0),(0,d.e)([(0,d.d)({type:String})],b.prototype,"keywords",void 0),(0,d.e)([(0,d.d)({type:String})],b.prototype,"name",void 0),(0,d.e)([(0,d.d)({json:{read:!1}})],b.prototype,"parentGlobalId",void 0),(0,d.e)([(0,d.d)({json:{read:!1}})],b.prototype,"parentObjectId",void 0),(0,d.e)([(0,d.d)({type:d.S})],b.prototype,"size",void 0),(0,d.e)([(0,d.d)({json:{read:!1}})],b.prototype,"url",void 0);var _=b=r=(0,d.e)([(0,d.n)("esri.layers.support.AttachmentInfo")],b);function w(e,t,n){return I.apply(this,arguments)}function I(){return I=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t,n,r);case 2:return i=e.sent,e.abrupt("return",v.default.fromJSON(i));case 4:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function k(e,t,n){return M.apply(this,arguments)}function M(){return M=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var o,s,l,u,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,p.n)(t),s=(0,i.Z)({},r),l=m.b.from(n),e.next=5,(0,h.c)(o,l,l.sourceSpatialReference,s);case 5:return u=e.sent,c=u.data,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)}))),M.apply(this,arguments)}},28999:function(e,t,n){n.d(t,{r:function(){return o}});var r=n(37762),i=n(75610),a=n(69953);function o(e,t,n){if(n&&n.features&&n.hasZ){var o=(0,a.o)(n.geometryType,t,e.outSpatialReference);if(!(0,i.t)(o)){var s,l=(0,r.Z)(n.features);try{for(l.s();!(s=l.n()).done;){o(s.value.geometry)}}catch(u){l.e(u)}finally{l.f()}}}}},69202:function(e,t,n){n.d(t,{e:function(){return o},n:function(){return s},o:function(){return l}});var r=n(1413),i=n(75610),a=n(57714);function o(e,t){return t?(0,r.Z)((0,r.Z)({},t),{},{query:(0,r.Z)((0,r.Z)({},e),t.query)}):{query:e}}function s(e){return"string"==typeof e?(0,a.j)(e):(0,i.m)(e)}function l(e,t,n){var r={};for(var i in e)if("declaredClass"!==i){var a=e[i];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){r[i]=[];for(var o=0;o<a.length;o++)r[i][o]=l(a[o])}else if("object"==typeof a)if(a.toJSON){var s=a.toJSON(n&&n[i]);r[i]=t?s:JSON.stringify(s)}else r[i]=t?a:JSON.stringify(a);else r[i]=a}return r}},79042:function(e,t,n){n.d(t,{e:function(){return r},t:function(){return i}});n(84538);function r(e){return e&&"function"==typeof e.render}function i(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}},69953:function(e,t,n){n.d(t,{o:function(){return s}});var r=n(37762),i=n(75610),a=n(44455),o=n(30709);function s(e,t,n){if((0,i.t)(t)||(0,i.t)(n)||n.vcsWkid||(0,o.E)(t,n))return null;var s=(0,a.W)(t)/(0,a.W)(n);if(1===s)return null;switch(e){case"point":case"esriGeometryPoint":return function(e){return function(e,t){e&&null!=e.z&&(e.z*=t)}(e,s)};case"polyline":case"esriGeometryPolyline":return function(e){return function(e,t){if(e){var n,i=(0,r.Z)(e.paths);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=(0,r.Z)(o);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.length>2&&(l[2]*=t)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){i.e(u)}finally{i.f()}}}(e,s)};case"polygon":case"esriGeometryPolygon":return function(e){return function(e,t){if(e){var n,i=(0,r.Z)(e.rings);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=(0,r.Z)(o);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.length>2&&(l[2]*=t)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){i.e(u)}finally{i.f()}}}(e,s)};case"multipoint":case"esriGeometryMultipoint":return function(e){return function(e,t){if(e){var n,i=(0,r.Z)(e.points);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.length>2&&(a[2]*=t)}}catch(o){i.e(o)}finally{i.f()}}}(e,s)};case"extent":case"esriGeometryExtent":return function(e){return function(e,t){e&&null!=e.zmin&&null!=e.zmax&&(e.zmin*=t,e.zmax*=t)}(e,s)};default:return null}}}}]);
//# sourceMappingURL=1530.a61d250b.chunk.js.map